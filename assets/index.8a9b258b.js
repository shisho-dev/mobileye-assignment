(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))s(g);new MutationObserver(g=>{for(const T of g)if(T.type==="childList")for(const I of T.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&s(I)}).observe(document,{childList:!0,subtree:!0});function r(g){const T={};return g.integrity&&(T.integrity=g.integrity),g.referrerpolicy&&(T.referrerPolicy=g.referrerpolicy),g.crossorigin==="use-credentials"?T.credentials="include":g.crossorigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function s(g){if(g.ep)return;g.ep=!0;const T=r(g);fetch(g.href,T)}})();function sm(t,e){const r=Object.create(null),s=t.split(",");for(let g=0;g<s.length;g++)r[s[g]]=!0;return e?g=>!!r[g.toLowerCase()]:g=>!!r[g]}const I6="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",D6=sm(I6),R6="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hk=sm(R6);function dk(t){return!!t||t===""}function am(t){if(rr(t)){const e={};for(let r=0;r<t.length;r++){const s=t[r],g=Sn(s)?k6(s):am(s);if(g)for(const T in g)e[T]=g[T]}return e}else{if(Sn(t))return t;if(Ei(t))return t}}const L6=/;(?![^(]*\))/g,B6=/:(.+)/;function k6(t){const e={};return t.split(L6).forEach(r=>{if(r){const s=r.split(B6);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function eh(t){let e="";if(Sn(t))e=t;else if(rr(t))for(let r=0;r<t.length;r++){const s=eh(t[r]);s&&(e+=s+" ")}else if(Ei(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function z6(t){if(!t)return null;let{class:e,style:r}=t;return e&&!Sn(e)&&(t.class=eh(e)),r&&(t.style=am(r)),t}function F6(t,e){if(t.length!==e.length)return!1;let r=!0;for(let s=0;r&&s<t.length;s++)r=Ac(t[s],e[s]);return r}function Ac(t,e){if(t===e)return!0;let r=lM(t),s=lM(e);if(r||s)return r&&s?t.getTime()===e.getTime():!1;if(r=W_(t),s=W_(e),r||s)return t===e;if(r=rr(t),s=rr(e),r||s)return r&&s?F6(t,e):!1;if(r=Ei(t),s=Ei(e),r||s){if(!r||!s)return!1;const g=Object.keys(t).length,T=Object.keys(e).length;if(g!==T)return!1;for(const I in t){const a=t.hasOwnProperty(I),N=e.hasOwnProperty(I);if(a&&!N||!a&&N||!Ac(t[I],e[I]))return!1}}return String(t)===String(e)}function my(t,e){return t.findIndex(r=>Ac(r,e))}const nO=t=>Sn(t)?t:t==null?"":rr(t)||Ei(t)&&(t.toString===pk||!Dr(t.toString))?JSON.stringify(t,fk,2):String(t),fk=(t,e)=>e&&e.__v_isRef?fk(t,e.value):kp(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[s,g])=>(r[`${s} =>`]=g,r),{})}:Gd(e)?{[`Set(${e.size})`]:[...e.values()]}:Ei(e)&&!rr(e)&&!R0(e)?String(e):e,Zi={},Bp=[],Ps=()=>{},N6=()=>!1,$6=/^on[^a-z]/,Bc=t=>$6.test(t),oO=t=>t.startsWith("onUpdate:"),Mi=Object.assign,sO=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},j6=Object.prototype.hasOwnProperty,Ai=(t,e)=>j6.call(t,e),rr=Array.isArray,kp=t=>gy(t)==="[object Map]",Gd=t=>gy(t)==="[object Set]",lM=t=>gy(t)==="[object Date]",Dr=t=>typeof t=="function",Sn=t=>typeof t=="string",W_=t=>typeof t=="symbol",Ei=t=>t!==null&&typeof t=="object",Sx=t=>Ei(t)&&Dr(t.then)&&Dr(t.catch),pk=Object.prototype.toString,gy=t=>pk.call(t),V6=t=>gy(t).slice(8,-1),R0=t=>gy(t)==="[object Object]",aO=t=>Sn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,zp=sm(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ox=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},U6=/-(\w)/g,Rs=Ox(t=>t.replace(U6,(e,r)=>r?r.toUpperCase():"")),G6=/\B([A-Z])/g,la=Ox(t=>t.replace(G6,"-$1").toLowerCase()),_y=Ox(t=>t.charAt(0).toUpperCase()+t.slice(1)),Fp=Ox(t=>t?`on${_y(t)}`:""),Up=(t,e)=>!Object.is(t,e),Wu=(t,e)=>{for(let r=0;r<t.length;r++)t[r](e)},L0=(t,e,r)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:r})},Cc=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let cM;const H6=()=>cM||(cM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Qs;class lO{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Qs,!e&&Qs&&(this.index=(Qs.scopes||(Qs.scopes=[])).push(this)-1)}run(e){if(this.active){const r=Qs;try{return Qs=this,e()}finally{Qs=r}}}on(){Qs=this}off(){Qs=this.parent}stop(e){if(this.active){let r,s;for(r=0,s=this.effects.length;r<s;r++)this.effects[r].stop();for(r=0,s=this.cleanups.length;r<s;r++)this.cleanups[r]();if(this.scopes)for(r=0,s=this.scopes.length;r<s;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.parent=void 0,this.active=!1}}}function q6(t){return new lO(t)}function mk(t,e=Qs){e&&e.active&&e.effects.push(t)}function W6(){return Qs}function Z6(t){Qs&&Qs.cleanups.push(t)}const cO=t=>{const e=new Set(t);return e.w=0,e.n=0,e},gk=t=>(t.w&th)>0,_k=t=>(t.n&th)>0,X6=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=th},K6=t=>{const{deps:e}=t;if(e.length){let r=0;for(let s=0;s<e.length;s++){const g=e[s];gk(g)&&!_k(g)?g.delete(t):e[r++]=g,g.w&=~th,g.n&=~th}e.length=r}},NE=new WeakMap;let v_=0,th=1;const $E=30;let Qa;const Sd=Symbol(""),jE=Symbol("");class yy{constructor(e,r=null,s){this.fn=e,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,mk(this,s)}run(){if(!this.active)return this.fn();let e=Qa,r=Zu;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Qa,Qa=this,Zu=!0,th=1<<++v_,v_<=$E?X6(this):uM(this),this.fn()}finally{v_<=$E&&K6(this),th=1<<--v_,Qa=this.parent,Zu=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Qa===this?this.deferStop=!0:this.active&&(uM(this),this.onStop&&this.onStop(),this.active=!1)}}function uM(t){const{deps:e}=t;if(e.length){for(let r=0;r<e.length;r++)e[r].delete(t);e.length=0}}function Y6(t,e){t.effect&&(t=t.effect.fn);const r=new yy(t);e&&(Mi(r,e),e.scope&&mk(r,e.scope)),(!e||!e.lazy)&&r.run();const s=r.run.bind(r);return s.effect=r,s}function J6(t){t.effect.stop()}let Zu=!0;const yk=[];function Hd(){yk.push(Zu),Zu=!1}function qd(){const t=yk.pop();Zu=t===void 0?!0:t}function Ls(t,e,r){if(Zu&&Qa){let s=NE.get(t);s||NE.set(t,s=new Map);let g=s.get(r);g||s.set(r,g=cO()),vk(g)}}function vk(t,e){let r=!1;v_<=$E?_k(t)||(t.n|=th,r=!gk(t)):r=!t.has(Qa),r&&(t.add(Qa),Qa.deps.push(t))}function Vl(t,e,r,s,g,T){const I=NE.get(t);if(!I)return;let a=[];if(e==="clear")a=[...I.values()];else if(r==="length"&&rr(t))I.forEach((N,H)=>{(H==="length"||H>=s)&&a.push(N)});else switch(r!==void 0&&a.push(I.get(r)),e){case"add":rr(t)?aO(r)&&a.push(I.get("length")):(a.push(I.get(Sd)),kp(t)&&a.push(I.get(jE)));break;case"delete":rr(t)||(a.push(I.get(Sd)),kp(t)&&a.push(I.get(jE)));break;case"set":kp(t)&&a.push(I.get(Sd));break}if(a.length===1)a[0]&&VE(a[0]);else{const N=[];for(const H of a)H&&N.push(...H);VE(cO(N))}}function VE(t,e){const r=rr(t)?t:[...t];for(const s of r)s.computed&&hM(s);for(const s of r)s.computed||hM(s)}function hM(t,e){(t!==Qa||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Q6=sm("__proto__,__v_isRef,__isVue"),bk=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(W_)),eU=Px(),tU=Px(!1,!0),rU=Px(!0),iU=Px(!0,!0),dM=nU();function nU(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...r){const s=ki(this);for(let T=0,I=this.length;T<I;T++)Ls(s,"get",T+"");const g=s[e](...r);return g===-1||g===!1?s[e](...r.map(ki)):g}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...r){Hd();const s=ki(this)[e].apply(this,r);return qd(),s}}),t}function Px(t=!1,e=!1){return function(s,g,T){if(g==="__v_isReactive")return!t;if(g==="__v_isReadonly")return t;if(g==="__v_isShallow")return e;if(g==="__v_raw"&&T===(t?e?Pk:Ok:e?Sk:Ek).get(s))return s;const I=rr(s);if(!t&&I&&Ai(dM,g))return Reflect.get(dM,g,T);const a=Reflect.get(s,g,T);return(W_(g)?bk.has(g):Q6(g))||(t||Ls(s,"get",g),e)?a:so(a)?I&&aO(g)?a:a.value:Ei(a)?t?hO(a):rh(a):a}}const oU=xk(),sU=xk(!0);function xk(t=!1){return function(r,s,g,T){let I=r[s];if(Rd(I)&&so(I)&&!so(g))return!1;if(!t&&(!Z_(g)&&!Rd(g)&&(I=ki(I),g=ki(g)),!rr(r)&&so(I)&&!so(g)))return I.value=g,!0;const a=rr(r)&&aO(s)?Number(s)<r.length:Ai(r,s),N=Reflect.set(r,s,g,T);return r===ki(T)&&(a?Up(g,I)&&Vl(r,"set",s,g):Vl(r,"add",s,g)),N}}function aU(t,e){const r=Ai(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&r&&Vl(t,"delete",e,void 0),s}function lU(t,e){const r=Reflect.has(t,e);return(!W_(e)||!bk.has(e))&&Ls(t,"has",e),r}function cU(t){return Ls(t,"iterate",rr(t)?"length":Sd),Reflect.ownKeys(t)}const wk={get:eU,set:oU,deleteProperty:aU,has:lU,ownKeys:cU},Tk={get:rU,set(t,e){return!0},deleteProperty(t,e){return!0}},uU=Mi({},wk,{get:tU,set:sU}),hU=Mi({},Tk,{get:iU}),uO=t=>t,Ax=t=>Reflect.getPrototypeOf(t);function Ob(t,e,r=!1,s=!1){t=t.__v_raw;const g=ki(t),T=ki(e);r||(e!==T&&Ls(g,"get",e),Ls(g,"get",T));const{has:I}=Ax(g),a=s?uO:r?pO:X_;if(I.call(g,e))return a(t.get(e));if(I.call(g,T))return a(t.get(T));t!==g&&t.get(e)}function Pb(t,e=!1){const r=this.__v_raw,s=ki(r),g=ki(t);return e||(t!==g&&Ls(s,"has",t),Ls(s,"has",g)),t===g?r.has(t):r.has(t)||r.has(g)}function Ab(t,e=!1){return t=t.__v_raw,!e&&Ls(ki(t),"iterate",Sd),Reflect.get(t,"size",t)}function fM(t){t=ki(t);const e=ki(this);return Ax(e).has.call(e,t)||(e.add(t),Vl(e,"add",t,t)),this}function pM(t,e){e=ki(e);const r=ki(this),{has:s,get:g}=Ax(r);let T=s.call(r,t);T||(t=ki(t),T=s.call(r,t));const I=g.call(r,t);return r.set(t,e),T?Up(e,I)&&Vl(r,"set",t,e):Vl(r,"add",t,e),this}function mM(t){const e=ki(this),{has:r,get:s}=Ax(e);let g=r.call(e,t);g||(t=ki(t),g=r.call(e,t)),s&&s.call(e,t);const T=e.delete(t);return g&&Vl(e,"delete",t,void 0),T}function gM(){const t=ki(this),e=t.size!==0,r=t.clear();return e&&Vl(t,"clear",void 0,void 0),r}function Cb(t,e){return function(s,g){const T=this,I=T.__v_raw,a=ki(I),N=e?uO:t?pO:X_;return!t&&Ls(a,"iterate",Sd),I.forEach((H,K)=>s.call(g,N(H),N(K),T))}}function Mb(t,e,r){return function(...s){const g=this.__v_raw,T=ki(g),I=kp(T),a=t==="entries"||t===Symbol.iterator&&I,N=t==="keys"&&I,H=g[t](...s),K=r?uO:e?pO:X_;return!e&&Ls(T,"iterate",N?jE:Sd),{next(){const{value:ee,done:ue}=H.next();return ue?{value:ee,done:ue}:{value:a?[K(ee[0]),K(ee[1])]:K(ee),done:ue}},[Symbol.iterator](){return this}}}}function Bu(t){return function(...e){return t==="delete"?!1:this}}function dU(){const t={get(T){return Ob(this,T)},get size(){return Ab(this)},has:Pb,add:fM,set:pM,delete:mM,clear:gM,forEach:Cb(!1,!1)},e={get(T){return Ob(this,T,!1,!0)},get size(){return Ab(this)},has:Pb,add:fM,set:pM,delete:mM,clear:gM,forEach:Cb(!1,!0)},r={get(T){return Ob(this,T,!0)},get size(){return Ab(this,!0)},has(T){return Pb.call(this,T,!0)},add:Bu("add"),set:Bu("set"),delete:Bu("delete"),clear:Bu("clear"),forEach:Cb(!0,!1)},s={get(T){return Ob(this,T,!0,!0)},get size(){return Ab(this,!0)},has(T){return Pb.call(this,T,!0)},add:Bu("add"),set:Bu("set"),delete:Bu("delete"),clear:Bu("clear"),forEach:Cb(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(T=>{t[T]=Mb(T,!1,!1),r[T]=Mb(T,!0,!1),e[T]=Mb(T,!1,!0),s[T]=Mb(T,!0,!0)}),[t,r,e,s]}const[fU,pU,mU,gU]=dU();function Cx(t,e){const r=e?t?gU:mU:t?pU:fU;return(s,g,T)=>g==="__v_isReactive"?!t:g==="__v_isReadonly"?t:g==="__v_raw"?s:Reflect.get(Ai(r,g)&&g in s?r:s,g,T)}const _U={get:Cx(!1,!1)},yU={get:Cx(!1,!0)},vU={get:Cx(!0,!1)},bU={get:Cx(!0,!0)},Ek=new WeakMap,Sk=new WeakMap,Ok=new WeakMap,Pk=new WeakMap;function xU(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function wU(t){return t.__v_skip||!Object.isExtensible(t)?0:xU(V6(t))}function rh(t){return Rd(t)?t:Mx(t,!1,wk,_U,Ek)}function Ak(t){return Mx(t,!1,uU,yU,Sk)}function hO(t){return Mx(t,!0,Tk,vU,Ok)}function TU(t){return Mx(t,!0,hU,bU,Pk)}function Mx(t,e,r,s,g){if(!Ei(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const T=g.get(t);if(T)return T;const I=wU(t);if(I===0)return t;const a=new Proxy(t,I===2?s:r);return g.set(t,a),a}function Sc(t){return Rd(t)?Sc(t.__v_raw):!!(t&&t.__v_isReactive)}function Rd(t){return!!(t&&t.__v_isReadonly)}function Z_(t){return!!(t&&t.__v_isShallow)}function dO(t){return Sc(t)||Rd(t)}function ki(t){const e=t&&t.__v_raw;return e?ki(e):t}function fO(t){return L0(t,"__v_skip",!0),t}const X_=t=>Ei(t)?rh(t):t,pO=t=>Ei(t)?hO(t):t;function mO(t){Zu&&Qa&&(t=ki(t),vk(t.dep||(t.dep=cO())))}function Ix(t,e){t=ki(t),t.dep&&VE(t.dep)}function so(t){return!!(t&&t.__v_isRef===!0)}function Xu(t){return Ck(t,!1)}function EU(t){return Ck(t,!0)}function Ck(t,e){return so(t)?t:new SU(t,e)}class SU{constructor(e,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?e:ki(e),this._value=r?e:X_(e)}get value(){return mO(this),this._value}set value(e){const r=this.__v_isShallow||Z_(e)||Rd(e);e=r?e:ki(e),Up(e,this._rawValue)&&(this._rawValue=e,this._value=r?e:X_(e),Ix(this))}}function OU(t){Ix(t)}function Mk(t){return so(t)?t.value:t}const PU={get:(t,e,r)=>Mk(Reflect.get(t,e,r)),set:(t,e,r,s)=>{const g=t[e];return so(g)&&!so(r)?(g.value=r,!0):Reflect.set(t,e,r,s)}};function gO(t){return Sc(t)?t:new Proxy(t,PU)}class AU{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:r,set:s}=e(()=>mO(this),()=>Ix(this));this._get=r,this._set=s}get value(){return this._get()}set value(e){this._set(e)}}function CU(t){return new AU(t)}function MU(t){const e=rr(t)?new Array(t.length):{};for(const r in t)e[r]=Ik(t,r);return e}class IU{constructor(e,r,s){this._object=e,this._key=r,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function Ik(t,e,r){const s=t[e];return so(s)?s:new IU(t,e,r)}var Dk;class DU{constructor(e,r,s,g){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Dk]=!1,this._dirty=!0,this.effect=new yy(e,()=>{this._dirty||(this._dirty=!0,Ix(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!g,this.__v_isReadonly=s}get value(){const e=ki(this);return mO(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}Dk="__v_isReadonly";function RU(t,e,r=!1){let s,g;const T=Dr(t);return T?(s=t,g=Ps):(s=t.get,g=t.set),new DU(s,g,T||!g,r)}const R_=[];function Rk(t,...e){Hd();const r=R_.length?R_[R_.length-1].component:null,s=r&&r.appContext.config.warnHandler,g=LU();if(s)el(s,r,11,[t+e.join(""),r&&r.proxy,g.map(({vnode:T})=>`at <${$3(r,T.type)}>`).join(`
`),g]);else{const T=[`[Vue warn]: ${t}`,...e];g.length&&T.push(`
`,...BU(g)),console.warn(...T)}qd()}function LU(){let t=R_[R_.length-1];if(!t)return[];const e=[];for(;t;){const r=e[0];r&&r.vnode===t?r.recurseCount++:e.push({vnode:t,recurseCount:0});const s=t.component&&t.component.parent;t=s&&s.vnode}return e}function BU(t){const e=[];return t.forEach((r,s)=>{e.push(...s===0?[]:[`
`],...kU(r))}),e}function kU({vnode:t,recurseCount:e}){const r=e>0?`... (${e} recursive calls)`:"",s=t.component?t.component.parent==null:!1,g=` at <${$3(t.component,t.type,s)}`,T=">"+r;return t.props?[g,...zU(t.props),T]:[g+T]}function zU(t){const e=[],r=Object.keys(t);return r.slice(0,3).forEach(s=>{e.push(...Lk(s,t[s]))}),r.length>3&&e.push(" ..."),e}function Lk(t,e,r){return Sn(e)?(e=JSON.stringify(e),r?e:[`${t}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?r?e:[`${t}=${e}`]:so(e)?(e=Lk(t,ki(e.value),!0),r?e:[`${t}=Ref<`,e,">"]):Dr(e)?[`${t}=fn${e.name?`<${e.name}>`:""}`]:(e=ki(e),r?e:[`${t}=`,e])}function el(t,e,r,s){let g;try{g=s?t(...s):t()}catch(T){Wd(T,e,r)}return g}function As(t,e,r,s){if(Dr(t)){const T=el(t,e,r,s);return T&&Sx(T)&&T.catch(I=>{Wd(I,e,r)}),T}const g=[];for(let T=0;T<t.length;T++)g.push(As(t[T],e,r,s));return g}function Wd(t,e,r,s=!0){const g=e?e.vnode:null;if(e){let T=e.parent;const I=e.proxy,a=r;for(;T;){const H=T.ec;if(H){for(let K=0;K<H.length;K++)if(H[K](t,I,a)===!1)return}T=T.parent}const N=e.appContext.config.errorHandler;if(N){el(N,null,10,[t,I,a]);return}}FU(t,r,g,s)}function FU(t,e,r,s=!0){console.error(t)}let K_=!1,UE=!1;const Vo=[];let zl=0;const Np=[];let gc=null,gd=0;const Bk=Promise.resolve();let _O=null;function vy(t){const e=_O||Bk;return t?e.then(this?t.bind(this):t):e}function NU(t){let e=zl+1,r=Vo.length;for(;e<r;){const s=e+r>>>1;Y_(Vo[s])<t?e=s+1:r=s}return e}function Dx(t){(!Vo.length||!Vo.includes(t,K_&&t.allowRecurse?zl+1:zl))&&(t.id==null?Vo.push(t):Vo.splice(NU(t.id),0,t),kk())}function kk(){!K_&&!UE&&(UE=!0,_O=Bk.then(zk))}function $U(t){const e=Vo.indexOf(t);e>zl&&Vo.splice(e,1)}function yO(t){rr(t)?Np.push(...t):(!gc||!gc.includes(t,t.allowRecurse?gd+1:gd))&&Np.push(t),kk()}function _M(t,e=K_?zl+1:0){for(;e<Vo.length;e++){const r=Vo[e];r&&r.pre&&(Vo.splice(e,1),e--,r())}}function B0(t){if(Np.length){const e=[...new Set(Np)];if(Np.length=0,gc){gc.push(...e);return}for(gc=e,gc.sort((r,s)=>Y_(r)-Y_(s)),gd=0;gd<gc.length;gd++)gc[gd]();gc=null,gd=0}}const Y_=t=>t.id==null?1/0:t.id,jU=(t,e)=>{const r=Y_(t)-Y_(e);if(r===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return r};function zk(t){UE=!1,K_=!0,Vo.sort(jU);const e=Ps;try{for(zl=0;zl<Vo.length;zl++){const r=Vo[zl];r&&r.active!==!1&&el(r,null,14)}}finally{zl=0,Vo.length=0,B0(),K_=!1,_O=null,(Vo.length||Np.length)&&zk()}}let Op,Ib=[];function Fk(t,e){var r,s;Op=t,Op?(Op.enabled=!0,Ib.forEach(({event:g,args:T})=>Op.emit(g,...T)),Ib=[]):typeof window<"u"&&window.HTMLElement&&!(!((s=(r=window.navigator)===null||r===void 0?void 0:r.userAgent)===null||s===void 0)&&s.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(T=>{Fk(T,e)}),setTimeout(()=>{Op||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Ib=[])},3e3)):Ib=[]}function VU(t,e,...r){}const vO={MODE:2};function UU(t){Mi(vO,t)}function yM(t,e){const r=e&&e.type.compatConfig;return r&&t in r?r[t]:vO[t]}function en(t,e,r=!1){if(!r&&e&&e.type.__isBuiltIn)return!1;const s=yM("MODE",e)||2,g=yM(t,e);return(Dr(s)?s(e&&e.type):s)===2?g!==!1:g===!0||g==="suppress-warning"}function Mo(t,e,...r){if(!en(t,e))throw new Error(`${t} compat has been disabled.`)}function Mc(t,e,...r){return en(t,e)}function Rx(t,e,...r){return en(t,e)}const GE=new WeakMap;function bO(t){let e=GE.get(t);return e||GE.set(t,e=Object.create(null)),e}function xO(t,e,r){if(rr(e))e.forEach(s=>xO(t,s,r));else{e.startsWith("hook:")?Mo("INSTANCE_EVENT_HOOKS",t,e):Mo("INSTANCE_EVENT_EMITTER",t);const s=bO(t);(s[e]||(s[e]=[])).push(r)}return t.proxy}function GU(t,e,r){const s=(...g)=>{wO(t,e,s),r.call(t.proxy,...g)};return s.fn=r,xO(t,e,s),t.proxy}function wO(t,e,r){Mo("INSTANCE_EVENT_EMITTER",t);const s=t.proxy;if(!e)return GE.set(t,Object.create(null)),s;if(rr(e))return e.forEach(I=>wO(t,I,r)),s;const g=bO(t),T=g[e];return T?r?(g[e]=T.filter(I=>!(I===r||I.fn===r)),s):(g[e]=void 0,s):s}function HU(t,e,r){const s=bO(t)[e];return s&&As(s.map(g=>g.bind(t.proxy)),t,6,r),t.proxy}const Lx="onModelCompat:";function qU(t){const{type:e,shapeFlag:r,props:s,dynamicProps:g}=t,T=e;if(r&6&&s&&"modelValue"in s){if(!en("COMPONENT_V_MODEL",{type:e}))return;const I=T.model||{};Nk(I,T.mixins);const{prop:a="value",event:N="input"}=I;a!=="modelValue"&&(s[a]=s.modelValue,delete s.modelValue),g&&(g[g.indexOf("modelValue")]=a),s[Lx+N]=s["onUpdate:modelValue"],delete s["onUpdate:modelValue"]}}function Nk(t,e){e&&e.forEach(r=>{r.model&&Mi(t,r.model),r.mixins&&Nk(t,r.mixins)})}function WU(t,e,r){if(!en("COMPONENT_V_MODEL",t))return;const s=t.vnode.props,g=s&&s[Lx+e];g&&el(g,t,6,r)}function ZU(t,e,...r){if(t.isUnmounted)return;const s=t.vnode.props||Zi;let g=r;const T=e.startsWith("update:"),I=T&&e.slice(7);if(I&&I in s){const K=`${I==="modelValue"?"model":I}Modifiers`,{number:ee,trim:ue}=s[K]||Zi;ue&&(g=r.map(Pe=>Pe.trim())),ee&&(g=r.map(Cc))}let a,N=s[a=Fp(e)]||s[a=Fp(Rs(e))];!N&&T&&(N=s[a=Fp(la(e))]),N&&As(N,t,6,g);const H=s[a+"Once"];if(H){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,As(H,t,6,g)}return WU(t,e,g),HU(t,e,g)}function $k(t,e,r=!1){const s=e.emitsCache,g=s.get(t);if(g!==void 0)return g;const T=t.emits;let I={},a=!1;if(!Dr(t)){const N=H=>{const K=$k(H,e,!0);K&&(a=!0,Mi(I,K))};!r&&e.mixins.length&&e.mixins.forEach(N),t.extends&&N(t.extends),t.mixins&&t.mixins.forEach(N)}return!T&&!a?(Ei(t)&&s.set(t,null),null):(rr(T)?T.forEach(N=>I[N]=null):Mi(I,T),Ei(t)&&s.set(t,I),I)}function Bx(t,e){return!t||!Bc(e)?!1:e.startsWith(Lx)?!0:(e=e.slice(2).replace(/Once$/,""),Ai(t,e[0].toLowerCase()+e.slice(1))||Ai(t,la(e))||Ai(t,e))}let Qn=null,$p=null;function J_(t){const e=Qn;return Qn=t,$p=t&&t.type.__scopeId||null,$p||($p=t&&t.type._scopeId||null),e}function XU(t){$p=t}function KU(){$p=null}const YU=t=>Gp;function Gp(t,e=Qn,r){if(!e||t._n)return t;const s=(...g)=>{s._d&&YE(-1);const T=J_(e);let I;try{I=t(...g)}finally{J_(T),s._d&&YE(1)}return I};return s._n=!0,s._c=!0,s._d=!0,r&&(s._ns=!0),s}function o0(t){const{type:e,vnode:r,proxy:s,withProxy:g,props:T,propsOptions:[I],slots:a,attrs:N,emit:H,render:K,renderCache:ee,data:ue,setupState:Pe,ctx:xe,inheritAttrs:Ie}=t;let dt,Le;const De=J_(t);try{if(r.shapeFlag&4){const He=g||s;dt=ra(K.call(He,He,ee,T,Pe,ue,xe)),Le=N}else{const He=e;dt=ra(He.length>1?He(T,{attrs:N,slots:a,emit:H}):He(T,null)),Le=e.props?N:QU(N)}}catch(He){k_.length=0,Wd(He,t,1),dt=Bi(Do)}let Ye=dt;if(Le&&Ie!==!1){const He=Object.keys(Le),{shapeFlag:ht}=Ye;He.length&&ht&7&&(I&&He.some(oO)&&(Le=e8(Le,I)),Ye=tl(Ye,Le))}if(en("INSTANCE_ATTRS_CLASS_STYLE",t)&&r.shapeFlag&4&&Ye.shapeFlag&7){const{class:He,style:ht}=r.props||{};(He||ht)&&(Ye=tl(Ye,{class:He,style:ht}))}return r.dirs&&(Ye=tl(Ye),Ye.dirs=Ye.dirs?Ye.dirs.concat(r.dirs):r.dirs),r.transition&&(Ye.transition=r.transition),dt=Ye,J_(De),dt}function JU(t){let e;for(let r=0;r<t.length;r++){const s=t[r];if(ua(s)){if(s.type!==Do||s.children==="v-if"){if(e)return;e=s}}else return}return e}const QU=t=>{let e;for(const r in t)(r==="class"||r==="style"||Bc(r))&&((e||(e={}))[r]=t[r]);return e},e8=(t,e)=>{const r={};for(const s in t)(!oO(s)||!(s.slice(9)in e))&&(r[s]=t[s]);return r};function t8(t,e,r){const{props:s,children:g,component:T}=t,{props:I,children:a,patchFlag:N}=e,H=T.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&N>=0){if(N&1024)return!0;if(N&16)return s?vM(s,I,H):!!I;if(N&8){const K=e.dynamicProps;for(let ee=0;ee<K.length;ee++){const ue=K[ee];if(I[ue]!==s[ue]&&!Bx(H,ue))return!0}}}else return(g||a)&&(!a||!a.$stable)?!0:s===I?!1:s?I?vM(s,I,H):!0:!!I;return!1}function vM(t,e,r){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let g=0;g<s.length;g++){const T=s[g];if(e[T]!==t[T]&&!Bx(r,T))return!0}return!1}function TO({vnode:t,parent:e},r){for(;e&&e.subTree===t;)(t=e.vnode).el=r,e=e.parent}const jk=t=>t.__isSuspense,r8={name:"Suspense",__isSuspense:!0,process(t,e,r,s,g,T,I,a,N,H){t==null?n8(e,r,s,g,T,I,a,N,H):o8(t,e,r,s,g,I,a,N,H)},hydrate:s8,create:EO,normalize:a8},i8=r8;function Q_(t,e){const r=t.props&&t.props[e];Dr(r)&&r()}function n8(t,e,r,s,g,T,I,a,N){const{p:H,o:{createElement:K}}=N,ee=K("div"),ue=t.suspense=EO(t,g,s,e,ee,r,T,I,a,N);H(null,ue.pendingBranch=t.ssContent,ee,null,s,ue,T,I),ue.deps>0?(Q_(t,"onPending"),Q_(t,"onFallback"),H(null,t.ssFallback,e,r,s,null,T,I),jp(ue,t.ssFallback)):ue.resolve()}function o8(t,e,r,s,g,T,I,a,{p:N,um:H,o:{createElement:K}}){const ee=e.suspense=t.suspense;ee.vnode=e,e.el=t.el;const ue=e.ssContent,Pe=e.ssFallback,{activeBranch:xe,pendingBranch:Ie,isInFallback:dt,isHydrating:Le}=ee;if(Ie)ee.pendingBranch=ue,Fl(ue,Ie)?(N(Ie,ue,ee.hiddenContainer,null,g,ee,T,I,a),ee.deps<=0?ee.resolve():dt&&(N(xe,Pe,r,s,g,null,T,I,a),jp(ee,Pe))):(ee.pendingId++,Le?(ee.isHydrating=!1,ee.activeBranch=Ie):H(Ie,g,ee),ee.deps=0,ee.effects.length=0,ee.hiddenContainer=K("div"),dt?(N(null,ue,ee.hiddenContainer,null,g,ee,T,I,a),ee.deps<=0?ee.resolve():(N(xe,Pe,r,s,g,null,T,I,a),jp(ee,Pe))):xe&&Fl(ue,xe)?(N(xe,ue,r,s,g,ee,T,I,a),ee.resolve(!0)):(N(null,ue,ee.hiddenContainer,null,g,ee,T,I,a),ee.deps<=0&&ee.resolve()));else if(xe&&Fl(ue,xe))N(xe,ue,r,s,g,ee,T,I,a),jp(ee,ue);else if(Q_(e,"onPending"),ee.pendingBranch=ue,ee.pendingId++,N(null,ue,ee.hiddenContainer,null,g,ee,T,I,a),ee.deps<=0)ee.resolve();else{const{timeout:De,pendingId:Ye}=ee;De>0?setTimeout(()=>{ee.pendingId===Ye&&ee.fallback(Pe)},De):De===0&&ee.fallback(Pe)}}function EO(t,e,r,s,g,T,I,a,N,H,K=!1){const{p:ee,m:ue,um:Pe,n:xe,o:{parentNode:Ie,remove:dt}}=H,Le=Cc(t.props&&t.props.timeout),De={vnode:t,parent:e,parentComponent:r,isSVG:I,container:s,hiddenContainer:g,anchor:T,deps:0,pendingId:0,timeout:typeof Le=="number"?Le:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:K,isUnmounted:!1,effects:[],resolve(Ye=!1){const{vnode:He,activeBranch:ht,pendingBranch:St,pendingId:st,effects:gt,parentComponent:Tt,container:at}=De;if(De.isHydrating)De.isHydrating=!1;else if(!Ye){const xr=ht&&St.transition&&St.transition.mode==="out-in";xr&&(ht.transition.afterLeave=()=>{st===De.pendingId&&ue(St,at,Jt,0)});let{anchor:Jt}=De;ht&&(Jt=xe(ht),Pe(ht,Tt,De,!0)),xr||ue(St,at,Jt,0)}jp(De,St),De.pendingBranch=null,De.isInFallback=!1;let ft=De.parent,gr=!1;for(;ft;){if(ft.pendingBranch){ft.effects.push(...gt),gr=!0;break}ft=ft.parent}gr||yO(gt),De.effects=[],Q_(He,"onResolve")},fallback(Ye){if(!De.pendingBranch)return;const{vnode:He,activeBranch:ht,parentComponent:St,container:st,isSVG:gt}=De;Q_(He,"onFallback");const Tt=xe(ht),at=()=>{!De.isInFallback||(ee(null,Ye,st,Tt,St,null,gt,a,N),jp(De,Ye))},ft=Ye.transition&&Ye.transition.mode==="out-in";ft&&(ht.transition.afterLeave=at),De.isInFallback=!0,Pe(ht,St,null,!0),ft||at()},move(Ye,He,ht){De.activeBranch&&ue(De.activeBranch,Ye,He,ht),De.container=Ye},next(){return De.activeBranch&&xe(De.activeBranch)},registerDep(Ye,He){const ht=!!De.pendingBranch;ht&&De.deps++;const St=Ye.vnode.el;Ye.asyncDep.catch(st=>{Wd(st,Ye,0)}).then(st=>{if(Ye.isUnmounted||De.isUnmounted||De.pendingId!==Ye.suspenseId)return;Ye.asyncResolved=!0;const{vnode:gt}=Ye;JE(Ye,st,!1),St&&(gt.el=St);const Tt=!St&&Ye.subTree.el;He(Ye,gt,Ie(St||Ye.subTree.el),St?null:xe(Ye.subTree),De,I,N),Tt&&dt(Tt),TO(Ye,gt.el),ht&&--De.deps===0&&De.resolve()})},unmount(Ye,He){De.isUnmounted=!0,De.activeBranch&&Pe(De.activeBranch,r,Ye,He),De.pendingBranch&&Pe(De.pendingBranch,r,Ye,He)}};return De}function s8(t,e,r,s,g,T,I,a,N){const H=e.suspense=EO(e,s,r,t.parentNode,document.createElement("div"),null,g,T,I,a,!0),K=N(t,H.pendingBranch=e.ssContent,r,H,T,I);return H.deps===0&&H.resolve(),K}function a8(t){const{shapeFlag:e,children:r}=t,s=e&32;t.ssContent=bM(s?r.default:r),t.ssFallback=s?bM(r.fallback):Bi(Do)}function bM(t){let e;if(Dr(t)){const r=Bd&&t._c;r&&(t._d=!1,ih()),t=t(),r&&(t._d=!0,e=Ss,L3())}return rr(t)&&(t=JU(t)),t=ra(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function Vk(t,e){e&&e.pendingBranch?rr(t)?e.effects.push(...t):e.effects.push(t):yO(t)}function jp(t,e){t.activeBranch=e;const{vnode:r,parentComponent:s}=t,g=r.el=e.el;s&&s.subTree===r&&(s.vnode.el=g,TO(s,g))}function Uk(t,e){if(oo){let r=oo.provides;const s=oo.parent&&oo.parent.provides;s===r&&(r=oo.provides=Object.create(s)),r[t]=e}}function Od(t,e,r=!1){const s=oo||Qn;if(s){const g=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(g&&t in g)return g[t];if(arguments.length>1)return r&&Dr(e)?e.call(s.proxy):e}}function l8(t,e){return by(t,null,e)}function Gk(t,e){return by(t,null,{flush:"post"})}function c8(t,e){return by(t,null,{flush:"sync"})}const xM={};function L_(t,e,r){return by(t,e,r)}function by(t,e,{immediate:r,deep:s,flush:g,onTrack:T,onTrigger:I}=Zi){const a=oo;let N,H=!1,K=!1;if(so(t)?(N=()=>t.value,H=Z_(t)):Sc(t)?(N=()=>t,s=!0):rr(t)?(K=!0,H=t.some(Le=>Sc(Le)||Z_(Le)),N=()=>t.map(Le=>{if(so(Le))return Le.value;if(Sc(Le))return Hu(Le);if(Dr(Le))return el(Le,a,2)})):Dr(t)?e?N=()=>el(t,a,2):N=()=>{if(!(a&&a.isUnmounted))return ee&&ee(),As(t,a,3,[ue])}:N=Ps,e&&!s){const Le=N;N=()=>{const De=Le();return rr(De)&&Rx("WATCH_ARRAY",a)&&Hu(De),De}}if(e&&s){const Le=N;N=()=>Hu(Le())}let ee,ue=Le=>{ee=dt.onStop=()=>{el(Le,a,4)}};if(Wp)return ue=Ps,e?r&&As(e,a,3,[N(),K?[]:void 0,ue]):N(),Ps;let Pe=K?[]:xM;const xe=()=>{if(!!dt.active)if(e){const Le=dt.run();(s||H||(K?Le.some((De,Ye)=>Up(De,Pe[Ye])):Up(Le,Pe))||rr(Le)&&en("WATCH_ARRAY",a))&&(ee&&ee(),As(e,a,3,[Le,Pe===xM?void 0:Pe,ue]),Pe=Le)}else dt.run()};xe.allowRecurse=!!e;let Ie;g==="sync"?Ie=xe:g==="post"?Ie=()=>Hn(xe,a&&a.suspense):(xe.pre=!0,a&&(xe.id=a.uid),Ie=()=>Dx(xe));const dt=new yy(N,Ie);return e?r?xe():Pe=dt.run():g==="post"?Hn(dt.run.bind(dt),a&&a.suspense):dt.run(),()=>{dt.stop(),a&&a.scope&&sO(a.scope.effects,dt)}}function u8(t,e,r){const s=this.proxy,g=Sn(t)?t.includes(".")?Hk(s,t):()=>s[t]:t.bind(s,s);let T;Dr(e)?T=e:(T=e.handler,r=e);const I=oo;nh(this);const a=by(g,T.bind(s),r);return I?nh(I):Ku(),a}function Hk(t,e){const r=e.split(".");return()=>{let s=t;for(let g=0;g<r.length&&s;g++)s=s[r[g]];return s}}function Hu(t,e){if(!Ei(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),so(t))Hu(t.value,e);else if(rr(t))for(let r=0;r<t.length;r++)Hu(t[r],e);else if(Gd(t)||kp(t))t.forEach(r=>{Hu(r,e)});else if(R0(t))for(const r in t)Hu(t[r],e);return t}function SO(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return lm(()=>{t.isMounted=!0}),ey(()=>{t.isUnmounting=!0}),t}const Sa=[Function,Array],qk={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Sa,onEnter:Sa,onAfterEnter:Sa,onEnterCancelled:Sa,onBeforeLeave:Sa,onLeave:Sa,onAfterLeave:Sa,onLeaveCancelled:Sa,onBeforeAppear:Sa,onAppear:Sa,onAfterAppear:Sa,onAppearCancelled:Sa},setup(t,{slots:e}){const r=ql(),s=SO();let g;return()=>{const T=e.default&&kx(e.default(),!0);if(!T||!T.length)return;let I=T[0];if(T.length>1){for(const Ie of T)if(Ie.type!==Do){I=Ie;break}}const a=ki(t),{mode:N}=a;if(s.isLeaving)return PT(I);const H=wM(I);if(!H)return PT(I);const K=Hp(H,a,s,r);Ld(H,K);const ee=r.subTree,ue=ee&&wM(ee);let Pe=!1;const{getTransitionKey:xe}=H.type;if(xe){const Ie=xe();g===void 0?g=Ie:Ie!==g&&(g=Ie,Pe=!0)}if(ue&&ue.type!==Do&&(!Fl(H,ue)||Pe)){const Ie=Hp(ue,a,s,r);if(Ld(ue,Ie),N==="out-in")return s.isLeaving=!0,Ie.afterLeave=()=>{s.isLeaving=!1,r.update()},PT(I);N==="in-out"&&H.type!==Do&&(Ie.delayLeave=(dt,Le,De)=>{const Ye=Wk(s,ue);Ye[String(ue.key)]=ue,dt._leaveCb=()=>{Le(),dt._leaveCb=void 0,delete K.delayedLeave},K.delayedLeave=De})}return I}}};qk.__isBuiltIn=!0;const OO=qk;function Wk(t,e){const{leavingVNodes:r}=t;let s=r.get(e.type);return s||(s=Object.create(null),r.set(e.type,s)),s}function Hp(t,e,r,s){const{appear:g,mode:T,persisted:I=!1,onBeforeEnter:a,onEnter:N,onAfterEnter:H,onEnterCancelled:K,onBeforeLeave:ee,onLeave:ue,onAfterLeave:Pe,onLeaveCancelled:xe,onBeforeAppear:Ie,onAppear:dt,onAfterAppear:Le,onAppearCancelled:De}=e,Ye=String(t.key),He=Wk(r,t),ht=(gt,Tt)=>{gt&&As(gt,s,9,Tt)},St=(gt,Tt)=>{const at=Tt[1];ht(gt,Tt),rr(gt)?gt.every(ft=>ft.length<=1)&&at():gt.length<=1&&at()},st={mode:T,persisted:I,beforeEnter(gt){let Tt=a;if(!r.isMounted)if(g)Tt=Ie||a;else return;gt._leaveCb&&gt._leaveCb(!0);const at=He[Ye];at&&Fl(t,at)&&at.el._leaveCb&&at.el._leaveCb(),ht(Tt,[gt])},enter(gt){let Tt=N,at=H,ft=K;if(!r.isMounted)if(g)Tt=dt||N,at=Le||H,ft=De||K;else return;let gr=!1;const xr=gt._enterCb=Jt=>{gr||(gr=!0,Jt?ht(ft,[gt]):ht(at,[gt]),st.delayedLeave&&st.delayedLeave(),gt._enterCb=void 0)};Tt?St(Tt,[gt,xr]):xr()},leave(gt,Tt){const at=String(t.key);if(gt._enterCb&&gt._enterCb(!0),r.isUnmounting)return Tt();ht(ee,[gt]);let ft=!1;const gr=gt._leaveCb=xr=>{ft||(ft=!0,Tt(),xr?ht(xe,[gt]):ht(Pe,[gt]),gt._leaveCb=void 0,He[at]===t&&delete He[at])};He[at]=t,ue?St(ue,[gt,gr]):gr()},clone(gt){return Hp(gt,e,r,s)}};return st}function PT(t){if(xy(t))return t=tl(t),t.children=null,t}function wM(t){return xy(t)?t.children?t.children[0]:void 0:t}function Ld(t,e){t.shapeFlag&6&&t.component?Ld(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function kx(t,e=!1,r){let s=[],g=0;for(let T=0;T<t.length;T++){let I=t[T];const a=r==null?I.key:String(r)+String(I.key!=null?I.key:T);I.type===_o?(I.patchFlag&128&&g++,s=s.concat(kx(I.children,e,a))):(e||I.type!==Do)&&s.push(a!=null?tl(I,{key:a}):I)}if(g>1)for(let T=0;T<s.length;T++)s[T].patchFlag=-2;return s}function PO(t){return Dr(t)?{setup:t,name:t.name}:t}const Pd=t=>!!t.type.__asyncLoader;function s0(t){Dr(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:s,delay:g=200,timeout:T,suspensible:I=!0,onError:a}=t;let N=null,H,K=0;const ee=()=>(K++,N=null,ue()),ue=()=>{let Pe;return N||(Pe=N=e().catch(xe=>{if(xe=xe instanceof Error?xe:new Error(String(xe)),a)return new Promise((Ie,dt)=>{a(xe,()=>Ie(ee()),()=>dt(xe),K+1)});throw xe}).then(xe=>Pe!==N&&N?N:(xe&&(xe.__esModule||xe[Symbol.toStringTag]==="Module")&&(xe=xe.default),H=xe,xe)))};return PO({name:"AsyncComponentWrapper",__asyncLoader:ue,get __asyncResolved(){return H},setup(){const Pe=oo;if(H)return()=>AT(H,Pe);const xe=De=>{N=null,Wd(De,Pe,13,!s)};if(I&&Pe.suspense||Wp)return ue().then(De=>()=>AT(De,Pe)).catch(De=>(xe(De),()=>s?Bi(s,{error:De}):null));const Ie=Xu(!1),dt=Xu(),Le=Xu(!!g);return g&&setTimeout(()=>{Le.value=!1},g),T!=null&&setTimeout(()=>{if(!Ie.value&&!dt.value){const De=new Error(`Async component timed out after ${T}ms.`);xe(De),dt.value=De}},T),ue().then(()=>{Ie.value=!0,Pe.parent&&xy(Pe.parent.vnode)&&Dx(Pe.parent.update)}).catch(De=>{xe(De),dt.value=De}),()=>{if(Ie.value&&H)return AT(H,Pe);if(dt.value&&s)return Bi(s,{error:dt.value});if(r&&!Le.value)return Bi(r)}}})}function AT(t,{vnode:{ref:e,props:r,children:s,shapeFlag:g},parent:T}){const I=Bi(t,r,s);return I.ref=e,I}const xy=t=>t.type.__isKeepAlive,Zk={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=ql(),s=r.ctx;if(!s.renderer)return()=>{const De=e.default&&e.default();return De&&De.length===1?De[0]:De};const g=new Map,T=new Set;let I=null;const a=r.suspense,{renderer:{p:N,m:H,um:K,o:{createElement:ee}}}=s,ue=ee("div");s.activate=(De,Ye,He,ht,St)=>{const st=De.component;H(De,Ye,He,0,a),N(st.vnode,De,Ye,He,st,a,ht,De.slotScopeIds,St),Hn(()=>{st.isDeactivated=!1,st.a&&Wu(st.a);const gt=De.props&&De.props.onVnodeMounted;gt&&xs(gt,st.parent,De)},a)},s.deactivate=De=>{const Ye=De.component;H(De,ue,null,1,a),Hn(()=>{Ye.da&&Wu(Ye.da);const He=De.props&&De.props.onVnodeUnmounted;He&&xs(He,Ye.parent,De),Ye.isDeactivated=!0},a)};function Pe(De){CT(De),K(De,r,a,!0)}function xe(De){g.forEach((Ye,He)=>{const ht=N0(Ye.type);ht&&(!De||!De(ht))&&Ie(He)})}function Ie(De){const Ye=g.get(De);!I||Ye.type!==I.type?Pe(Ye):I&&CT(I),g.delete(De),T.delete(De)}L_(()=>[t.include,t.exclude],([De,Ye])=>{De&&xe(He=>b_(De,He)),Ye&&xe(He=>!b_(Ye,He))},{flush:"post",deep:!0});let dt=null;const Le=()=>{dt!=null&&g.set(dt,MT(r.subTree))};return lm(Le),Fx(Le),ey(()=>{g.forEach(De=>{const{subTree:Ye,suspense:He}=r,ht=MT(Ye);if(De.type===ht.type){CT(ht);const St=ht.component.da;St&&Hn(St,He);return}Pe(De)})}),()=>{if(dt=null,!e.default)return null;const De=e.default(),Ye=De[0];if(De.length>1)return I=null,De;if(!ua(Ye)||!(Ye.shapeFlag&4)&&!(Ye.shapeFlag&128))return I=null,Ye;let He=MT(Ye);const ht=He.type,St=N0(Pd(He)?He.type.__asyncResolved||{}:ht),{include:st,exclude:gt,max:Tt}=t;if(st&&(!St||!b_(st,St))||gt&&St&&b_(gt,St))return I=He,Ye;const at=He.key==null?ht:He.key,ft=g.get(at);return He.el&&(He=tl(He),Ye.shapeFlag&128&&(Ye.ssContent=He)),dt=at,ft?(He.el=ft.el,He.component=ft.component,He.transition&&Ld(He,He.transition),He.shapeFlag|=512,T.delete(at),T.add(at)):(T.add(at),Tt&&T.size>parseInt(Tt,10)&&Ie(T.values().next().value)),He.shapeFlag|=256,I=He,jk(Ye.type)?Ye:He}}};Zk.__isBuildIn=!0;const Xk=Zk;function b_(t,e){return rr(t)?t.some(r=>b_(r,e)):Sn(t)?t.split(",").includes(e):t.test?t.test(e):!1}function Kk(t,e){Jk(t,"a",e)}function Yk(t,e){Jk(t,"da",e)}function Jk(t,e,r=oo){const s=t.__wdc||(t.__wdc=()=>{let g=r;for(;g;){if(g.isDeactivated)return;g=g.parent}return t()});if(zx(e,s,r),r){let g=r.parent;for(;g&&g.parent;)xy(g.parent.vnode)&&h8(s,e,r,g),g=g.parent}}function h8(t,e,r,s){const g=zx(e,t,s,!0);ty(()=>{sO(s[e],g)},r)}function CT(t){let e=t.shapeFlag;e&256&&(e-=256),e&512&&(e-=512),t.shapeFlag=e}function MT(t){return t.shapeFlag&128?t.ssContent:t}function zx(t,e,r=oo,s=!1){if(r){const g=r[t]||(r[t]=[]),T=e.__weh||(e.__weh=(...I)=>{if(r.isUnmounted)return;Hd(),nh(r);const a=As(e,r,t,I);return Ku(),qd(),a});return s?g.unshift(T):g.push(T),T}}const kc=t=>(e,r=oo)=>(!Wp||t==="sp")&&zx(t,(...s)=>e(...s),r),Qk=kc("bm"),lm=kc("m"),e3=kc("bu"),Fx=kc("u"),ey=kc("bum"),ty=kc("um"),t3=kc("sp"),r3=kc("rtg"),i3=kc("rtc");function n3(t,e=oo){zx("ec",t,e)}function d8(t){Mo("INSTANCE_CHILDREN",t);const e=t.subTree,r=[];return e&&o3(e,r),r}function o3(t,e){if(t.component)e.push(t.component.proxy);else if(t.shapeFlag&16){const r=t.children;for(let s=0;s<r.length;s++)o3(r[s],e)}}function s3(t){Mo("INSTANCE_LISTENERS",t);const e={},r=t.vnode.props;if(!r)return e;for(const s in r)Bc(s)&&(e[s[2].toLowerCase()+s.slice(3)]=r[s]);return e}const f8={beforeMount:"bind",mounted:"inserted",updated:["update","componentUpdated"],unmounted:"unbind"};function p8(t,e,r){const s=f8[t];if(s)if(rr(s)){const g=[];return s.forEach(T=>{const I=e[T];I&&(Mc("CUSTOM_DIR",r,T,t),g.push(I))}),g.length?g:void 0}else return e[s]&&Mc("CUSTOM_DIR",r,s,t),e[s]}function a3(t,e){const r=Qn;if(r===null)return t;const s=Hx(r)||r.proxy,g=t.dirs||(t.dirs=[]);for(let T=0;T<e.length;T++){let[I,a,N,H=Zi]=e[T];Dr(I)&&(I={mounted:I,updated:I}),I.deep&&Hu(a),g.push({dir:I,instance:s,value:a,oldValue:void 0,arg:N,modifiers:H})}return t}function Dl(t,e,r,s){const g=t.dirs,T=e&&e.dirs;for(let I=0;I<g.length;I++){const a=g[I];T&&(a.oldValue=T[I].value);let N=a.dir[s];N||(N=p8(s,a.dir,r)),N&&(Hd(),As(N,r,8,[t.el,a,t,e]),qd())}}const AO="components",m8="directives",g8="filters";function wd(t,e){return Nx(AO,t,!0,e)||t}const l3=Symbol();function c3(t){return Sn(t)?Nx(AO,t,!1)||t:t||l3}function u3(t){return Nx(m8,t)}function h3(t){return Nx(g8,t)}function Nx(t,e,r=!0,s=!1){const g=Qn||oo;if(g){const T=g.type;if(t===AO){const a=N0(T,!1);if(a&&(a===e||a===Rs(e)||a===_y(Rs(e))))return T}const I=TM(g[t]||T[t],e)||TM(g.appContext[t],e);return!I&&s?T:I}}function TM(t,e){return t&&(t[e]||t[Rs(e)]||t[_y(Rs(e))])}function _8(t){const e=t.type,r=e.render;if(!(!r||r._rc||r._compatChecked||r._compatWrapped)){if(r.length>=2){r._compatChecked=!0;return}if(Rx("RENDER_FUNCTION",t)){const s=e.render=function(){return r.call(this,k0)};s._compatWrapped=!0}}}function k0(t,e,r){if(t||(t=Do),typeof t=="string"){const T=la(t);(T==="transition"||T==="transition-group"||T==="keep-alive")&&(t=`__compat__${T}`),t=c3(t)}const s=arguments.length,g=rr(e);return s===2||g?Ei(e)&&!g?ua(e)?Db(Bi(t,null,[e])):Db(SM(Bi(t,EM(e,t)),e)):Db(Bi(t,null,e)):(ua(r)&&(r=[r]),Db(SM(Bi(t,EM(e,t),r),e)))}const y8=sm("staticStyle,staticClass,directives,model,hook");function EM(t,e){if(!t)return null;const r={};for(const s in t)if(s==="attrs"||s==="domProps"||s==="props")Mi(r,t[s]);else if(s==="on"||s==="nativeOn"){const g=t[s];for(const T in g){let I=v8(T);s==="nativeOn"&&(I+="Native");const a=r[I],N=g[T];a!==N&&(a?r[I]=[].concat(a,N):r[I]=N)}}else y8(s)||(r[s]=t[s]);if(t.staticClass&&(r.class=eh([t.staticClass,r.class])),t.staticStyle&&(r.style=am([t.staticStyle,r.style])),t.model&&Ei(e)){const{prop:s="value",event:g="input"}=e.model||{};r[s]=t.model.value,r[Lx+g]=t.model.callback}return r}function v8(t){return t[0]==="&"&&(t=t.slice(1)+"Passive"),t[0]==="~"&&(t=t.slice(1)+"Once"),t[0]==="!"&&(t=t.slice(1)+"Capture"),Fp(t)}function SM(t,e){return e&&e.directives?a3(t,e.directives.map(({name:r,value:s,arg:g,modifiers:T})=>[u3(r),s,g,T])):t}function Db(t){const{props:e,children:r}=t;let s;if(t.shapeFlag&6&&rr(r)){s={};for(let T=0;T<r.length;T++){const I=r[T],a=ua(I)&&I.props&&I.props.slot||"default",N=s[a]||(s[a]=[]);ua(I)&&I.type==="template"?N.push(I.children):N.push(I)}if(s)for(const T in s){const I=s[T];s[T]=()=>I,s[T]._ns=!0}}const g=e&&e.scopedSlots;return g&&(delete e.scopedSlots,s?Mi(s,g):s=g),s&&Ux(t,s),t}function d3(t){if(en("RENDER_FUNCTION",Qn,!0)&&en("PRIVATE_APIS",Qn,!0)){const e=Qn,r=()=>t.component&&t.component.proxy;let s;Object.defineProperties(t,{tag:{get:()=>t.type},data:{get:()=>t.props||{},set:g=>t.props=g},elm:{get:()=>t.el},componentInstance:{get:r},child:{get:r},text:{get:()=>Sn(t.children)?t.children:null},context:{get:()=>e&&e.proxy},componentOptions:{get:()=>{if(t.shapeFlag&4)return s||(s={Ctor:t.type,propsData:t.props,children:t.children})}}})}}const IT=new Map,f3={get(t,e){const r=t[e];return r&&r()}};function b8(t){if(IT.has(t))return IT.get(t);const e=t.render,r=(s,g)=>{const T=ql(),I={props:s,children:T.vnode.children||[],data:T.vnode.props||{},scopedSlots:g.slots,parent:T.parent&&T.parent.proxy,slots(){return new Proxy(g.slots,f3)},get listeners(){return s3(T)},get injections(){if(t.inject){const a={};return x3(t.inject,a),a}return{}}};return e(k0,I)};return r.props=t.props,r.displayName=t.name,r.compatConfig=t.compatConfig,r.inheritAttrs=!1,IT.set(t,r),r}function p3(t,e,r,s){let g;const T=r&&r[s];if(rr(t)||Sn(t)){g=new Array(t.length);for(let I=0,a=t.length;I<a;I++)g[I]=e(t[I],I,void 0,T&&T[I])}else if(typeof t=="number"){g=new Array(t);for(let I=0;I<t;I++)g[I]=e(I+1,I,void 0,T&&T[I])}else if(Ei(t))if(t[Symbol.iterator])g=Array.from(t,(I,a)=>e(I,a,void 0,T&&T[a]));else{const I=Object.keys(t);g=new Array(I.length);for(let a=0,N=I.length;a<N;a++){const H=I[a];g[a]=e(t[H],H,a,T&&T[a])}}else g=[];return r&&(r[s]=g),g}function m3(t,e){for(let r=0;r<e.length;r++){const s=e[r];if(rr(s))for(let g=0;g<s.length;g++)t[s[g].name]=s[g].fn;else s&&(t[s.name]=s.key?(...g)=>{const T=s.fn(...g);return T&&(T.key=s.key),T}:s.fn)}return t}function g3(t,e,r={},s,g){if(Qn.isCE||Qn.parent&&Pd(Qn.parent)&&Qn.parent.isCE)return Bi("slot",e==="default"?null:{name:e},s&&s());let T=t[e];T&&T._c&&(T._d=!1),ih();const I=T&&_3(T(r)),a=jx(_o,{key:r.key||I&&I.key||`_${e}`},I||(s?s():[]),I&&t._===1?64:-2);return!g&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),T&&T._c&&(T._d=!0),a}function _3(t){return t.some(e=>ua(e)?!(e.type===Do||e.type===_o&&!_3(e.children)):!0)?t:null}function y3(t,e){const r={};for(const s in t)r[e&&/[A-Z]/.test(s)?`on:${s}`:Fp(s)]=t[s];return r}function x8(t){const e={};for(let r=0;r<t.length;r++)t[r]&&Mi(e,t[r]);return e}function w8(t,e,r,s,g){if(r&&Ei(r)){rr(r)&&(r=x8(r));for(const T in r)if(zp(T))t[T]=r[T];else if(T==="class")t.class=eh([t.class,r.class]);else if(T==="style")t.style=eh([t.style,r.style]);else{const I=t.attrs||(t.attrs={}),a=Rs(T),N=la(T);if(!(a in I)&&!(N in I)&&(I[T]=r[T],g)){const H=t.on||(t.on={});H[`update:${T}`]=function(K){r[T]=K}}}}return t}function T8(t,e){return Gx(t,y3(e))}function E8(t,e,r,s,g){return g&&(s=Gx(s,g)),g3(t.slots,e,s,r&&(()=>r))}function S8(t,e,r){return m3(e||{$stable:!r},v3(t))}function v3(t){for(let e=0;e<t.length;e++){const r=t[e];r&&(rr(r)?v3(r):r.name=r.key||"default")}return t}const OM=new WeakMap;function O8(t,e){let r=OM.get(t);if(r||OM.set(t,r=[]),r[e])return r[e];const s=t.type.staticRenderFns[e],g=t.proxy;return r[e]=s.call(g,null,g)}function P8(t,e,r,s,g,T){const a=t.appContext.config.keyCodes||{},N=a[r]||s;if(T&&g&&!a[r])return PM(T,g);if(N)return PM(N,e);if(g)return la(g)!==r}function PM(t,e){return rr(t)?!t.includes(e):t!==e}function A8(t){return t}function C8(t,e){for(let r=0;r<e.length;r+=2){const s=e[r];typeof s=="string"&&s&&(t[e[r]]=e[r+1])}return t}function M8(t,e){return typeof t=="string"?e+t:t}function I8(t){const e=(s,g,T)=>{s[g]=T},r=(s,g)=>{delete s[g]};Mi(t,{$set:s=>(Mo("INSTANCE_SET",s),e),$delete:s=>(Mo("INSTANCE_DELETE",s),r),$mount:s=>(Mo("GLOBAL_MOUNT",null),s.ctx._compat_mount||Ps),$destroy:s=>(Mo("INSTANCE_DESTROY",s),s.ctx._compat_destroy||Ps),$slots:s=>en("RENDER_FUNCTION",s)&&s.render&&s.render._compatWrapped?new Proxy(s.slots,f3):s.slots,$scopedSlots:s=>{Mo("INSTANCE_SCOPED_SLOTS",s);const g={};for(const T in s.slots){const I=s.slots[T];I._ns||(g[T]=I)}return g},$on:s=>xO.bind(null,s),$once:s=>GU.bind(null,s),$off:s=>wO.bind(null,s),$children:d8,$listeners:s3}),en("PRIVATE_APIS",null)&&Mi(t,{$vnode:s=>s.vnode,$options:s=>{const g=Mi({},wy(s));return g.parent=s.proxy.$parent,g.propsData=s.vnode.props,g},_self:s=>s.proxy,_uid:s=>s.uid,_data:s=>s.data,_isMounted:s=>s.isMounted,_isDestroyed:s=>s.isUnmounted,$createElement:()=>k0,_c:()=>k0,_o:()=>A8,_n:()=>Cc,_s:()=>nO,_l:()=>p3,_t:s=>E8.bind(null,s),_q:()=>Ac,_i:()=>my,_m:s=>O8.bind(null,s),_f:()=>h3,_k:s=>P8.bind(null,s),_b:()=>w8,_v:()=>Ty,_e:()=>IO,_u:()=>S8,_g:()=>T8,_d:()=>C8,_p:()=>M8})}const HE=t=>t?F3(t)?Hx(t)||t.proxy:HE(t.parent):null,ry=Mi(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>HE(t.parent),$root:t=>HE(t.root),$emit:t=>t.emit,$options:t=>wy(t),$forceUpdate:t=>t.f||(t.f=()=>Dx(t.update)),$nextTick:t=>t.n||(t.n=vy.bind(t.proxy)),$watch:t=>u8.bind(t)});I8(ry);const qE={get({_:t},e){const{ctx:r,setupState:s,data:g,props:T,accessCache:I,type:a,appContext:N}=t;let H;if(e[0]!=="$"){const Pe=I[e];if(Pe!==void 0)switch(Pe){case 1:return s[e];case 2:return g[e];case 4:return r[e];case 3:return T[e]}else{if(s!==Zi&&Ai(s,e))return I[e]=1,s[e];if(g!==Zi&&Ai(g,e))return I[e]=2,g[e];if((H=t.propsOptions[0])&&Ai(H,e))return I[e]=3,T[e];if(r!==Zi&&Ai(r,e))return I[e]=4,r[e];WE&&(I[e]=0)}}const K=ry[e];let ee,ue;if(K)return e==="$attrs"&&Ls(t,"get",e),K(t);if((ee=a.__cssModules)&&(ee=ee[e]))return ee;if(r!==Zi&&Ai(r,e))return I[e]=4,r[e];if(ue=N.config.globalProperties,Ai(ue,e)){const Pe=Object.getOwnPropertyDescriptor(ue,e);if(Pe.get)return Pe.get.call(t.proxy);{const xe=ue[e];return Dr(xe)?Object.assign(xe.bind(t.proxy),xe):xe}}},set({_:t},e,r){const{data:s,setupState:g,ctx:T}=t;return g!==Zi&&Ai(g,e)?(g[e]=r,!0):s!==Zi&&Ai(s,e)?(s[e]=r,!0):Ai(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(T[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:s,appContext:g,propsOptions:T}},I){let a;return!!r[I]||t!==Zi&&Ai(t,I)||e!==Zi&&Ai(e,I)||(a=T[0])&&Ai(a,I)||Ai(s,I)||Ai(ry,I)||Ai(g.config.globalProperties,I)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:Ai(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}},D8=Mi({},qE,{get(t,e){if(e!==Symbol.unscopables)return qE.get(t,e,t)},has(t,e){return e[0]!=="_"&&!D6(e)}});function b3(t,e){for(const r in e){const s=t[r],g=e[r];r in t&&R0(s)&&R0(g)?b3(s,g):t[r]=g}return t}let WE=!0;function R8(t){const e=wy(t),r=t.proxy,s=t.ctx;WE=!1,e.beforeCreate&&AM(e.beforeCreate,t,"bc");const{data:g,computed:T,methods:I,watch:a,provide:N,inject:H,created:K,beforeMount:ee,mounted:ue,beforeUpdate:Pe,updated:xe,activated:Ie,deactivated:dt,beforeDestroy:Le,beforeUnmount:De,destroyed:Ye,unmounted:He,render:ht,renderTracked:St,renderTriggered:st,errorCaptured:gt,serverPrefetch:Tt,expose:at,inheritAttrs:ft,components:gr,directives:xr,filters:Jt}=e;if(H&&x3(H,s,null,t.appContext.config.unwrapInjectedRef),I)for(const fr in I){const jr=I[fr];Dr(jr)&&(s[fr]=jr.bind(r))}if(g){const fr=g.call(r,r);Ei(fr)&&(t.data=rh(fr))}if(WE=!0,T)for(const fr in T){const jr=T[fr],er=Dr(jr)?jr.bind(r,r):Dr(jr.get)?jr.get.bind(r,r):Ps,tn=!Dr(jr)&&Dr(jr.set)?jr.set.bind(r):Ps,ln=j3({get:er,set:tn});Object.defineProperty(s,fr,{enumerable:!0,configurable:!0,get:()=>ln.value,set:Yi=>ln.value=Yi})}if(a)for(const fr in a)w3(a[fr],s,r,fr);if(N){const fr=Dr(N)?N.call(r):N;Reflect.ownKeys(fr).forEach(jr=>{Uk(jr,fr[jr])})}K&&AM(K,t,"c");function Et(fr,jr){rr(jr)?jr.forEach(er=>fr(er.bind(r))):jr&&fr(jr.bind(r))}if(Et(Qk,ee),Et(lm,ue),Et(e3,Pe),Et(Fx,xe),Et(Kk,Ie),Et(Yk,dt),Et(n3,gt),Et(i3,St),Et(r3,st),Et(ey,De),Et(ty,He),Et(t3,Tt),Le&&Mc("OPTIONS_BEFORE_DESTROY",t)&&Et(ey,Le),Ye&&Mc("OPTIONS_DESTROYED",t)&&Et(ty,Ye),rr(at))if(at.length){const fr=t.exposed||(t.exposed={});at.forEach(jr=>{Object.defineProperty(fr,jr,{get:()=>r[jr],set:er=>r[jr]=er})})}else t.exposed||(t.exposed={});ht&&t.render===Ps&&(t.render=ht),ft!=null&&(t.inheritAttrs=ft),gr&&(t.components=gr),xr&&(t.directives=xr),Jt&&en("FILTERS",t)&&(t.filters=Jt)}function x3(t,e,r=Ps,s=!1){rr(t)&&(t=ZE(t));for(const g in t){const T=t[g];let I;Ei(T)?"default"in T?I=Od(T.from||g,T.default,!0):I=Od(T.from||g):I=Od(T),so(I)&&s?Object.defineProperty(e,g,{enumerable:!0,configurable:!0,get:()=>I.value,set:a=>I.value=a}):e[g]=I}}function AM(t,e,r){As(rr(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,r)}function w3(t,e,r,s){const g=s.includes(".")?Hk(r,s):()=>r[s];if(Sn(t)){const T=e[t];Dr(T)&&L_(g,T)}else if(Dr(t))L_(g,t.bind(r));else if(Ei(t))if(rr(t))t.forEach(T=>w3(T,e,r,s));else{const T=Dr(t.handler)?t.handler.bind(r):e[t.handler];Dr(T)&&L_(g,T,t)}}function wy(t){const e=t.type,{mixins:r,extends:s}=e,{mixins:g,optionsCache:T,config:{optionMergeStrategies:I}}=t.appContext,a=T.get(e);let N;return a?N=a:!g.length&&!r&&!s?en("PRIVATE_APIS",t)?(N=Mi({},e),N.parent=t.parent&&t.parent.proxy,N.propsData=t.vnode.props):N=e:(N={},g.length&&g.forEach(H=>Ad(N,H,I,!0)),Ad(N,e,I)),Ei(e)&&T.set(e,N),N}function Ad(t,e,r,s=!1){Dr(e)&&(e=e.options);const{mixins:g,extends:T}=e;T&&Ad(t,T,r,!0),g&&g.forEach(I=>Ad(t,I,r,!0));for(const I in e)if(!(s&&I==="expose")){const a=Cd[I]||r&&r[I];t[I]=a?a(t[I],e[I]):e[I]}return t}const Cd={data:CM,props:$u,emits:$u,methods:$u,computed:$u,beforeCreate:rs,created:rs,beforeMount:rs,mounted:rs,beforeUpdate:rs,updated:rs,beforeDestroy:rs,beforeUnmount:rs,destroyed:rs,unmounted:rs,activated:rs,deactivated:rs,errorCaptured:rs,serverPrefetch:rs,components:$u,directives:$u,watch:B8,provide:CM,inject:L8};Cd.filters=$u;function CM(t,e){return e?t?function(){return(en("OPTIONS_DATA_MERGE",null)?b3:Mi)(Dr(t)?t.call(this,this):t,Dr(e)?e.call(this,this):e)}:e:t}function L8(t,e){return $u(ZE(t),ZE(e))}function ZE(t){if(rr(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function rs(t,e){return t?[...new Set([].concat(t,e))]:e}function $u(t,e){return t?Mi(Mi(Object.create(null),t),e):e}function B8(t,e){if(!t)return e;if(!e)return t;const r=Mi(Object.create(null),t);for(const s in e)r[s]=rs(t[s],e[s]);return r}function k8(t,e,r){return new Proxy({},{get(s,g){if(g==="$options")return wy(t);if(g in e)return e[g];const T=t.type.inject;if(T){if(rr(T)){if(T.includes(g))return Od(g)}else if(g in T)return Od(g)}}})}function T3(t,e){return!!(t==="is"||(t==="class"||t==="style")&&en("INSTANCE_ATTRS_CLASS_STYLE",e)||Bc(t)&&en("INSTANCE_LISTENERS",e)||t.startsWith("routerView")||t==="registerRouteInstance")}function z8(t,e,r,s=!1){const g={},T={};L0(T,Vx,1),t.propsDefaults=Object.create(null),E3(t,e,g,T);for(const I in t.propsOptions[0])I in g||(g[I]=void 0);r?t.props=s?g:Ak(g):t.type.props?t.props=g:t.props=T,t.attrs=T}function F8(t,e,r,s){const{props:g,attrs:T,vnode:{patchFlag:I}}=t,a=ki(g),[N]=t.propsOptions;let H=!1;if((s||I>0)&&!(I&16)){if(I&8){const K=t.vnode.dynamicProps;for(let ee=0;ee<K.length;ee++){let ue=K[ee];if(Bx(t.emitsOptions,ue))continue;const Pe=e[ue];if(N)if(Ai(T,ue))Pe!==T[ue]&&(T[ue]=Pe,H=!0);else{const xe=Rs(ue);g[xe]=XE(N,a,xe,Pe,t,!1)}else{if(Bc(ue)&&ue.endsWith("Native"))ue=ue.slice(0,-6);else if(T3(ue,t))continue;Pe!==T[ue]&&(T[ue]=Pe,H=!0)}}}}else{E3(t,e,g,T)&&(H=!0);let K;for(const ee in a)(!e||!Ai(e,ee)&&((K=la(ee))===ee||!Ai(e,K)))&&(N?r&&(r[ee]!==void 0||r[K]!==void 0)&&(g[ee]=XE(N,a,ee,void 0,t,!0)):delete g[ee]);if(T!==a)for(const ee in T)(!e||!Ai(e,ee)&&!Ai(e,ee+"Native"))&&(delete T[ee],H=!0)}H&&Vl(t,"set","$attrs")}function E3(t,e,r,s){const[g,T]=t.propsOptions;let I=!1,a;if(e)for(let N in e){if(zp(N)||(N.startsWith("onHook:")&&Mc("INSTANCE_EVENT_HOOKS",t,N.slice(2).toLowerCase()),N==="inline-template"))continue;const H=e[N];let K;if(g&&Ai(g,K=Rs(N)))!T||!T.includes(K)?r[K]=H:(a||(a={}))[K]=H;else if(!Bx(t.emitsOptions,N)){if(Bc(N)&&N.endsWith("Native"))N=N.slice(0,-6);else if(T3(N,t))continue;(!(N in s)||H!==s[N])&&(s[N]=H,I=!0)}}if(T){const N=ki(r),H=a||Zi;for(let K=0;K<T.length;K++){const ee=T[K];r[ee]=XE(g,N,ee,H[ee],t,!Ai(H,ee))}}return I}function XE(t,e,r,s,g,T){const I=t[r];if(I!=null){const a=Ai(I,"default");if(a&&s===void 0){const N=I.default;if(I.type!==Function&&Dr(N)){const{propsDefaults:H}=g;r in H?s=H[r]:(nh(g),s=H[r]=N.call(en("PROPS_DEFAULT_THIS",g)?k8(g,e):null,e),Ku())}else s=N}I[0]&&(T&&!a?s=!1:I[1]&&(s===""||s===la(r))&&(s=!0))}return s}function S3(t,e,r=!1){const s=e.propsCache,g=s.get(t);if(g)return g;const T=t.props,I={},a=[];let N=!1;if(!Dr(t)){const K=ee=>{Dr(ee)&&(ee=ee.options),N=!0;const[ue,Pe]=S3(ee,e,!0);Mi(I,ue),Pe&&a.push(...Pe)};!r&&e.mixins.length&&e.mixins.forEach(K),t.extends&&K(t.extends),t.mixins&&t.mixins.forEach(K)}if(!T&&!N)return Ei(t)&&s.set(t,Bp),Bp;if(rr(T))for(let K=0;K<T.length;K++){const ee=Rs(T[K]);MM(ee)&&(I[ee]=Zi)}else if(T)for(const K in T){const ee=Rs(K);if(MM(ee)){const ue=T[K],Pe=I[ee]=rr(ue)||Dr(ue)?{type:ue}:ue;if(Pe){const xe=RM(Boolean,Pe.type),Ie=RM(String,Pe.type);Pe[0]=xe>-1,Pe[1]=Ie<0||xe<Ie,(xe>-1||Ai(Pe,"default"))&&a.push(ee)}}}const H=[I,a];return Ei(t)&&s.set(t,H),H}function MM(t){return t[0]!=="$"}function IM(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function DM(t,e){return IM(t)===IM(e)}function RM(t,e){return rr(e)?e.findIndex(r=>DM(r,t)):Dr(e)&&DM(e,t)?0:-1}const O3=t=>t[0]==="_"||t==="$stable",CO=t=>rr(t)?t.map(ra):[ra(t)],N8=(t,e,r)=>{if(e._n)return e;const s=Gp((...g)=>CO(e(...g)),r);return s._c=!1,s},P3=(t,e,r)=>{const s=t._ctx;for(const g in t){if(O3(g))continue;const T=t[g];if(Dr(T))e[g]=N8(g,T,s);else if(T!=null){const I=CO(T);e[g]=()=>I}}},A3=(t,e)=>{const r=CO(e);t.slots.default=()=>r},$8=(t,e)=>{if(t.vnode.shapeFlag&32){const r=e._;r?(t.slots=ki(e),L0(e,"_",r)):P3(e,t.slots={})}else t.slots={},e&&A3(t,e);L0(t.slots,Vx,1)},j8=(t,e,r)=>{const{vnode:s,slots:g}=t;let T=!0,I=Zi;if(s.shapeFlag&32){const a=e._;a?r&&a===1?T=!1:(Mi(g,e),!r&&a===1&&delete g._):(T=!e.$stable,P3(e,g)),I=e}else e&&(A3(t,e),I={default:1});if(T)for(const a in g)!O3(a)&&!(a in I)&&delete g[a]};function V8(t){t.optionMergeStrategies=new Proxy({},{get(e,r){if(r in e)return e[r];if(r in Cd&&Mc("CONFIG_OPTION_MERGE_STRATS",null))return Cd[r]}})}let Ts,_d;function U8(t,e){Ts=e({});const r=_d=function N(H={}){return s(H,N)};function s(N={},H){Mo("GLOBAL_MOUNT",null);const{data:K}=N;K&&!Dr(K)&&Mc("OPTIONS_DATA_FN",null)&&(N.data=()=>K);const ee=t(N);H!==r&&C3(ee,H);const ue=ee._createRoot(N);return N.el?ue.$mount(N.el):ue}r.version="2.6.14-compat:3.2.41",r.config=Ts.config,r.use=(N,...H)=>(N&&Dr(N.install)?N.install(r,...H):Dr(N)&&N(r,...H),r),r.mixin=N=>(Ts.mixin(N),r),r.component=(N,H)=>H?(Ts.component(N,H),r):Ts.component(N),r.directive=(N,H)=>H?(Ts.directive(N,H),r):Ts.directive(N),r.options={_base:r};let g=1;r.cid=g,r.nextTick=vy;const T=new WeakMap;function I(N={}){if(Mo("GLOBAL_EXTEND",null),Dr(N)&&(N=N.options),T.has(N))return T.get(N);const H=this;function K(ue){return s(ue?Ad(Mi({},K.options),ue,Cd):K.options,K)}K.super=H,K.prototype=Object.create(r.prototype),K.prototype.constructor=K;const ee={};for(const ue in H.options){const Pe=H.options[ue];ee[ue]=rr(Pe)?Pe.slice():Ei(Pe)?Mi(Object.create(null),Pe):Pe}return K.options=Ad(ee,N,Cd),K.options._base=K,K.extend=I.bind(K),K.mixin=H.mixin,K.use=H.use,K.cid=++g,T.set(N,K),K}r.extend=I.bind(r),r.set=(N,H,K)=>{Mo("GLOBAL_SET",null),N[H]=K},r.delete=(N,H)=>{Mo("GLOBAL_DELETE",null),delete N[H]},r.observable=N=>(Mo("GLOBAL_OBSERVABLE",null),rh(N)),r.filter=(N,H)=>H?(Ts.filter(N,H),r):Ts.filter(N);const a={warn:Ps,extend:Mi,mergeOptions:(N,H,K)=>Ad(N,H,K?void 0:Cd),defineReactive:Y8};return Object.defineProperty(r,"util",{get(){return Mo("GLOBAL_PRIVATE_UTIL",null),a}}),r.configureCompat=UU,r}function G8(t,e,r){H8(t,e),V8(t.config),Ts&&(Z8(t,e,r),q8(t),W8(t))}function H8(t,e){e.filters={},t.filter=(r,s)=>(Mo("FILTERS",null),s?(e.filters[r]=s,t):e.filters[r])}function q8(t){Object.defineProperties(t,{prototype:{get(){return t.config.globalProperties}},nextTick:{value:vy},extend:{value:_d.extend},set:{value:_d.set},delete:{value:_d.delete},observable:{value:_d.observable},util:{get(){return _d.util}}})}function W8(t){t._context.mixins=[...Ts._context.mixins],["components","directives","filters"].forEach(e=>{t._context[e]=Object.create(Ts._context[e])});for(const e in Ts.config){if(e==="isNativeTag"||eS()&&(e==="isCustomElement"||e==="compilerOptions"))continue;const r=Ts.config[e];t.config[e]=Ei(r)?Object.create(r):r,e==="ignoredElements"&&en("CONFIG_IGNORED_ELEMENTS",null)&&!eS()&&rr(r)&&(t.config.compilerOptions.isCustomElement=s=>r.some(g=>Sn(g)?g===s:g.test(s)))}C3(t,_d)}function C3(t,e){const r=en("GLOBAL_PROTOTYPE",null);r&&(t.config.globalProperties=Object.create(e.prototype));const s=Object.getOwnPropertyDescriptors(e.prototype);for(const g in s)g!=="constructor"&&r&&Object.defineProperty(t.config.globalProperties,g,s[g])}function Z8(t,e,r){let s=!1;t._createRoot=g=>{const T=t._component,I=Bi(T,g.propsData||null);I.appContext=e;const a=!Dr(T)&&!T.render&&!T.template,N=()=>{},H=DO(I,null,null);return a&&(H.render=N),RO(H),I.component=H,I.isCompatRoot=!0,H.ctx._compat_mount=K=>{if(s)return;let ee;if(typeof K=="string"){const Pe=document.querySelector(K);if(!Pe)return;ee=Pe}else ee=K||document.createElement("div");const ue=ee instanceof SVGElement;return a&&H.render===N&&(H.render=null,T.template=ee.innerHTML,LO(H,!1,!0)),ee.innerHTML="",r(I,ee,ue),ee instanceof Element&&(ee.removeAttribute("v-cloak"),ee.setAttribute("data-v-app","")),s=!0,t._container=ee,ee.__vue_app__=t,H.proxy},H.ctx._compat_destroy=()=>{if(s)r(null,t._container),delete t._container.__vue_app__;else{const{bum:K,scope:ee,um:ue}=H;K&&Wu(K),en("INSTANCE_EVENT_HOOKS",H)&&H.emit("hook:beforeDestroy"),ee&&ee.stop(),ue&&Wu(ue),en("INSTANCE_EVENT_HOOKS",H)&&H.emit("hook:destroyed")}},H.proxy}}const X8=["push","pop","shift","unshift","splice","sort","reverse"],K8=new WeakSet;function Y8(t,e,r){if(Ei(r)&&!Sc(r)&&!K8.has(r)){const g=rh(r);rr(r)?X8.forEach(T=>{r[T]=(...I)=>{Array.prototype[T].call(g,...I)}}):Object.keys(r).forEach(T=>{try{DT(r,T,r[T])}catch{}})}const s=t.$;s&&t===s.proxy?(DT(s.ctx,e,r),s.accessCache=Object.create(null)):Sc(t)?t[e]=r:DT(t,e,r)}function DT(t,e,r){r=Ei(r)?rh(r):r,Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get(){return Ls(t,"get",e),r},set(s){r=Ei(s)?rh(s):s,Vl(t,"set",e,s)}})}function M3(){return{app:null,config:{isNativeTag:N6,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let J8=0;function Q8(t,e){return function(s,g=null){Dr(s)||(s=Object.assign({},s)),g!=null&&!Ei(g)&&(g=null);const T=M3(),I=new Set;let a=!1;const N=T.app={_uid:J8++,_component:s,_props:g,_container:null,_context:T,_instance:null,version:q3,get config(){return T.config},set config(H){},use(H,...K){return I.has(H)||(H&&Dr(H.install)?(I.add(H),H.install(N,...K)):Dr(H)&&(I.add(H),H(N,...K))),N},mixin(H){return T.mixins.includes(H)||T.mixins.push(H),N},component(H,K){return K?(T.components[H]=K,N):T.components[H]},directive(H,K){return K?(T.directives[H]=K,N):T.directives[H]},mount(H,K,ee){if(!a){const ue=Bi(s,g);return ue.appContext=T,K&&e?e(ue,H):t(ue,H,ee),a=!0,N._container=H,H.__vue_app__=N,Hx(ue.component)||ue.component.proxy}},unmount(){a&&(t(null,N._container),delete N._container.__vue_app__)},provide(H,K){return T.provides[H]=K,N}};return G8(N,T,t),N}}function z0(t,e,r,s,g=!1){if(rr(t)){t.forEach((ue,Pe)=>z0(ue,e&&(rr(e)?e[Pe]:e),r,s,g));return}if(Pd(s)&&!g)return;const T=s.shapeFlag&4?Hx(s.component)||s.component.proxy:s.el,I=g?null:T,{i:a,r:N}=t,H=e&&e.r,K=a.refs===Zi?a.refs={}:a.refs,ee=a.setupState;if(H!=null&&H!==N&&(Sn(H)?(K[H]=null,Ai(ee,H)&&(ee[H]=null)):so(H)&&(H.value=null)),Dr(N))el(N,a,12,[I,K]);else{const ue=Sn(N),Pe=so(N);if(ue||Pe){const xe=()=>{if(t.f){const Ie=ue?Ai(ee,N)?ee[N]:K[N]:N.value;g?rr(Ie)&&sO(Ie,T):rr(Ie)?Ie.includes(T)||Ie.push(T):ue?(K[N]=[T],Ai(ee,N)&&(ee[N]=K[N])):(N.value=[T],t.k&&(K[t.k]=N.value))}else ue?(K[N]=I,Ai(ee,N)&&(ee[N]=I)):Pe&&(N.value=I,t.k&&(K[t.k]=I))};I?(xe.id=-1,Hn(xe,r)):xe()}}}let ku=!1;const Rb=t=>/svg/.test(t.namespaceURI)&&t.tagName!=="foreignObject",Lb=t=>t.nodeType===8;function eG(t){const{mt:e,p:r,o:{patchProp:s,createText:g,nextSibling:T,parentNode:I,remove:a,insert:N,createComment:H}}=t,K=(Le,De)=>{if(!De.hasChildNodes()){r(null,Le,De),B0(),De._vnode=Le;return}ku=!1,ee(De.firstChild,Le,null,null,null),B0(),De._vnode=Le,ku&&console.error("Hydration completed but contains mismatches.")},ee=(Le,De,Ye,He,ht,St=!1)=>{const st=Lb(Le)&&Le.data==="[",gt=()=>Ie(Le,De,Ye,He,ht,st),{type:Tt,ref:at,shapeFlag:ft,patchFlag:gr}=De;let xr=Le.nodeType;De.el=Le,gr===-2&&(St=!1,De.dynamicChildren=null);let Jt=null;switch(Tt){case qp:xr!==3?De.children===""?(N(De.el=g(""),I(Le),Le),Jt=Le):Jt=gt():(Le.data!==De.children&&(ku=!0,Le.data=De.children),Jt=T(Le));break;case Do:xr!==8||st?Jt=gt():Jt=T(Le);break;case Md:if(st&&(Le=T(Le),xr=Le.nodeType),xr===1||xr===3){Jt=Le;const Zt=!De.children.length;for(let Et=0;Et<De.staticCount;Et++)Zt&&(De.children+=Jt.nodeType===1?Jt.outerHTML:Jt.data),Et===De.staticCount-1&&(De.anchor=Jt),Jt=T(Jt);return st?T(Jt):Jt}else gt();break;case _o:st?Jt=xe(Le,De,Ye,He,ht,St):Jt=gt();break;default:if(ft&1)xr!==1||De.type.toLowerCase()!==Le.tagName.toLowerCase()?Jt=gt():Jt=ue(Le,De,Ye,He,ht,St);else if(ft&6){De.slotScopeIds=ht;const Zt=I(Le);if(e(De,Zt,null,Ye,He,Rb(Zt),St),Jt=st?dt(Le):T(Le),Jt&&Lb(Jt)&&Jt.data==="teleport end"&&(Jt=T(Jt)),Pd(De)){let Et;st?(Et=Bi(_o),Et.anchor=Jt?Jt.previousSibling:Zt.lastChild):Et=Le.nodeType===3?Ty(""):Bi("div"),Et.el=Le,De.component.subTree=Et}}else ft&64?xr!==8?Jt=gt():Jt=De.type.hydrate(Le,De,Ye,He,ht,St,t,Pe):ft&128&&(Jt=De.type.hydrate(Le,De,Ye,He,Rb(I(Le)),ht,St,t,ee))}return at!=null&&z0(at,null,He,De),Jt},ue=(Le,De,Ye,He,ht,St)=>{St=St||!!De.dynamicChildren;const{type:st,props:gt,patchFlag:Tt,shapeFlag:at,dirs:ft}=De,gr=st==="input"&&ft||st==="option";if(gr||Tt!==-1){if(ft&&Dl(De,null,Ye,"created"),gt)if(gr||!St||Tt&48)for(const Jt in gt)(gr&&Jt.endsWith("value")||Bc(Jt)&&!zp(Jt))&&s(Le,Jt,null,gt[Jt],!1,void 0,Ye);else gt.onClick&&s(Le,"onClick",null,gt.onClick,!1,void 0,Ye);let xr;if((xr=gt&&gt.onVnodeBeforeMount)&&xs(xr,Ye,De),ft&&Dl(De,null,Ye,"beforeMount"),((xr=gt&&gt.onVnodeMounted)||ft)&&Vk(()=>{xr&&xs(xr,Ye,De),ft&&Dl(De,null,Ye,"mounted")},He),at&16&&!(gt&&(gt.innerHTML||gt.textContent))){let Jt=Pe(Le.firstChild,De,Le,Ye,He,ht,St);for(;Jt;){ku=!0;const Zt=Jt;Jt=Jt.nextSibling,a(Zt)}}else at&8&&Le.textContent!==De.children&&(ku=!0,Le.textContent=De.children)}return Le.nextSibling},Pe=(Le,De,Ye,He,ht,St,st)=>{st=st||!!De.dynamicChildren;const gt=De.children,Tt=gt.length;for(let at=0;at<Tt;at++){const ft=st?gt[at]:gt[at]=ra(gt[at]);if(Le)Le=ee(Le,ft,He,ht,St,st);else{if(ft.type===qp&&!ft.children)continue;ku=!0,r(null,ft,Ye,null,He,ht,Rb(Ye),St)}}return Le},xe=(Le,De,Ye,He,ht,St)=>{const{slotScopeIds:st}=De;st&&(ht=ht?ht.concat(st):st);const gt=I(Le),Tt=Pe(T(Le),De,gt,Ye,He,ht,St);return Tt&&Lb(Tt)&&Tt.data==="]"?T(De.anchor=Tt):(ku=!0,N(De.anchor=H("]"),gt,Tt),Tt)},Ie=(Le,De,Ye,He,ht,St)=>{if(ku=!0,De.el=null,St){const Tt=dt(Le);for(;;){const at=T(Le);if(at&&at!==Tt)a(at);else break}}const st=T(Le),gt=I(Le);return a(Le),r(null,De,gt,st,Ye,He,Rb(gt),ht),st},dt=Le=>{let De=0;for(;Le;)if(Le=T(Le),Le&&Lb(Le)&&(Le.data==="["&&De++,Le.data==="]")){if(De===0)return T(Le);De--}return Le};return[K,ee]}const Hn=Vk;function I3(t){return R3(t)}function D3(t){return R3(t,eG)}function R3(t,e){const r=H6();r.__VUE__=!0;const{insert:s,remove:g,patchProp:T,createElement:I,createText:a,createComment:N,setText:H,setElementText:K,parentNode:ee,nextSibling:ue,setScopeId:Pe=Ps,insertStaticContent:xe}=t,Ie=(Ne,Qe,ze,Bt=null,At=null,qt=null,Mt=!1,Vt=null,Gt=!!Qe.dynamicChildren)=>{if(Ne===Qe)return;Ne&&!Fl(Ne,Qe)&&(Bt=Si(Ne),Yi(Ne,At,qt,!0),Ne=null),Qe.patchFlag===-2&&(Gt=!1,Qe.dynamicChildren=null);const{type:Nt,ref:br,shapeFlag:ar}=Qe;switch(Nt){case qp:dt(Ne,Qe,ze,Bt);break;case Do:Le(Ne,Qe,ze,Bt);break;case Md:Ne==null&&De(Qe,ze,Bt,Mt);break;case _o:gr(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt);break;default:ar&1?ht(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt):ar&6?xr(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt):(ar&64||ar&128)&&Nt.process(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt,qi)}br!=null&&At&&z0(br,Ne&&Ne.ref,qt,Qe||Ne,!Qe)},dt=(Ne,Qe,ze,Bt)=>{if(Ne==null)s(Qe.el=a(Qe.children),ze,Bt);else{const At=Qe.el=Ne.el;Qe.children!==Ne.children&&H(At,Qe.children)}},Le=(Ne,Qe,ze,Bt)=>{Ne==null?s(Qe.el=N(Qe.children||""),ze,Bt):Qe.el=Ne.el},De=(Ne,Qe,ze,Bt)=>{[Ne.el,Ne.anchor]=xe(Ne.children,Qe,ze,Bt,Ne.el,Ne.anchor)},Ye=({el:Ne,anchor:Qe},ze,Bt)=>{let At;for(;Ne&&Ne!==Qe;)At=ue(Ne),s(Ne,ze,Bt),Ne=At;s(Qe,ze,Bt)},He=({el:Ne,anchor:Qe})=>{let ze;for(;Ne&&Ne!==Qe;)ze=ue(Ne),g(Ne),Ne=ze;g(Qe)},ht=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt)=>{Mt=Mt||Qe.type==="svg",Ne==null?St(Qe,ze,Bt,At,qt,Mt,Vt,Gt):Tt(Ne,Qe,At,qt,Mt,Vt,Gt)},St=(Ne,Qe,ze,Bt,At,qt,Mt,Vt)=>{let Gt,Nt;const{type:br,props:ar,shapeFlag:Dt,transition:zr,dirs:Hr}=Ne;if(Gt=Ne.el=I(Ne.type,qt,ar&&ar.is,ar),Dt&8?K(Gt,Ne.children):Dt&16&&gt(Ne.children,Gt,null,Bt,At,qt&&br!=="foreignObject",Mt,Vt),Hr&&Dl(Ne,null,Bt,"created"),ar){for(const Kr in ar)Kr!=="value"&&!zp(Kr)&&T(Gt,Kr,null,ar[Kr],qt,Ne.children,Bt,At,yi);"value"in ar&&T(Gt,"value",null,ar.value),(Nt=ar.onVnodeBeforeMount)&&xs(Nt,Bt,Ne)}st(Gt,Ne,Ne.scopeId,Mt,Bt),Hr&&Dl(Ne,null,Bt,"beforeMount");const Oi=(!At||At&&!At.pendingBranch)&&zr&&!zr.persisted;Oi&&zr.beforeEnter(Gt),s(Gt,Qe,ze),((Nt=ar&&ar.onVnodeMounted)||Oi||Hr)&&Hn(()=>{Nt&&xs(Nt,Bt,Ne),Oi&&zr.enter(Gt),Hr&&Dl(Ne,null,Bt,"mounted")},At)},st=(Ne,Qe,ze,Bt,At)=>{if(ze&&Pe(Ne,ze),Bt)for(let qt=0;qt<Bt.length;qt++)Pe(Ne,Bt[qt]);if(At){let qt=At.subTree;if(Qe===qt){const Mt=At.vnode;st(Ne,Mt,Mt.scopeId,Mt.slotScopeIds,At.parent)}}},gt=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt=0)=>{for(let Nt=Gt;Nt<Ne.length;Nt++){const br=Ne[Nt]=Vt?ju(Ne[Nt]):ra(Ne[Nt]);Ie(null,br,Qe,ze,Bt,At,qt,Mt,Vt)}},Tt=(Ne,Qe,ze,Bt,At,qt,Mt)=>{const Vt=Qe.el=Ne.el;let{patchFlag:Gt,dynamicChildren:Nt,dirs:br}=Qe;Gt|=Ne.patchFlag&16;const ar=Ne.props||Zi,Dt=Qe.props||Zi;let zr;ze&&od(ze,!1),(zr=Dt.onVnodeBeforeUpdate)&&xs(zr,ze,Qe,Ne),br&&Dl(Qe,Ne,ze,"beforeUpdate"),ze&&od(ze,!0);const Hr=At&&Qe.type!=="foreignObject";if(Nt?at(Ne.dynamicChildren,Nt,Vt,ze,Bt,Hr,qt):Mt||jr(Ne,Qe,Vt,null,ze,Bt,Hr,qt,!1),Gt>0){if(Gt&16)ft(Vt,Qe,ar,Dt,ze,Bt,At);else if(Gt&2&&ar.class!==Dt.class&&T(Vt,"class",null,Dt.class,At),Gt&4&&T(Vt,"style",ar.style,Dt.style,At),Gt&8){const Oi=Qe.dynamicProps;for(let Kr=0;Kr<Oi.length;Kr++){const Pi=Oi[Kr],to=ar[Pi],ds=Dt[Pi];(ds!==to||Pi==="value")&&T(Vt,Pi,to,ds,At,Ne.children,ze,Bt,yi)}}Gt&1&&Ne.children!==Qe.children&&K(Vt,Qe.children)}else!Mt&&Nt==null&&ft(Vt,Qe,ar,Dt,ze,Bt,At);((zr=Dt.onVnodeUpdated)||br)&&Hn(()=>{zr&&xs(zr,ze,Qe,Ne),br&&Dl(Qe,Ne,ze,"updated")},Bt)},at=(Ne,Qe,ze,Bt,At,qt,Mt)=>{for(let Vt=0;Vt<Qe.length;Vt++){const Gt=Ne[Vt],Nt=Qe[Vt],br=Gt.el&&(Gt.type===_o||!Fl(Gt,Nt)||Gt.shapeFlag&70)?ee(Gt.el):ze;Ie(Gt,Nt,br,null,Bt,At,qt,Mt,!0)}},ft=(Ne,Qe,ze,Bt,At,qt,Mt)=>{if(ze!==Bt){if(ze!==Zi)for(const Vt in ze)!zp(Vt)&&!(Vt in Bt)&&T(Ne,Vt,ze[Vt],null,Mt,Qe.children,At,qt,yi);for(const Vt in Bt){if(zp(Vt))continue;const Gt=Bt[Vt],Nt=ze[Vt];Gt!==Nt&&Vt!=="value"&&T(Ne,Vt,Nt,Gt,Mt,Qe.children,At,qt,yi)}"value"in Bt&&T(Ne,"value",ze.value,Bt.value)}},gr=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt)=>{const Nt=Qe.el=Ne?Ne.el:a(""),br=Qe.anchor=Ne?Ne.anchor:a("");let{patchFlag:ar,dynamicChildren:Dt,slotScopeIds:zr}=Qe;zr&&(Vt=Vt?Vt.concat(zr):zr),Ne==null?(s(Nt,ze,Bt),s(br,ze,Bt),gt(Qe.children,ze,br,At,qt,Mt,Vt,Gt)):ar>0&&ar&64&&Dt&&Ne.dynamicChildren?(at(Ne.dynamicChildren,Dt,ze,At,qt,Mt,Vt),(Qe.key!=null||At&&Qe===At.subTree)&&MO(Ne,Qe,!0)):jr(Ne,Qe,ze,br,At,qt,Mt,Vt,Gt)},xr=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt)=>{Qe.slotScopeIds=Vt,Ne==null?Qe.shapeFlag&512?At.ctx.activate(Qe,ze,Bt,Mt,Gt):Jt(Qe,ze,Bt,At,qt,Mt,Gt):Zt(Ne,Qe,Gt)},Jt=(Ne,Qe,ze,Bt,At,qt,Mt)=>{const Vt=Ne.isCompatRoot&&Ne.component,Gt=Vt||(Ne.component=DO(Ne,Bt,At));if(xy(Ne)&&(Gt.ctx.renderer=qi),Vt||RO(Gt),Gt.asyncDep){if(At&&At.registerDep(Gt,Et),!Ne.el){const Nt=Gt.subTree=Bi(Do);Le(null,Nt,Qe,ze)}return}Et(Gt,Ne,Qe,ze,At,qt,Mt)},Zt=(Ne,Qe,ze)=>{const Bt=Qe.component=Ne.component;if(t8(Ne,Qe,ze))if(Bt.asyncDep&&!Bt.asyncResolved){fr(Bt,Qe,ze);return}else Bt.next=Qe,$U(Bt.update),Bt.update();else Qe.el=Ne.el,Bt.vnode=Qe},Et=(Ne,Qe,ze,Bt,At,qt,Mt)=>{const Vt=()=>{if(Ne.isMounted){let{next:br,bu:ar,u:Dt,parent:zr,vnode:Hr}=Ne,Oi=br,Kr;od(Ne,!1),br?(br.el=Hr.el,fr(Ne,br,Mt)):br=Hr,ar&&Wu(ar),(Kr=br.props&&br.props.onVnodeBeforeUpdate)&&xs(Kr,zr,br,Hr),en("INSTANCE_EVENT_HOOKS",Ne)&&Ne.emit("hook:beforeUpdate"),od(Ne,!0);const Pi=o0(Ne),to=Ne.subTree;Ne.subTree=Pi,Ie(to,Pi,ee(to.el),Si(to),Ne,At,qt),br.el=Pi.el,Oi===null&&TO(Ne,Pi.el),Dt&&Hn(Dt,At),(Kr=br.props&&br.props.onVnodeUpdated)&&Hn(()=>xs(Kr,zr,br,Hr),At),en("INSTANCE_EVENT_HOOKS",Ne)&&Hn(()=>Ne.emit("hook:updated"),At)}else{let br;const{el:ar,props:Dt}=Qe,{bm:zr,m:Hr,parent:Oi}=Ne,Kr=Pd(Qe);if(od(Ne,!1),zr&&Wu(zr),!Kr&&(br=Dt&&Dt.onVnodeBeforeMount)&&xs(br,Oi,Qe),en("INSTANCE_EVENT_HOOKS",Ne)&&Ne.emit("hook:beforeMount"),od(Ne,!0),ar&&Kn){const Pi=()=>{Ne.subTree=o0(Ne),Kn(ar,Ne.subTree,Ne,At,null)};Kr?Qe.type.__asyncLoader().then(()=>!Ne.isUnmounted&&Pi()):Pi()}else{const Pi=Ne.subTree=o0(Ne);Ie(null,Pi,ze,Bt,Ne,At,qt),Qe.el=Pi.el}if(Hr&&Hn(Hr,At),!Kr&&(br=Dt&&Dt.onVnodeMounted)){const Pi=Qe;Hn(()=>xs(br,Oi,Pi),At)}en("INSTANCE_EVENT_HOOKS",Ne)&&Hn(()=>Ne.emit("hook:mounted"),At),(Qe.shapeFlag&256||Oi&&Pd(Oi.vnode)&&Oi.vnode.shapeFlag&256)&&(Ne.a&&Hn(Ne.a,At),en("INSTANCE_EVENT_HOOKS",Ne)&&Hn(()=>Ne.emit("hook:activated"),At)),Ne.isMounted=!0,Qe=ze=Bt=null}},Gt=Ne.effect=new yy(Vt,()=>Dx(Nt),Ne.scope),Nt=Ne.update=()=>Gt.run();Nt.id=Ne.uid,od(Ne,!0),Nt()},fr=(Ne,Qe,ze)=>{Qe.component=Ne;const Bt=Ne.vnode.props;Ne.vnode=Qe,Ne.next=null,F8(Ne,Qe.props,Bt,ze),j8(Ne,Qe.children,ze),Hd(),_M(),qd()},jr=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt=!1)=>{const Nt=Ne&&Ne.children,br=Ne?Ne.shapeFlag:0,ar=Qe.children,{patchFlag:Dt,shapeFlag:zr}=Qe;if(Dt>0){if(Dt&128){tn(Nt,ar,ze,Bt,At,qt,Mt,Vt,Gt);return}else if(Dt&256){er(Nt,ar,ze,Bt,At,qt,Mt,Vt,Gt);return}}zr&8?(br&16&&yi(Nt,At,qt),ar!==Nt&&K(ze,ar)):br&16?zr&16?tn(Nt,ar,ze,Bt,At,qt,Mt,Vt,Gt):yi(Nt,At,qt,!0):(br&8&&K(ze,""),zr&16&&gt(ar,ze,Bt,At,qt,Mt,Vt,Gt))},er=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt)=>{Ne=Ne||Bp,Qe=Qe||Bp;const Nt=Ne.length,br=Qe.length,ar=Math.min(Nt,br);let Dt;for(Dt=0;Dt<ar;Dt++){const zr=Qe[Dt]=Gt?ju(Qe[Dt]):ra(Qe[Dt]);Ie(Ne[Dt],zr,ze,null,At,qt,Mt,Vt,Gt)}Nt>br?yi(Ne,At,qt,!0,!1,ar):gt(Qe,ze,Bt,At,qt,Mt,Vt,Gt,ar)},tn=(Ne,Qe,ze,Bt,At,qt,Mt,Vt,Gt)=>{let Nt=0;const br=Qe.length;let ar=Ne.length-1,Dt=br-1;for(;Nt<=ar&&Nt<=Dt;){const zr=Ne[Nt],Hr=Qe[Nt]=Gt?ju(Qe[Nt]):ra(Qe[Nt]);if(Fl(zr,Hr))Ie(zr,Hr,ze,null,At,qt,Mt,Vt,Gt);else break;Nt++}for(;Nt<=ar&&Nt<=Dt;){const zr=Ne[ar],Hr=Qe[Dt]=Gt?ju(Qe[Dt]):ra(Qe[Dt]);if(Fl(zr,Hr))Ie(zr,Hr,ze,null,At,qt,Mt,Vt,Gt);else break;ar--,Dt--}if(Nt>ar){if(Nt<=Dt){const zr=Dt+1,Hr=zr<br?Qe[zr].el:Bt;for(;Nt<=Dt;)Ie(null,Qe[Nt]=Gt?ju(Qe[Nt]):ra(Qe[Nt]),ze,Hr,At,qt,Mt,Vt,Gt),Nt++}}else if(Nt>Dt)for(;Nt<=ar;)Yi(Ne[Nt],At,qt,!0),Nt++;else{const zr=Nt,Hr=Nt,Oi=new Map;for(Nt=Hr;Nt<=Dt;Nt++){const Nn=Qe[Nt]=Gt?ju(Qe[Nt]):ra(Qe[Nt]);Nn.key!=null&&Oi.set(Nn.key,Nt)}let Kr,Pi=0;const to=Dt-Hr+1;let ds=!1,ka=0;const xo=new Array(to);for(Nt=0;Nt<to;Nt++)xo[Nt]=0;for(Nt=zr;Nt<=ar;Nt++){const Nn=Ne[Nt];if(Pi>=to){Yi(Nn,At,qt,!0);continue}let vn;if(Nn.key!=null)vn=Oi.get(Nn.key);else for(Kr=Hr;Kr<=Dt;Kr++)if(xo[Kr-Hr]===0&&Fl(Nn,Qe[Kr])){vn=Kr;break}vn===void 0?Yi(Nn,At,qt,!0):(xo[vn-Hr]=Nt+1,vn>=ka?ka=vn:ds=!0,Ie(Nn,Qe[vn],ze,null,At,qt,Mt,Vt,Gt),Pi++)}const ha=ds?tG(xo):Bp;for(Kr=ha.length-1,Nt=to-1;Nt>=0;Nt--){const Nn=Hr+Nt,vn=Qe[Nn],dl=Nn+1<br?Qe[Nn+1].el:Bt;xo[Nt]===0?Ie(null,vn,ze,dl,At,qt,Mt,Vt,Gt):ds&&(Kr<0||Nt!==ha[Kr]?ln(vn,ze,dl,2):Kr--)}}},ln=(Ne,Qe,ze,Bt,At=null)=>{const{el:qt,type:Mt,transition:Vt,children:Gt,shapeFlag:Nt}=Ne;if(Nt&6){ln(Ne.component.subTree,Qe,ze,Bt);return}if(Nt&128){Ne.suspense.move(Qe,ze,Bt);return}if(Nt&64){Mt.move(Ne,Qe,ze,qi);return}if(Mt===_o){s(qt,Qe,ze);for(let ar=0;ar<Gt.length;ar++)ln(Gt[ar],Qe,ze,Bt);s(Ne.anchor,Qe,ze);return}if(Mt===Md){Ye(Ne,Qe,ze);return}if(Bt!==2&&Nt&1&&Vt)if(Bt===0)Vt.beforeEnter(qt),s(qt,Qe,ze),Hn(()=>Vt.enter(qt),At);else{const{leave:ar,delayLeave:Dt,afterLeave:zr}=Vt,Hr=()=>s(qt,Qe,ze),Oi=()=>{ar(qt,()=>{Hr(),zr&&zr()})};Dt?Dt(qt,Hr,Oi):Oi()}else s(qt,Qe,ze)},Yi=(Ne,Qe,ze,Bt=!1,At=!1)=>{const{type:qt,props:Mt,ref:Vt,children:Gt,dynamicChildren:Nt,shapeFlag:br,patchFlag:ar,dirs:Dt}=Ne;if(Vt!=null&&z0(Vt,null,ze,Ne,!0),br&256){Qe.ctx.deactivate(Ne);return}const zr=br&1&&Dt,Hr=!Pd(Ne);let Oi;if(Hr&&(Oi=Mt&&Mt.onVnodeBeforeUnmount)&&xs(Oi,Qe,Ne),br&6)rn(Ne.component,ze,Bt);else{if(br&128){Ne.suspense.unmount(ze,Bt);return}zr&&Dl(Ne,null,Qe,"beforeUnmount"),br&64?Ne.type.remove(Ne,Qe,ze,At,qi,Bt):Nt&&(qt!==_o||ar>0&&ar&64)?yi(Nt,Qe,ze,!1,!0):(qt===_o&&ar&384||!At&&br&16)&&yi(Gt,Qe,ze),Bt&&ir(Ne)}(Hr&&(Oi=Mt&&Mt.onVnodeUnmounted)||zr)&&Hn(()=>{Oi&&xs(Oi,Qe,Ne),zr&&Dl(Ne,null,Qe,"unmounted")},ze)},ir=Ne=>{const{type:Qe,el:ze,anchor:Bt,transition:At}=Ne;if(Qe===_o){us(ze,Bt);return}if(Qe===Md){He(Ne);return}const qt=()=>{g(ze),At&&!At.persisted&&At.afterLeave&&At.afterLeave()};if(Ne.shapeFlag&1&&At&&!At.persisted){const{leave:Mt,delayLeave:Vt}=At,Gt=()=>Mt(ze,qt);Vt?Vt(Ne.el,qt,Gt):Gt()}else qt()},us=(Ne,Qe)=>{let ze;for(;Ne!==Qe;)ze=ue(Ne),g(Ne),Ne=ze;g(Qe)},rn=(Ne,Qe,ze)=>{const{bum:Bt,scope:At,update:qt,subTree:Mt,um:Vt}=Ne;Bt&&Wu(Bt),en("INSTANCE_EVENT_HOOKS",Ne)&&Ne.emit("hook:beforeDestroy"),At.stop(),qt&&(qt.active=!1,Yi(Mt,Ne,Qe,ze)),Vt&&Hn(Vt,Qe),en("INSTANCE_EVENT_HOOKS",Ne)&&Hn(()=>Ne.emit("hook:destroyed"),Qe),Hn(()=>{Ne.isUnmounted=!0},Qe),Qe&&Qe.pendingBranch&&!Qe.isUnmounted&&Ne.asyncDep&&!Ne.asyncResolved&&Ne.suspenseId===Qe.pendingId&&(Qe.deps--,Qe.deps===0&&Qe.resolve())},yi=(Ne,Qe,ze,Bt=!1,At=!1,qt=0)=>{for(let Mt=qt;Mt<Ne.length;Mt++)Yi(Ne[Mt],Qe,ze,Bt,At)},Si=Ne=>Ne.shapeFlag&6?Si(Ne.component.subTree):Ne.shapeFlag&128?Ne.suspense.next():ue(Ne.anchor||Ne.el),hs=(Ne,Qe,ze)=>{Ne==null?Qe._vnode&&Yi(Qe._vnode,null,null,!0):Ie(Qe._vnode||null,Ne,Qe,null,null,null,ze),_M(),B0(),Qe._vnode=Ne},qi={p:Ie,um:Yi,m:ln,r:ir,mt:Jt,mc:gt,pc:jr,pbc:at,n:Si,o:t};let we,Kn;return e&&([we,Kn]=e(qi)),{render:hs,hydrate:we,createApp:Q8(hs,we)}}function od({effect:t,update:e},r){t.allowRecurse=e.allowRecurse=r}function MO(t,e,r=!1){const s=t.children,g=e.children;if(rr(s)&&rr(g))for(let T=0;T<s.length;T++){const I=s[T];let a=g[T];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=g[T]=ju(g[T]),a.el=I.el),r||MO(I,a))}}function tG(t){const e=t.slice(),r=[0];let s,g,T,I,a;const N=t.length;for(s=0;s<N;s++){const H=t[s];if(H!==0){if(g=r[r.length-1],t[g]<H){e[s]=g,r.push(s);continue}for(T=0,I=r.length-1;T<I;)a=T+I>>1,t[r[a]]<H?T=a+1:I=a;H<t[r[T]]&&(T>0&&(e[s]=r[T-1]),r[T]=s)}}for(T=r.length,I=r[T-1];T-- >0;)r[T]=I,I=e[I];return r}const rG=t=>t.__isTeleport,B_=t=>t&&(t.disabled||t.disabled===""),LM=t=>typeof SVGElement<"u"&&t instanceof SVGElement,KE=(t,e)=>{const r=t&&t.to;return Sn(r)?e?e(r):null:r},iG={__isTeleport:!0,process(t,e,r,s,g,T,I,a,N,H){const{mc:K,pc:ee,pbc:ue,o:{insert:Pe,querySelector:xe,createText:Ie,createComment:dt}}=H,Le=B_(e.props);let{shapeFlag:De,children:Ye,dynamicChildren:He}=e;if(t==null){const ht=e.el=Ie(""),St=e.anchor=Ie("");Pe(ht,r,s),Pe(St,r,s);const st=e.target=KE(e.props,xe),gt=e.targetAnchor=Ie("");st&&(Pe(gt,st),I=I||LM(st));const Tt=(at,ft)=>{De&16&&K(Ye,at,ft,g,T,I,a,N)};Le?Tt(r,St):st&&Tt(st,gt)}else{e.el=t.el;const ht=e.anchor=t.anchor,St=e.target=t.target,st=e.targetAnchor=t.targetAnchor,gt=B_(t.props),Tt=gt?r:St,at=gt?ht:st;if(I=I||LM(St),He?(ue(t.dynamicChildren,He,Tt,g,T,I,a),MO(t,e,!0)):N||ee(t,e,Tt,at,g,T,I,a,!1),Le)gt||Bb(e,r,ht,H,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const ft=e.target=KE(e.props,xe);ft&&Bb(e,ft,null,H,0)}else gt&&Bb(e,St,st,H,1)}},remove(t,e,r,s,{um:g,o:{remove:T}},I){const{shapeFlag:a,children:N,anchor:H,targetAnchor:K,target:ee,props:ue}=t;if(ee&&T(K),(I||!B_(ue))&&(T(H),a&16))for(let Pe=0;Pe<N.length;Pe++){const xe=N[Pe];g(xe,e,r,!0,!!xe.dynamicChildren)}},move:Bb,hydrate:nG};function Bb(t,e,r,{o:{insert:s},m:g},T=2){T===0&&s(t.targetAnchor,e,r);const{el:I,anchor:a,shapeFlag:N,children:H,props:K}=t,ee=T===2;if(ee&&s(I,e,r),(!ee||B_(K))&&N&16)for(let ue=0;ue<H.length;ue++)g(H[ue],e,r,2);ee&&s(a,e,r)}function nG(t,e,r,s,g,T,{o:{nextSibling:I,parentNode:a,querySelector:N}},H){const K=e.target=KE(e.props,N);if(K){const ee=K._lpa||K.firstChild;if(e.shapeFlag&16)if(B_(e.props))e.anchor=H(I(t),e,a(t),r,s,g,T),e.targetAnchor=ee;else{e.anchor=I(t);let ue=ee;for(;ue;)if(ue=I(ue),ue&&ue.nodeType===8&&ue.data==="teleport anchor"){e.targetAnchor=ue,K._lpa=e.targetAnchor&&I(e.targetAnchor);break}H(ee,e,K,r,s,g,T)}}return e.anchor&&I(e.anchor)}const oG=iG,RT=new Map;function sG(t){if(RT.has(t))return RT.get(t);let e,r;const s=new Promise((I,a)=>{e=I,r=a}),g=t(e,r);let T;return Sx(g)?T=s0(()=>g):Ei(g)&&!ua(g)&&!rr(g)?T=s0({loader:()=>g.component,loadingComponent:g.loading,errorComponent:g.error,delay:g.delay,timeout:g.timeout}):g==null?T=s0(()=>s):T=t,RT.set(t,T),T}function aG(t,e){return t.__isBuiltIn?t:(Dr(t)&&t.cid&&(t=t.options),Dr(t)&&Rx("COMPONENT_ASYNC",e,t)?sG(t):Ei(t)&&t.functional&&Mc("COMPONENT_FUNCTIONAL",e,t)?b8(t):t)}const _o=Symbol(void 0),qp=Symbol(void 0),Do=Symbol(void 0),Md=Symbol(void 0),k_=[];let Ss=null;function ih(t=!1){k_.push(Ss=t?null:[])}function L3(){k_.pop(),Ss=k_[k_.length-1]||null}let Bd=1;function YE(t){Bd+=t}function B3(t){return t.dynamicChildren=Bd>0?Ss||Bp:null,L3(),Bd>0&&Ss&&Ss.push(t),t}function $x(t,e,r,s,g,T){return B3(iy(t,e,r,s,g,T,!0))}function jx(t,e,r,s,g){return B3(Bi(t,e,r,s,g,!0))}function ua(t){return t?t.__v_isVNode===!0:!1}function Fl(t,e){return t.type===e.type&&t.key===e.key}function lG(t){}const Vx="__vInternal",k3=({key:t})=>t!=null?t:null,a0=({ref:t,ref_key:e,ref_for:r})=>t!=null?Sn(t)||so(t)||Dr(t)?{i:Qn,r:t,k:e,f:!!r}:t:null;function iy(t,e=null,r=null,s=0,g=null,T=t===_o?0:1,I=!1,a=!1){const N={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&k3(e),ref:e&&a0(e),scopeId:$p,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:T,patchFlag:s,dynamicProps:g,dynamicChildren:null,appContext:null};return a?(Ux(N,r),T&128&&t.normalize(N)):r&&(N.shapeFlag|=Sn(r)?8:16),Bd>0&&!I&&Ss&&(N.patchFlag>0||T&6)&&N.patchFlag!==32&&Ss.push(N),qU(N),d3(N),N}const Bi=cG;function cG(t,e=null,r=null,s=0,g=null,T=!1){if((!t||t===l3)&&(t=Do),ua(t)){const a=tl(t,e,!0);return r&&Ux(a,r),Bd>0&&!T&&Ss&&(a.shapeFlag&6?Ss[Ss.indexOf(t)]=a:Ss.push(a)),a.patchFlag|=-2,a}if(yG(t)&&(t=t.__vccOpts),t=aG(t,Qn),e){e=z3(e);let{class:a,style:N}=e;a&&!Sn(a)&&(e.class=eh(a)),Ei(N)&&(dO(N)&&!rr(N)&&(N=Mi({},N)),e.style=am(N))}const I=Sn(t)?1:jk(t)?128:rG(t)?64:Ei(t)?4:Dr(t)?2:0;return iy(t,e,r,s,g,I,T,!0)}function z3(t){return t?dO(t)||Vx in t?Mi({},t):t:null}function tl(t,e,r=!1){const{props:s,ref:g,patchFlag:T,children:I}=t,a=e?Gx(s||{},e):s,N={__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&k3(a),ref:e&&e.ref?r&&g?rr(g)?g.concat(a0(e)):[g,a0(e)]:a0(e):g,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:I,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==_o?T===-1?16:T|16:T,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&tl(t.ssContent),ssFallback:t.ssFallback&&tl(t.ssFallback),el:t.el,anchor:t.anchor};return d3(N),N}function Ty(t=" ",e=0){return Bi(qp,null,t,e)}function uG(t,e){const r=Bi(Md,null,t);return r.staticCount=e,r}function IO(t="",e=!1){return e?(ih(),jx(Do,null,t)):Bi(Do,null,t)}function ra(t){return t==null||typeof t=="boolean"?Bi(Do):rr(t)?Bi(_o,null,t.slice()):typeof t=="object"?ju(t):Bi(qp,null,String(t))}function ju(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:tl(t)}function Ux(t,e){let r=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(rr(e))r=16;else if(typeof e=="object")if(s&65){const g=e.default;g&&(g._c&&(g._d=!1),Ux(t,g()),g._c&&(g._d=!0));return}else{r=32;const g=e._;!g&&!(Vx in e)?e._ctx=Qn:g===3&&Qn&&(Qn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Dr(e)?(e={default:e,_ctx:Qn},r=32):(e=String(e),s&64?(r=16,e=[Ty(e)]):r=8);t.children=e,t.shapeFlag|=r}function Gx(...t){const e={};for(let r=0;r<t.length;r++){const s=t[r];for(const g in s)if(g==="class")e.class!==s.class&&(e.class=eh([e.class,s.class]));else if(g==="style")e.style=am([e.style,s.style]);else if(Bc(g)){const T=e[g],I=s[g];I&&T!==I&&!(rr(T)&&T.includes(I))&&(e[g]=T?[].concat(T,I):I)}else g!==""&&(e[g]=s[g])}return e}function xs(t,e,r,s=null){As(t,e,7,[r,s])}const hG=M3();let dG=0;function DO(t,e,r){const s=t.type,g=(e?e.appContext:t.appContext)||hG,T={uid:dG++,vnode:t,type:s,parent:e,appContext:g,root:null,next:null,subTree:null,effect:null,update:null,scope:new lO(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(g.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:S3(s,g),emitsOptions:$k(s,g),emit:null,emitted:null,propsDefaults:Zi,inheritAttrs:s.inheritAttrs,ctx:Zi,data:Zi,props:Zi,attrs:Zi,slots:Zi,refs:Zi,setupState:Zi,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return T.ctx={_:T},T.root=e?e.root:T,T.emit=ZU.bind(null,T),t.ce&&t.ce(T),T}let oo=null;const ql=()=>oo||Qn,nh=t=>{oo=t,t.scope.on()},Ku=()=>{oo&&oo.scope.off(),oo=null};function F3(t){return t.vnode.shapeFlag&4}let Wp=!1;function RO(t,e=!1){Wp=e;const{props:r,children:s}=t.vnode,g=F3(t);z8(t,r,g,e),$8(t,s);const T=g?fG(t,e):void 0;return Wp=!1,T}function fG(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=fO(new Proxy(t.ctx,qE));const{setup:s}=r;if(s){const g=t.setupContext=s.length>1?N3(t):null;nh(t),Hd();const T=el(s,t,0,[t.props,g]);if(qd(),Ku(),Sx(T)){if(T.then(Ku,Ku),e)return T.then(I=>{JE(t,I,e)}).catch(I=>{Wd(I,t,0)});t.asyncDep=T}else JE(t,T,e)}else LO(t,e)}function JE(t,e,r){Dr(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ei(e)&&(t.setupState=gO(e)),LO(t,r)}let F0,QE;function pG(t){F0=t,QE=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,D8))}}const eS=()=>!F0;function LO(t,e,r){const s=t.type;if(_8(t),!t.render){if(!e&&F0&&!s.render){const g=t.vnode.props&&t.vnode.props["inline-template"]||s.template||wy(t).template;if(g){const{isCustomElement:T,compilerOptions:I}=t.appContext.config,{delimiters:a,compilerOptions:N}=s,H=Mi(Mi({isCustomElement:T,delimiters:a},I),N);H.compatConfig=Object.create(vO),s.compatConfig&&Mi(H.compatConfig,s.compatConfig),s.render=F0(g,H)}}t.render=s.render||Ps,QE&&QE(t)}r||(nh(t),Hd(),R8(t),qd(),Ku())}function mG(t){return new Proxy(t.attrs,{get(e,r){return Ls(t,"get","$attrs"),e[r]}})}function N3(t){const e=s=>{t.exposed=s||{}};let r;return{get attrs(){return r||(r=mG(t))},slots:t.slots,emit:t.emit,expose:e}}function Hx(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(gO(fO(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in ry)return ry[r](t)}}))}const gG=/(?:^|[-_])(\w)/g,_G=t=>t.replace(gG,e=>e.toUpperCase()).replace(/[-_]/g,"");function N0(t,e=!0){return Dr(t)?t.displayName||t.name:t.name||e&&t.__name}function $3(t,e,r=!1){let s=N0(e);if(!s&&e.__file){const g=e.__file.match(/([^/\\]+)\.\w+$/);g&&(s=g[1])}if(!s&&t&&t.parent){const g=T=>{for(const I in T)if(T[I]===e)return I};s=g(t.components||t.parent.type.components)||g(t.appContext.components)}return s?_G(s):r?"App":"Anonymous"}function yG(t){return Dr(t)&&"__vccOpts"in t}const j3=(t,e)=>RU(t,e,Wp);function vG(){return null}function bG(){return null}function xG(t){}function wG(t,e){return null}function TG(){return V3().slots}function EG(){return V3().attrs}function V3(){const t=ql();return t.setupContext||(t.setupContext=N3(t))}function SG(t,e){const r=rr(t)?t.reduce((s,g)=>(s[g]={},s),{}):t;for(const s in e){const g=r[s];g?rr(g)||Dr(g)?r[s]={type:g,default:e[s]}:g.default=e[s]:g===null&&(r[s]={default:e[s]})}return r}function OG(t,e){const r={};for(const s in t)e.includes(s)||Object.defineProperty(r,s,{enumerable:!0,get:()=>t[s]});return r}function PG(t){const e=ql();let r=t();return Ku(),Sx(r)&&(r=r.catch(s=>{throw nh(e),s})),[r,()=>nh(e)]}function U3(t,e,r){const s=arguments.length;return s===2?Ei(e)&&!rr(e)?ua(e)?Bi(t,null,[e]):Bi(t,e):Bi(t,null,e):(s>3?r=Array.prototype.slice.call(arguments,2):s===3&&ua(r)&&(r=[r]),Bi(t,e,r))}const G3=Symbol(""),AG=()=>{{const t=Od(G3);return t||Rk("Server rendering context not provided. Make sure to only call useSSRContext() conditionally in the server build."),t}};function CG(){}function MG(t,e,r,s){const g=r[s];if(g&&H3(g,t))return g;const T=e();return T.memo=t.slice(),r[s]=T}function H3(t,e){const r=t.memo;if(r.length!=e.length)return!1;for(let s=0;s<r.length;s++)if(Up(r[s],e[s]))return!1;return Bd>0&&Ss&&Ss.push(t),!0}const q3="3.2.41",IG={createComponentInstance:DO,setupComponent:RO,renderComponentRoot:o0,setCurrentRenderingInstance:J_,isVNode:ua,normalizeVNode:ra},DG=IG,RG=h3,LG={warnDeprecation:VU,createCompatVue:U8,isCompatEnabled:en,checkCompatEnabled:Rx,softAssertCompatEnabled:Mc},Ul=LG,BG="http://www.w3.org/2000/svg",yd=typeof document<"u"?document:null,BM=yd&&yd.createElement("template"),kG={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,s)=>{const g=e?yd.createElementNS(BG,t):yd.createElement(t,r?{is:r}:void 0);return t==="select"&&s&&s.multiple!=null&&g.setAttribute("multiple",s.multiple),g},createText:t=>yd.createTextNode(t),createComment:t=>yd.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>yd.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,s,g,T){const I=r?r.previousSibling:e.lastChild;if(g&&(g===T||g.nextSibling))for(;e.insertBefore(g.cloneNode(!0),r),!(g===T||!(g=g.nextSibling)););else{BM.innerHTML=s?`<svg>${t}</svg>`:t;const a=BM.content;if(s){const N=a.firstChild;for(;N.firstChild;)a.appendChild(N.firstChild);a.removeChild(N)}e.insertBefore(a,r)}return[I?I.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}};function zG(t,e,r){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}function FG(t,e,r){const s=t.style,g=Sn(r);if(r&&!g){for(const T in r)tS(s,T,r[T]);if(e&&!Sn(e))for(const T in e)r[T]==null&&tS(s,T,"")}else{const T=s.display;g?e!==r&&(s.cssText=r):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=T)}}const kM=/\s*!important$/;function tS(t,e,r){if(rr(r))r.forEach(s=>tS(t,e,s));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const s=NG(t,e);kM.test(r)?t.setProperty(la(s),r.replace(kM,""),"important"):t[s]=r}}const zM=["Webkit","Moz","ms"],LT={};function NG(t,e){const r=LT[e];if(r)return r;let s=Rs(e);if(s!=="filter"&&s in t)return LT[e]=s;s=_y(s);for(let g=0;g<zM.length;g++){const T=zM[g]+s;if(T in t)return LT[e]=T}return e}const FM="http://www.w3.org/1999/xlink";function $G(t,e,r,s,g){if(s&&e.startsWith("xlink:"))r==null?t.removeAttributeNS(FM,e.slice(6,e.length)):t.setAttributeNS(FM,e,r);else{if(VG(t,e,r,g))return;const T=hk(e);r==null||T&&!dk(r)?t.removeAttribute(e):t.setAttribute(e,T?"":r)}}const jG=sm("contenteditable,draggable,spellcheck");function VG(t,e,r,s=null){if(jG(e)){const g=r===null?"false":typeof r!="boolean"&&r!==void 0?"true":null;if(g&&Ul.softAssertCompatEnabled("ATTR_ENUMERATED_COERCION",s,e,r,g))return t.setAttribute(e,g),!0}else if(r===!1&&!hk(e)&&Ul.softAssertCompatEnabled("ATTR_FALSE_VALUE",s,e))return t.removeAttribute(e),!0;return!1}function UG(t,e,r,s,g,T,I){if(e==="innerHTML"||e==="textContent"){s&&I(s,g,T),t[e]=r==null?"":r;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=r;const N=r==null?"":r;(t.value!==N||t.tagName==="OPTION")&&(t.value=N),r==null&&t.removeAttribute(e);return}let a=!1;if(r===""||r==null){const N=typeof t[e];N==="boolean"?r=dk(r):r==null&&N==="string"?(r="",a=!0):N==="number"&&(r=0,a=!0)}else if(r===!1&&Ul.isCompatEnabled("ATTR_FALSE_VALUE",g)){const N=typeof t[e];(N==="string"||N==="number")&&(r=N==="number"?0:"",a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(e)}function bc(t,e,r,s){t.addEventListener(e,r,s)}function GG(t,e,r,s){t.removeEventListener(e,r,s)}function HG(t,e,r,s,g=null){const T=t._vei||(t._vei={}),I=T[e];if(s&&I)I.value=s;else{const[a,N]=qG(e);if(s){const H=T[e]=XG(s,g);bc(t,a,H,N)}else I&&(GG(t,a,I,N),T[e]=void 0)}}const NM=/(?:Once|Passive|Capture)$/;function qG(t){let e;if(NM.test(t)){e={};let s;for(;s=t.match(NM);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):la(t.slice(2)),e]}let BT=0;const WG=Promise.resolve(),ZG=()=>BT||(WG.then(()=>BT=0),BT=Date.now());function XG(t,e){const r=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=r.attached)return;As(KG(s,r.value),e,5,[s])};return r.value=t,r.attached=ZG(),r}function KG(t,e){if(rr(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(s=>g=>!g._stopped&&s&&s(g))}else return e}const $M=/^on[a-z]/,YG=(t,e,r,s,g=!1,T,I,a,N)=>{e==="class"?zG(t,s,g):e==="style"?FG(t,r,s):Bc(e)?oO(e)||HG(t,e,r,s,I):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):JG(t,e,s,g))?UG(t,e,s,T,I,a,N):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),$G(t,e,s,g,I))};function JG(t,e,r,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&$M.test(e)&&Dr(r)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||$M.test(e)&&Sn(r)?!1:e in t}function W3(t,e){const r=PO(t);class s extends qx{constructor(T){super(r,T,e)}}return s.def=r,s}const QG=t=>W3(t,lz),eH=typeof HTMLElement<"u"?HTMLElement:class{};class qx extends eH{constructor(e,r={},s){super(),this._def=e,this._props=r,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&s?s(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,vy(()=>{this._connected||(iS(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let s=0;s<this.attributes.length;s++)this._setAttr(this.attributes[s].name);new MutationObserver(s=>{for(const g of s)this._setAttr(g.attributeName)}).observe(this,{attributes:!0});const e=s=>{const{props:g,styles:T}=s,I=!rr(g),a=g?I?Object.keys(g):g:[];let N;if(I)for(const H in this._props){const K=g[H];(K===Number||K&&K.type===Number)&&(this._props[H]=Cc(this._props[H]),(N||(N=Object.create(null)))[H]=!0)}this._numberProps=N;for(const H of Object.keys(this))H[0]!=="_"&&this._setProp(H,this[H],!0,!1);for(const H of a.map(Rs))Object.defineProperty(this,H,{get(){return this._getProp(H)},set(K){this._setProp(H,K)}});this._applyStyles(T),this._update()},r=this._def.__asyncLoader;r?r().then(e):e(this._def)}_setAttr(e){let r=this.getAttribute(e);this._numberProps&&this._numberProps[e]&&(r=Cc(r)),this._setProp(Rs(e),r,!1)}_getProp(e){return this._props[e]}_setProp(e,r,s=!0,g=!0){r!==this._props[e]&&(this._props[e]=r,g&&this._instance&&this._update(),s&&(r===!0?this.setAttribute(la(e),""):typeof r=="string"||typeof r=="number"?this.setAttribute(la(e),r+""):r||this.removeAttribute(la(e))))}_update(){iS(this._createVNode(),this.shadowRoot)}_createVNode(){const e=Bi(this._def,Mi({},this._props));return this._instance||(e.ce=r=>{this._instance=r,r.isCE=!0,r.emit=(g,...T)=>{this.dispatchEvent(new CustomEvent(g,{detail:T}))};let s=this;for(;s=s&&(s.parentNode||s.host);)if(s instanceof qx){r.parent=s._instance;break}}),e}_applyStyles(e){e&&e.forEach(r=>{const s=document.createElement("style");s.textContent=r,this.shadowRoot.appendChild(s)})}}function tH(t="$style"){{const e=ql();if(!e)return Zi;const r=e.type.__cssModules;if(!r)return Zi;const s=r[t];return s||Zi}}function rH(t){const e=ql();if(!e)return;const r=()=>rS(e.subTree,t(e.proxy));Gk(r),lm(()=>{const s=new MutationObserver(r);s.observe(e.subTree.el.parentNode,{childList:!0}),ty(()=>s.disconnect())})}function rS(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{rS(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)jM(t.el,e);else if(t.type===_o)t.children.forEach(r=>rS(r,e));else if(t.type===Md){let{el:r,anchor:s}=t;for(;r&&(jM(r,e),r!==s);)r=r.nextSibling}}function jM(t,e){if(t.nodeType===1){const r=t.style;for(const s in e)r.setProperty(`--${s}`,e[s])}}const zu="transition",Jg="animation",Ey=(t,{slots:e})=>U3(OO,X3(t),e);Ey.displayName="Transition";Ey.__isBuiltIn=!0;const Z3={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},iH=Ey.props=Mi({},OO.props,Z3),sd=(t,e=[])=>{rr(t)?t.forEach(r=>r(...e)):t&&t(...e)},VM=t=>t?rr(t)?t.some(e=>e.length>1):t.length>1:!1;function X3(t){const e={};for(const Et in t)Et in Z3||(e[Et]=t[Et]);if(t.css===!1)return e;const{name:r="v",type:s,duration:g,enterFromClass:T=`${r}-enter-from`,enterActiveClass:I=`${r}-enter-active`,enterToClass:a=`${r}-enter-to`,appearFromClass:N=T,appearActiveClass:H=I,appearToClass:K=a,leaveFromClass:ee=`${r}-leave-from`,leaveActiveClass:ue=`${r}-leave-active`,leaveToClass:Pe=`${r}-leave-to`}=t,xe=Ul.isCompatEnabled("TRANSITION_CLASSES",null);let Ie,dt,Le;if(xe){const Et=fr=>fr.replace(/-from$/,"");t.enterFromClass||(Ie=Et(T)),t.appearFromClass||(dt=Et(N)),t.leaveFromClass||(Le=Et(ee))}const De=nH(g),Ye=De&&De[0],He=De&&De[1],{onBeforeEnter:ht,onEnter:St,onEnterCancelled:st,onLeave:gt,onLeaveCancelled:Tt,onBeforeAppear:at=ht,onAppear:ft=St,onAppearCancelled:gr=st}=e,xr=(Et,fr,jr)=>{Ml(Et,fr?K:a),Ml(Et,fr?H:I),jr&&jr()},Jt=(Et,fr)=>{Et._isLeaving=!1,Ml(Et,ee),Ml(Et,Pe),Ml(Et,ue),fr&&fr()},Zt=Et=>(fr,jr)=>{const er=Et?ft:St,tn=()=>xr(fr,Et,jr);sd(er,[fr,tn]),UM(()=>{Ml(fr,Et?N:T),xe&&Ml(fr,Et?dt:Ie),Pa(fr,Et?K:a),VM(er)||GM(fr,s,Ye,tn)})};return Mi(e,{onBeforeEnter(Et){sd(ht,[Et]),Pa(Et,T),xe&&Pa(Et,Ie),Pa(Et,I)},onBeforeAppear(Et){sd(at,[Et]),Pa(Et,N),xe&&Pa(Et,dt),Pa(Et,H)},onEnter:Zt(!1),onAppear:Zt(!0),onLeave(Et,fr){Et._isLeaving=!0;const jr=()=>Jt(Et,fr);Pa(Et,ee),xe&&Pa(Et,Le),Y3(),Pa(Et,ue),UM(()=>{!Et._isLeaving||(Ml(Et,ee),xe&&Ml(Et,Le),Pa(Et,Pe),VM(gt)||GM(Et,s,He,jr))}),sd(gt,[Et,jr])},onEnterCancelled(Et){xr(Et,!1),sd(st,[Et])},onAppearCancelled(Et){xr(Et,!0),sd(gr,[Et])},onLeaveCancelled(Et){Jt(Et),sd(Tt,[Et])}})}function nH(t){if(t==null)return null;if(Ei(t))return[kT(t.enter),kT(t.leave)];{const e=kT(t);return[e,e]}}function kT(t){return Cc(t)}function Pa(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t._vtc||(t._vtc=new Set)).add(e)}function Ml(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:r}=t;r&&(r.delete(e),r.size||(t._vtc=void 0))}function UM(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let oH=0;function GM(t,e,r,s){const g=t._endId=++oH,T=()=>{g===t._endId&&s()};if(r)return setTimeout(T,r);const{type:I,timeout:a,propCount:N}=K3(t,e);if(!I)return s();const H=I+"end";let K=0;const ee=()=>{t.removeEventListener(H,ue),T()},ue=Pe=>{Pe.target===t&&++K>=N&&ee()};setTimeout(()=>{K<N&&ee()},a+1),t.addEventListener(H,ue)}function K3(t,e){const r=window.getComputedStyle(t),s=xe=>(r[xe]||"").split(", "),g=s(zu+"Delay"),T=s(zu+"Duration"),I=HM(g,T),a=s(Jg+"Delay"),N=s(Jg+"Duration"),H=HM(a,N);let K=null,ee=0,ue=0;e===zu?I>0&&(K=zu,ee=I,ue=T.length):e===Jg?H>0&&(K=Jg,ee=H,ue=N.length):(ee=Math.max(I,H),K=ee>0?I>H?zu:Jg:null,ue=K?K===zu?T.length:N.length:0);const Pe=K===zu&&/\b(transform|all)(,|$)/.test(r[zu+"Property"]);return{type:K,timeout:ee,propCount:ue,hasTransform:Pe}}function HM(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,s)=>qM(r)+qM(t[s])))}function qM(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function Y3(){return document.body.offsetHeight}const J3=new WeakMap,Q3=new WeakMap,ez={name:"TransitionGroup",props:Mi({},iH,{tag:String,moveClass:String}),setup(t,{slots:e}){const r=ql(),s=SO();let g,T;return Fx(()=>{if(!g.length)return;const I=t.moveClass||`${t.name||"v"}-move`;if(!cH(g[0].el,r.vnode.el,I))return;g.forEach(sH),g.forEach(aH);const a=g.filter(lH);Y3(),a.forEach(N=>{const H=N.el,K=H.style;Pa(H,I),K.transform=K.webkitTransform=K.transitionDuration="";const ee=H._moveCb=ue=>{ue&&ue.target!==H||(!ue||/transform$/.test(ue.propertyName))&&(H.removeEventListener("transitionend",ee),H._moveCb=null,Ml(H,I))};H.addEventListener("transitionend",ee)})}),()=>{const I=ki(t),a=X3(I);let N=I.tag||_o;!I.tag&&Ul.checkCompatEnabled("TRANSITION_GROUP_ROOT",r.parent)&&(N="span"),g=T,T=e.default?kx(e.default()):[];for(let H=0;H<T.length;H++){const K=T[H];K.key!=null&&Ld(K,Hp(K,a,s,r))}if(g)for(let H=0;H<g.length;H++){const K=g[H];Ld(K,Hp(K,a,s,r)),J3.set(K,K.el.getBoundingClientRect())}return Bi(N,null,T)}}};ez.__isBuiltIn=!0;const tz=ez;function sH(t){const e=t.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function aH(t){Q3.set(t,t.el.getBoundingClientRect())}function lH(t){const e=J3.get(t),r=Q3.get(t),s=e.left-r.left,g=e.top-r.top;if(s||g){const T=t.el.style;return T.transform=T.webkitTransform=`translate(${s}px,${g}px)`,T.transitionDuration="0s",t}}function cH(t,e,r){const s=t.cloneNode();t._vtc&&t._vtc.forEach(I=>{I.split(/\s+/).forEach(a=>a&&s.classList.remove(a))}),r.split(/\s+/).forEach(I=>I&&s.classList.add(I)),s.style.display="none";const g=e.nodeType===1?e:e.parentNode;g.appendChild(s);const{hasTransform:T}=K3(s);return g.removeChild(s),T}const oh=t=>{const e=t.props["onUpdate:modelValue"]||t.props["onModelCompat:input"];return rr(e)?r=>Wu(e,r):e};function uH(t){t.target.composing=!0}function WM(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const $0={created(t,{modifiers:{lazy:e,trim:r,number:s}},g){t._assign=oh(g);const T=s||g.props&&g.props.type==="number";bc(t,e?"change":"input",I=>{if(I.target.composing)return;let a=t.value;r&&(a=a.trim()),T&&(a=Cc(a)),t._assign(a)}),r&&bc(t,"change",()=>{t.value=t.value.trim()}),e||(bc(t,"compositionstart",uH),bc(t,"compositionend",WM),bc(t,"change",WM))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:r,trim:s,number:g}},T){if(t._assign=oh(T),t.composing||document.activeElement===t&&t.type!=="range"&&(r||s&&t.value.trim()===e||(g||t.type==="number")&&Cc(t.value)===e))return;const I=e==null?"":e;t.value!==I&&(t.value=I)}},BO={deep:!0,created(t,e,r){t._assign=oh(r),bc(t,"change",()=>{const s=t._modelValue,g=Zp(t),T=t.checked,I=t._assign;if(rr(s)){const a=my(s,g),N=a!==-1;if(T&&!N)I(s.concat(g));else if(!T&&N){const H=[...s];H.splice(a,1),I(H)}}else if(Gd(s)){const a=new Set(s);T?a.add(g):a.delete(g),I(a)}else I(iz(t,T))})},mounted:ZM,beforeUpdate(t,e,r){t._assign=oh(r),ZM(t,e,r)}};function ZM(t,{value:e,oldValue:r},s){t._modelValue=e,rr(e)?t.checked=my(e,s.props.value)>-1:Gd(e)?t.checked=e.has(s.props.value):e!==r&&(t.checked=Ac(e,iz(t,!0)))}const kO={created(t,{value:e},r){t.checked=Ac(e,r.props.value),t._assign=oh(r),bc(t,"change",()=>{t._assign(Zp(t))})},beforeUpdate(t,{value:e,oldValue:r},s){t._assign=oh(s),e!==r&&(t.checked=Ac(e,s.props.value))}},rz={deep:!0,created(t,{value:e,modifiers:{number:r}},s){const g=Gd(e);bc(t,"change",()=>{const T=Array.prototype.filter.call(t.options,I=>I.selected).map(I=>r?Cc(Zp(I)):Zp(I));t._assign(t.multiple?g?new Set(T):T:T[0])}),t._assign=oh(s)},mounted(t,{value:e}){XM(t,e)},beforeUpdate(t,e,r){t._assign=oh(r)},updated(t,{value:e}){XM(t,e)}};function XM(t,e){const r=t.multiple;if(!(r&&!rr(e)&&!Gd(e))){for(let s=0,g=t.options.length;s<g;s++){const T=t.options[s],I=Zp(T);if(r)rr(e)?T.selected=my(e,I)>-1:T.selected=e.has(I);else if(Ac(Zp(T),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Zp(t){return"_value"in t?t._value:t.value}function iz(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const zO={created(t,e,r){kb(t,e,r,null,"created")},mounted(t,e,r){kb(t,e,r,null,"mounted")},beforeUpdate(t,e,r,s){kb(t,e,r,s,"beforeUpdate")},updated(t,e,r,s){kb(t,e,r,s,"updated")}};function nz(t,e){switch(t){case"SELECT":return rz;case"TEXTAREA":return $0;default:switch(e){case"checkbox":return BO;case"radio":return kO;default:return $0}}}function kb(t,e,r,s,g){const I=nz(t.tagName,r.props&&r.props.type)[g];I&&I(t,e,r,s)}function hH(){$0.getSSRProps=({value:t})=>({value:t}),kO.getSSRProps=({value:t},e)=>{if(e.props&&Ac(e.props.value,t))return{checked:!0}},BO.getSSRProps=({value:t},e)=>{if(rr(t)){if(e.props&&my(t,e.props.value)>-1)return{checked:!0}}else if(Gd(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},zO.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const r=nz(e.type.toUpperCase(),e.props&&e.props.type);if(r.getSSRProps)return r.getSSRProps(t,e)}}const dH=["ctrl","shift","alt","meta"],fH={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>dH.some(r=>t[`${r}Key`]&&!e.includes(r))},pH=(t,e)=>(r,...s)=>{for(let g=0;g<e.length;g++){const T=fH[e[g]];if(T&&T(r,e))return}return t(r,...s)},mH={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},gH=(t,e)=>{let r,s=null;return s=ql(),Ul.isCompatEnabled("CONFIG_KEY_CODES",s)&&s&&(r=s.appContext.config.keyCodes),g=>{if(!("key"in g))return;const T=la(g.key);if(e.some(I=>I===T||mH[I]===T))return t(g);{const I=String(g.keyCode);if(Ul.isCompatEnabled("V_ON_KEYCODE_MODIFIER",s)&&e.some(a=>a==I))return t(g);if(r)for(const a of e){const N=r[a];if(N&&(rr(N)?N.some(K=>String(K)===I):String(N)===I))return t(g)}}}},FO={beforeMount(t,{value:e},{transition:r}){t._vod=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):Qg(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:s}){!e!=!r&&(s?e?(s.beforeEnter(t),Qg(t,!0),s.enter(t)):s.leave(t,()=>{Qg(t,!1)}):Qg(t,e))},beforeUnmount(t,{value:e}){Qg(t,e)}};function Qg(t,e){t.style.display=e?t._vod:"none"}function _H(){FO.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const oz=Mi({patchProp:YG},kG);let z_,KM=!1;function sz(){return z_||(z_=I3(oz))}function az(){return z_=KM?z_:D3(oz),KM=!0,z_}const iS=(...t)=>{sz().render(...t)},lz=(...t)=>{az().hydrate(...t)},Wx=(...t)=>{const e=sz().createApp(...t),{mount:r}=e;return e.mount=s=>{const g=cz(s);if(!g)return;const T=e._component;!Dr(T)&&!T.render&&!T.template&&(T.template=g.innerHTML),g.innerHTML="";const I=r(g,!1,g instanceof SVGElement);return g instanceof Element&&(g.removeAttribute("v-cloak"),g.setAttribute("data-v-app","")),I},e},yH=(...t)=>{const e=az().createApp(...t),{mount:r}=e;return e.mount=s=>{const g=cz(s);if(g)return r(g,!0,g instanceof SVGElement)},e};function cz(t){return Sn(t)?document.querySelector(t):t}let YM=!1;const vH=()=>{YM||(YM=!0,hH(),_H())};var bH=Object.freeze({__proto__:null,render:iS,hydrate:lz,createApp:Wx,createSSRApp:yH,initDirectivesForSSR:vH,defineCustomElement:W3,defineSSRCustomElement:QG,VueElement:qx,useCssModule:tH,useCssVars:rH,Transition:Ey,TransitionGroup:tz,vModelText:$0,vModelCheckbox:BO,vModelRadio:kO,vModelSelect:rz,vModelDynamic:zO,withModifiers:pH,withKeys:gH,vShow:FO,reactive:rh,ref:Xu,readonly:hO,unref:Mk,proxyRefs:gO,isRef:so,toRef:Ik,toRefs:MU,isProxy:dO,isReactive:Sc,isReadonly:Rd,isShallow:Z_,customRef:CU,triggerRef:OU,shallowRef:EU,shallowReactive:Ak,shallowReadonly:TU,markRaw:fO,toRaw:ki,effect:Y6,stop:J6,ReactiveEffect:yy,effectScope:q6,EffectScope:lO,getCurrentScope:W6,onScopeDispose:Z6,computed:j3,watch:L_,watchEffect:l8,watchPostEffect:Gk,watchSyncEffect:c8,onBeforeMount:Qk,onMounted:lm,onBeforeUpdate:e3,onUpdated:Fx,onBeforeUnmount:ey,onUnmounted:ty,onActivated:Kk,onDeactivated:Yk,onRenderTracked:i3,onRenderTriggered:r3,onErrorCaptured:n3,onServerPrefetch:t3,provide:Uk,inject:Od,nextTick:vy,defineComponent:PO,defineAsyncComponent:s0,useAttrs:EG,useSlots:TG,defineProps:vG,defineEmits:bG,defineExpose:xG,withDefaults:wG,mergeDefaults:SG,createPropsRestProxy:OG,withAsyncContext:PG,getCurrentInstance:ql,h:U3,createVNode:Bi,cloneVNode:tl,mergeProps:Gx,isVNode:ua,Fragment:_o,Text:qp,Comment:Do,Static:Md,Teleport:oG,Suspense:i8,KeepAlive:Xk,BaseTransition:OO,withDirectives:a3,useSSRContext:AG,ssrContextKey:G3,createRenderer:I3,createHydrationRenderer:D3,queuePostFlushCb:yO,warn:Rk,handleError:Wd,callWithErrorHandling:el,callWithAsyncErrorHandling:As,resolveComponent:wd,resolveDirective:u3,resolveDynamicComponent:c3,registerRuntimeCompiler:pG,isRuntimeOnly:eS,useTransitionState:SO,resolveTransitionHooks:Hp,setTransitionHooks:Ld,getTransitionRawChildren:kx,initCustomFormatter:CG,get devtools(){return Op},setDevtoolsHook:Fk,withCtx:Gp,pushScopeId:XU,popScopeId:KU,withScopeId:YU,renderList:p3,toHandlers:y3,renderSlot:g3,createSlots:m3,withMemo:MG,isMemoSame:H3,openBlock:ih,createBlock:jx,setBlockTracking:YE,createTextVNode:Ty,createCommentVNode:IO,createStaticVNode:uG,createElementVNode:iy,createElementBlock:$x,guardReactiveProps:z3,toDisplayString:nO,camelize:Rs,capitalize:_y,toHandlerKey:Fp,normalizeProps:z6,normalizeClass:eh,normalizeStyle:am,transformVNodeArgs:lG,version:q3,ssrUtils:DG,resolveFilter:RG,compatUtils:Ul});function xH(...t){const e=Wx(...t);return Ul.isCompatEnabled("RENDER_FUNCTION",null)&&(e.component("__compat__transition",Ey),e.component("__compat__transition-group",tz),e.component("__compat__keep-alive",Xk),e._context.directives.show=FO,e._context.directives.model=zO),e}function wH(){const t=Ul.createCompatVue(Wx,xH);return Mi(t,bH),t}const An=wH();An.compile=()=>{};var uz=function(){return(uz=Object.assign||function(t){for(var e,r=1,s=arguments.length;r<s;r++)for(var g in e=arguments[r])Object.prototype.hasOwnProperty.call(e,g)&&(t[g]=e[g]);return t}).apply(this,arguments)},zT={kebab:/-(\w)/g,styleProp:/:(.*)/,styleList:/;(?![^(]*\))/g};function TH(t,e){return e?e.toUpperCase():""}function EH(t){for(var e,r={},s=0,g=t.split(zT.styleList);s<g.length;s++){var T=g[s].split(zT.styleProp),I=T[0],a=T[1];(I=I.trim())&&(typeof a=="string"&&(a=a.trim()),r[e=I,e.replace(zT.kebab,TH)]=a)}return r}function Sr(){for(var t,e,r={},s=arguments.length;s--;)for(var g=0,T=Object.keys(arguments[s]);g<T.length;g++)switch(t=T[g]){case"class":case"style":case"directives":if(Array.isArray(r[t])||(r[t]=[]),t==="style"){var I=void 0;I=Array.isArray(arguments[s].style)?arguments[s].style:[arguments[s].style];for(var a=0;a<I.length;a++){var N=I[a];typeof N=="string"&&(I[a]=EH(N))}arguments[s].style=I}r[t]=r[t].concat(arguments[s][t]);break;case"staticClass":if(!arguments[s][t])break;r[t]===void 0&&(r[t]=""),r[t]&&(r[t]+=" "),r[t]+=arguments[s][t].trim();break;case"on":case"nativeOn":r[t]||(r[t]={});for(var H=0,K=Object.keys(arguments[s][t]||{});H<K.length;H++)e=K[H],r[t][e]?r[t][e]=[].concat(r[t][e],arguments[s][t][e]):r[t][e]=arguments[s][t][e];break;case"attrs":case"props":case"domProps":case"scopedSlots":case"staticStyle":case"hook":case"transition":r[t]||(r[t]={}),r[t]=uz({},arguments[s][t],r[t]);break;case"slot":case"key":case"ref":case"tag":case"show":case"keepAlive":default:r[t]||(r[t]=arguments[s][t])}return r}function JM(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function e_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JM(Object(r),!0).forEach(function(s){SH(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JM(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function SH(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OH(t,e){if(t==null)return{};var r=PH(t,e),s,g;if(Object.getOwnPropertySymbols){var T=Object.getOwnPropertySymbols(t);for(g=0;g<T.length;g++)s=T[g],!(e.indexOf(s)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,s)||(r[s]=t[s]))}return r}function PH(t,e){if(t==null)return{};var r={},s=Object.keys(t),g,T;for(T=0;T<s.length;T++)g=s[T],!(e.indexOf(g)>=0)&&(r[g]=t[g]);return r}function j0(t){return j0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j0(t)}var Oc="_uid",cs=An.version.startsWith("3"),NO=cs?"ref_for":"refInFor",AH=["class","staticClass","style","attrs","props","domProps","on","nativeOn","directives","scopedSlots","slot","key","ref","refInFor"],ot=An.extend.bind(An);if(cs){var CH=An.extend,MH=["router-link","transition"],IH=An.vModelDynamic.created,DH=An.vModelDynamic.beforeUpdate;An.vModelDynamic.created=function(t,e,r){IH.call(this,t,e,r),t._assign||(t._assign=function(){})},An.vModelDynamic.beforeUpdate=function(t,e,r){DH.call(this,t,e,r),t._assign||(t._assign=function(){})},ot=function(e){if(j0(e)==="object"&&e.render&&!e.__alreadyPatched){var r=e.render;e.__alreadyPatched=!0,e.render=function(s){var g=function(ue,Pe,xe){var Ie=xe===void 0?[]:[Array.isArray(xe)?xe.filter(Boolean):xe],dt=typeof ue=="string"&&!MH.includes(ue),Le=Pe&&j0(Pe)==="object"&&!Array.isArray(Pe);if(!Le)return s.apply(void 0,[ue,Pe].concat(Ie));var De=Pe.attrs,Ye=Pe.props,He=OH(Pe,["attrs","props"]),ht=e_(e_({},He),{},{attrs:De,props:dt?{}:Ye});return ue==="router-link"&&!ht.slots&&!ht.scopedSlots&&(ht.scopedSlots={$hasNormal:function(){}}),s.apply(void 0,[ue,ht].concat(Ie))};if(e.functional){var T,I,a=arguments[1],N=e_({},a);N.data={attrs:e_({},a.data.attrs||{}),props:e_({},a.data.props||{})},Object.keys(a.data||{}).forEach(function(ee){AH.includes(ee)?N.data[ee]=a.data[ee]:ee in a.props?N.data.props[ee]=a.data[ee]:ee.startsWith("on")||(N.data.attrs[ee]=a.data[ee])});var H=["_ctx"],K=((T=a.children)===null||T===void 0||(I=T.default)===null||I===void 0?void 0:I.call(T))||a.children;return K&&Object.keys(N.children).filter(function(ee){return!H.includes(ee)}).length===0?delete N.children:N.children=K,N.data.on=a.listeners,r.call(this,g,N)}return r.call(this,g)}}return CH.call(this,e)}.bind(An)}var $O=An.nextTick,cm=typeof window<"u",hz=typeof document<"u",dz=typeof navigator<"u",fz=typeof Promise<"u",RH=typeof MutationObserver<"u"||typeof WebKitMutationObserver<"u"||typeof MozMutationObserver<"u",Xi=cm&&hz&&dz,Ln=cm?window:{},um=hz?document:{},pz=dz?navigator:{},mz=(pz.userAgent||"").toLowerCase(),LH=mz.indexOf("jsdom")>0;/msie|trident/.test(mz);var BH=function(){var t=!1;if(Xi)try{var e={get passive(){t=!0}};Ln.addEventListener("test",e,e),Ln.removeEventListener("test",e,e)}catch{t=!1}return t}(),V0=Xi&&("ontouchstart"in um.documentElement||pz.maxTouchPoints>0),t_=Xi&&Boolean(Ln.PointerEvent||Ln.MSPointerEvent),QM=Xi&&"IntersectionObserver"in Ln&&"IntersectionObserverEntry"in Ln&&"intersectionRatio"in Ln.IntersectionObserverEntry.prototype,kH="BvConfig",Pp="$bvConfig",zH=["xs","sm","md","lg","xl"],FH=/\[(\d+)]/g,NH=/^(BV?)/,gz=/^\d+$/,$H=/^\..+/,jH=/^#/,VH=/^#[A-Za-z]+[\w\-:.]*$/,UH=/(<([^>]+)>)/gi,GH=/\B([A-Z])/g,HH=/([a-z])([A-Z])/g,qH=/^[0-9]*\.?[0-9]+$/,WH=/\+/g,ZH=/[-/\\^$*+?.()|[\]{}]/g,_z=/[\s\uFEFF\xA0]+/g,l0=/\s+/,XH=/\/\*$/,KH=/(\s|^)(\w)/g,YH=/^\s+/,JH=/_/g,QH=/-(\w)/g,eq=/^\d+-\d\d?-\d\d?(?:\s|T|$)/,tq=/-|\s|T/,rq=/^([0-1]?[0-9]|2[0-3]):[0-5]?[0-9](:[0-5]?[0-9])?$/,eI=/^.*(#[^#]+)$/,iq=/%2C/g,nq=/[!'()*]/g,oq=/^(\?|#|&)/,sq=/^\d+(\.\d*)?[/:]\d+(\.\d*)?$/,aq=/[/:]/,lq=/^col-/,cq=/^BIcon/,uq=/-u-.+/;function nS(t){return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nS(t)}function Zx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xx(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&ny(t,e)}function Kx(t){var e=yz();return function(){var s=oy(t),g;if(e){var T=oy(this).constructor;g=Reflect.construct(s,arguments,T)}else g=s.apply(this,arguments);return hq(this,g)}}function hq(t,e){if(e&&(nS(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dq(t)}function dq(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function U0(t){var e=typeof Map=="function"?new Map:void 0;return U0=function(s){if(s===null||!fq(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(s))return e.get(s);e.set(s,g)}function g(){return c0(s,arguments,oy(this).constructor)}return g.prototype=Object.create(s.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),ny(g,s)},U0(t)}function c0(t,e,r){return yz()?c0=Reflect.construct:c0=function(g,T,I){var a=[null];a.push.apply(a,T);var N=Function.bind.apply(g,a),H=new N;return I&&ny(H,I.prototype),H},c0.apply(null,arguments)}function yz(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fq(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function ny(t,e){return ny=Object.setPrototypeOf||function(s,g){return s.__proto__=g,s},ny(t,e)}function oy(t){return oy=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},oy(t)}var jO=cm?Ln.Element:function(t){Xx(r,t);var e=Kx(r);function r(){return Zx(this,r),e.apply(this,arguments)}return r}(U0(Object)),Yu=cm?Ln.HTMLElement:function(t){Xx(r,t);var e=Kx(r);function r(){return Zx(this,r),e.apply(this,arguments)}return r}(jO),vz=cm?Ln.SVGElement:function(t){Xx(r,t);var e=Kx(r);function r(){return Zx(this,r),e.apply(this,arguments)}return r}(jO),bz=cm?Ln.File:function(t){Xx(r,t);var e=Kx(r);function r(){return Zx(this,r),e.apply(this,arguments)}return r}(U0(Object));function G0(t){return G0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G0(t)}var Yx=function(e){return G0(e)},pq=function(e){return Object.prototype.toString.call(e).slice(8,-1)},Fn=function(e){return e===void 0},fn=function(e){return e===null},ji=function(e){return Fn(e)||fn(e)},Mr=function(e){return Yx(e)==="function"},Da=function(e){return Yx(e)==="boolean"},_i=function(e){return Yx(e)==="string"},rl=function(e){return Yx(e)==="number"},F_=function(e){return qH.test(String(e))},Ni=function(e){return Array.isArray(e)},kn=function(e){return e!==null&&G0(e)==="object"},Go=function(e){return Object.prototype.toString.call(e)==="[object Object]"},Xp=function(e){return e instanceof Date},kd=function(e){return e instanceof Event},mq=function(e){return e instanceof bz},tI=function(e){return pq(e)==="RegExp"},gq=function(e){return!ji(e)&&Mr(e.then)&&Mr(e.catch)};function rI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function zd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rI(Object(r),!0).forEach(function(s){Sy(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Sy(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Oy=function(){return Object.assign.apply(Object,arguments)},qu=function(e,r){return Object.create(e,r)},Jx=function(e,r){return Object.defineProperties(e,r)},VO=function(e,r,s){return Object.defineProperty(e,r,s)},iI=function(e){return Object.getOwnPropertyNames(e)},Gr=function(e){return Object.keys(e)},Fd=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},_q=function(e){return Object.prototype.toString.call(e)},hh=function(e){return zd({},e)},sl=function(e,r){return Gr(e).filter(function(s){return r.indexOf(s)!==-1}).reduce(function(s,g){return zd(zd({},s),{},Sy({},g,e[g]))},{})},oi=function(e,r){return Gr(e).filter(function(s){return r.indexOf(s)===-1}).reduce(function(s,g){return zd(zd({},s),{},Sy({},g,e[g]))},{})},yq=function t(e,r){return kn(e)&&kn(r)&&Gr(r).forEach(function(s){kn(r[s])?((!e[s]||!kn(e[s]))&&(e[s]=r[s]),t(e[s],r[s])):Oy(e,Sy({},s,r[s]))}),e},vr=function(e){return Gr(e).sort().reduce(function(r,s){return zd(zd({},r),{},Sy({},s,e[s]))},{})},Ia=function(){return{enumerable:!0,configurable:!1,writable:!1}};function nI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function oI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nI(Object(r),!0).forEach(function(s){xz(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function xz(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vq(t){return Tq(t)||wq(t)||xq(t)||bq()}function bq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xq(t,e){if(!!t){if(typeof t=="string")return oS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oS(t,e)}}function wq(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Tq(t){if(Array.isArray(t))return oS(t)}function oS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}var Ra=function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;return Ni(e)?e.reduce(function(s,g){return[].concat(vq(s),[t(g,g)])},[]):Go(e)?Gr(e).reduce(function(s,g){return oI(oI({},s),{},xz({},g,t(e[g],e[g])))},{}):r},$r=function(e){return e},wz=function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(r=Ni(r)?r.join("."):r,!r||!kn(e))return s;if(r in e)return e[r];r=String(r).replace(FH,".$1");var g=r.split(".").filter($r);return g.length===0?s:g.every(function(T){return kn(e)&&T in e&&!ji(e=e[T])})?e:fn(e)?null:s},Io=function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,g=wz(e,r);return ji(g)?s:g},sI=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=typeof process<"u"&&process?process.env||{}:{};return e?s[e]||r:s},Eq=function(){return sI("BOOTSTRAP_VUE_NO_WARN")||sI("NODE_ENV")==="production"},ao=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Eq()||console.warn("[BootstrapVue warn]: ".concat(r?"".concat(r," - "):"").concat(e))},H0=function(e){return Xi?!1:(ao("".concat(e,": Can not be called during SSR.")),!0)},aI=function(e){return fz?!1:(ao("".concat(e,": Requires Promise support.")),!0)},Sq=function(e){return RH?!1:(ao("".concat(e,": Requires MutationObserver support.")),!0)};function Oq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lI(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Pq(t,e,r){return e&&lI(t.prototype,e),r&&lI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Aq=function(){function t(){Oq(this,t),this.$_config={}}return Pq(t,[{key:"setConfig",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!!Go(s)){var g=iI(s);g.forEach(function(T){var I=s[T];T==="breakpoints"?!Ni(I)||I.length<2||I.some(function(a){return!_i(a)||a.length===0})?ao('"breakpoints" must be an array of at least 2 breakpoint names',kH):r.$_config[T]=Ra(I):Go(I)&&(r.$_config[T]=iI(I).reduce(function(a,N){return Fn(I[N])||(a[N]=Ra(I[N])),a},r.$_config[T]||{}))})}}},{key:"resetConfig",value:function(){this.$_config={}}},{key:"getConfig",value:function(){return Ra(this.$_config)}},{key:"getConfigValue",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;return Ra(wz(this.$_config,r,s))}}]),t}(),Cq=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:An;r.prototype[Pp]=An.prototype[Pp]=r.prototype[Pp]||An.prototype[Pp]||new Aq,r.prototype[Pp].setConfig(e)};function cI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function uI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cI(Object(r),!0).forEach(function(s){Mq(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Mq(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Iq=function(){var t=!1,e=["Multiple instances of Vue detected!","You may need to set up an alias for Vue in your bundler config.","See: https://bootstrap-vue.org/docs#using-module-bundlers"].join(`
`);return function(r){!t&&An!==r&&!LH&&ao(e),t=!0}}(),Tz=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.components,s=e.directives,g=e.plugins,T=function I(a){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};I.installed||(I.installed=!0,Iq(a),Cq(N,a),Lq(a,r),kq(a,s),Dq(a,g))};return T.installed=!1,T},wr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return uI(uI({},r),{},{install:Tz(e)})},Dq=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(var s in r)s&&r[s]&&e.use(r[s])},Rq=function(e,r,s){e&&r&&s&&e.component(r,s)},Lq=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(var s in r)Rq(e,s,r[s])},Bq=function(e,r,s){e&&r&&s&&e.directive(r.replace(/^VB/,"B"),s)},kq=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(var s in r)Bq(e,s,r[s])},Ez="BAlert",Sz="BAspect",Oz="BAvatar",Pz="BAvatarGroup",Az="BBadge",Cz="BBreadcrumb",Mz="BBreadcrumbItem",Iz="BBreadcrumbLink",Dz="BButton",Rz="BButtonClose",Lz="BButtonGroup",Bz="BButtonToolbar",kz="BCalendar",UO="BCard",zz="BCardBody",Fz="BCardFooter",Nz="BCardGroup",$z="BCardHeader",jz="BCardImg",Vz="BCardImgLazy",Uz="BCardSubTitle",Gz="BCardText",Hz="BCardTitle",qz="BCarousel",Wz="BCarouselSlide",Zz="BCol",Ro="BCollapse",Xz="BContainer",Nd="BDropdown",Kz="BDropdownDivider",Yz="BDropdownForm",Jz="BDropdownGroup",Qz="BDropdownHeader",eF="BDropdownItem",tF="BDropdownItemButton",rF="BDropdownText",iF="BEmbed",nF="BForm",oF="BFormCheckbox",sF="BFormCheckboxGroup",aF="BFormDatalist",lF="BFormDatepicker",GO="BFormFile",cF="BFormGroup",uF="BFormInput",hF="BFormInvalidFeedback",dF="BFormRadio",fF="BFormRadioGroup",pF="BFormRating",mF="BFormRow",gF="BFormSelect",_F="BFormSelectOption",yF="BFormSelectOptionGroup",vF="BFormSpinbutton",bF="BFormTag",xF="BFormTags",wF="BFormText",TF="BFormTextarea",EF="BFormTimepicker",SF="BFormValidFeedback",OF="BIcon",zq="BIconBase",PF="BImg",AF="BImgLazy",CF="BInputGroup",MF="BInputGroupAddon",IF="BInputGroupAppend",DF="BInputGroupPrepend",RF="BInputGroupText",LF="BJumbotron",HO="BLink",BF="BListGroup",kF="BListGroupItem",zF="BMedia",FF="BMediaAside",NF="BMediaBody",Es="BModal",Fq="BMsgBox",$F="BNav",jF="BNavbar",VF="BNavbarBrand",UF="BNavbarNav",GF="BNavbarToggle",HF="BNavForm",qF="BNavItem",WF="BNavItemDropdown",Nq="BNavText",ZF="BOverlay",Qx="BPagination",sS="BPaginationNav",vd="BPopover",XF="BProgress",KF="BProgressBar",YF="BRow",JF="BSidebar",QF="BSkeleton",eN="BSkeletonIcon",tN="BSkeletonImg",rN="BSkeletonTable",iN="BSkeletonWrapper",nN="BSpinner",oN="BTab",$d="BTable",sN="BTableCell",aN="BTableLite",lN="BTableSimple",cN="BTabs",uN="BTbody",hN="BTfoot",dN="BTh",fN="BThead",pN="BTime",Tc="BToast",Vp="BToaster",bd="BTooltip",mN="BTr",$q="BVCollapse",jq="BVFormBtnLabelControl",Vq="BVFormRatingStar",Uq="BVPopover",Gq="BVPopoverTemplate",Hq="BVPopper",qq="BVTabButton",Wq="BVToastPop",Zq="BVTooltip",Xq="BVTooltipTemplate",Kq="BVTransition",gN="BVTransporter",Yq="BVTransporterTarget",Jq="activate-tab",_N="blur",Qq="cancel",Bs="change",e7="changed",Ba="click",aS="close",Kp="context",yN="context-changed",qO="destroyed",lS="disable",u0="disabled",t7="dismissed",r7="dismiss-count-down",cS="enable",h0="enabled",uS="filtered",vN="first",i7="focus",q0="focusin",W0="focusout",N_="head-clicked",zn="hidden",Cs="hide",n7="img-error",bN="input",xN="last",wN="mouseenter",TN="mouseleave",EN="next",o7="ok",hI="open",SN="page-click",s7="paused",ON="prev",a7="refresh",x_="refreshed",l7="remove",Z0="row-clicked",c7="row-contextmenu",u7="row-dblclicked",h7="row-hovered",d7="row-middle-clicked",f7="row-selected",p7="row-unhovered",PN="selected",yo="show",os="shown",FT="sliding-end",m7="sliding-start",g7="sort-changed",_7="tag-state",AN="toggle",y7="unpaused",v7="update",CN=cs?"vnodeBeforeUnmount":"hook:beforeDestroy",sy=cs?"vNodeUnmounted":"hook:destroyed",dh="update:",MN="bv",IN="::",Os={passive:!0},gi={passive:!0,capture:!1},Yp=void 0,ss=Array,Ee=Boolean,b7=Date,ls=Function,Uo=Number,Zn=Object,x7=RegExp,ie=String,DN=[ss,ls],w7=[ss,Zn],Nr=[ss,Zn,ie],Ho=[ss,ie],T7=[Ee,Uo],ay=[Ee,Uo,ie],qo=[Ee,ie],Id=[b7,ie],E7=[ls,ie],dr=[Uo,ie],S7=[Uo,Zn,ie],O7=[Zn,ls],RN=[Zn,ie],P7="add-button-text",dI="append",A7="aside",fI="badge",pI="bottom-row",Ic="button-content",mI="custom-foot",C7="decrement",eo="default",M7="description",I7="dismiss",D7="drop-placeholder",R7="ellipsis-text",LN="empty",L7="emptyfiltered",gI="file-name",WO="first",B7="first-text",hS="footer",sh="header",k7="header-close",z7="icon-clear",F7="icon-empty",N7="icon-full",$7="icon-half",j7="img",V7="increment",U7="invalid-feedback",BN="label",G7="last-text",_I="lead",H7="loading",q7="modal-backdrop",yI="modal-cancel",W7="modal-footer",Z7="modal-header",X7="modal-header-close",vI="modal-ok",NT="modal-title",K7="nav-next-decade",Y7="nav-next-month",J7="nav-next-year",Q7="nav-prev-decade",eW="nav-prev-month",tW="nav-prev-year",rW="nav-this-month",iW="next-text",nW="overlay",oW="page",sW="placeholder",bI="prepend",aW="prev-text",r_="row-details",w_="table-busy",xI="table-caption",wI="table-colgroup",lW="tabs-end",cW="tabs-start",uW="text",hW="thead-top",Py="title",dW="toast-title",TI="top-row",fW="valid-feedback",jd=function(){return Array.from.apply(Array,arguments)},Vr=function(e,r){return e.indexOf(r)!==-1},bi=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return Array.prototype.concat.apply([],r)},$_=function(e,r){var s=Mr(r)?r:function(){return r};return Array.apply(null,{length:e}).map(s)},pW=function(e){return e.reduce(function(r,s){return bi(r,s)},[])},i_=function t(e){return e.reduce(function(r,s){return bi(r,Array.isArray(s)?t(s):s)},[])},Dc=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=bi(e).filter($r),e.some(function(g){return r[g]||s[g]})},vo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};e=bi(e).filter($r);for(var T,I=0;I<e.length&&!T;I++){var a=e[I];T=s[a]||g[a]}return Mr(T)?T(r):T},Ur=ot({methods:{hasNormalizedSlot:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eo,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.$scopedSlots,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.$slots;return Dc(e,r,s)},normalizeSlot:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eo,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.$scopedSlots,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this.$slots,T=vo(e,r,s,g);return T&&bi(T)}}}),or=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN,s=parseInt(e,10);return isNaN(s)?r:s},hi=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN,s=parseFloat(e);return isNaN(s)?r:s},$T=function(e,r){return hi(e).toFixed(or(r,0))},ZO=function(e){return e.replace(GH,"-$1").toLowerCase()},kN=function(e){return e=ZO(e).replace(QH,function(r,s){return s?s.toUpperCase():""}),e.charAt(0).toUpperCase()+e.slice(1)},d0=function(e){return e.replace(JH," ").replace(HH,function(r,s,g){return s+" "+g}).replace(KH,function(r,s,g){return s+g.toUpperCase()})},mW=function(e){return e=_i(e)?e.trim():String(e),e.charAt(0).toLowerCase()+e.slice(1)},zN=function(e){return e=_i(e)?e.trim():String(e),e.charAt(0).toUpperCase()+e.slice(1)},XO=function(e){return e.replace(ZH,"\\$&")},Lr=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return ji(e)?"":Ni(e)||Go(e)&&e.toString===Object.prototype.toString?JSON.stringify(e,null,r):String(e)},gW=function(e){return Lr(e).replace(YH,"")},Ju=function(e){return Lr(e).trim()},X0=function(e){return Lr(e).toLowerCase()},f0=jO.prototype,_W=["button","[href]:not(.disabled)","input","select","textarea","[tabindex]","[contenteditable]"].map(function(t){return"".concat(t,":not(:disabled):not([disabled])")}).join(", "),yW=f0.matches||f0.msMatchesSelector||f0.webkitMatchesSelector,vW=f0.closest||function(t){var e=this;do{if(Pc(e,t))return e;e=e.parentElement||e.parentNode}while(!fn(e)&&e.nodeType===Node.ELEMENT_NODE);return null},Vi=(Ln.requestAnimationFrame||Ln.webkitRequestAnimationFrame||Ln.mozRequestAnimationFrame||Ln.msRequestAnimationFrame||Ln.oRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(Ln),bW=Ln.MutationObserver||Ln.WebKitMutationObserver||Ln.MozMutationObserver||null,xW=function(e){return e&&e.parentNode&&e.parentNode.removeChild(e)},an=function(e){return!!(e&&e.nodeType===Node.ELEMENT_NODE)},ah=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=um.activeElement;return r&&!e.some(function(s){return s===r})?r:null},Wl=function(e,r){return Lr(e).toLowerCase()===Lr(r).toLowerCase()},KO=function(e){return an(e)&&e===ah()},il=function(e){if(!an(e)||!e.parentNode||!qn(um.body,e)||Mp(e,"display")==="none")return!1;var r=Vd(e);return!!(r&&r.height>0&&r.width>0)},Td=function(e){return!an(e)||e.disabled||$l(e,"disabled")||ly(e,"disabled")},YO=function(e){return an(e)&&e.offsetHeight},ca=function(e,r){return jd((an(r)?r:um).querySelectorAll(e))},sa=function(e,r){return(an(r)?r:um).querySelector(e)||null},Pc=function(e,r){return an(e)?yW.call(e,r):!1},Ms=function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!an(r))return null;var g=vW.call(r,e);return s?g:g===r?null:g},qn=function(e,r){return e&&Mr(e.contains)?e.contains(r):!1},dS=function(e){return um.getElementById(/^#/.test(e)?e.slice(1):e)||null},ns=function(e,r){r&&an(e)&&e.classList&&e.classList.add(r)},jo=function(e,r){r&&an(e)&&e.classList&&e.classList.remove(r)},ly=function(e,r){return r&&an(e)&&e.classList?e.classList.contains(r):!1},yn=function(e,r,s){r&&an(e)&&e.setAttribute(r,s)},Nl=function(e,r){r&&an(e)&&e.removeAttribute(r)},aa=function(e,r){return r&&an(e)?e.getAttribute(r):null},$l=function(e,r){return r&&an(e)?e.hasAttribute(r):null},Co=function(e,r,s){r&&an(e)&&(e.style[r]=s)},e1=function(e,r){r&&an(e)&&(e.style[r]="")},Mp=function(e,r){return r&&an(e)&&e.style[r]||null},Vd=function(e){return an(e)?e.getBoundingClientRect():null},ia=function(e){var r=Ln.getComputedStyle;return r&&an(e)?r(e):{}},wW=function(){var e=Ln.getSelection;return e?Ln.getSelection():null},fS=function(e){var r={top:0,left:0};if(!an(e)||e.getClientRects().length===0)return r;var s=Vd(e);if(s){var g=e.ownerDocument.defaultView;r.top=s.top+g.pageYOffset,r.left=s.left+g.pageXOffset}return r},TW=function(e){var r={top:0,left:0};if(!an(e))return r;var s={top:0,left:0},g=ia(e);if(g.position==="fixed")r=Vd(e)||r;else{r=fS(e);for(var T=e.ownerDocument,I=e.offsetParent||T.documentElement;I&&(I===T.body||I===T.documentElement)&&ia(I).position==="static";)I=I.parentNode;if(I&&I!==e&&I.nodeType===Node.ELEMENT_NODE){s=fS(I);var a=ia(I);s.top+=hi(a.borderTopWidth,0),s.left+=hi(a.borderLeftWidth,0)}}return{top:r.top-s.top-hi(g.marginTop,0),left:r.left-s.left-hi(g.marginLeft,0)}},pS=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ca(_W,e).filter(il).filter(function(r){return r.tabIndex>-1&&!r.disabled})},ii=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};try{e.focus(r)}catch{}return KO(e)},zs=function(e){try{e.blur()}catch{}return!KO(e)},Ay=function(e){var r=qu(null);return function(){for(var s=arguments.length,g=new Array(s),T=0;T<s;T++)g[T]=arguments[T];var I=JSON.stringify(g);return r[I]=r[I]||e.apply(null,g)}},EW=An.prototype,mS=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=EW[Pp];return s?s.getConfigValue(e,r):Ra(r)},na=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return r?mS("".concat(e,".").concat(r),s):mS(e,{})},FN=function(){return mS("breakpoints",zH)},SW=Ay(function(){return FN()}),OW=function(){return Ra(SW())},cy=Ay(function(){var t=OW();return t[0]="",t});function EI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Dd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EI(Object(r),!0).forEach(function(s){NN(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function NN(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var t1=function(e,r){return e+zN(r)},$N=function(e,r){return mW(r.replace(e,""))},Qu=function(e,r){return r+(e?zN(e):"")},k=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yp,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:void 0,T=s===!0;return g=T?g:s,Dd(Dd(Dd({},e?{type:e}:{}),T?{required:T}:Fn(r)?{}:{default:kn(r)?function(){return r}:r}),Fn(g)?{}:{validator:g})},r1=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$r;if(Ni(e))return e.map(r);var s={};for(var g in e)Fd(e,g)&&(s[r(g)]=kn(e[g])?hh(e[g]):e[g]);return s},mn=function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$r;return(Ni(e)?e.slice():Gr(e)).reduce(function(g,T){return g[s(T)]=r[T],g},{})},jN=function(e,r,s){return Dd(Dd({},Ra(e)),{},{default:function(){var T=na(s,r,e.default);return Mr(T)?T():T}})},Ct=function(e,r){return Gr(e).reduce(function(s,g){return Dd(Dd({},s),{},NN({},g,jN(e[g],g,r)))},{})},PW=jN({},"","").default.name,Gl=function(e){return Mr(e)&&e.name&&e.name!==PW};function AW(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Xn=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.type,g=s===void 0?Yp:s,T=r.defaultValue,I=T===void 0?void 0:T,a=r.validator,N=a===void 0?void 0:a,H=r.event,K=H===void 0?bN:H,ee=AW({},e,k(g,I,N)),ue=ot({model:{prop:e,event:K},props:ee});return{mixin:ue,props:ee,prop:e,event:K}},VN=function(e){return BH?kn(e)?e:{capture:!!e||!1}:!!(kn(e)?e.capture:e)},pn=function(e,r,s,g){e&&e.addEventListener&&e.addEventListener(r,s,VN(g))},Tn=function(e,r,s,g){e&&e.removeEventListener&&e.removeEventListener(r,s,VN(g))},nl=function(e){for(var r=e?pn:Tn,s=arguments.length,g=new Array(s>1?s-1:0),T=1;T<s;T++)g[T-1]=arguments[T];r.apply(void 0,g)},ei=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.preventDefault,g=s===void 0?!0:s,T=r.propagation,I=T===void 0?!0:T,a=r.immediatePropagation,N=a===void 0?!1:a;g&&e.preventDefault(),I&&e.stopPropagation(),N&&e.stopImmediatePropagation()},UN=function(e){return ZO(e.replace(NH,""))},Cn=function(e,r){return[MN,UN(e),r].join(IN)},Wn=function(e,r){return[MN,r,UN(e)].join(IN)};function CW(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var MW=Ct({ariaLabel:k(ie,"Close"),content:k(ie,"&times;"),disabled:k(Ee,!1),textVariant:k(ie)},Rz),Ud=ot({name:Rz,functional:!0,props:MW,render:function(e,r){var s=r.props,g=r.data,T=r.slots,I=r.scopedSlots,a=T(),N=I||{},H={staticClass:"close",class:CW({},"text-".concat(s.textVariant),s.textVariant),attrs:{type:"button",disabled:s.disabled,"aria-label":s.ariaLabel?String(s.ariaLabel):null},on:{click:function(ee){s.disabled&&kd(ee)&&ei(ee)}}};return Dc(eo,N,a)||(H.domProps={innerHTML:s.content}),e("button",Sr(g,H),vo(eo,{},N,a))}});function SI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function xd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SI(Object(r),!0).forEach(function(s){IW(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function IW(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var GN={name:"",enterClass:"",enterActiveClass:"",enterToClass:"show",leaveClass:"show",leaveActiveClass:"",leaveToClass:""},DW=xd(xd({},GN),{},{enterActiveClass:"fade",leaveActiveClass:"fade"}),RW={appear:k(Ee,!1),mode:k(ie),noFade:k(Ee,!1),transProps:k(Zn)},Zd=ot({name:Kq,functional:!0,props:RW,render:function(e,r){var s=r.children,g=r.data,T=r.props,I=T.transProps;Go(I)||(I=T.noFade?GN:DW,T.appear&&(I=xd(xd({},I),{},{appear:!0,appearClass:I.enterClass,appearActiveClass:I.enterActiveClass,appearToClass:I.enterToClass}))),I=xd(xd({mode:T.mode},I),{},{css:!0});var a=xd({},g);return delete a.props,e("transition",Sr(a,{props:I}),s)}}),n_;function OI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function PI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OI(Object(r),!0).forEach(function(s){T_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function T_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var i1=Xn("show",{type:ay,defaultValue:!1}),LW=i1.mixin,BW=i1.props,o_=i1.prop,AI=i1.event,CI=function(e){return e===""||Da(e)?0:(e=or(e,0),e>0?e:0)},jT=function(e){return e===""||e===!0?!0:or(e,0)<1?!1:!!e},kW=Ct(vr(PI(PI({},BW),{},{dismissLabel:k(ie,"Close"),dismissible:k(Ee,!1),fade:k(Ee,!1),variant:k(ie,"info")})),Ez),zW=ot({name:Ez,mixins:[LW,Ur],props:kW,data:function(){return{countDown:0,localShow:jT(this[o_])}},watch:(n_={},T_(n_,o_,function(t){this.countDown=CI(t),this.localShow=jT(t)}),T_(n_,"countDown",function(e){var r=this;this.clearCountDownInterval();var s=this[o_];F_(s)&&(this.$emit(r7,e),s!==e&&this.$emit(AI,e),e>0?(this.localShow=!0,this.$_countDownTimeout=setTimeout(function(){r.countDown--},1e3)):this.$nextTick(function(){Vi(function(){r.localShow=!1})}))}),T_(n_,"localShow",function(e){var r=this[o_];!e&&(this.dismissible||F_(r))&&this.$emit(t7),!F_(r)&&r!==e&&this.$emit(AI,e)}),n_),created:function(){this.$_filterTimer=null;var e=this[o_];this.countDown=CI(e),this.localShow=jT(e)},beforeDestroy:function(){this.clearCountDownInterval()},methods:{dismiss:function(){this.clearCountDownInterval(),this.countDown=0,this.localShow=!1},clearCountDownInterval:function(){clearTimeout(this.$_countDownTimeout),this.$_countDownTimeout=null}},render:function(e){var r=e();if(this.localShow){var s=this.dismissible,g=this.variant,T=e();s&&(T=e(Ud,{attrs:{"aria-label":this.dismissLabel},on:{click:this.dismiss}},[this.normalizeSlot(I7)])),r=e("div",{staticClass:"alert",class:T_({"alert-dismissible":s},"alert-".concat(g),g),attrs:{role:"alert","aria-live":"polite","aria-atomic":!0},key:this[Oc]},[T,this.normalizeSlot()])}return e(Zd,{props:{noFade:!this.fade}},[r])}}),FW=wr({components:{BAlert:zW}}),Ec=Math.min,Li=Math.max,HN=Math.abs,qN=Math.ceil,uy=Math.floor,WN=Math.pow,gS=Math.round;function NW(t,e){return UW(t)||VW(t,e)||jW(t,e)||$W()}function $W(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jW(t,e){if(!!t){if(typeof t=="string")return MI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MI(t,e)}}function MI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function VW(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s=[],g=!0,T=!1,I,a;try{for(r=r.call(t);!(g=(I=r.next()).done)&&(s.push(I.value),!(e&&s.length===e));g=!0);}catch(N){T=!0,a=N}finally{try{!g&&r.return!=null&&r.return()}finally{if(T)throw a}}return s}}function UW(t){if(Array.isArray(t))return t}var VT="b-aspect",GW=Ct({aspect:k(dr,"1:1"),tag:k(ie,"div")},Sz),ZN=ot({name:Sz,mixins:[Ur],props:GW,computed:{padding:function(){var e=this.aspect,r=1;if(sq.test(e)){var s=e.split(aq).map(function(a){return hi(a)||1}),g=NW(s,2),T=g[0],I=g[1];r=T/I}else r=hi(e)||1;return"".concat(100/HN(r),"%")}},render:function(e){var r=e("div",{staticClass:"".concat(VT,"-sizer flex-grow-1"),style:{paddingBottom:this.padding,height:0}}),s=e("div",{staticClass:"".concat(VT,"-content flex-grow-1 w-100 mw-100"),style:{marginLeft:"-100%"}},this.normalizeSlot());return e(this.tag,{staticClass:"".concat(VT," d-flex")},[r,s])}}),HW=wr({components:{BAspect:ZN}});function Bn(t){return cs?new Proxy(t,{get:function(r,s){return s in r?r[s]:void 0}}):t}var XN="a",qW=function(e){return"%"+e.charCodeAt(0).toString(16)},pp=function(e){return encodeURIComponent(Lr(e)).replace(nq,qW).replace(iq,",")},II=decodeURIComponent,WW=function(e){if(!Go(e))return"";var r=Gr(e).map(function(s){var g=e[s];return Fn(g)?"":fn(g)?pp(s):Ni(g)?g.reduce(function(T,I){return fn(I)?T.push(pp(s)):Fn(I)||T.push(pp(s)+"="+pp(I)),T},[]).join("&"):pp(s)+"="+pp(g)}).filter(function(s){return s.length>0}).join("&");return r?"?".concat(r):""},DI=function(e){var r={};return e=Lr(e).trim().replace(oq,""),e&&e.split("&").forEach(function(s){var g=s.replace(WH," ").split("="),T=II(g.shift()),I=g.length>0?II(g.join("=")):null;Fn(r[T])?r[T]=I:Ni(r[T])?r[T].push(I):r[T]=[r[T],I]}),r},Cy=function(e){return!!(e.href||e.to)},KN=function(e){return!!(e&&!Wl(e,"a"))},ZW=function(e,r){var s=e.to,g=e.disabled,T=e.routerComponentName,I=!!Bn(r).$router,a=!!Bn(r).$nuxt;return!I||I&&(g||!s)?XN:T||(a?"nuxt-link":"router-link")},XW=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.target,s=e.rel;return r==="_blank"&&fn(s)?"noopener":s||null},YN=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.href,s=e.to,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XN,T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"#",I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"/";if(r)return r;if(KN(g))return null;if(_i(s))return s||I;if(Go(s)&&(s.path||s.query||s.hash)){var a=Lr(s.path),N=WW(s.query),H=Lr(s.hash);return H=!H||H.charAt(0)==="#"?H:"#".concat(H),"".concat(a).concat(N).concat(H)||I}return T};function RI(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var KW={viewBox:"0 0 16 16",width:"1em",height:"1em",focusable:"false",role:"img","aria-label":"icon"},YW={width:null,height:null,focusable:null,role:null,"aria-label":null},JO={animation:k(ie),content:k(ie),flipH:k(Ee,!1),flipV:k(Ee,!1),fontScale:k(dr,1),rotate:k(dr,0),scale:k(dr,1),shiftH:k(dr,0),shiftV:k(dr,0),stacked:k(Ee,!1),title:k(ie),variant:k(ie)},JW=ot({name:zq,functional:!0,props:JO,render:function(e,r){var s,g=r.data,T=r.props,I=r.children,a=T.animation,N=T.content,H=T.flipH,K=T.flipV,ee=T.stacked,ue=T.title,Pe=T.variant,xe=Li(hi(T.fontScale,1),0)||1,Ie=Li(hi(T.scale,1),0)||1,dt=hi(T.rotate,0),Le=hi(T.shiftH,0),De=hi(T.shiftV,0),Ye=H||K||Ie!==1,He=Ye||dt,ht=Le||De,St=!ji(N),st=[He?"translate(8 8)":null,Ye?"scale(".concat((H?-1:1)*Ie," ").concat((K?-1:1)*Ie,")"):null,dt?"rotate(".concat(dt,")"):null,He?"translate(-8 -8)":null].filter($r),gt=e("g",{attrs:{transform:st.join(" ")||null},domProps:St?{innerHTML:N||""}:{}},I);ht&&(gt=e("g",{attrs:{transform:"translate(".concat(16*Le/16," ").concat(-16*De/16,")")}},[gt])),ee&&(gt=e("g",[gt]));var Tt=ue?e("title",ue):null,at=[Tt,gt].filter($r);return e("svg",Sr({staticClass:"b-icon bi",class:(s={},RI(s,"text-".concat(Pe),Pe),RI(s,"b-icon-animation-".concat(a),a),s),attrs:KW,style:ee?{}:{fontSize:xe===1?null:"".concat(xe*100,"%")}},g,ee?{attrs:YW}:{},{attrs:{xmlns:ee?null:"http://www.w3.org/2000/svg",fill:"currentColor"}}),at)}});function LI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function BI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LI(Object(r),!0).forEach(function(s){QW(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function QW(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var eZ=oi(JO,["content"]),bo=function(e,r){var s=ZO(e),g="BIcon".concat(kN(e)),T="bi-".concat(s),I=s.replace(/-/g," "),a=Ju(r||"");return ot({name:g,functional:!0,props:eZ,render:function(H,K){var ee=K.data,ue=K.props;return H(JW,Sr({props:{title:I},attrs:{"aria-label":I}},ee,{staticClass:T,props:BI(BI({},ue),{},{content:a})}))}})},kI=bo("Blank",""),tZ=bo("Calendar",'<path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>'),rZ=bo("CalendarFill",'<path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5h16V4H0V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5z"/>'),zI=bo("ChevronBarLeft",'<path fill-rule="evenodd" d="M11.854 3.646a.5.5 0 0 1 0 .708L8.207 8l3.647 3.646a.5.5 0 0 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 0 1 .708 0zM4.5 1a.5.5 0 0 0-.5.5v13a.5.5 0 0 0 1 0v-13a.5.5 0 0 0-.5-.5z"/>'),FI=bo("ChevronDoubleLeft",'<path fill-rule="evenodd" d="M8.354 1.646a.5.5 0 0 1 0 .708L2.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/><path fill-rule="evenodd" d="M12.354 1.646a.5.5 0 0 1 0 .708L6.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>'),iZ=bo("ChevronDown",'<path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>'),NI=bo("ChevronLeft",'<path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>'),$I=bo("ChevronUp",'<path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>'),_S=bo("CircleFill",'<circle cx="8" cy="8" r="8"/>'),nZ=bo("Clock",'<path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>'),oZ=bo("ClockFill",'<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>'),sZ=bo("Dash",'<path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/>'),aZ=bo("PersonFill",'<path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>'),lZ=bo("Plus",'<path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>'),cZ=bo("Star",'<path d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"/>'),uZ=bo("StarFill",'<path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>'),hZ=bo("StarHalf",'<path d="M5.354 5.119 7.538.792A.516.516 0 0 1 8 .5c.183 0 .366.097.465.292l2.184 4.327 4.898.696A.537.537 0 0 1 16 6.32a.548.548 0 0 1-.17.445l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256a.52.52 0 0 1-.146.05c-.342.06-.668-.254-.6-.642l.83-4.73L.173 6.765a.55.55 0 0 1-.172-.403.58.58 0 0 1 .085-.302.513.513 0 0 1 .37-.245l4.898-.696zM8 12.027a.5.5 0 0 1 .232.056l3.686 1.894-.694-3.957a.565.565 0 0 1 .162-.505l2.907-2.77-4.052-.576a.525.525 0 0 1-.393-.288L8.001 2.223 8 2.226v9.8z"/>'),JN=bo("X",'<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>');function jI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function VI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jI(Object(r),!0).forEach(function(s){dZ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function dZ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var fZ=function t(e,r){if(!e)return An.component(r);var s=(e.$options||{}).components,g=s&&s[r];return g||t(e.$parent,r)},QN=oi(JO,["content"]),pZ=Ct(vr(VI(VI({},QN),{},{icon:k(ie)})),OF),K0=ot({name:OF,functional:!0,props:pZ,render:function(e,r){var s=r.data,g=r.props,T=r.parent,I=kN(Ju(g.icon||"")).replace(cq,"");return e(I&&fZ(T,"BIcon".concat(I))||kI,Sr(s,{props:mn(QN,g)}))}}),mZ=8,e4=46,as=40,lh=35,zc=13,QO=27,ch=36,ol=37,Y0=34,J0=33,Rc=39,Zl=32,Is=38,gZ=function(e,r){if(e.length!==r.length)return!1;for(var s=!0,g=0;s&&g<e.length;g++)s=Ci(e[g],r[g]);return s},Ci=function t(e,r){if(e===r)return!0;var s=Xp(e),g=Xp(r);if(s||g)return s&&g?e.getTime()===r.getTime():!1;if(s=Ni(e),g=Ni(r),s||g)return s&&g?gZ(e,r):!1;if(s=kn(e),g=kn(r),s||g){if(!s||!g)return!1;var T=Gr(e).length,I=Gr(r).length;if(T!==I)return!1;for(var a in e){var N=Fd(e,a),H=Fd(r,a);if(N&&!H||!N&&H||!t(e[a],r[a]))return!1}}return String(e)===String(r)};function UI(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var GI=function(e){return!e||Gr(e).length===0},_Z=function(e){return{handler:function(s,g){if(!Ci(s,g)){if(GI(s)||GI(g)){this[e]=Ra(s);return}for(var T in g)Fd(s,T)||this.$delete(this.$data[e],T);for(var I in s)this.$set(this.$data[e],I,s[I])}}}},t4=function(e,r){return ot({data:function(){return UI({},r,Ra(this[e]))},watch:UI({},e,_Z(r))})};function HI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function yZ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?HI(Object(r),!0).forEach(function(s){vZ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):HI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function vZ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bZ=t4("$attrs","bvAttrs"),xZ=ot({computed:{bvAttrs:function(){var e=yZ({},this.$attrs);return Object.keys(e).forEach(function(r){e[r]===void 0&&delete e[r]}),e}}}),lo=cs?xZ:bZ,Hl=function(e){return e.$root.$options.bvEventRoot||e.$root},Xs="$_rootListeners",al=ot({computed:{bvEventRoot:function(){return Hl(this)}},created:function(){this[Xs]={}},beforeDestroy:function(){var e=this;Gr(this[Xs]||{}).forEach(function(r){e[Xs][r].forEach(function(s){e.listenOffRoot(r,s)})}),this[Xs]=null},methods:{registerRootListener:function(e,r){this[Xs]&&(this[Xs][e]=this[Xs][e]||[],Vr(this[Xs][e],r)||this[Xs][e].push(r))},unregisterRootListener:function(e,r){this[Xs]&&this[Xs][e]&&(this[Xs][e]=this[Xs][e].filter(function(s){return s!==r}))},listenOnRoot:function(e,r){this.bvEventRoot&&(this.bvEventRoot.$on(e,r),this.registerRootListener(e,r))},listenOnRootOnce:function(e,r){var s=this;if(this.bvEventRoot){var g=function T(){s.unregisterRootListener(T),r.apply(void 0,arguments)};this.bvEventRoot.$once(e,g),this.registerRootListener(e,g)}},listenOffRoot:function(e,r){this.unregisterRootListener(e,r),this.bvEventRoot&&this.bvEventRoot.$off(e,r)},emitOnRoot:function(e){if(this.bvEventRoot){for(var r,s=arguments.length,g=new Array(s>1?s-1:0),T=1;T<s;T++)g[T-1]=arguments[T];(r=this.bvEventRoot).$emit.apply(r,[e].concat(g))}}}});function qI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function WI(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qI(Object(r),!0).forEach(function(s){wZ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function wZ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var TZ=t4("$listeners","bvListeners"),EZ=ot({data:function(){return{bvListeners:{}}},created:function(){this.bvListeners=WI({},this.$listeners)},beforeUpdate:function(){this.bvListeners=WI({},this.$listeners)}}),Fc=cs?EZ:TZ;function SZ(t){return CZ(t)||AZ(t)||PZ(t)||OZ()}function OZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PZ(t,e){if(!!t){if(typeof t=="string")return yS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yS(t,e)}}function AZ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function CZ(t){if(Array.isArray(t))return yS(t)}function yS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function ZI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function is(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZI(Object(r),!0).forEach(function(s){r4(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function r4(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var MZ=Cn(HO,"clicked"),i4={activeClass:k(ie),append:k(Ee,!1),event:k(Ho),exact:k(Ee,!1),exactActiveClass:k(ie),exactPath:k(Ee,!1),exactPathActiveClass:k(ie),replace:k(Ee,!1),routerTag:k(ie),to:k(RN)},n4={noPrefetch:k(Ee,!1),prefetch:k(Ee,null)},ll=Ct(vr(is(is(is({},n4),i4),{},{active:k(Ee,!1),disabled:k(Ee,!1),href:k(ie),rel:k(ie,null),routerComponentName:k(ie),target:k(ie,"_self")})),HO),ks=ot({name:HO,mixins:[lo,Fc,al,Ur],inheritAttrs:!1,props:ll,computed:{computedTag:function(){var e=this.to,r=this.disabled,s=this.routerComponentName;return ZW({to:e,disabled:r,routerComponentName:s},this)},isRouterLink:function(){return KN(this.computedTag)},computedRel:function(){var e=this.target,r=this.rel;return XW({target:e,rel:r})},computedHref:function(){var e=this.to,r=this.href;return YN({to:e,href:r},this.computedTag)},computedProps:function(){var e=this.event,r=this.prefetch,s=this.routerTag;return this.isRouterLink?is(is(is(is({},mn(oi(is(is({},i4),this.computedTag==="nuxt-link"?n4:{}),["event","prefetch","routerTag"]),this)),e?{event:e}:{}),Da(r)?{prefetch:r}:{}),s?{tag:s}:{}):{}},computedAttrs:function(){var e=this.bvAttrs,r=this.computedHref,s=this.computedRel,g=this.disabled,T=this.target,I=this.routerTag,a=this.isRouterLink;return is(is(is(is({},e),r?{href:r}:{}),a&&I&&!Wl(I,"a")?{}:{rel:s,target:T}),{},{tabindex:g?"-1":Fn(e.tabindex)?null:e.tabindex,"aria-disabled":g?"true":null})},computedListeners:function(){return is(is({},this.bvListeners),{},{click:this.onClick})}},methods:{onClick:function(e){var r=arguments,s=kd(e),g=this.isRouterLink,T=this.bvListeners.click;if(s&&this.disabled)ei(e,{immediatePropagation:!0});else{if(g){var I;(I=e.currentTarget.__vue__)===null||I===void 0||I.$emit(Ba,e)}bi(T).filter(function(a){return Mr(a)}).forEach(function(a){a.apply(void 0,SZ(r))}),this.emitOnRoot(MZ,e),this.emitOnRoot("clicked::link",e)}s&&!g&&this.computedHref==="#"&&ei(e,{propagation:!1})},focus:function(){ii(this.$el)},blur:function(){zs(this.$el)}},render:function(e){var r=this.active,s=this.disabled;return e(this.computedTag,r4({class:{active:r,disabled:s},attrs:this.computedAttrs,props:this.computedProps},this.isRouterLink?"nativeOn":"on",this.computedListeners),this.normalizeSlot())}});function XI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Q0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XI(Object(r),!0).forEach(function(s){fd(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fd(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n1=oi(ll,["event","routerTag"]);delete n1.href.default;delete n1.to.default;var o4=Ct(vr(Q0(Q0({},n1),{},{block:k(Ee,!1),disabled:k(Ee,!1),pill:k(Ee,!1),pressed:k(Ee,null),size:k(ie),squared:k(Ee,!1),tag:k(ie,"button"),type:k(ie,"button"),variant:k(ie,"secondary")})),Dz),KI=function(e){e.type==="focusin"?ns(e.target,"focus"):e.type==="focusout"&&jo(e.target,"focus")},My=function(e){return Cy(e)||Wl(e.tag,"a")},s4=function(e){return Da(e.pressed)},a4=function(e){return!(My(e)||e.tag&&!Wl(e.tag,"button"))},l4=function(e){return!My(e)&&!a4(e)},IZ=function(e){var r;return["btn-".concat(e.variant||"secondary"),(r={},fd(r,"btn-".concat(e.size),e.size),fd(r,"btn-block",e.block),fd(r,"rounded-pill",e.pill),fd(r,"rounded-0",e.squared&&!e.pill),fd(r,"disabled",e.disabled),fd(r,"active",e.pressed),r)]},DZ=function(e){return My(e)?mn(n1,e):{}},RZ=function(e,r){var s=a4(e),g=My(e),T=s4(e),I=l4(e),a=g&&e.href==="#",N=r.attrs&&r.attrs.role?r.attrs.role:null,H=r.attrs?r.attrs.tabindex:null;return(I||a)&&(H="0"),{type:s&&!g?e.type:null,disabled:s?e.disabled:null,role:I||a?"button":N,"aria-disabled":I?String(e.disabled):null,"aria-pressed":T?String(e.pressed):null,autocomplete:T?"off":null,tabindex:e.disabled&&!s?"-1":H}},Ds=ot({name:Dz,functional:!0,props:o4,render:function(e,r){var s=r.props,g=r.data,T=r.listeners,I=r.children,a=s4(s),N=My(s),H=l4(s),K=N&&s.href==="#",ee={keydown:function(xe){if(!(s.disabled||!(H||K))){var Ie=xe.keyCode;if(Ie===Zl||Ie===zc&&H){var dt=xe.currentTarget||xe.target;ei(xe,{propagation:!1}),dt.click()}}},click:function(xe){s.disabled&&kd(xe)?ei(xe):a&&T&&T["update:pressed"]&&bi(T["update:pressed"]).forEach(function(Ie){Mr(Ie)&&Ie(!s.pressed)})}};a&&(ee.focusin=KI,ee.focusout=KI);var ue={staticClass:"btn",class:IZ(s),props:DZ(s),attrs:RZ(s,g),on:ee};return e(N?ks:s.tag,Sr(Q0(Q0({},g),{},{props:void 0}),ue),I)}});function YI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function ex(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YI(Object(r),!0).forEach(function(s){pd(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function pd(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var JI="b-avatar",UT=["sm",null,"lg"],c4=.4,LZ=c4*.7,u4=function(e){return e=_i(e)&&F_(e)?hi(e,0):e,rl(e)?"".concat(e,"px"):e||null},h4=oi(ll,["active","event","routerTag"]),BZ=Ct(vr(ex(ex({},h4),{},{alt:k(ie,"avatar"),ariaLabel:k(ie),badge:k(qo,!1),badgeLeft:k(Ee,!1),badgeOffset:k(ie),badgeTop:k(Ee,!1),badgeVariant:k(ie,"primary"),button:k(Ee,!1),buttonType:k(ie,"button"),icon:k(ie),rounded:k(qo,!1),size:k(dr),square:k(Ee,!1),src:k(ie),text:k(ie),variant:k(ie,"secondary")})),Oz),kZ=ot({name:Oz,mixins:[Ur],inject:{getBvAvatarGroup:{default:function(){return function(){return null}}}},props:BZ,data:function(){return{localSrc:this.src||null}},computed:{bvAvatarGroup:function(){return this.getBvAvatarGroup()},computedSize:function(){var e=this.bvAvatarGroup;return u4(e?e.size:this.size)},computedVariant:function(){var e=this.bvAvatarGroup;return e&&e.variant?e.variant:this.variant},computedRounded:function(){var e=this.bvAvatarGroup,r=e&&e.square?!0:this.square,s=e&&e.rounded?e.rounded:this.rounded;return r?"0":s===""?!0:s||"circle"},fontStyle:function(){var e=this.computedSize,r=UT.indexOf(e)===-1?"calc(".concat(e," * ").concat(c4,")"):null;return r?{fontSize:r}:{}},marginStyle:function(){var e=this.computedSize,r=this.bvAvatarGroup,s=r?r.overlapScale:0,g=e&&s?"calc(".concat(e," * -").concat(s,")"):null;return g?{marginLeft:g,marginRight:g}:{}},badgeStyle:function(){var e=this.computedSize,r=this.badgeTop,s=this.badgeLeft,g=this.badgeOffset,T=g||"0px";return{fontSize:UT.indexOf(e)===-1?"calc(".concat(e," * ").concat(LZ," )"):null,top:r?T:null,bottom:r?null:T,left:s?T:null,right:s?null:T}}},watch:{src:function(e,r){e!==r&&(this.localSrc=e||null)}},methods:{onImgError:function(e){this.localSrc=null,this.$emit(n7,e)},onClick:function(e){this.$emit(Ba,e)}},render:function(e){var r,s=this.computedVariant,g=this.disabled,T=this.computedRounded,I=this.icon,a=this.localSrc,N=this.text,H=this.fontStyle,K=this.marginStyle,ee=this.computedSize,ue=this.button,Pe=this.buttonType,xe=this.badge,Ie=this.badgeVariant,dt=this.badgeStyle,Le=!ue&&Cy(this),De=ue?Ds:Le?ks:"span",Ye=this.alt,He=this.ariaLabel||null,ht=null;this.hasNormalizedSlot()?ht=e("span",{staticClass:"b-avatar-custom"},[this.normalizeSlot()]):a?(ht=e("img",{style:s?{}:{width:"100%",height:"100%"},attrs:{src:a,alt:Ye},on:{error:this.onImgError}}),ht=e("span",{staticClass:"b-avatar-img"},[ht])):I?ht=e(K0,{props:{icon:I},attrs:{"aria-hidden":"true",alt:Ye}}):N?ht=e("span",{staticClass:"b-avatar-text",style:H},[e("span",N)]):ht=e(aZ,{attrs:{"aria-hidden":"true",alt:Ye}});var St=e(),st=this.hasNormalizedSlot(fI);if(xe||xe===""||st){var gt=xe===!0?"":xe;St=e("span",{staticClass:"b-avatar-badge",class:pd({},"badge-".concat(Ie),Ie),style:dt},[st?this.normalizeSlot(fI):gt])}var Tt={staticClass:JI,class:(r={},pd(r,"".concat(JI,"-").concat(ee),ee&&UT.indexOf(ee)!==-1),pd(r,"badge-".concat(s),!ue&&s),pd(r,"rounded",T===!0),pd(r,"rounded-".concat(T),T&&T!==!0),pd(r,"disabled",g),r),style:ex(ex({},K),{},{width:ee,height:ee}),attrs:{"aria-label":He||null},props:ue?{variant:s,disabled:g,type:Pe}:Le?mn(h4,this):{},on:ue||Le?{click:this.onClick}:{}};return e(De,Tt,[ht,St])}}),zZ=Ct({overlap:k(dr,.3),rounded:k(qo,!1),size:k(ie),square:k(Ee,!1),tag:k(ie,"div"),variant:k(ie)},Pz),FZ=ot({name:Pz,mixins:[Ur],provide:function(){var e=this;return{getBvAvatarGroup:function(){return e}}},props:zZ,computed:{computedSize:function(){return u4(this.size)},overlapScale:function(){return Ec(Li(hi(this.overlap,0),0),1)/2},paddingStyle:function(){var e=this.computedSize;return e=e?"calc(".concat(e," * ").concat(this.overlapScale,")"):null,e?{paddingLeft:e,paddingRight:e}:{}}},render:function(e){var r=e("div",{staticClass:"b-avatar-group-inner",style:this.paddingStyle},this.normalizeSlot());return e(this.tag,{staticClass:"b-avatar-group",attrs:{role:"group"}},[r])}}),NZ=wr({components:{BAvatar:kZ,BAvatarGroup:FZ}});function QI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function eD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QI(Object(r),!0).forEach(function(s){$Z(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QI(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function $Z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o1=oi(ll,["event","routerTag"]);delete o1.href.default;delete o1.to.default;var jZ=Ct(vr(eD(eD({},o1),{},{pill:k(Ee,!1),tag:k(ie,"span"),variant:k(ie,"secondary")})),Az),d4=ot({name:Az,functional:!0,props:jZ,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.active,a=s.disabled,N=Cy(s),H=N?ks:s.tag,K=s.variant||"secondary";return e(H,Sr(g,{staticClass:"badge",class:["badge-".concat(K),{"badge-pill":s.pill,active:I,disabled:a}],props:N?mn(o1,s):{}}),T)}}),VZ=wr({components:{BBadge:d4}}),tD=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return String(e).replace(UH,"")},En=function(e,r){return e?{innerHTML:e}:r?{textContent:r}:{}};function rD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function iD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rD(Object(r),!0).forEach(function(s){UZ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function UZ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var vS=Ct(vr(iD(iD({},oi(ll,["event","routerTag"])),{},{ariaCurrent:k(ie,"location"),html:k(ie),text:k(ie)})),Iz),f4=ot({name:Iz,functional:!0,props:vS,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.active,a=I?"span":ks,N={attrs:{"aria-current":I?s.ariaCurrent:null},props:mn(vS,s)};return T||(N.domProps=En(s.html,s.text)),e(a,Sr(g,N),T)}}),GZ=Ct(vS,Mz),p4=ot({name:Mz,functional:!0,props:GZ,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e("li",Sr(g,{staticClass:"breadcrumb-item",class:{active:s.active}}),[e(f4,{props:s},T)])}});function nD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function oD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nD(Object(r),!0).forEach(function(s){HZ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function HZ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var qZ=Ct({items:k(ss)},Cz),WZ=ot({name:Cz,functional:!0,props:qZ,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.items,a=T;if(Ni(I)){var N=!1;a=I.map(function(H,K){kn(H)||(H={text:Lr(H)});var ee=H,ue=ee.active;return ue&&(N=!0),!ue&&!N&&(ue=K+1===I.length),e(p4,{props:oD(oD({},H),{},{active:ue})})})}return e("ol",Sr(g,{staticClass:"breadcrumb"}),a)}}),ZZ=wr({components:{BBreadcrumb:WZ,BBreadcrumbItem:p4,BBreadcrumbLink:f4}}),XZ=wr({components:{BButton:Ds,BBtn:Ds,BButtonClose:Ud,BBtnClose:Ud}});function sD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function aD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sD(Object(r),!0).forEach(function(s){m4(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function m4(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var KZ=Ct(vr(aD(aD({},sl(o4,["size"])),{},{ariaRole:k(ie,"group"),size:k(ie),tag:k(ie,"div"),vertical:k(Ee,!1)})),Lz),lD=ot({name:Lz,functional:!0,props:KZ,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.tag,Sr(g,{class:m4({"btn-group":!s.vertical,"btn-group-vertical":s.vertical},"btn-group-".concat(s.size),s.size),attrs:{role:s.ariaRole}}),T)}}),YZ=wr({components:{BButtonGroup:lD,BBtnGroup:lD}}),JZ=[".btn:not(.disabled):not([disabled]):not(.dropdown-item)",".form-control:not(.disabled):not([disabled])","select:not(.disabled):not([disabled])",'input[type="checkbox"]:not(.disabled)','input[type="radio"]:not(.disabled)'].join(","),QZ=Ct({justify:k(Ee,!1),keyNav:k(Ee,!1)},Bz),cD=ot({name:Bz,mixins:[Ur],props:QZ,mounted:function(){this.keyNav&&this.getItems()},methods:{getItems:function(){var e=ca(JZ,this.$el);return e.forEach(function(r){r.tabIndex=-1}),e.filter(function(r){return il(r)})},focusFirst:function(){var e=this.getItems();ii(e[0])},focusPrev:function(e){var r=this.getItems(),s=r.indexOf(e.target);s>-1&&(r=r.slice(0,s).reverse(),ii(r[0]))},focusNext:function(e){var r=this.getItems(),s=r.indexOf(e.target);s>-1&&(r=r.slice(s+1),ii(r[0]))},focusLast:function(){var e=this.getItems().reverse();ii(e[0])},onFocusin:function(e){var r=this.$el;e.target===r&&!qn(r,e.relatedTarget)&&(ei(e),this.focusFirst(e))},onKeydown:function(e){var r=e.keyCode,s=e.shiftKey;r===Is||r===ol?(ei(e),s?this.focusFirst(e):this.focusPrev(e)):(r===as||r===Rc)&&(ei(e),s?this.focusLast(e):this.focusNext(e))}},render:function(e){var r=this.keyNav;return e("div",{staticClass:"btn-toolbar",class:{"justify-content-between":this.justify},attrs:{role:"toolbar",tabindex:r?"0":null},on:r?{focusin:this.onFocusin,keydown:this.onKeydown}:{}},[this.normalizeSlot()])}}),e9=wr({components:{BButtonToolbar:cD,BBtnToolbar:cD}}),Nu="gregory",j_="long",t9="narrow",bS="short",uD="2-digit",tx="numeric";function r9(t,e){return s9(t)||o9(t,e)||n9(t,e)||i9()}function i9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n9(t,e){if(!!t){if(typeof t=="string")return hD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hD(t,e)}}function hD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function o9(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s=[],g=!0,T=!1,I,a;try{for(r=r.call(t);!(g=(I=r.next()).done)&&(s.push(I.value),!(e&&s.length===e));g=!0);}catch(N){T=!0,a=N}finally{try{!g&&r.return!=null&&r.return()}finally{if(T)throw a}}return s}}function s9(t){if(Array.isArray(t))return t}function p0(t,e,r){return a9()?p0=Reflect.construct:p0=function(g,T,I){var a=[null];a.push.apply(a,T);var N=Function.bind.apply(g,a),H=new N;return I&&xS(H,I.prototype),H},p0.apply(null,arguments)}function a9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xS(t,e){return xS=Object.setPrototypeOf||function(s,g){return s.__proto__=g,s},xS(t,e)}var go=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return p0(Date,r)},Gn=function(e){if(_i(e)&&eq.test(e.trim())){var r=e.split(tq).map(function(a){return or(a,1)}),s=r9(r,3),g=s[0],T=s[1],I=s[2];return go(g,T-1,I)}else if(Xp(e))return go(e.getFullYear(),e.getMonth(),e.getDate());return null},dn=function(e){if(e=Gn(e),!e)return null;var r=e.getFullYear(),s="0".concat(e.getMonth()+1).slice(-2),g="0".concat(e.getDate()).slice(-2);return"".concat(r,"-").concat(s,"-").concat(g)},l9=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nu;e=bi(e).filter($r);var s=new Intl.DateTimeFormat(e,{calendar:r});return s.resolvedOptions().locale},E_=function(e,r){var s=new Intl.DateTimeFormat(e,r);return s.format},zb=function(e,r){return dn(e)===dn(r)},GT=function(e){return e=go(e),e.setDate(1),e},HT=function(e){return e=go(e),e.setMonth(e.getMonth()+1),e.setDate(0),e},s1=function(e,r){e=go(e);var s=e.getMonth();return e.setFullYear(e.getFullYear()+r),e.getMonth()!==s&&e.setDate(0),e},qT=function(e){e=go(e);var r=e.getMonth();return e.setMonth(r-1),e.getMonth()===r&&e.setDate(0),e},WT=function(e){e=go(e);var r=e.getMonth();return e.setMonth(r+1),e.getMonth()===(r+2)%12&&e.setDate(0),e},ZT=function(e){return s1(e,-1)},XT=function(e){return s1(e,1)},KT=function(e){return s1(e,-10)},YT=function(e){return s1(e,10)},rx=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return e=Gn(e),r=Gn(r)||e,s=Gn(s)||e,e?e<r?r:e>s?s:e:null},dD=["ar","az","ckb","fa","he","ks","lrc","mzn","ps","sd","te","ug","ur","yi"].map(function(t){return t.toLowerCase()}),a1=function(e){var r=Lr(e).toLowerCase().replace(uq,"").split("-"),s=r.slice(0,2).join("-"),g=r[0];return Vr(dD,s)||Vr(dD,g)},Hi={id:k(ie)},Ki=ot({props:Hi,data:function(){return{localId_:null}},computed:{safeId:function(){var e=this.id||this.localId_,r=function(g){return e?(g=String(g||"").replace(/\s+/g,"_"),g?e+"_"+g:e):null};return r}},mounted:function(){var e=this;this.$nextTick(function(){e.localId_="__BVID__".concat(e[Oc])})}}),mp;function fD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Rl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fD(Object(r),!0).forEach(function(s){Aa(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Aa(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l1=Xn("value",{type:Id}),c9=l1.mixin,u9=l1.props,JT=l1.prop,h9=l1.event,g4=Ct(vr(Rl(Rl(Rl({},Hi),u9),{},{ariaControls:k(ie),block:k(Ee,!1),dateDisabledFn:k(ls),dateFormatOptions:k(Zn,{year:tx,month:j_,day:tx,weekday:j_}),dateInfoFn:k(ls),direction:k(ie),disabled:k(Ee,!1),headerTag:k(ie,"header"),hidden:k(Ee,!1),hideHeader:k(Ee,!1),initialDate:k(Id),labelCalendar:k(ie,"Calendar"),labelCurrentMonth:k(ie,"Current month"),labelHelp:k(ie,"Use cursor keys to navigate calendar dates"),labelNav:k(ie,"Calendar navigation"),labelNextDecade:k(ie,"Next decade"),labelNextMonth:k(ie,"Next month"),labelNextYear:k(ie,"Next year"),labelNoDateSelected:k(ie,"No date selected"),labelPrevDecade:k(ie,"Previous decade"),labelPrevMonth:k(ie,"Previous month"),labelPrevYear:k(ie,"Previous year"),labelSelected:k(ie,"Selected date"),labelToday:k(ie,"Today"),locale:k(Ho),max:k(Id),min:k(Id),navButtonVariant:k(ie,"secondary"),noHighlightToday:k(Ee,!1),noKeyNav:k(Ee,!1),readonly:k(Ee,!1),roleDescription:k(ie),selectedVariant:k(ie,"primary"),showDecadeNav:k(Ee,!1),startWeekday:k(dr,0),todayVariant:k(ie),valueAsDate:k(Ee,!1),weekdayHeaderFormat:k(ie,bS,function(t){return Vr([j_,bS,t9],t)}),width:k(ie,"270px")})),kz),_4=ot({name:kz,mixins:[lo,Ki,c9,Ur],props:g4,data:function(){var e=dn(this[JT])||"";return{selectedYMD:e,activeYMD:e||dn(rx(this.initialDate||this.getToday()),this.min,this.max),gridHasFocus:!1,isLive:!1}},computed:{valueId:function(){return this.safeId()},widgetId:function(){return this.safeId("_calendar-wrapper_")},navId:function(){return this.safeId("_calendar-nav_")},gridId:function(){return this.safeId("_calendar-grid_")},gridCaptionId:function(){return this.safeId("_calendar-grid-caption_")},gridHelpId:function(){return this.safeId("_calendar-grid-help_")},activeId:function(){return this.activeYMD?this.safeId("_cell-".concat(this.activeYMD,"_")):null},selectedDate:function(){return Gn(this.selectedYMD)},activeDate:function(){return Gn(this.activeYMD)},computedMin:function(){return Gn(this.min)},computedMax:function(){return Gn(this.max)},computedWeekStarts:function(){return Li(or(this.startWeekday,0),0)%7},computedLocale:function(){return l9(bi(this.locale).filter($r),Nu)},computedDateDisabledFn:function(){var e=this.dateDisabledFn;return Gl(e)?e:function(){return!1}},computedDateInfoFn:function(){var e=this.dateInfoFn;return Gl(e)?e:function(){return{}}},calendarLocale:function(){var e=new Intl.DateTimeFormat(this.computedLocale,{calendar:Nu}),r=e.resolvedOptions().calendar,s=e.resolvedOptions().locale;return r!==Nu&&(s=s.replace(/-u-.+$/i,"").concat("-u-ca-gregory")),s},calendarYear:function(){return this.activeDate.getFullYear()},calendarMonth:function(){return this.activeDate.getMonth()},calendarFirstDay:function(){return go(this.calendarYear,this.calendarMonth,1,12)},calendarDaysInMonth:function(){var e=go(this.calendarFirstDay);return e.setMonth(e.getMonth()+1,0),e.getDate()},computedVariant:function(){return"btn-".concat(this.selectedVariant||"primary")},computedTodayVariant:function(){return"btn-outline-".concat(this.todayVariant||this.selectedVariant||"primary")},computedNavButtonVariant:function(){return"btn-outline-".concat(this.navButtonVariant||"primary")},isRTL:function(){var e=Lr(this.direction).toLowerCase();return e==="rtl"?!0:e==="ltr"?!1:a1(this.computedLocale)},context:function(){var e=this.selectedYMD,r=this.activeYMD,s=Gn(e),g=Gn(r);return{selectedYMD:e,selectedDate:s,selectedFormatted:s?this.formatDateString(s):this.labelNoDateSelected,activeYMD:r,activeDate:g,activeFormatted:g?this.formatDateString(g):"",disabled:this.dateDisabled(g),locale:this.computedLocale,calendarLocale:this.calendarLocale,rtl:this.isRTL}},dateOutOfRange:function(){var e=this.computedMin,r=this.computedMax;return function(s){return s=Gn(s),e&&s<e||r&&s>r}},dateDisabled:function(){var e=this,r=this.dateOutOfRange;return function(s){s=Gn(s);var g=dn(s);return!!(r(s)||e.computedDateDisabledFn(g,s))}},formatDateString:function(){return E_(this.calendarLocale,Rl(Rl({year:tx,month:uD,day:uD},this.dateFormatOptions),{},{hour:void 0,minute:void 0,second:void 0,calendar:Nu}))},formatYearMonth:function(){return E_(this.calendarLocale,{year:tx,month:j_,calendar:Nu})},formatWeekdayName:function(){return E_(this.calendarLocale,{weekday:j_,calendar:Nu})},formatWeekdayNameShort:function(){return E_(this.calendarLocale,{weekday:this.weekdayHeaderFormat||bS,calendar:Nu})},formatDay:function(){var e=new Intl.NumberFormat([this.computedLocale],{style:"decimal",minimumIntegerDigits:1,minimumFractionDigits:0,maximumFractionDigits:0,notation:"standard"});return function(r){return e.format(r.getDate())}},prevDecadeDisabled:function(){var e=this.computedMin;return this.disabled||e&&HT(KT(this.activeDate))<e},prevYearDisabled:function(){var e=this.computedMin;return this.disabled||e&&HT(ZT(this.activeDate))<e},prevMonthDisabled:function(){var e=this.computedMin;return this.disabled||e&&HT(qT(this.activeDate))<e},thisMonthDisabled:function(){return this.disabled},nextMonthDisabled:function(){var e=this.computedMax;return this.disabled||e&&GT(WT(this.activeDate))>e},nextYearDisabled:function(){var e=this.computedMax;return this.disabled||e&&GT(XT(this.activeDate))>e},nextDecadeDisabled:function(){var e=this.computedMax;return this.disabled||e&&GT(YT(this.activeDate))>e},calendar:function(){for(var e=[],r=this.calendarFirstDay,s=r.getFullYear(),g=r.getMonth(),T=this.calendarDaysInMonth,I=r.getDay(),a=(this.computedWeekStarts>I?7:0)-this.computedWeekStarts,N=0-a-I,H=0;H<6&&N<T;H++){e[H]=[];for(var K=0;K<7;K++){N++;var ee=go(s,g,N),ue=ee.getMonth(),Pe=dn(ee),xe=this.dateDisabled(ee),Ie=this.computedDateInfoFn(Pe,Gn(Pe));Ie=_i(Ie)||Ni(Ie)?{class:Ie}:Go(Ie)?Rl({class:""},Ie):{class:""},e[H].push({ymd:Pe,day:this.formatDay(ee),label:this.formatDateString(ee),isThisMonth:ue===g,isDisabled:xe,info:Ie})}}return e},calendarHeadings:function(){var e=this;return this.calendar[0].map(function(r){return{text:e.formatWeekdayNameShort(Gn(r.ymd)),label:e.formatWeekdayName(Gn(r.ymd))}})}},watch:(mp={},Aa(mp,JT,function(t,e){var r=dn(t)||"",s=dn(e)||"";zb(r,s)||(this.activeYMD=r||this.activeYMD,this.selectedYMD=r)}),Aa(mp,"selectedYMD",function(e,r){e!==r&&this.$emit(h9,this.valueAsDate?Gn(e)||null:e||"")}),Aa(mp,"context",function(e,r){Ci(e,r)||this.$emit(Kp,e)}),Aa(mp,"hidden",function(e){this.activeYMD=this.selectedYMD||dn(this[JT]||this.constrainDate(this.initialDate||this.getToday())),this.setLive(!e)}),mp),created:function(){var e=this;this.$nextTick(function(){e.$emit(Kp,e.context)})},mounted:function(){this.setLive(!0)},activated:function(){this.setLive(!0)},deactivated:function(){this.setLive(!1)},beforeDestroy:function(){this.setLive(!1)},methods:{focus:function(){this.disabled||ii(this.$refs.grid)},blur:function(){this.disabled||zs(this.$refs.grid)},setLive:function(e){var r=this;e?this.$nextTick(function(){Vi(function(){r.isLive=!0})}):this.isLive=!1},getToday:function(){return Gn(go())},constrainDate:function(e){return rx(e,this.computedMin,this.computedMax)},emitSelected:function(e){var r=this;this.$nextTick(function(){r.$emit(PN,dn(e)||"",Gn(e)||null)})},setGridFocusFlag:function(e){this.gridHasFocus=!this.disabled&&e.type==="focus"},onKeydownWrapper:function(e){if(!this.noKeyNav){var r=e.altKey,s=e.ctrlKey,g=e.keyCode;if(!!Vr([J0,Y0,lh,ch,ol,Is,Rc,as],g)){ei(e);var T=go(this.activeDate),I=go(this.activeDate),a=T.getDate(),N=this.constrainDate(this.getToday()),H=this.isRTL;g===J0?(T=(r?s?KT:ZT:qT)(T),I=go(T),I.setDate(1)):g===Y0?(T=(r?s?YT:XT:WT)(T),I=go(T),I.setMonth(I.getMonth()+1),I.setDate(0)):g===ol?(T.setDate(a+(H?1:-1)),T=this.constrainDate(T),I=T):g===Rc?(T.setDate(a+(H?-1:1)),T=this.constrainDate(T),I=T):g===Is?(T.setDate(a-7),T=this.constrainDate(T),I=T):g===as?(T.setDate(a+7),T=this.constrainDate(T),I=T):g===ch?(T=N,I=T):g===lh&&(T=Gn(this.selectedDate)||N,I=T),!this.dateOutOfRange(I)&&!zb(T,this.activeDate)&&(this.activeYMD=dn(T)),this.focus()}}},onKeydownGrid:function(e){var r=e.keyCode,s=this.activeDate;(r===zc||r===Zl)&&(ei(e),!this.disabled&&!this.readonly&&!this.dateDisabled(s)&&(this.selectedYMD=dn(s),this.emitSelected(s)),this.focus())},onClickDay:function(e){var r=this.selectedDate,s=this.activeDate,g=Gn(e.ymd);!this.disabled&&!e.isDisabled&&!this.dateDisabled(g)&&(this.readonly||(this.selectedYMD=dn(zb(g,r)?r:g),this.emitSelected(g)),this.activeYMD=dn(zb(g,s)?s:go(g)),this.focus())},gotoPrevDecade:function(){this.activeYMD=dn(this.constrainDate(KT(this.activeDate)))},gotoPrevYear:function(){this.activeYMD=dn(this.constrainDate(ZT(this.activeDate)))},gotoPrevMonth:function(){this.activeYMD=dn(this.constrainDate(qT(this.activeDate)))},gotoCurrentMonth:function(){this.activeYMD=dn(this.constrainDate(this.getToday()))},gotoNextMonth:function(){this.activeYMD=dn(this.constrainDate(WT(this.activeDate)))},gotoNextYear:function(){this.activeYMD=dn(this.constrainDate(XT(this.activeDate)))},gotoNextDecade:function(){this.activeYMD=dn(this.constrainDate(YT(this.activeDate)))},onHeaderClick:function(){this.disabled||(this.activeYMD=this.selectedYMD||dn(this.getToday()),this.focus())}},render:function(e){var r=this;if(this.hidden)return e();var s=this.valueId,g=this.widgetId,T=this.navId,I=this.gridId,a=this.gridCaptionId,N=this.gridHelpId,H=this.activeId,K=this.disabled,ee=this.noKeyNav,ue=this.isLive,Pe=this.isRTL,xe=this.activeYMD,Ie=this.selectedYMD,dt=this.safeId,Le=!this.showDecadeNav,De=dn(this.getToday()),Ye=!this.noHighlightToday,He=e("output",{staticClass:"form-control form-control-sm text-center",class:{"text-muted":K,readonly:this.readonly||K},attrs:{id:s,for:I,role:"status",tabindex:K?null:"-1","data-selected":Lr(Ie),"aria-live":ue?"polite":"off","aria-atomic":ue?"true":null},on:{click:this.onHeaderClick,focus:this.onHeaderClick}},this.selectedDate?[e("bdi",{staticClass:"sr-only"}," (".concat(Lr(this.labelSelected),") ")),e("bdi",this.formatDateString(this.selectedDate))]:this.labelNoDateSelected||"\xA0");He=e(this.headerTag,{staticClass:"b-calendar-header",class:{"sr-only":this.hideHeader},attrs:{title:this.selectedDate&&this.labelSelected||null}},[He]);var ht={isRTL:Pe},St={shiftV:.5},st=Rl(Rl({},St),{},{flipH:Pe}),gt=Rl(Rl({},St),{},{flipH:!Pe}),Tt=this.normalizeSlot(Q7,ht)||e(zI,{props:st}),at=this.normalizeSlot(tW,ht)||e(FI,{props:st}),ft=this.normalizeSlot(eW,ht)||e(NI,{props:st}),gr=this.normalizeSlot(rW,ht)||e(_S,{props:St}),xr=this.normalizeSlot(Y7,ht)||e(NI,{props:gt}),Jt=this.normalizeSlot(J7,ht)||e(FI,{props:gt}),Zt=this.normalizeSlot(K7,ht)||e(zI,{props:gt}),Et=function(yi,Si,hs,qi,we){return e("button",{staticClass:"btn btn-sm border-0 flex-fill",class:[r.computedNavButtonVariant,{disabled:qi}],attrs:{title:Si||null,type:"button",tabindex:ee?"-1":null,"aria-label":Si||null,"aria-disabled":qi?"true":null,"aria-keyshortcuts":we||null},on:qi?{}:{click:hs}},[e("div",{attrs:{"aria-hidden":"true"}},[yi])])},fr=e("div",{staticClass:"b-calendar-nav d-flex",attrs:{id:T,role:"group",tabindex:ee?"-1":null,"aria-hidden":K?"true":null,"aria-label":this.labelNav||null,"aria-controls":I}},[Le?e():Et(Tt,this.labelPrevDecade,this.gotoPrevDecade,this.prevDecadeDisabled,"Ctrl+Alt+PageDown"),Et(at,this.labelPrevYear,this.gotoPrevYear,this.prevYearDisabled,"Alt+PageDown"),Et(ft,this.labelPrevMonth,this.gotoPrevMonth,this.prevMonthDisabled,"PageDown"),Et(gr,this.labelCurrentMonth,this.gotoCurrentMonth,this.thisMonthDisabled,"Home"),Et(xr,this.labelNextMonth,this.gotoNextMonth,this.nextMonthDisabled,"PageUp"),Et(Jt,this.labelNextYear,this.gotoNextYear,this.nextYearDisabled,"Alt+PageUp"),Le?e():Et(Zt,this.labelNextDecade,this.gotoNextDecade,this.nextDecadeDisabled,"Ctrl+Alt+PageUp")]),jr=e("div",{staticClass:"b-calendar-grid-caption text-center font-weight-bold",class:{"text-muted":K},attrs:{id:a,"aria-live":ue?"polite":null,"aria-atomic":ue?"true":null},key:"grid-caption"},this.formatYearMonth(this.calendarFirstDay)),er=e("div",{staticClass:"b-calendar-grid-weekdays row no-gutters border-bottom",attrs:{"aria-hidden":"true"}},this.calendarHeadings.map(function(rn,yi){return e("small",{staticClass:"col text-truncate",class:{"text-muted":K},attrs:{title:rn.label===rn.text?null:rn.label,"aria-label":rn.label},key:yi},rn.text)})),tn=this.calendar.map(function(rn){var yi=rn.map(function(Si,hs){var qi,we=Si.ymd===Ie,Kn=Si.ymd===xe,Ne=Si.ymd===De,Qe=dt("_cell-".concat(Si.ymd,"_")),ze=e("span",{staticClass:"btn border-0 rounded-circle text-nowrap",class:(qi={focus:Kn&&r.gridHasFocus,disabled:Si.isDisabled||K,active:we},Aa(qi,r.computedVariant,we),Aa(qi,r.computedTodayVariant,Ne&&Ye&&!we&&Si.isThisMonth),Aa(qi,"btn-outline-light",!(Ne&&Ye)&&!we&&!Kn),Aa(qi,"btn-light",!(Ne&&Ye)&&!we&&Kn),Aa(qi,"text-muted",!Si.isThisMonth&&!we),Aa(qi,"text-dark",!(Ne&&Ye)&&!we&&!Kn&&Si.isThisMonth),Aa(qi,"font-weight-bold",(we||Si.isThisMonth)&&!Si.isDisabled),qi),on:{click:function(){return r.onClickDay(Si)}}},Si.day);return e("div",{staticClass:"col p-0",class:Si.isDisabled?"bg-light":Si.info.class||"",attrs:{id:Qe,role:"button","data-date":Si.ymd,"aria-hidden":Si.isThisMonth?null:"true","aria-disabled":Si.isDisabled||K?"true":null,"aria-label":[Si.label,we?"(".concat(r.labelSelected,")"):null,Ne?"(".concat(r.labelToday,")"):null].filter($r).join(" "),"aria-selected":we?"true":null,"aria-current":we?"date":null},key:hs},[ze])});return e("div",{staticClass:"row no-gutters",key:rn[0].ymd},yi)});tn=e("div",{staticClass:"b-calendar-grid-body",style:K?{pointerEvents:"none"}:{}},tn);var ln=e("div",{staticClass:"b-calendar-grid-help border-top small text-muted text-center bg-light",attrs:{id:N}},[e("div",{staticClass:"small"},this.labelHelp)]),Yi=e("div",{staticClass:"b-calendar-grid form-control h-auto text-center",attrs:{id:I,role:"application",tabindex:ee?"-1":K?null:"0","data-month":xe.slice(0,-3),"aria-roledescription":this.labelCalendar||null,"aria-labelledby":a,"aria-describedby":N,"aria-disabled":K?"true":null,"aria-activedescendant":H},on:{keydown:this.onKeydownGrid,focus:this.setGridFocusFlag,blur:this.setGridFocusFlag},ref:"grid"},[jr,er,tn,ln]),ir=this.normalizeSlot();ir=ir?e("footer",{staticClass:"b-calendar-footer"},ir):e();var us=e("div",{staticClass:"b-calendar-inner",style:this.block?{}:{width:this.width},attrs:{id:g,dir:Pe?"rtl":"ltr",lang:this.computedLocale||null,role:"group","aria-disabled":K?"true":null,"aria-controls":this.ariaControls||null,"aria-roledescription":this.roleDescription||null,"aria-describedby":[this.bvAttrs["aria-describedby"],s,N].filter($r).join(" ")},on:{keydown:this.onKeydownWrapper}},[He,fr,Yi,ir]);return e("div",{staticClass:"b-calendar",class:{"d-block":this.block}},[us])}}),d9=wr({components:{BCalendar:_4}}),Iy=Ct({bgVariant:k(ie),borderVariant:k(ie),tag:k(ie,"div"),textVariant:k(ie)},UO);ot({props:Iy});var eP=Ct({title:k(ie),titleTag:k(ie,"h4")},Hz),y4=ot({name:Hz,functional:!0,props:eP,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.titleTag,Sr(g,{staticClass:"card-title"}),T||Lr(s.title))}}),tP=Ct({subTitle:k(ie),subTitleTag:k(ie,"h6"),subTitleTextVariant:k(ie,"muted")},Uz),v4=ot({name:Uz,functional:!0,props:tP,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.subTitleTag,Sr(g,{staticClass:"card-subtitle",class:[s.subTitleTextVariant?"text-".concat(s.subTitleTextVariant):null]}),T||Lr(s.subTitle))}});function pD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Fb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pD(Object(r),!0).forEach(function(s){m0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function m0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var rP=Ct(vr(Fb(Fb(Fb(Fb({},eP),tP),r1(Iy,t1.bind(null,"body"))),{},{bodyClass:k(Nr),overlay:k(Ee,!1)})),zz),b4=ot({name:zz,functional:!0,props:rP,render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.bodyBgVariant,N=g.bodyBorderVariant,H=g.bodyTextVariant,K=e();g.title&&(K=e(y4,{props:mn(eP,g)}));var ee=e();return g.subTitle&&(ee=e(v4,{props:mn(tP,g),class:["mb-2"]})),e(g.bodyTag,Sr(T,{staticClass:"card-body",class:[(s={"card-img-overlay":g.overlay},m0(s,"bg-".concat(a),a),m0(s,"border-".concat(N),N),m0(s,"text-".concat(H),H),s),g.bodyClass]}),[K,ee,I])}});function mD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function gD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mD(Object(r),!0).forEach(function(s){g0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function g0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var iP=Ct(vr(gD(gD({},r1(Iy,t1.bind(null,"header"))),{},{header:k(ie),headerClass:k(Nr),headerHtml:k(ie)})),$z),x4=ot({name:$z,functional:!0,props:iP,render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.headerBgVariant,N=g.headerBorderVariant,H=g.headerTextVariant;return e(g.headerTag,Sr(T,{staticClass:"card-header",class:[g.headerClass,(s={},g0(s,"bg-".concat(a),a),g0(s,"border-".concat(N),N),g0(s,"text-".concat(H),H),s)],domProps:I?{}:En(g.headerHtml,g.header)}),I)}});function _D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function yD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_D(Object(r),!0).forEach(function(s){_0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_D(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function _0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var nP=Ct(vr(yD(yD({},r1(Iy,t1.bind(null,"footer"))),{},{footer:k(ie),footerClass:k(Nr),footerHtml:k(ie)})),Fz),w4=ot({name:Fz,functional:!0,props:nP,render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.footerBgVariant,N=g.footerBorderVariant,H=g.footerTextVariant;return e(g.footerTag,Sr(T,{staticClass:"card-footer",class:[g.footerClass,(s={},_0(s,"bg-".concat(a),a),_0(s,"border-".concat(N),N),_0(s,"text-".concat(H),H),s)],domProps:I?{}:En(g.footerHtml,g.footer)}),I)}});function QT(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f9='<svg width="%{w}" height="%{h}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 %{w} %{h}" preserveAspectRatio="none"><rect width="100%" height="100%" style="fill:%{f};"></rect></svg>',p9=function(e,r,s){var g=encodeURIComponent(f9.replace("%{w}",Lr(e)).replace("%{h}",Lr(r)).replace("%{f}",s));return"data:image/svg+xml;charset=UTF-8,".concat(g)},c1=Ct({alt:k(ie),blank:k(Ee,!1),blankColor:k(ie,"transparent"),block:k(Ee,!1),center:k(Ee,!1),fluid:k(Ee,!1),fluidGrow:k(Ee,!1),height:k(dr),left:k(Ee,!1),right:k(Ee,!1),rounded:k(qo,!1),sizes:k(Ho),src:k(ie),srcset:k(Ho),thumbnail:k(Ee,!1),width:k(dr)},PF),oP=ot({name:PF,functional:!0,props:c1,render:function(e,r){var s,g=r.props,T=r.data,I=g.alt,a=g.src,N=g.block,H=g.fluidGrow,K=g.rounded,ee=or(g.width)||null,ue=or(g.height)||null,Pe=null,xe=bi(g.srcset).filter($r).join(","),Ie=bi(g.sizes).filter($r).join(",");return g.blank&&(!ue&&ee?ue=ee:!ee&&ue&&(ee=ue),!ee&&!ue&&(ee=1,ue=1),a=p9(ee,ue,g.blankColor||"transparent"),xe=null,Ie=null),g.left?Pe="float-left":g.right?Pe="float-right":g.center&&(Pe="mx-auto",N=!0),e("img",Sr(T,{attrs:{src:a,alt:I,width:ee?Lr(ee):null,height:ue?Lr(ue):null,srcset:xe||null,sizes:Ie||null},class:(s={"img-thumbnail":g.thumbnail,"img-fluid":g.fluid||H,"w-100":H,rounded:K===""||K===!0},QT(s,"rounded-".concat(K),_i(K)&&K!==""),QT(s,Pe,Pe),QT(s,"d-block",N),s)}))}});function vD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function bD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vD(Object(r),!0).forEach(function(s){m9(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function m9(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var sP=Ct(vr(bD(bD({},sl(c1,["src","alt","width","height","left","right"])),{},{bottom:k(Ee,!1),end:k(Ee,!1),start:k(Ee,!1),top:k(Ee,!1)})),jz),T4=ot({name:jz,functional:!0,props:sP,render:function(e,r){var s=r.props,g=r.data,T=s.src,I=s.alt,a=s.width,N=s.height,H="card-img";return s.top?H+="-top":s.right||s.end?H+="-right":s.bottom?H+="-bottom":(s.left||s.start)&&(H+="-left"),e("img",Sr(g,{class:H,attrs:{src:T,alt:I,width:a,height:N}}))}});function xD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function gp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xD(Object(r),!0).forEach(function(s){S_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function S_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var aP=r1(sP,t1.bind(null,"img"));aP.imgSrc.required=!1;var g9=Ct(vr(gp(gp(gp(gp(gp(gp({},rP),iP),nP),aP),Iy),{},{align:k(ie),noBody:k(Ee,!1)})),UO),_9=ot({name:UO,functional:!0,props:g9,render:function(e,r){var s,g=r.props,T=r.data,I=r.slots,a=r.scopedSlots,N=g.imgSrc,H=g.imgLeft,K=g.imgRight,ee=g.imgStart,ue=g.imgEnd,Pe=g.imgBottom,xe=g.header,Ie=g.headerHtml,dt=g.footer,Le=g.footerHtml,De=g.align,Ye=g.textVariant,He=g.bgVariant,ht=g.borderVariant,St=a||{},st=I(),gt={},Tt=e(),at=e();if(N){var ft=e(T4,{props:mn(aP,g,$N.bind(null,"img"))});Pe?at=ft:Tt=ft}var gr=e(),xr=Dc(sh,St,st);(xr||xe||Ie)&&(gr=e(x4,{props:mn(iP,g),domProps:xr?{}:En(Ie,xe)},vo(sh,gt,St,st)));var Jt=vo(eo,gt,St,st);g.noBody||(Jt=e(b4,{props:mn(rP,g)},Jt),g.overlay&&N&&(Jt=e("div",{staticClass:"position-relative"},[Tt,Jt,at]),Tt=e(),at=e()));var Zt=e(),Et=Dc(hS,St,st);return(Et||dt||Le)&&(Zt=e(w4,{props:mn(nP,g),domProps:xr?{}:En(Le,dt)},vo(hS,gt,St,st))),e(g.tag,Sr(T,{staticClass:"card",class:(s={"flex-row":H||ee,"flex-row-reverse":(K||ue)&&!(H||ee)},S_(s,"text-".concat(De),De),S_(s,"bg-".concat(He),He),S_(s,"border-".concat(ht),ht),S_(s,"text-".concat(Ye),Ye),s)}),[Tt,gr,Jt,Zt,at])}});function y9(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wD(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function v9(t,e,r){return e&&wD(t.prototype,e),r&&wD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Jp="__bv__visibility_observer",b9=function(){function t(e,r){y9(this,t),this.el=e,this.callback=r.callback,this.margin=r.margin||0,this.once=r.once||!1,this.observer=null,this.visible=void 0,this.doneOnce=!1,this.createObserver()}return v9(t,[{key:"createObserver",value:function(){var r=this;if(this.observer&&this.stop(),!(this.doneOnce||!Mr(this.callback))){try{this.observer=new IntersectionObserver(this.handler.bind(this),{root:null,rootMargin:this.margin,threshold:0})}catch{this.doneOnce=!0,this.observer=void 0,this.callback(null);return}$O(function(){Vi(function(){r.observer&&r.observer.observe(r.el)})})}}},{key:"handler",value:function(r){var s=r?r[0]:{},g=Boolean(s.isIntersecting||s.intersectionRatio>0);g!==this.visible&&(this.visible=g,this.callback(g),this.once&&this.visible&&(this.doneOnce=!0,this.stop()))}},{key:"stop",value:function(){this.observer&&this.observer.disconnect(),this.observer=null}}]),t}(),E4=function(e){var r=e[Jp];r&&r.stop&&r.stop(),delete e[Jp]},S4=function(e,r){var s=r.value,g=r.modifiers,T={margin:"0px",once:!1,callback:s};Gr(g).forEach(function(I){gz.test(I)?T.margin="".concat(I,"px"):I.toLowerCase()==="once"&&(T.once=!0)}),E4(e),e[Jp]=new b9(e,T),e[Jp]._prevModifiers=hh(g)},x9=function(e,r,s){var g=r.value,T=r.oldValue,I=r.modifiers;I=hh(I),e&&(g!==T||!e[Jp]||!Ci(I,e[Jp]._prevModifiers))&&S4(e,{value:g,modifiers:I})},w9=function(e){E4(e)},lP={bind:S4,componentUpdated:x9,unbind:w9},Nb;function TD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function ix(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TD(Object(r),!0).forEach(function(s){Ip(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ip(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var V_="show",T9=dh+V_,O4=oi(c1,["blank"]),P4=Ct(ix(ix({},O4),{},Ip({blankHeight:k(dr),blankSrc:k(ie,null),blankWidth:k(dr),offset:k(dr,360)},V_,k(Ee,!1))),AF),A4=ot({name:AF,directives:{"b-visible":lP},props:P4,data:function(){return{isShown:this[V_]}},computed:{computedSrc:function(){var e=this.blankSrc;return!e||this.isShown?this.src:e},computedBlank:function(){return!(this.isShown||this.blankSrc)},computedWidth:function(){var e=this.width;return this.isShown?e:this.blankWidth||e},computedHeight:function(){var e=this.height;return this.isShown?e:this.blankHeight||e},computedSrcset:function(){var e=bi(this.srcset).filter($r).join(",");return e&&(!this.blankSrc||this.isShown)?e:null},computedSizes:function(){var e=bi(this.sizes).filter($r).join(",");return e&&(!this.blankSrc||this.isShown)?e:null}},watch:(Nb={},Ip(Nb,V_,function(t,e){if(t!==e){var r=QM?t:!0;this.isShown=r,t!==r&&this.$nextTick(this.updateShowProp)}}),Ip(Nb,"isShown",function(e,r){e!==r&&this.updateShowProp()}),Nb),mounted:function(){var e=this;this.$nextTick(function(){e.isShown=QM?e[V_]:!0})},methods:{updateShowProp:function(){this.$emit(T9,this.isShown)},doShow:function(e){var r=this;(e||e===null)&&!this.isShown&&Vi(function(){r.isShown=!0})}},render:function(e){var r=[];if(!this.isShown){var s;r.push({name:"b-visible",value:this.doShow,modifiers:(s={},Ip(s,"".concat(or(this.offset,0)),!0),Ip(s,"once",!0),s)})}return e(oP,{directives:r,props:ix(ix({},mn(O4,this.$props)),{},{src:this.computedSrc,blank:this.computedBlank,width:this.computedWidth,height:this.computedHeight,srcset:this.computedSrcset,sizes:this.computedSizes})})}});function ED(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function SD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ED(Object(r),!0).forEach(function(s){E9(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ED(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function E9(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var S9=Ct(vr(SD(SD({},oi(P4,Gr(c1))),oi(sP,["src","alt","width","height"]))),Vz),O9=ot({name:Vz,functional:!0,props:S9,render:function(e,r){var s=r.props,g=r.data,T="card-img";return s.top?T+="-top":s.right||s.end?T+="-right":s.bottom?T+="-bottom":(s.left||s.start)&&(T+="-left"),e(A4,Sr(g,{class:[T],props:oi(s,["left","right"])}))}}),P9=Ct({textTag:k(ie,"p")},Gz),A9=ot({name:Gz,functional:!0,props:P9,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.textTag,Sr(g,{staticClass:"card-text"}),T)}}),C9=Ct({columns:k(Ee,!1),deck:k(Ee,!1),tag:k(ie,"div")},Nz),M9=ot({name:Nz,functional:!0,props:C9,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.tag,Sr(g,{class:s.deck?"card-deck":s.columns?"card-columns":"card-group"}),T)}}),I9=wr({components:{BCard:_9,BCardHeader:x4,BCardBody:b4,BCardTitle:y4,BCardSubTitle:v4,BCardFooter:w4,BCardImg:T4,BCardImgLazy:O9,BCardText:A9,BCardGroup:M9}}),hy=function(){};function OD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function D9(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OD(Object(r),!0).forEach(function(s){R9(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function R9(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var dy=function(e,r,s){if(e=e?e.$el||e:null,!an(e)||Sq("observeDom"))return null;var g=new bW(function(T){for(var I=!1,a=0;a<T.length&&!I;a++){var N=T[a],H=N.type,K=N.target;(H==="characterData"&&K.nodeType===Node.TEXT_NODE||H==="attributes"||H==="childList"&&(N.addedNodes.length>0||N.removedNodes.length>0))&&(I=!0)}I&&r()});return g.observe(e,D9({childList:!0,subtree:!0},s)),g},_p;function PD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function eE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PD(Object(r),!0).forEach(function(s){O_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function O_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u1=Xn("value",{type:Uo,defaultValue:0}),L9=u1.mixin,B9=u1.props,tE=u1.prop,AD=u1.event,rE={next:{dirClass:"carousel-item-left",overlayClass:"carousel-item-next"},prev:{dirClass:"carousel-item-right",overlayClass:"carousel-item-prev"}},k9=600+50,z9=500,F9=40,CD={TOUCH:"touch",PEN:"pen"},MD={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend oTransitionEnd",transition:"transitionend"},N9=function(e){for(var r in MD)if(!Fn(e.style[r]))return MD[r];return null},$9=Ct(vr(eE(eE(eE({},Hi),B9),{},{background:k(ie),controls:k(Ee,!1),fade:k(Ee,!1),imgHeight:k(dr),imgWidth:k(dr),indicators:k(Ee,!1),interval:k(Uo,5e3),labelGotoSlide:k(ie,"Goto slide"),labelIndicators:k(ie,"Select a slide to display"),labelNext:k(ie,"Next slide"),labelPrev:k(ie,"Previous slide"),noAnimation:k(Ee,!1),noHoverPause:k(Ee,!1),noTouch:k(Ee,!1),noWrap:k(Ee,!1)})),qz),j9=ot({name:qz,mixins:[Ki,L9,Ur],provide:function(){var e=this;return{getBvCarousel:function(){return e}}},props:$9,data:function(){return{index:this[tE]||0,isSliding:!1,transitionEndEvent:null,slides:[],direction:null,isPaused:!(or(this.interval,0)>0),touchStartX:0,touchDeltaX:0}},computed:{numSlides:function(){return this.slides.length}},watch:(_p={},O_(_p,tE,function(t,e){t!==e&&this.setSlide(or(t,0))}),O_(_p,"interval",function(e,r){e!==r&&(e?(this.pause(!0),this.start(!1)):this.pause(!1))}),O_(_p,"isPaused",function(e,r){e!==r&&this.$emit(e?s7:y7)}),O_(_p,"index",function(e,r){e===r||this.isSliding||this.doSlide(e,r)}),_p),created:function(){this.$_interval=null,this.$_animationTimeout=null,this.$_touchTimeout=null,this.$_observer=null,this.isPaused=!(or(this.interval,0)>0)},mounted:function(){this.transitionEndEvent=N9(this.$el)||null,this.updateSlides(),this.setObserver(!0)},beforeDestroy:function(){this.clearInterval(),this.clearAnimationTimeout(),this.clearTouchTimeout(),this.setObserver(!1)},methods:{clearInterval:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){clearInterval(this.$_interval),this.$_interval=null}),clearAnimationTimeout:function(){clearTimeout(this.$_animationTimeout),this.$_animationTimeout=null},clearTouchTimeout:function(){clearTimeout(this.$_touchTimeout),this.$_touchTimeout=null},setObserver:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.$_observer&&this.$_observer.disconnect(),this.$_observer=null,e&&(this.$_observer=dy(this.$refs.inner,this.updateSlides.bind(this),{subtree:!1,childList:!0,attributes:!0,attributeFilter:["id"]}))},setSlide:function(e){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!(Xi&&document.visibilityState&&document.hidden)){var g=this.noWrap,T=this.numSlides;if(e=uy(e),T!==0){if(this.isSliding){this.$once(FT,function(){Vi(function(){return r.setSlide(e,s)})});return}this.direction=s,this.index=e>=T?g?T-1:0:e<0?g?0:T-1:e,g&&this.index!==e&&this.index!==this[tE]&&this.$emit(AD,this.index)}}},prev:function(){this.setSlide(this.index-1,"prev")},next:function(){this.setSlide(this.index+1,"next")},pause:function(e){e||(this.isPaused=!0),this.clearInterval()},start:function(e){e||(this.isPaused=!1),this.clearInterval(),this.interval&&this.numSlides>1&&(this.$_interval=setInterval(this.next,Li(1e3,this.interval)))},restart:function(){this.$el.contains(ah())||this.start()},doSlide:function(e,r){var s=this,g=Boolean(this.interval),T=this.calcDirection(this.direction,r,e),I=T.overlayClass,a=T.dirClass,N=this.slides[r],H=this.slides[e];if(!(!N||!H)){if(this.isSliding=!0,g&&this.pause(!1),this.$emit(m7,e),this.$emit(AD,this.index),this.noAnimation)ns(H,"active"),jo(N,"active"),this.isSliding=!1,this.$nextTick(function(){return s.$emit(FT,e)});else{ns(H,I),YO(H),ns(N,a),ns(H,a);var K=!1,ee=function Pe(){if(!K){if(K=!0,s.transitionEndEvent){var xe=s.transitionEndEvent.split(/\s+/);xe.forEach(function(Ie){return Tn(H,Ie,Pe,gi)})}s.clearAnimationTimeout(),jo(H,a),jo(H,I),ns(H,"active"),jo(N,"active"),jo(N,a),jo(N,I),yn(N,"aria-current","false"),yn(H,"aria-current","true"),yn(N,"aria-hidden","true"),yn(H,"aria-hidden","false"),s.isSliding=!1,s.direction=null,s.$nextTick(function(){return s.$emit(FT,e)})}};if(this.transitionEndEvent){var ue=this.transitionEndEvent.split(/\s+/);ue.forEach(function(Pe){return pn(H,Pe,ee,gi)})}this.$_animationTimeout=setTimeout(ee,k9)}g&&this.start(!1)}},updateSlides:function(){this.pause(!0),this.slides=ca(".carousel-item",this.$refs.inner);var e=this.slides.length,r=Li(0,Ec(uy(this.index),e-1));this.slides.forEach(function(s,g){var T=g+1;g===r?(ns(s,"active"),yn(s,"aria-current","true")):(jo(s,"active"),yn(s,"aria-current","false")),yn(s,"aria-posinset",String(T)),yn(s,"aria-setsize",String(e))}),this.setSlide(r),this.start(this.isPaused)},calcDirection:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return e?rE[e]:s>r?rE.next:rE.prev},handleClick:function(e,r){var s=e.keyCode;(e.type==="click"||s===Zl||s===zc)&&(ei(e),r())},handleSwipe:function(){var e=HN(this.touchDeltaX);if(!(e<=F9)){var r=e/this.touchDeltaX;this.touchDeltaX=0,r>0?this.prev():r<0&&this.next()}},touchStart:function(e){t_&&CD[e.pointerType.toUpperCase()]?this.touchStartX=e.clientX:t_||(this.touchStartX=e.touches[0].clientX)},touchMove:function(e){e.touches&&e.touches.length>1?this.touchDeltaX=0:this.touchDeltaX=e.touches[0].clientX-this.touchStartX},touchEnd:function(e){t_&&CD[e.pointerType.toUpperCase()]&&(this.touchDeltaX=e.clientX-this.touchStartX),this.handleSwipe(),this.pause(!1),this.clearTouchTimeout(),this.$_touchTimeout=setTimeout(this.start,z9+Li(1e3,this.interval))}},render:function(e){var r=this,s=this.indicators,g=this.background,T=this.noAnimation,I=this.noHoverPause,a=this.noTouch,N=this.index,H=this.isSliding,K=this.pause,ee=this.restart,ue=this.touchStart,Pe=this.touchEnd,xe=this.safeId("__BV_inner_"),Ie=e("div",{staticClass:"carousel-inner",attrs:{id:xe,role:"list"},ref:"inner"},[this.normalizeSlot()]),dt=e();if(this.controls){var Le=function(ht,St,st){var gt=function(at){H?ei(at,{propagation:!1}):r.handleClick(at,st)};return e("a",{staticClass:"carousel-control-".concat(ht),attrs:{href:"#",role:"button","aria-controls":xe,"aria-disabled":H?"true":null},on:{click:gt,keydown:gt}},[e("span",{staticClass:"carousel-control-".concat(ht,"-icon"),attrs:{"aria-hidden":"true"}}),e("span",{class:"sr-only"},[St])])};dt=[Le("prev",this.labelPrev,this.prev),Le("next",this.labelNext,this.next)]}var De=e("ol",{staticClass:"carousel-indicators",directives:[{name:"show",value:s}],attrs:{id:this.safeId("__BV_indicators_"),"aria-hidden":s?"false":"true","aria-label":this.labelIndicators,"aria-owns":xe}},this.slides.map(function(He,ht){var St=function(gt){r.handleClick(gt,function(){r.setSlide(ht)})};return e("li",{class:{active:ht===N},attrs:{role:"button",id:r.safeId("__BV_indicator_".concat(ht+1,"_")),tabindex:s?"0":"-1","aria-current":ht===N?"true":"false","aria-label":"".concat(r.labelGotoSlide," ").concat(ht+1),"aria-describedby":He.id||null,"aria-controls":xe},on:{click:St,keydown:St},key:"slide_".concat(ht)})})),Ye={mouseenter:I?hy:K,mouseleave:I?hy:ee,focusin:K,focusout:ee,keydown:function(ht){if(!/input|textarea/i.test(ht.target.tagName)){var St=ht.keyCode;(St===ol||St===Rc)&&(ei(ht),r[St===ol?"prev":"next"]())}}};return V0&&!a&&(t_?(Ye["&pointerdown"]=ue,Ye["&pointerup"]=Pe):(Ye["&touchstart"]=ue,Ye["&touchmove"]=this.touchMove,Ye["&touchend"]=Pe)),e("div",{staticClass:"carousel",class:{slide:!T,"carousel-fade":!T&&this.fade,"pointer-event":V0&&t_&&!a},style:{background:g},attrs:{role:"region",id:this.safeId(),"aria-busy":H?"true":"false"},on:Ye},[Ie,dt,De])}});function ID(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function U_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ID(Object(r),!0).forEach(function(s){V9(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ID(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function V9(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var C4={imgAlt:k(ie),imgBlank:k(Ee,!1),imgBlankColor:k(ie,"transparent"),imgHeight:k(dr),imgSrc:k(ie),imgWidth:k(dr)},U9=Ct(vr(U_(U_(U_({},Hi),C4),{},{background:k(ie),caption:k(ie),captionHtml:k(ie),captionTag:k(ie,"h3"),contentTag:k(ie,"div"),contentVisibleUp:k(ie),text:k(ie),textHtml:k(ie),textTag:k(ie,"p")})),Wz),G9=ot({name:Wz,mixins:[Ki,Ur],inject:{getBvCarousel:{default:function(){return function(){return{noTouch:!0}}}}},props:U9,computed:{bvCarousel:function(){return this.getBvCarousel()},contentClasses:function(){return[this.contentVisibleUp?"d-none":"",this.contentVisibleUp?"d-".concat(this.contentVisibleUp,"-block"):""]},computedWidth:function(){return this.imgWidth||this.bvCarousel.imgWidth||null},computedHeight:function(){return this.imgHeight||this.bvCarousel.imgHeight||null}},render:function(e){var r=this.normalizeSlot(j7);if(!r&&(this.imgSrc||this.imgBlank)){var s={};!this.bvCarousel.noTouch&&V0&&(s.dragstart=function(I){return ei(I,{propagation:!1})}),r=e(oP,{props:U_(U_({},mn(C4,this.$props,$N.bind(null,"img"))),{},{width:this.computedWidth,height:this.computedHeight,fluidGrow:!0,block:!0}),on:s})}var g=[this.caption||this.captionHtml?e(this.captionTag,{domProps:En(this.captionHtml,this.caption)}):!1,this.text||this.textHtml?e(this.textTag,{domProps:En(this.textHtml,this.text)}):!1,this.normalizeSlot()||!1],T=e();return g.some($r)&&(T=e(this.contentTag,{staticClass:"carousel-caption",class:this.contentClasses},g.map(function(I){return I||e()}))),e("div",{staticClass:"carousel-item",style:{background:this.background||this.bvCarousel.background||null},attrs:{id:this.safeId(),role:"listitem"}},[r,T])}}),H9=wr({components:{BCarousel:j9,BCarouselSlide:G9}}),iE="show",q9=function(e){Co(e,"height",0),Vi(function(){YO(e),Co(e,"height","".concat(e.scrollHeight,"px"))})},W9=function(e){e1(e,"height")},Z9=function(e){Co(e,"height","auto"),Co(e,"display","block"),Co(e,"height","".concat(Vd(e).height,"px")),YO(e),Co(e,"height",0)},X9=function(e){e1(e,"height")},K9={css:!0,enterClass:"",enterActiveClass:"collapsing",enterToClass:"collapse show",leaveClass:"collapse show",leaveActiveClass:"collapsing",leaveToClass:"collapse"},Y9={enter:q9,afterEnter:W9,leave:Z9,afterLeave:X9},J9={appear:k(Ee,!1)},Q9=ot({name:$q,functional:!0,props:J9,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e("transition",Sr(g,{props:K9,on:Y9},{props:s}),T)}}),$b;function DD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function nE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DD(Object(r),!0).forEach(function(s){wS(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function wS(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var eX=Wn(Ro,"toggle"),tX=Wn(Ro,"request-state"),RD=Cn(Ro,"accordion"),rX=Cn(Ro,"state"),iX=Cn(Ro,"sync-state"),h1=Xn("visible",{type:Ee,defaultValue:!1}),nX=h1.mixin,oX=h1.props,jb=h1.prop,sX=h1.event,aX=Ct(vr(nE(nE(nE({},Hi),oX),{},{accordion:k(ie),appear:k(Ee,!1),isNav:k(Ee,!1),tag:k(ie,"div")})),Ro),lX=ot({name:Ro,mixins:[Ki,nX,Ur,al],props:aX,data:function(){return{show:this[jb],transitioning:!1}},computed:{classObject:function(){var e=this.transitioning;return{"navbar-collapse":this.isNav,collapse:!e,show:this.show&&!e}},slotScope:function(){var e=this;return{visible:this.show,close:function(){e.show=!1}}}},watch:($b={},wS($b,jb,function(t){t!==this.show&&(this.show=t)}),wS($b,"show",function(e,r){e!==r&&this.emitState()}),$b),created:function(){this.show=this[jb]},mounted:function(){var e=this;this.show=this[jb],this.listenOnRoot(eX,this.handleToggleEvent),this.listenOnRoot(RD,this.handleAccordionEvent),this.isNav&&(this.setWindowEvents(!0),this.handleResize()),this.$nextTick(function(){e.emitState()}),this.listenOnRoot(tX,function(r){r===e.safeId()&&e.$nextTick(e.emitSync)})},updated:function(){this.emitSync()},deactivated:function(){this.isNav&&this.setWindowEvents(!1)},activated:function(){this.isNav&&this.setWindowEvents(!0),this.emitSync()},beforeDestroy:function(){this.show=!1,this.isNav&&Xi&&this.setWindowEvents(!1)},methods:{setWindowEvents:function(e){nl(e,window,"resize",this.handleResize,gi),nl(e,window,"orientationchange",this.handleResize,gi)},toggle:function(){this.show=!this.show},onEnter:function(){this.transitioning=!0,this.$emit(yo)},onAfterEnter:function(){this.transitioning=!1,this.$emit(os)},onLeave:function(){this.transitioning=!0,this.$emit(Cs)},onAfterLeave:function(){this.transitioning=!1,this.$emit(zn)},emitState:function(){var e=this.show,r=this.accordion,s=this.safeId();this.$emit(sX,e),this.emitOnRoot(rX,s,e),r&&e&&this.emitOnRoot(RD,s,r)},emitSync:function(){this.emitOnRoot(iX,this.safeId(),this.show)},checkDisplayBlock:function(){var e=this.$el,r=ly(e,iE);jo(e,iE);var s=ia(e).display==="block";return r&&ns(e,iE),s},clickHandler:function(e){var r=e.target;!this.isNav||!r||ia(this.$el).display!=="block"||(Pc(r,".nav-link,.dropdown-item")||Ms(".nav-link,.dropdown-item",r))&&!this.checkDisplayBlock()&&(this.show=!1)},handleToggleEvent:function(e){e===this.safeId()&&this.toggle()},handleAccordionEvent:function(e,r){var s=this.accordion,g=this.show;if(!(!s||s!==r)){var T=e===this.safeId();(T&&!g||!T&&g)&&this.toggle()}},handleResize:function(){this.show=ia(this.$el).display==="block"}},render:function(e){var r=this.appear,s=e(this.tag,{class:this.classObject,directives:[{name:"show",value:this.show}],attrs:{id:this.safeId()},on:{click:this.clickHandler}},this.normalizeSlot(eo,this.slotScope));return e(Q9,{props:{appear:r},on:{enter:this.onEnter,afterEnter:this.onAfterEnter,leave:this.onLeave,afterLeave:this.onAfterLeave}},[s])}}),jl=function(e,r){return cs?r.instance:e.context},TS="collapsed",ES="not-collapsed",d1="__BV_toggle",G_="".concat(d1,"_HANDLER__"),nx="".concat(d1,"_CLICK__"),ox="".concat(d1,"_STATE__"),Qp="".concat(d1,"_TARGETS__"),cX="false",uX="true",SS="aria-controls",OS="aria-expanded",PS="role",LD="tabindex",AS="overflow-anchor",hX=Wn(Ro,"toggle"),M4=Cn(Ro,"state"),I4=Cn(Ro,"sync-state"),dX=Wn(Ro,"request-state"),fX=[zc,Zl],D4=function(e){return!Vr(["button","a"],e.tagName.toLowerCase())},pX=function(e,r){var s=e.modifiers,g=e.arg,T=e.value,I=Gr(s||{});if(T=_i(T)?T.split(l0):T,Wl(r.tagName,"a")){var a=aa(r,"href")||"";VH.test(a)&&I.push(a.replace(jH,""))}return bi(g,T).forEach(function(N){return _i(N)&&I.push(N)}),I.filter(function(N,H,K){return N&&K.indexOf(N)===H})},R4=function(e){var r=e[nx];r&&(Tn(e,"click",r,Os),Tn(e,"keydown",r,Os)),e[nx]=null},mX=function(e,r){if(R4(e),r){var s=function(T){if(!(T.type==="keydown"&&!Vr(fX,T.keyCode))&&!Td(e)){var I=e[Qp]||[];I.forEach(function(a){Hl(r).$emit(hX,a)})}};e[nx]=s,pn(e,"click",s,Os),D4(e)&&pn(e,"keydown",s,Os)}},L4=function(e,r){e[G_]&&r&&Hl(r).$off([M4,I4],e[G_]),e[G_]=null},gX=function(e,r){if(L4(e,r),r){var s=function(T,I){Vr(e[Qp]||[],T)&&(e[ox]=I,B4(e,I))};e[G_]=s,Hl(r).$on([M4,I4],s)}},B4=function(e,r){r?(jo(e,TS),ns(e,ES),yn(e,OS,uX)):(jo(e,ES),ns(e,TS),yn(e,OS,cX))},Vb=function(e,r){e[r]=null,delete e[r]},oE=function(e,r,s){if(!(!Xi||!jl(s,r))){D4(e)&&($l(e,PS)||yn(e,PS,"button"),$l(e,LD)||yn(e,LD,"0")),B4(e,e[ox]);var g=pX(r,e);g.length>0?(yn(e,SS,g.join(" ")),Co(e,AS,"none")):(Nl(e,SS),e1(e,AS)),Vi(function(){mX(e,jl(s,r))}),Ci(g,e[Qp])||(e[Qp]=g,g.forEach(function(T){Hl(jl(s,r)).$emit(dX,T)}))}},k4={bind:function(e,r,s){e[ox]=!1,e[Qp]=[],gX(e,jl(s,r)),oE(e,r,s)},componentUpdated:oE,updated:oE,unbind:function(e,r,s){R4(e),L4(e,jl(s,r)),Vb(e,G_),Vb(e,nx),Vb(e,ox),Vb(e,Qp),jo(e,TS),jo(e,ES),Nl(e,OS),Nl(e,SS),Nl(e,PS),e1(e,AS)}},cP=wr({directives:{VBToggle:k4}}),z4=wr({components:{BCollapse:lX},plugins:{VBTogglePlugin:cP}});/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Dy=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",_X=function(){for(var t=["Edge","Trident","Firefox"],e=0;e<t.length;e+=1)if(Dy&&navigator.userAgent.indexOf(t[e])>=0)return 1;return 0}();function yX(t){var e=!1;return function(){e||(e=!0,window.Promise.resolve().then(function(){e=!1,t()}))}}function vX(t){var e=!1;return function(){e||(e=!0,setTimeout(function(){e=!1,t()},_X))}}var bX=Dy&&window.Promise,xX=bX?yX:vX;function F4(t){var e={};return t&&e.toString.call(t)==="[object Function]"}function Xd(t,e){if(t.nodeType!==1)return[];var r=t.ownerDocument.defaultView,s=r.getComputedStyle(t,null);return e?s[e]:s}function uP(t){return t.nodeName==="HTML"?t:t.parentNode||t.host}function Ry(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var e=Xd(t),r=e.overflow,s=e.overflowX,g=e.overflowY;return/(auto|scroll|overlay)/.test(r+g+s)?t:Ry(uP(t))}function N4(t){return t&&t.referenceNode?t.referenceNode:t}var BD=Dy&&!!(window.MSInputMethodContext&&document.documentMode),kD=Dy&&/MSIE 10/.test(navigator.userAgent);function hm(t){return t===11?BD:t===10?kD:BD||kD}function em(t){if(!t)return document.documentElement;for(var e=hm(10)?document.body:null,r=t.offsetParent||null;r===e&&t.nextElementSibling;)r=(t=t.nextElementSibling).offsetParent;var s=r&&r.nodeName;return!s||s==="BODY"||s==="HTML"?t?t.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(r.nodeName)!==-1&&Xd(r,"position")==="static"?em(r):r}function wX(t){var e=t.nodeName;return e==="BODY"?!1:e==="HTML"||em(t.firstElementChild)===t}function CS(t){return t.parentNode!==null?CS(t.parentNode):t}function sx(t,e){if(!t||!t.nodeType||!e||!e.nodeType)return document.documentElement;var r=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,s=r?t:e,g=r?e:t,T=document.createRange();T.setStart(s,0),T.setEnd(g,0);var I=T.commonAncestorContainer;if(t!==I&&e!==I||s.contains(g))return wX(I)?I:em(I);var a=CS(t);return a.host?sx(a.host,e):sx(t,CS(e).host)}function tm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",r=e==="top"?"scrollTop":"scrollLeft",s=t.nodeName;if(s==="BODY"||s==="HTML"){var g=t.ownerDocument.documentElement,T=t.ownerDocument.scrollingElement||g;return T[r]}return t[r]}function TX(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=tm(e,"top"),g=tm(e,"left"),T=r?-1:1;return t.top+=s*T,t.bottom+=s*T,t.left+=g*T,t.right+=g*T,t}function zD(t,e){var r=e==="x"?"Left":"Top",s=r==="Left"?"Right":"Bottom";return parseFloat(t["border"+r+"Width"])+parseFloat(t["border"+s+"Width"])}function FD(t,e,r,s){return Math.max(e["offset"+t],e["scroll"+t],r["client"+t],r["offset"+t],r["scroll"+t],hm(10)?parseInt(r["offset"+t])+parseInt(s["margin"+(t==="Height"?"Top":"Left")])+parseInt(s["margin"+(t==="Height"?"Bottom":"Right")]):0)}function $4(t){var e=t.body,r=t.documentElement,s=hm(10)&&getComputedStyle(r);return{height:FD("Height",e,r,s),width:FD("Width",e,r,s)}}var EX=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},SX=function(){function t(e,r){for(var s=0;s<r.length;s++){var g=r[s];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(e,g.key,g)}}return function(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),e}}(),rm=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},La=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t};function uh(t){return La({},t,{right:t.left+t.width,bottom:t.top+t.height})}function MS(t){var e={};try{if(hm(10)){e=t.getBoundingClientRect();var r=tm(t,"top"),s=tm(t,"left");e.top+=r,e.left+=s,e.bottom+=r,e.right+=s}else e=t.getBoundingClientRect()}catch{}var g={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},T=t.nodeName==="HTML"?$4(t.ownerDocument):{},I=T.width||t.clientWidth||g.width,a=T.height||t.clientHeight||g.height,N=t.offsetWidth-I,H=t.offsetHeight-a;if(N||H){var K=Xd(t);N-=zD(K,"x"),H-=zD(K,"y"),g.width-=N,g.height-=H}return uh(g)}function hP(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=hm(10),g=e.nodeName==="HTML",T=MS(t),I=MS(e),a=Ry(t),N=Xd(e),H=parseFloat(N.borderTopWidth),K=parseFloat(N.borderLeftWidth);r&&g&&(I.top=Math.max(I.top,0),I.left=Math.max(I.left,0));var ee=uh({top:T.top-I.top-H,left:T.left-I.left-K,width:T.width,height:T.height});if(ee.marginTop=0,ee.marginLeft=0,!s&&g){var ue=parseFloat(N.marginTop),Pe=parseFloat(N.marginLeft);ee.top-=H-ue,ee.bottom-=H-ue,ee.left-=K-Pe,ee.right-=K-Pe,ee.marginTop=ue,ee.marginLeft=Pe}return(s&&!r?e.contains(a):e===a&&a.nodeName!=="BODY")&&(ee=TX(ee,e)),ee}function OX(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=t.ownerDocument.documentElement,s=hP(t,r),g=Math.max(r.clientWidth,window.innerWidth||0),T=Math.max(r.clientHeight,window.innerHeight||0),I=e?0:tm(r),a=e?0:tm(r,"left"),N={top:I-s.top+s.marginTop,left:a-s.left+s.marginLeft,width:g,height:T};return uh(N)}function j4(t){var e=t.nodeName;if(e==="BODY"||e==="HTML")return!1;if(Xd(t,"position")==="fixed")return!0;var r=uP(t);return r?j4(r):!1}function V4(t){if(!t||!t.parentElement||hm())return document.documentElement;for(var e=t.parentElement;e&&Xd(e,"transform")==="none";)e=e.parentElement;return e||document.documentElement}function dP(t,e,r,s){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,T={top:0,left:0},I=g?V4(t):sx(t,N4(e));if(s==="viewport")T=OX(I,g);else{var a=void 0;s==="scrollParent"?(a=Ry(uP(e)),a.nodeName==="BODY"&&(a=t.ownerDocument.documentElement)):s==="window"?a=t.ownerDocument.documentElement:a=s;var N=hP(a,I,g);if(a.nodeName==="HTML"&&!j4(I)){var H=$4(t.ownerDocument),K=H.height,ee=H.width;T.top+=N.top-N.marginTop,T.bottom=K+N.top,T.left+=N.left-N.marginLeft,T.right=ee+N.left}else T=N}r=r||0;var ue=typeof r=="number";return T.left+=ue?r:r.left||0,T.top+=ue?r:r.top||0,T.right-=ue?r:r.right||0,T.bottom-=ue?r:r.bottom||0,T}function PX(t){var e=t.width,r=t.height;return e*r}function U4(t,e,r,s,g){var T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(t.indexOf("auto")===-1)return t;var I=dP(r,s,T,g),a={top:{width:I.width,height:e.top-I.top},right:{width:I.right-e.right,height:I.height},bottom:{width:I.width,height:I.bottom-e.bottom},left:{width:e.left-I.left,height:I.height}},N=Object.keys(a).map(function(ue){return La({key:ue},a[ue],{area:PX(a[ue])})}).sort(function(ue,Pe){return Pe.area-ue.area}),H=N.filter(function(ue){var Pe=ue.width,xe=ue.height;return Pe>=r.clientWidth&&xe>=r.clientHeight}),K=H.length>0?H[0].key:N[0].key,ee=t.split("-")[1];return K+(ee?"-"+ee:"")}function G4(t,e,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,g=s?V4(e):sx(e,N4(r));return hP(r,g,s)}function H4(t){var e=t.ownerDocument.defaultView,r=e.getComputedStyle(t),s=parseFloat(r.marginTop||0)+parseFloat(r.marginBottom||0),g=parseFloat(r.marginLeft||0)+parseFloat(r.marginRight||0),T={width:t.offsetWidth+g,height:t.offsetHeight+s};return T}function ax(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(r){return e[r]})}function q4(t,e,r){r=r.split("-")[0];var s=H4(t),g={width:s.width,height:s.height},T=["right","left"].indexOf(r)!==-1,I=T?"top":"left",a=T?"left":"top",N=T?"height":"width",H=T?"width":"height";return g[I]=e[I]+e[N]/2-s[N]/2,r===a?g[a]=e[a]-s[H]:g[a]=e[ax(a)],g}function Ly(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function AX(t,e,r){if(Array.prototype.findIndex)return t.findIndex(function(g){return g[e]===r});var s=Ly(t,function(g){return g[e]===r});return t.indexOf(s)}function W4(t,e,r){var s=r===void 0?t:t.slice(0,AX(t,"name",r));return s.forEach(function(g){g.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var T=g.function||g.fn;g.enabled&&F4(T)&&(e.offsets.popper=uh(e.offsets.popper),e.offsets.reference=uh(e.offsets.reference),e=T(e,g))}),e}function CX(){if(!this.state.isDestroyed){var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=G4(this.state,this.popper,this.reference,this.options.positionFixed),t.placement=U4(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.positionFixed=this.options.positionFixed,t.offsets.popper=q4(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",t=W4(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function Z4(t,e){return t.some(function(r){var s=r.name,g=r.enabled;return g&&s===e})}function fP(t){for(var e=[!1,"ms","Webkit","Moz","O"],r=t.charAt(0).toUpperCase()+t.slice(1),s=0;s<e.length;s++){var g=e[s],T=g?""+g+r:t;if(typeof document.body.style[T]<"u")return T}return null}function MX(){return this.state.isDestroyed=!0,Z4(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[fP("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function X4(t){var e=t.ownerDocument;return e?e.defaultView:window}function K4(t,e,r,s){var g=t.nodeName==="BODY",T=g?t.ownerDocument.defaultView:t;T.addEventListener(e,r,{passive:!0}),g||K4(Ry(T.parentNode),e,r,s),s.push(T)}function IX(t,e,r,s){r.updateBound=s,X4(t).addEventListener("resize",r.updateBound,{passive:!0});var g=Ry(t);return K4(g,"scroll",r.updateBound,r.scrollParents),r.scrollElement=g,r.eventsEnabled=!0,r}function DX(){this.state.eventsEnabled||(this.state=IX(this.reference,this.options,this.state,this.scheduleUpdate))}function RX(t,e){return X4(t).removeEventListener("resize",e.updateBound),e.scrollParents.forEach(function(r){r.removeEventListener("scroll",e.updateBound)}),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}function LX(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=RX(this.reference,this.state))}function pP(t){return t!==""&&!isNaN(parseFloat(t))&&isFinite(t)}function IS(t,e){Object.keys(e).forEach(function(r){var s="";["width","height","top","right","bottom","left"].indexOf(r)!==-1&&pP(e[r])&&(s="px"),t.style[r]=e[r]+s})}function BX(t,e){Object.keys(e).forEach(function(r){var s=e[r];s!==!1?t.setAttribute(r,e[r]):t.removeAttribute(r)})}function kX(t){return IS(t.instance.popper,t.styles),BX(t.instance.popper,t.attributes),t.arrowElement&&Object.keys(t.arrowStyles).length&&IS(t.arrowElement,t.arrowStyles),t}function zX(t,e,r,s,g){var T=G4(g,e,t,r.positionFixed),I=U4(r.placement,T,e,t,r.modifiers.flip.boundariesElement,r.modifiers.flip.padding);return e.setAttribute("x-placement",I),IS(e,{position:r.positionFixed?"fixed":"absolute"}),r}function FX(t,e){var r=t.offsets,s=r.popper,g=r.reference,T=Math.round,I=Math.floor,a=function(Le){return Le},N=T(g.width),H=T(s.width),K=["left","right"].indexOf(t.placement)!==-1,ee=t.placement.indexOf("-")!==-1,ue=N%2===H%2,Pe=N%2===1&&H%2===1,xe=e?K||ee||ue?T:I:a,Ie=e?T:a;return{left:xe(Pe&&!ee&&e?s.left-1:s.left),top:Ie(s.top),bottom:Ie(s.bottom),right:xe(s.right)}}var NX=Dy&&/Firefox/i.test(navigator.userAgent);function $X(t,e){var r=e.x,s=e.y,g=t.offsets.popper,T=Ly(t.instance.modifiers,function(Ye){return Ye.name==="applyStyle"}).gpuAcceleration;T!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var I=T!==void 0?T:e.gpuAcceleration,a=em(t.instance.popper),N=MS(a),H={position:g.position},K=FX(t,window.devicePixelRatio<2||!NX),ee=r==="bottom"?"top":"bottom",ue=s==="right"?"left":"right",Pe=fP("transform"),xe=void 0,Ie=void 0;if(ee==="bottom"?a.nodeName==="HTML"?Ie=-a.clientHeight+K.bottom:Ie=-N.height+K.bottom:Ie=K.top,ue==="right"?a.nodeName==="HTML"?xe=-a.clientWidth+K.right:xe=-N.width+K.right:xe=K.left,I&&Pe)H[Pe]="translate3d("+xe+"px, "+Ie+"px, 0)",H[ee]=0,H[ue]=0,H.willChange="transform";else{var dt=ee==="bottom"?-1:1,Le=ue==="right"?-1:1;H[ee]=Ie*dt,H[ue]=xe*Le,H.willChange=ee+", "+ue}var De={"x-placement":t.placement};return t.attributes=La({},De,t.attributes),t.styles=La({},H,t.styles),t.arrowStyles=La({},t.offsets.arrow,t.arrowStyles),t}function Y4(t,e,r){var s=Ly(t,function(a){var N=a.name;return N===e}),g=!!s&&t.some(function(a){return a.name===r&&a.enabled&&a.order<s.order});if(!g){var T="`"+e+"`",I="`"+r+"`";console.warn(I+" modifier is required by "+T+" modifier in order to work, be sure to include it before "+T+"!")}return g}function jX(t,e){var r;if(!Y4(t.instance.modifiers,"arrow","keepTogether"))return t;var s=e.element;if(typeof s=="string"){if(s=t.instance.popper.querySelector(s),!s)return t}else if(!t.instance.popper.contains(s))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var g=t.placement.split("-")[0],T=t.offsets,I=T.popper,a=T.reference,N=["left","right"].indexOf(g)!==-1,H=N?"height":"width",K=N?"Top":"Left",ee=K.toLowerCase(),ue=N?"left":"top",Pe=N?"bottom":"right",xe=H4(s)[H];a[Pe]-xe<I[ee]&&(t.offsets.popper[ee]-=I[ee]-(a[Pe]-xe)),a[ee]+xe>I[Pe]&&(t.offsets.popper[ee]+=a[ee]+xe-I[Pe]),t.offsets.popper=uh(t.offsets.popper);var Ie=a[ee]+a[H]/2-xe/2,dt=Xd(t.instance.popper),Le=parseFloat(dt["margin"+K]),De=parseFloat(dt["border"+K+"Width"]),Ye=Ie-t.offsets.popper[ee]-Le-De;return Ye=Math.max(Math.min(I[H]-xe,Ye),0),t.arrowElement=s,t.offsets.arrow=(r={},rm(r,ee,Math.round(Ye)),rm(r,ue,""),r),t}function VX(t){return t==="end"?"start":t==="start"?"end":t}var J4=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],sE=J4.slice(3);function ND(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=sE.indexOf(t),s=sE.slice(r+1).concat(sE.slice(0,r));return e?s.reverse():s}var aE={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function UX(t,e){if(Z4(t.instance.modifiers,"inner")||t.flipped&&t.placement===t.originalPlacement)return t;var r=dP(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement,t.positionFixed),s=t.placement.split("-")[0],g=ax(s),T=t.placement.split("-")[1]||"",I=[];switch(e.behavior){case aE.FLIP:I=[s,g];break;case aE.CLOCKWISE:I=ND(s);break;case aE.COUNTERCLOCKWISE:I=ND(s,!0);break;default:I=e.behavior}return I.forEach(function(a,N){if(s!==a||I.length===N+1)return t;s=t.placement.split("-")[0],g=ax(s);var H=t.offsets.popper,K=t.offsets.reference,ee=Math.floor,ue=s==="left"&&ee(H.right)>ee(K.left)||s==="right"&&ee(H.left)<ee(K.right)||s==="top"&&ee(H.bottom)>ee(K.top)||s==="bottom"&&ee(H.top)<ee(K.bottom),Pe=ee(H.left)<ee(r.left),xe=ee(H.right)>ee(r.right),Ie=ee(H.top)<ee(r.top),dt=ee(H.bottom)>ee(r.bottom),Le=s==="left"&&Pe||s==="right"&&xe||s==="top"&&Ie||s==="bottom"&&dt,De=["top","bottom"].indexOf(s)!==-1,Ye=!!e.flipVariations&&(De&&T==="start"&&Pe||De&&T==="end"&&xe||!De&&T==="start"&&Ie||!De&&T==="end"&&dt),He=!!e.flipVariationsByContent&&(De&&T==="start"&&xe||De&&T==="end"&&Pe||!De&&T==="start"&&dt||!De&&T==="end"&&Ie),ht=Ye||He;(ue||Le||ht)&&(t.flipped=!0,(ue||Le)&&(s=I[N+1]),ht&&(T=VX(T)),t.placement=s+(T?"-"+T:""),t.offsets.popper=La({},t.offsets.popper,q4(t.instance.popper,t.offsets.reference,t.placement)),t=W4(t.instance.modifiers,t,"flip"))}),t}function GX(t){var e=t.offsets,r=e.popper,s=e.reference,g=t.placement.split("-")[0],T=Math.floor,I=["top","bottom"].indexOf(g)!==-1,a=I?"right":"bottom",N=I?"left":"top",H=I?"width":"height";return r[a]<T(s[N])&&(t.offsets.popper[N]=T(s[N])-r[H]),r[N]>T(s[a])&&(t.offsets.popper[N]=T(s[a])),t}function HX(t,e,r,s){var g=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),T=+g[1],I=g[2];if(!T)return t;if(I.indexOf("%")===0){var a=void 0;switch(I){case"%p":a=r;break;case"%":case"%r":default:a=s}var N=uh(a);return N[e]/100*T}else if(I==="vh"||I==="vw"){var H=void 0;return I==="vh"?H=Math.max(document.documentElement.clientHeight,window.innerHeight||0):H=Math.max(document.documentElement.clientWidth,window.innerWidth||0),H/100*T}else return T}function qX(t,e,r,s){var g=[0,0],T=["right","left"].indexOf(s)!==-1,I=t.split(/(\+|\-)/).map(function(K){return K.trim()}),a=I.indexOf(Ly(I,function(K){return K.search(/,|\s/)!==-1}));I[a]&&I[a].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var N=/\s*,\s*|\s+/,H=a!==-1?[I.slice(0,a).concat([I[a].split(N)[0]]),[I[a].split(N)[1]].concat(I.slice(a+1))]:[I];return H=H.map(function(K,ee){var ue=(ee===1?!T:T)?"height":"width",Pe=!1;return K.reduce(function(xe,Ie){return xe[xe.length-1]===""&&["+","-"].indexOf(Ie)!==-1?(xe[xe.length-1]=Ie,Pe=!0,xe):Pe?(xe[xe.length-1]+=Ie,Pe=!1,xe):xe.concat(Ie)},[]).map(function(xe){return HX(xe,ue,e,r)})}),H.forEach(function(K,ee){K.forEach(function(ue,Pe){pP(ue)&&(g[ee]+=ue*(K[Pe-1]==="-"?-1:1))})}),g}function WX(t,e){var r=e.offset,s=t.placement,g=t.offsets,T=g.popper,I=g.reference,a=s.split("-")[0],N=void 0;return pP(+r)?N=[+r,0]:N=qX(r,T,I,a),a==="left"?(T.top+=N[0],T.left-=N[1]):a==="right"?(T.top+=N[0],T.left+=N[1]):a==="top"?(T.left+=N[0],T.top-=N[1]):a==="bottom"&&(T.left+=N[0],T.top+=N[1]),t.popper=T,t}function ZX(t,e){var r=e.boundariesElement||em(t.instance.popper);t.instance.reference===r&&(r=em(r));var s=fP("transform"),g=t.instance.popper.style,T=g.top,I=g.left,a=g[s];g.top="",g.left="",g[s]="";var N=dP(t.instance.popper,t.instance.reference,e.padding,r,t.positionFixed);g.top=T,g.left=I,g[s]=a,e.boundaries=N;var H=e.priority,K=t.offsets.popper,ee={primary:function(Pe){var xe=K[Pe];return K[Pe]<N[Pe]&&!e.escapeWithReference&&(xe=Math.max(K[Pe],N[Pe])),rm({},Pe,xe)},secondary:function(Pe){var xe=Pe==="right"?"left":"top",Ie=K[xe];return K[Pe]>N[Pe]&&!e.escapeWithReference&&(Ie=Math.min(K[xe],N[Pe]-(Pe==="right"?K.width:K.height))),rm({},xe,Ie)}};return H.forEach(function(ue){var Pe=["left","top"].indexOf(ue)!==-1?"primary":"secondary";K=La({},K,ee[Pe](ue))}),t.offsets.popper=K,t}function XX(t){var e=t.placement,r=e.split("-")[0],s=e.split("-")[1];if(s){var g=t.offsets,T=g.reference,I=g.popper,a=["bottom","top"].indexOf(r)!==-1,N=a?"left":"top",H=a?"width":"height",K={start:rm({},N,T[N]),end:rm({},N,T[N]+T[H]-I[H])};t.offsets.popper=La({},I,K[s])}return t}function KX(t){if(!Y4(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,r=Ly(t.instance.modifiers,function(s){return s.name==="preventOverflow"}).boundaries;if(e.bottom<r.top||e.left>r.right||e.top>r.bottom||e.right<r.left){if(t.hide===!0)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(t.hide===!1)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}function YX(t){var e=t.placement,r=e.split("-")[0],s=t.offsets,g=s.popper,T=s.reference,I=["left","right"].indexOf(r)!==-1,a=["top","left"].indexOf(r)===-1;return g[I?"left":"top"]=T[r]-(a?g[I?"width":"height"]:0),t.placement=ax(e),t.offsets.popper=uh(g),t}var JX={shift:{order:100,enabled:!0,fn:XX},offset:{order:200,enabled:!0,fn:WX,offset:0},preventOverflow:{order:300,enabled:!0,fn:ZX,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:GX},arrow:{order:500,enabled:!0,fn:jX,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:UX,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:YX},hide:{order:800,enabled:!0,fn:KX},computeStyle:{order:850,enabled:!0,fn:$X,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:kX,onLoad:zX,gpuAcceleration:void 0}},QX={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:JX},f1=function(){function t(e,r){var s=this,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};EX(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(s.update)},this.update=xX(this.update.bind(this)),this.options=La({},t.Defaults,g),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=r&&r.jquery?r[0]:r,this.options.modifiers={},Object.keys(La({},t.Defaults.modifiers,g.modifiers)).forEach(function(I){s.options.modifiers[I]=La({},t.Defaults.modifiers[I]||{},g.modifiers?g.modifiers[I]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(I){return La({name:I},s.options.modifiers[I])}).sort(function(I,a){return I.order-a.order}),this.modifiers.forEach(function(I){I.enabled&&F4(I.onLoad)&&I.onLoad(s.reference,s.popper,s.options,I,s.state)}),this.update();var T=this.options.eventsEnabled;T&&this.enableEventListeners(),this.state.eventsEnabled=T}return SX(t,[{key:"update",value:function(){return CX.call(this)}},{key:"destroy",value:function(){return MX.call(this)}},{key:"enableEventListeners",value:function(){return DX.call(this)}},{key:"disableEventListeners",value:function(){return LX.call(this)}}]),t}();f1.Utils=(typeof window<"u"?window:global).PopperUtils;f1.placements=J4;f1.Defaults=QX;const DS=f1;var eK="top-start",tK="top-end",rK="bottom-start",iK="bottom-end",nK="right-start",oK="left-start";function sK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $D(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function aK(t,e,r){return e&&$D(t.prototype,e),r&&$D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var Kd=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(sK(this,t),!e)throw new TypeError("Failed to construct '".concat(this.constructor.name,"'. 1 argument required, ").concat(arguments.length," given."));Oy(this,t.Defaults,this.constructor.Defaults,r,{type:e}),Jx(this,{type:Ia(),cancelable:Ia(),nativeEvent:Ia(),target:Ia(),relatedTarget:Ia(),vueTarget:Ia(),componentId:Ia()});var s=!1;this.preventDefault=function(){this.cancelable&&(s=!0)},VO(this,"defaultPrevented",{enumerable:!0,get:function(){return s}})}return aK(t,null,[{key:"Defaults",get:function(){return{type:"",cancelable:!0,nativeEvent:null,target:null,relatedTarget:null,vueTarget:null,componentId:null}}}]),t}(),lK=ot({data:function(){return{listenForClickOut:!1}},watch:{listenForClickOut:function(e,r){e!==r&&(Tn(this.clickOutElement,this.clickOutEventName,this._clickOutHandler,gi),e&&pn(this.clickOutElement,this.clickOutEventName,this._clickOutHandler,gi))}},beforeCreate:function(){this.clickOutElement=null,this.clickOutEventName=null},mounted:function(){this.clickOutElement||(this.clickOutElement=document),this.clickOutEventName||(this.clickOutEventName="click"),this.listenForClickOut&&pn(this.clickOutElement,this.clickOutEventName,this._clickOutHandler,gi)},beforeDestroy:function(){Tn(this.clickOutElement,this.clickOutEventName,this._clickOutHandler,gi)},methods:{isClickOut:function(e){return!qn(this.$el,e.target)},_clickOutHandler:function(e){this.clickOutHandler&&this.isClickOut(e)&&this.clickOutHandler(e)}}}),cK=ot({data:function(){return{listenForFocusIn:!1}},watch:{listenForFocusIn:function(e,r){e!==r&&(Tn(this.focusInElement,"focusin",this._focusInHandler,gi),e&&pn(this.focusInElement,"focusin",this._focusInHandler,gi))}},beforeCreate:function(){this.focusInElement=null},mounted:function(){this.focusInElement||(this.focusInElement=document),this.listenForFocusIn&&pn(this.focusInElement,"focusin",this._focusInHandler,gi)},beforeDestroy:function(){Tn(this.focusInElement,"focusin",this._focusInHandler,gi)},methods:{_focusInHandler:function(e){this.focusInHandler&&this.focusInHandler(e)}}}),fy=null;cs&&(fy=new WeakMap);var uK=function(e,r){!cs||fy.set(e,r)},hK=function(e){!cs||fy.delete(e)},dK=function(e){if(!cs)return e.__vue__;for(var r=e;r;){if(fy.has(r))return fy.get(r);r=r.parentNode}return null};function jD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function VD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jD(Object(r),!0).forEach(function(s){fK(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var UD=Cn(Nd,os),pK=Cn(Nd,zn),mK=".dropdown form",gK=[".dropdown-item",".b-dropdown-form"].map(function(t){return"".concat(t,":not(.disabled):not([disabled])")}).join(", "),_K=function(e){return(e||[]).filter(il)},p1=Ct(vr(VD(VD({},Hi),{},{boundary:k([Yu,ie],"scrollParent"),disabled:k(Ee,!1),dropleft:k(Ee,!1),dropright:k(Ee,!1),dropup:k(Ee,!1),noFlip:k(Ee,!1),offset:k(dr,0),popperOpts:k(Zn,{}),right:k(Ee,!1)})),Nd),mP=ot({mixins:[Ki,al,lK,cK],provide:function(){var e=this;return{getBvDropdown:function(){return e}}},inject:{getBvNavbar:{default:function(){return function(){return null}}}},props:p1,data:function(){return{visible:!1,visibleChangePrevented:!1}},computed:{bvNavbar:function(){return this.getBvNavbar()},inNavbar:function(){return!fn(this.bvNavbar)},toggler:function(){var e=this.$refs.toggle;return e?e.$el||e:null},directionClass:function(){return this.dropup?"dropup":this.dropright?"dropright":this.dropleft?"dropleft":""},boundaryClass:function(){return this.boundary!=="scrollParent"&&!this.inNavbar?"position-static":""},hideDelay:function(){return this.inNavbar?V0?300:50:0}},watch:{visible:function(e,r){if(this.visibleChangePrevented){this.visibleChangePrevented=!1;return}if(e!==r){var s=e?yo:Cs,g=new Kd(s,{cancelable:!0,vueTarget:this,target:this.$refs.menu,relatedTarget:null,componentId:this.safeId?this.safeId():this.id||null});if(this.emitEvent(g),g.defaultPrevented){this.visibleChangePrevented=!0,this.visible=r,this.$off(zn,this.focusToggler);return}e?this.showMenu():this.hideMenu()}},disabled:function(e,r){e!==r&&e&&this.visible&&(this.visible=!1)}},created:function(){this.$_popper=null,this.$_hideTimeout=null},deactivated:function(){this.visible=!1,this.whileOpenListen(!1),this.destroyPopper()},mounted:function(){uK(this.$el,this)},beforeDestroy:function(){this.visible=!1,this.whileOpenListen(!1),this.destroyPopper(),this.clearHideTimeout(),hK(this.$el)},methods:{emitEvent:function(e){var r=e.type;this.emitOnRoot(Cn(Nd,r),e),this.$emit(r,e)},showMenu:function(){var e=this;if(!this.disabled){if(!this.inNavbar)if(typeof DS>"u")ao("Popper.js not found. Falling back to CSS positioning",Nd);else{var r=this.dropup&&this.right||this.split?this.$el:this.$refs.toggle;r=r.$el||r,this.createPopper(r)}this.emitOnRoot(UD,this),this.whileOpenListen(!0),this.$nextTick(function(){e.focusMenu(),e.$emit(os)})}},hideMenu:function(){this.whileOpenListen(!1),this.emitOnRoot(pK,this),this.$emit(zn),this.destroyPopper()},createPopper:function(e){this.destroyPopper(),this.$_popper=new DS(e,this.$refs.menu,this.getPopperConfig())},destroyPopper:function(){this.$_popper&&this.$_popper.destroy(),this.$_popper=null},updatePopper:function(){try{this.$_popper.scheduleUpdate()}catch{}},clearHideTimeout:function(){clearTimeout(this.$_hideTimeout),this.$_hideTimeout=null},getPopperConfig:function(){var e=rK;this.dropup?e=this.right?tK:eK:this.dropright?e=nK:this.dropleft?e=oK:this.right&&(e=iK);var r={placement:e,modifiers:{offset:{offset:this.offset||0},flip:{enabled:!this.noFlip}}},s=this.boundary;return s&&(r.modifiers.preventOverflow={boundariesElement:s}),yq(r,this.popperOpts||{})},whileOpenListen:function(e){this.listenForClickOut=e,this.listenForFocusIn=e;var r=e?"listenOnRoot":"listenOffRoot";this[r](UD,this.rootCloseListener)},rootCloseListener:function(e){e!==this&&(this.visible=!1)},show:function(){var e=this;this.disabled||Vi(function(){e.visible=!0})},hide:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.disabled||(this.visible=!1,e&&this.$once(zn,this.focusToggler))},toggle:function(e){e=e||{};var r=e,s=r.type,g=r.keyCode;if(!(s!=="click"&&!(s==="keydown"&&[zc,Zl,as].indexOf(g)!==-1))){if(this.disabled){this.visible=!1;return}this.$emit(AN,e),ei(e),this.visible?this.hide(!0):this.show()}},onMousedown:function(e){ei(e,{propagation:!1})},onKeydown:function(e){var r=e.keyCode;r===QO?this.onEsc(e):r===as?this.focusNext(e,!1):r===Is&&this.focusNext(e,!0)},onEsc:function(e){this.visible&&(this.visible=!1,ei(e),this.$once(zn,this.focusToggler))},onSplitClick:function(e){if(this.disabled){this.visible=!1;return}this.$emit(Ba,e)},hideHandler:function(e){var r=this,s=e.target;this.visible&&!qn(this.$refs.menu,s)&&!qn(this.toggler,s)&&(this.clearHideTimeout(),this.$_hideTimeout=setTimeout(function(){return r.hide()},this.hideDelay))},clickOutHandler:function(e){this.hideHandler(e)},focusInHandler:function(e){this.hideHandler(e)},focusNext:function(e,r){var s=this,g=e.target;!this.visible||e&&Ms(mK,g)||(ei(e),this.$nextTick(function(){var T=s.getItems();if(!(T.length<1)){var I=T.indexOf(g);r&&I>0?I--:!r&&I<T.length-1&&I++,I<0&&(I=0),s.focusItem(I,T)}}))},focusItem:function(e,r){var s=r.find(function(g,T){return T===e});ii(s)},getItems:function(){return _K(ca(gK,this.$refs.menu))},focusMenu:function(){ii(this.$refs.menu)},focusToggler:function(){var e=this;this.$nextTick(function(){ii(e.toggler)})}}});function GD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function vc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GD(Object(r),!0).forEach(function(s){yK(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function yK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Q4=Ct(vr(vc(vc(vc({},Hi),p1),{},{block:k(Ee,!1),html:k(ie),lazy:k(Ee,!1),menuClass:k(Nr),noCaret:k(Ee,!1),role:k(ie,"menu"),size:k(ie),split:k(Ee,!1),splitButtonType:k(ie,"button",function(t){return Vr(["button","submit","reset"],t)}),splitClass:k(Nr),splitHref:k(ie),splitTo:k(RN),splitVariant:k(ie),text:k(ie),toggleAttrs:k(Zn,{}),toggleClass:k(Nr),toggleTag:k(ie,"button"),toggleText:k(ie,"Toggle dropdown"),variant:k(ie,"secondary")})),Nd),HD=ot({name:Nd,mixins:[Ki,mP,Ur],props:Q4,computed:{dropdownClasses:function(){var e=this.block,r=this.split;return[this.directionClass,this.boundaryClass,{show:this.visible,"btn-group":r||!e,"d-flex":e&&r}]},menuClasses:function(){return[this.menuClass,{"dropdown-menu-right":this.right,show:this.visible}]},toggleClasses:function(){var e=this.split;return[this.toggleClass,{"dropdown-toggle-split":e,"dropdown-toggle-no-caret":this.noCaret&&!e}]}},render:function(e){var r=this.visible,s=this.variant,g=this.size,T=this.block,I=this.disabled,a=this.split,N=this.role,H=this.hide,K=this.toggle,ee={variant:s,size:g,block:T,disabled:I},ue=this.normalizeSlot(Ic),Pe=this.hasNormalizedSlot(Ic)?{}:En(this.html,this.text),xe=e();if(a){var Ie=this.splitTo,dt=this.splitHref,Le=this.splitButtonType,De=vc(vc({},ee),{},{variant:this.splitVariant||s});Ie?De.to=Ie:dt?De.href=dt:Le&&(De.type=Le),xe=e(Ds,{class:this.splitClass,attrs:{id:this.safeId("_BV_button_")},props:De,domProps:Pe,on:{click:this.onSplitClick},ref:"button"},ue),ue=[e("span",{class:["sr-only"]},[this.toggleText])],Pe={}}var Ye=["menu","listbox","tree","grid","dialog"],He=e(Ds,{staticClass:"dropdown-toggle",class:this.toggleClasses,attrs:vc(vc({},this.toggleAttrs),{},{id:this.safeId("_BV_toggle_"),"aria-haspopup":Ye.includes(N)?N:"false","aria-expanded":Lr(r)}),props:vc(vc({},ee),{},{tag:this.toggleTag,block:T&&!a}),domProps:Pe,on:{mousedown:this.onMousedown,click:K,keydown:K},ref:"toggle"},ue),ht=e("ul",{staticClass:"dropdown-menu",class:this.menuClasses,attrs:{role:N,tabindex:"-1","aria-labelledby":this.safeId(a?"_BV_button_":"_BV_toggle_")},on:{keydown:this.onKeydown},ref:"menu"},[!this.lazy||r?this.normalizeSlot(eo,{hide:H}):e()]);return e("div",{staticClass:"dropdown b-dropdown",class:this.dropdownClasses,attrs:{id:this.safeId()}},[xe,He,ht])}});function qD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function lx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qD(Object(r),!0).forEach(function(s){e5(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function e5(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var t5=oi(ll,["event","routerTag"]),vK=Ct(vr(lx(lx({},t5),{},{linkClass:k(Nr),variant:k(ie)})),eF),WD=ot({name:eF,mixins:[lo,Ur],inject:{getBvDropdown:{default:function(){return function(){return null}}}},inheritAttrs:!1,props:vK,computed:{bvDropdown:function(){return this.getBvDropdown()},computedAttrs:function(){return lx(lx({},this.bvAttrs),{},{role:"menuitem"})}},methods:{closeDropdown:function(){var e=this;Vi(function(){e.bvDropdown&&e.bvDropdown.hide(!0)})},onClick:function(e){this.$emit(Ba,e),this.closeDropdown()}},render:function(e){var r=this.linkClass,s=this.variant,g=this.active,T=this.disabled,I=this.onClick,a=this.bvAttrs;return e("li",{class:a.class,style:a.style,attrs:{role:"presentation"}},[e(ks,{staticClass:"dropdown-item",class:[r,e5({},"text-".concat(s),s&&!(g||T))],props:mn(t5,this.$props),attrs:this.computedAttrs,on:{click:I},ref:"item"},this.normalizeSlot())])}});function ZD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function XD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZD(Object(r),!0).forEach(function(s){RS(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function RS(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bK=Ct({active:k(Ee,!1),activeClass:k(ie,"active"),buttonClass:k(Nr),disabled:k(Ee,!1),variant:k(ie)},tF),Ub=ot({name:tF,mixins:[lo,Ur],inject:{getBvDropdown:{default:function(){return function(){return null}}}},inheritAttrs:!1,props:bK,computed:{bvDropdown:function(){return this.getBvDropdown()},computedAttrs:function(){return XD(XD({},this.bvAttrs),{},{role:"menuitem",type:"button",disabled:this.disabled})}},methods:{closeDropdown:function(){this.bvDropdown&&this.bvDropdown.hide(!0)},onClick:function(e){this.$emit(Ba,e),this.closeDropdown()}},render:function(e){var r,s=this.active,g=this.variant,T=this.bvAttrs;return e("li",{class:T.class,style:T.style,attrs:{role:"presentation"}},[e("button",{staticClass:"dropdown-item",class:[this.buttonClass,(r={},RS(r,this.activeClass,s),RS(r,"text-".concat(g),g&&!(s||this.disabled)),r)],attrs:this.computedAttrs,on:{click:this.onClick},ref:"button"},this.normalizeSlot())])}});function KD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function YD(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KD(Object(r),!0).forEach(function(s){r5(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function r5(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var xK=Ct({id:k(ie),tag:k(ie,"header"),variant:k(ie)},Qz),JD=ot({name:Qz,functional:!0,props:xK,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.tag,a=s.variant;return e("li",Sr(oi(g,["attrs"]),{attrs:{role:"presentation"}}),[e(I,{staticClass:"dropdown-header",class:r5({},"text-".concat(a),a),attrs:YD(YD({},g.attrs||{}),{},{id:s.id||null,role:Wl(I,"header")?null:"heading"}),ref:"header"},T)])}});function QD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function eR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QD(Object(r),!0).forEach(function(s){wK(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function wK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var TK=Ct({tag:k(ie,"hr")},Kz),tR=ot({name:Kz,functional:!0,props:TK,render:function(e,r){var s=r.props,g=r.data;return e("li",Sr(oi(g,["attrs"]),{attrs:{role:"presentation"}}),[e(s.tag,{staticClass:"dropdown-divider",attrs:eR(eR({},g.attrs||{}),{},{role:"separator","aria-orientation":"horizontal"}),ref:"divider"})])}}),gP=Ct({id:k(ie),inline:k(Ee,!1),novalidate:k(Ee,!1),validated:k(Ee,!1)},nF),_P=ot({name:nF,functional:!0,props:gP,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e("form",Sr(g,{class:{"form-inline":s.inline,"was-validated":s.validated},attrs:{id:s.id,novalidate:s.novalidate}}),T)}});function rR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function cx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rR(Object(r),!0).forEach(function(s){EK(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function EK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var SK=Ct(vr(cx(cx({},gP),{},{disabled:k(Ee,!1),formClass:k(Nr)})),Yz),iR=ot({name:Yz,functional:!0,props:SK,render:function(e,r){var s=r.props,g=r.data,T=r.listeners,I=r.children;return e("li",Sr(oi(g,["attrs","on"]),{attrs:{role:"presentation"}}),[e(_P,{staticClass:"b-dropdown-form",class:[s.formClass,{disabled:s.disabled}],props:s,attrs:cx(cx({},g.attrs||{}),{},{disabled:s.disabled,tabindex:s.disabled?null:"-1"}),on:T,ref:"form"},I)])}});function OK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var PK=Ct({tag:k(ie,"p"),textClass:k(Nr),variant:k(ie)},rF),nR=ot({name:rF,functional:!0,props:PK,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.tag,a=s.textClass,N=s.variant;return e("li",Sr(oi(g,["attrs"]),{attrs:{role:"presentation"}}),[e(I,{staticClass:"b-dropdown-text",class:[a,OK({},"text-".concat(N),N)],props:s,attrs:g.attrs||{},ref:"text"},T)])}});function oR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function sR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oR(Object(r),!0).forEach(function(s){i5(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function i5(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var AK=Ct({ariaDescribedby:k(ie),header:k(ie),headerClasses:k(Nr),headerTag:k(ie,"header"),headerVariant:k(ie),id:k(ie)},Jz),aR=ot({name:Jz,functional:!0,props:AK,render:function(e,r){var s=r.props,g=r.data,T=r.slots,I=r.scopedSlots,a=s.id,N=s.variant,H=s.header,K=s.headerTag,ee=T(),ue=I||{},Pe={},xe=a?"_bv_".concat(a,"_group_dd_header"):null,Ie=e();return(Dc(sh,ue,ee)||H)&&(Ie=e(K,{staticClass:"dropdown-header",class:[s.headerClasses,i5({},"text-".concat(N),N)],attrs:{id:xe,role:Wl(K,"header")?null:"heading"}},vo(sh,Pe,ue,ee)||H)),e("li",Sr(oi(g,["attrs"]),{attrs:{role:"presentation"}}),[Ie,e("ul",{staticClass:"list-unstyled",attrs:sR(sR({},g.attrs||{}),{},{id:a,role:"group","aria-describedby":[xe,s.ariaDescribedBy].filter($r).join(" ").trim()||null})},vo(eo,Pe,ue,ee))])}}),yP=wr({components:{BDropdown:HD,BDd:HD,BDropdownItem:WD,BDdItem:WD,BDropdownItemButton:Ub,BDropdownItemBtn:Ub,BDdItemButton:Ub,BDdItemBtn:Ub,BDropdownHeader:JD,BDdHeader:JD,BDropdownDivider:tR,BDdDivider:tR,BDropdownForm:iR,BDdForm:iR,BDropdownText:nR,BDdText:nR,BDropdownGroup:aR,BDdGroup:aR}});function CK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var MK=["iframe","embed","video","object","img","b-img","b-img-lazy"],IK=Ct({aspect:k(ie,"16by9"),tag:k(ie,"div"),type:k(ie,"iframe",function(t){return Vr(MK,t)})},iF),DK=ot({name:iF,functional:!0,props:IK,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.aspect;return e(s.tag,{staticClass:"embed-responsive",class:CK({},"embed-responsive-".concat(I),I),ref:g.ref},[e(s.type,Sr(oi(g,["ref"]),{staticClass:"embed-responsive-item"}),T)])}}),RK=wr({components:{BEmbed:DK}}),LK='Setting prop "options" to an object is deprecated. Use the array format instead.',By=Ct({disabledField:k(ie,"disabled"),htmlField:k(ie,"html"),options:k(w7,[]),textField:k(ie,"text"),valueField:k(ie,"value")},"formOptionControls"),m1=ot({props:By,computed:{formOptions:function(){return this.normalizeOptions(this.options)}},methods:{normalizeOption:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(Go(e)){var s=Io(e,this.valueField),g=Io(e,this.textField);return{value:Fn(s)?r||g:s,text:tD(String(Fn(g)?r:g)),html:Io(e,this.htmlField),disabled:Boolean(Io(e,this.disabledField))}}return{value:r||e,text:tD(String(e)),disabled:!1}},normalizeOptions:function(e){var r=this;return Ni(e)?e.map(function(s){return r.normalizeOption(s)}):Go(e)?(ao(LK,this.$options.name),Gr(e).map(function(s){return r.normalizeOption(e[s]||{},s)})):[]}}});function lR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function cR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lR(Object(r),!0).forEach(function(s){BK(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function BK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kK=Ct(vr(cR(cR({},By),{},{id:k(ie,void 0,!0)})),aF),uR=ot({name:aF,mixins:[m1,Ur],props:kK,render:function(e){var r=this.id,s=this.formOptions.map(function(g,T){var I=g.value,a=g.text,N=g.html,H=g.disabled;return e("option",{attrs:{value:I,disabled:H},domProps:En(N,a),key:"option_".concat(T)})});return e("datalist",{attrs:{id:r}},[s,this.normalizeSlot()])}});function zK(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var FK=Ct({id:k(ie),inline:k(Ee,!1),tag:k(ie,"small"),textVariant:k(ie,"muted")},wF),ux=ot({name:wF,functional:!0,props:FK,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.tag,Sr(g,{class:zK({"form-text":!s.inline},"text-".concat(s.textVariant),s.textVariant),attrs:{id:s.id}}),T)}}),NK=Ct({ariaLive:k(ie),forceShow:k(Ee,!1),id:k(ie),role:k(ie),state:k(Ee,null),tag:k(ie,"div"),tooltip:k(Ee,!1)},hF),hx=ot({name:hF,functional:!0,props:NK,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.tooltip,a=s.ariaLive,N=s.forceShow===!0||s.state===!1;return e(s.tag,Sr(g,{class:{"d-block":N,"invalid-feedback":!I,"invalid-tooltip":I},attrs:{id:s.id||null,role:s.role||null,"aria-live":a||null,"aria-atomic":a?"true":null}}),T)}}),$K=Ct({ariaLive:k(ie),forceShow:k(Ee,!1),id:k(ie),role:k(ie),state:k(Ee,null),tag:k(ie,"div"),tooltip:k(Ee,!1)},SF),n5=ot({name:SF,functional:!0,props:$K,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.tooltip,a=s.ariaLive,N=s.forceShow===!0||s.state===!0;return e(s.tag,Sr(g,{class:{"d-block":N,"valid-feedback":!I,"valid-tooltip":I},attrs:{id:s.id||null,role:s.role||null,"aria-live":a||null,"aria-atomic":a?"true":null}}),T)}}),jK=Ct({tag:k(ie,"div")},mF),dx=ot({name:mF,functional:!0,props:jK,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.tag,Sr(g,{staticClass:"form-row"}),T)}}),VK=wr({components:{BForm:_P,BFormDatalist:uR,BDatalist:uR,BFormText:ux,BFormInvalidFeedback:hx,BFormFeedback:hx,BFormValidFeedback:n5,BFormRow:dx}}),hR=function(e,r){for(var s=0;s<e.length;s++)if(Ci(e[s],r))return s;return-1},dR="input, textarea, select",cl=Ct({autofocus:k(Ee,!1),disabled:k(Ee,!1),form:k(ie),id:k(ie),name:k(ie),required:k(Ee,!1)},"formControls"),Yd=ot({props:cl,mounted:function(){this.handleAutofocus()},activated:function(){this.handleAutofocus()},methods:{handleAutofocus:function(){var e=this;this.$nextTick(function(){Vi(function(){var r=e.$el;e.autofocus&&il(r)&&(Pc(r,dR)||(r=sa(dR,r)),ii(r))})})}}}),ky=Ct({plain:k(Ee,!1)},"formControls"),g1=ot({props:ky,computed:{custom:function(){return!this.plain}}}),ul=Ct({size:k(ie)},"formControls"),Nc=ot({props:ul,computed:{sizeFormClass:function(){return[this.size?"form-control-".concat(this.size):null]}}}),hl=Ct({state:k(Ee,null)},"formState"),Xl=ot({props:hl,computed:{computedState:function(){return Da(this.state)?this.state:null},stateClass:function(){var e=this.computedState;return e===!0?"is-valid":e===!1?"is-invalid":null},computedAriaInvalid:function(){var e=Bn(this).ariaInvalid;return e===!0||e==="true"||e===""||this.computedState===!1?"true":e}}}),Gb,Fu;function fR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Ll(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fR(Object(r),!0).forEach(function(s){bs(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function bs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _1=Xn("checked",{defaultValue:null}),UK=_1.mixin,GK=_1.props,s_=_1.prop,vP=_1.event,bP=Ct(vr(Ll(Ll(Ll(Ll(Ll(Ll(Ll({},Hi),GK),cl),ul),hl),ky),{},{ariaLabel:k(ie),ariaLabelledby:k(ie),button:k(Ee,!1),buttonVariant:k(ie),inline:k(Ee,!1),value:k(Yp)})),"formRadioCheckControls"),o5=ot({mixins:[lo,Ki,UK,Ur,Yd,Nc,Xl,g1],inheritAttrs:!1,props:bP,data:function(){return{localChecked:this.isGroup?this.bvGroup[s_]:this[s_],hasFocus:!1}},computed:{computedLocalChecked:{get:function(){return this.isGroup?this.bvGroup.localChecked:this.localChecked},set:function(e){this.isGroup?this.bvGroup.localChecked=e:this.localChecked=e}},isChecked:function(){return Ci(this.value,this.computedLocalChecked)},isRadio:function(){return!0},isGroup:function(){return!!this.bvGroup},isBtnMode:function(){return this.isGroup?this.bvGroup.buttons:this.button},isPlain:function(){return this.isBtnMode?!1:this.isGroup?this.bvGroup.plain:this.plain},isCustom:function(){return this.isBtnMode?!1:!this.isPlain},isSwitch:function(){return this.isBtnMode||this.isRadio||this.isPlain?!1:this.isGroup?this.bvGroup.switches:this.switch},isInline:function(){return this.isGroup?this.bvGroup.inline:this.inline},isDisabled:function(){return this.isGroup?this.bvGroup.disabled||this.disabled:this.disabled},isRequired:function(){return this.computedName&&(this.isGroup?this.bvGroup.required:this.required)},computedName:function(){return(this.isGroup?this.bvGroup.groupName:this.name)||null},computedForm:function(){return(this.isGroup?this.bvGroup.form:this.form)||null},computedSize:function(){return(this.isGroup?this.bvGroup.size:this.size)||""},computedState:function(){return this.isGroup?this.bvGroup.computedState:Da(this.state)?this.state:null},computedButtonVariant:function(){var e=this.buttonVariant;return e||(this.isGroup&&this.bvGroup.buttonVariant?this.bvGroup.buttonVariant:"secondary")},buttonClasses:function(){var e,r=this.computedSize;return["btn","btn-".concat(this.computedButtonVariant),(e={},bs(e,"btn-".concat(r),r),bs(e,"disabled",this.isDisabled),bs(e,"active",this.isChecked),bs(e,"focus",this.hasFocus),e)]},computedAttrs:function(){var e=this.isDisabled,r=this.isRequired;return Ll(Ll({},this.bvAttrs),{},{id:this.safeId(),type:this.isRadio?"radio":"checkbox",name:this.computedName,form:this.computedForm,disabled:e,required:r,"aria-required":r||null,"aria-label":this.ariaLabel||null,"aria-labelledby":this.ariaLabelledby||null})}},watch:(Gb={},bs(Gb,s_,function(){this["".concat(s_,"Watcher")].apply(this,arguments)}),bs(Gb,"computedLocalChecked",function(){this.computedLocalCheckedWatcher.apply(this,arguments)}),Gb),methods:(Fu={},bs(Fu,"".concat(s_,"Watcher"),function(e){Ci(e,this.computedLocalChecked)||(this.computedLocalChecked=e)}),bs(Fu,"computedLocalCheckedWatcher",function(e,r){Ci(e,r)||this.$emit(vP,e)}),bs(Fu,"handleChange",function(e){var r=this,s=e.target.checked,g=this.value,T=s?g:null;this.computedLocalChecked=g,this.$nextTick(function(){r.$emit(Bs,T),r.isGroup&&r.bvGroup.$emit(Bs,T)})}),bs(Fu,"handleFocus",function(e){e.target&&(e.type==="focus"?this.hasFocus=!0:e.type==="blur"&&(this.hasFocus=!1))}),bs(Fu,"focus",function(){this.isDisabled||ii(this.$refs.input)}),bs(Fu,"blur",function(){this.isDisabled||zs(this.$refs.input)}),Fu),render:function(e){var r=this.isRadio,s=this.isBtnMode,g=this.isPlain,T=this.isCustom,I=this.isInline,a=this.isSwitch,N=this.computedSize,H=this.bvAttrs,K=this.normalizeSlot(),ee=e("input",{class:[{"form-check-input":g,"custom-control-input":T,"position-static":g&&!K},s?"":this.stateClass],directives:[{name:"model",value:this.computedLocalChecked}],attrs:this.computedAttrs,domProps:{value:this.value,checked:this.isChecked},on:Ll({change:this.handleChange},s?{focus:this.handleFocus,blur:this.handleFocus}:{}),key:"input",ref:"input"});if(s){var ue=e("label",{class:this.buttonClasses},[ee,K]);return this.isGroup||(ue=e("div",{class:["btn-group-toggle","d-inline-block"]},[ue])),ue}var Pe=e();return g&&!K||(Pe=e("label",{class:{"form-check-label":g,"custom-control-label":T},attrs:{for:this.safeId()}},K)),e("div",{class:[bs({"form-check":g,"form-check-inline":g&&I,"custom-control":T,"custom-control-inline":T&&I,"custom-checkbox":T&&!r&&!a,"custom-switch":a,"custom-radio":T&&r},"b-custom-control-".concat(N),N&&!s),H.class],style:H.style},[ee,Pe])}}),yp;function pR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function mR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pR(Object(r),!0).forEach(function(s){Dp(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Dp(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var fx="indeterminate",lE=dh+fx,HK=Ct(vr(mR(mR({},bP),{},(yp={},Dp(yp,fx,k(Ee,!1)),Dp(yp,"switch",k(Ee,!1)),Dp(yp,"uncheckedValue",k(Yp,!1)),Dp(yp,"value",k(Yp,!0)),yp))),oF),y0=ot({name:oF,mixins:[o5],inject:{getBvGroup:{from:"getBvCheckGroup",default:function(){return function(){return null}}}},props:HK,computed:{bvGroup:function(){return this.getBvGroup()},isChecked:function(){var e=this.value,r=this.computedLocalChecked;return Ni(r)?hR(r,e)>-1:Ci(r,e)},isRadio:function(){return!1}},watch:Dp({},fx,function(t,e){Ci(t,e)||this.setIndeterminate(t)}),mounted:function(){this.setIndeterminate(this[fx])},methods:{computedLocalCheckedWatcher:function(e,r){if(!Ci(e,r)){this.$emit(vP,e);var s=this.$refs.input;s&&this.$emit(lE,s.indeterminate)}},handleChange:function(e){var r=this,s=e.target,g=s.checked,T=s.indeterminate,I=this.value,a=this.uncheckedValue,N=this.computedLocalChecked;if(Ni(N)){var H=hR(N,I);g&&H<0?N=N.concat(I):!g&&H>-1&&(N=N.slice(0,H).concat(N.slice(H+1)))}else N=g?I:a;this.computedLocalChecked=N,this.$nextTick(function(){r.$emit(Bs,N),r.isGroup&&r.bvGroup.$emit(Bs,N),r.$emit(lE,T)})},setIndeterminate:function(e){Ni(this.computedLocalChecked)&&(e=!1);var r=this.$refs.input;r&&(r.indeterminate=e,this.$emit(lE,e))}}}),qK=Ct(bP,dF),LS=ot({name:dF,mixins:[o5],inject:{getBvGroup:{from:"getBvRadioGroup",default:function(){return function(){return null}}}},props:qK,computed:{bvGroup:function(){return this.getBvGroup()}},watch:{computedLocalChecked:function(e,r){Ci(e,r)||this.$emit(vP,e)}}}),Hb;function gR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Il(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gR(Object(r),!0).forEach(function(s){v0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function v0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _R=["aria-describedby","aria-labelledby"],y1=Xn("checked"),WK=y1.mixin,ZK=y1.props,BS=y1.prop,XK=y1.event,xP=Ct(vr(Il(Il(Il(Il(Il(Il(Il(Il({},Hi),ZK),cl),By),ul),hl),ky),{},{ariaInvalid:k(qo,!1),buttonVariant:k(ie),buttons:k(Ee,!1),stacked:k(Ee,!1),validated:k(Ee,!1)})),"formRadioCheckGroups"),s5=ot({mixins:[Ki,WK,Ur,Yd,m1,Nc,Xl,g1],inheritAttrs:!1,props:xP,data:function(){return{localChecked:this[BS]}},computed:{inline:function(){return!this.stacked},groupName:function(){return this.name||this.safeId()},groupClasses:function(){var e=this.inline,r=this.size,s=this.validated,g={"was-validated":s};return this.buttons&&(g=[g,"btn-group-toggle",v0({"btn-group":e,"btn-group-vertical":!e},"btn-group-".concat(r),r)]),g}},watch:(Hb={},v0(Hb,BS,function(t){Ci(t,this.localChecked)||(this.localChecked=t)}),v0(Hb,"localChecked",function(e,r){Ci(e,r)||this.$emit(XK,e)}),Hb),render:function(e){var r=this,s=this.isRadioGroup,g=sl(this.$attrs,_R),T=s?LS:y0,I=this.formOptions.map(function(a,N){var H="BV_option_".concat(N);return e(T,{props:{disabled:a.disabled||!1,id:r.safeId(H),value:a.value},attrs:g,key:H},[e("span",{domProps:En(a.html,a.text)})])});return e("div",{class:[this.groupClasses,"bv-no-focus-ring"],attrs:Il(Il({},oi(this.$attrs,_R)),{},{"aria-invalid":this.computedAriaInvalid,"aria-required":this.required?"true":null,id:this.safeId(),role:s?"radiogroup":"group",tabindex:"-1"})},[this.normalizeSlot(WO),I,this.normalizeSlot()])}}),qb;function yR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function vR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yR(Object(r),!0).forEach(function(s){kS(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function kS(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var KK=Ct(vr(vR(vR({},xP),{},(qb={},kS(qb,BS,k(ss,[])),kS(qb,"switches",k(Ee,!1)),qb))),sF),cE=ot({name:sF,mixins:[s5],provide:function(){var e=this;return{getBvCheckGroup:function(){return e}}},props:KK,computed:{isRadioGroup:function(){return!1}}}),YK=wr({components:{BFormCheckbox:y0,BCheckbox:y0,BCheck:y0,BFormCheckboxGroup:cE,BCheckboxGroup:cE,BCheckGroup:cE}}),Wb="__BV_hover_handler__",a5="mouseenter",JK="mouseleave",QK=function(e){var r=function(g){e(g.type===a5,g)};return r.fn=e,r},bR=function(e,r,s){nl(e,r,a5,s,gi),nl(e,r,JK,s,gi)},uE=function(e,r){var s=r.value,g=s===void 0?null:s;if(Xi){var T=e[Wb],I=Mr(T),a=!(I&&T.fn===g);I&&a&&(bR(!1,e,T),delete e[Wb]),Mr(g)&&a&&(e[Wb]=QK(g),bR(!0,e,e[Wb]))}},l5={bind:uE,componentUpdated:uE,unbind:function(e){uE(e,{value:null})}};function xR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function vp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xR(Object(r),!0).forEach(function(s){Ap(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ap(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var wP=vr(vp(vp(vp(vp(vp(vp({},Hi),ul),hl),oi(p1,["disabled"])),oi(cl,["autofocus"])),{},{buttonOnly:k(Ee,!1),buttonVariant:k(ie,"secondary"),formattedValue:k(ie),labelSelected:k(ie),lang:k(ie),menuClass:k(Nr),placeholder:k(ie),readonly:k(Ee,!1),rtl:k(Ee,null),value:k(ie,"")})),c5=ot({name:jq,directives:{"b-hover":l5},mixins:[Ki,Nc,Xl,mP,Ur],props:wP,data:function(){return{isHovered:!1,hasFocus:!1}},computed:{idButton:function(){return this.safeId()},idLabel:function(){return this.safeId("_value_")},idMenu:function(){return this.safeId("_dialog_")},idWrapper:function(){return this.safeId("_outer_")},computedDir:function(){return this.rtl===!0?"rtl":this.rtl===!1?"ltr":null}},methods:{focus:function(){this.disabled||ii(this.$refs.toggle)},blur:function(){this.disabled||zs(this.$refs.toggle)},setFocus:function(e){this.hasFocus=e.type==="focus"},handleHover:function(e){this.isHovered=e}},render:function(e){var r,s=this.idButton,g=this.idLabel,T=this.idMenu,I=this.idWrapper,a=this.disabled,N=this.readonly,H=this.required,K=this.name,ee=this.state,ue=this.visible,Pe=this.size,xe=this.isHovered,Ie=this.hasFocus,dt=this.labelSelected,Le=this.buttonVariant,De=this.buttonOnly,Ye=Lr(this.value)||"",He=ee===!1||H&&!Ye,ht={isHovered:xe,hasFocus:Ie,state:ee,opened:ue},St=e("button",{staticClass:"btn",class:(r={},Ap(r,"btn-".concat(Le),De),Ap(r,"btn-".concat(Pe),Pe),Ap(r,"h-auto",!De),Ap(r,"dropdown-toggle",De),Ap(r,"dropdown-toggle-no-caret",De),r),attrs:{id:s,type:"button",disabled:a,"aria-haspopup":"dialog","aria-expanded":ue?"true":"false","aria-invalid":He?"true":null,"aria-required":H?"true":null},directives:[{name:"b-hover",value:this.handleHover}],on:{mousedown:this.onMousedown,click:this.toggle,keydown:this.toggle,"!focus":this.setFocus,"!blur":this.setFocus},ref:"toggle"},[this.hasNormalizedSlot(Ic)?this.normalizeSlot(Ic,ht):e(iZ,{props:{scale:1.25}})]),st=e();K&&!a&&(st=e("input",{attrs:{type:"hidden",name:K||null,form:this.form||null,value:Ye}}));var gt=e("div",{staticClass:"dropdown-menu",class:[this.menuClass,{show:ue,"dropdown-menu-right":this.right}],attrs:{id:T,role:"dialog",tabindex:"-1","aria-modal":"false","aria-labelledby":g},on:{keydown:this.onKeydown},ref:"menu"},[this.normalizeSlot(eo,{opened:ue})]),Tt=e("label",{class:De?"sr-only":["form-control",{"text-muted":!Ye},this.stateClass,this.sizeFormClass],attrs:{id:g,for:s,"aria-invalid":He?"true":null,"aria-required":H?"true":null},directives:[{name:"b-hover",value:this.handleHover}],on:{"!click":function(ft){ei(ft,{preventDefault:!1})}}},[Ye?this.formattedValue||Ye:this.placeholder||"",Ye&&dt?e("bdi",{staticClass:"sr-only"},dt):""]);return e("div",{staticClass:"b-form-btn-label-control dropdown",class:[this.directionClass,this.boundaryClass,[{"btn-group":De,"form-control":!De,focus:Ie&&!De,show:ue,"is-valid":ee===!0,"is-invalid":ee===!1},De?null:this.sizeFormClass]],attrs:{id:I,role:De?null:"group",lang:this.lang||null,dir:this.computedDir,"aria-disabled":a,"aria-readonly":N&&!a,"aria-labelledby":g,"aria-invalid":ee===!1||H&&!Ye?"true":null,"aria-required":H?"true":null}},[St,st,gt,Tt])}}),a_;function wR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function xc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wR(Object(r),!0).forEach(function(s){P_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function P_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var v1=Xn("value",{type:Id}),eY=v1.mixin,tY=v1.props,TR=v1.prop,rY=v1.event,u5=oi(g4,["block","hidden","id","noKeyNav","roleDescription","value","width"]),h5=oi(wP,["formattedValue","id","lang","rtl","value"]),iY=Ct(vr(xc(xc(xc(xc(xc({},Hi),tY),u5),h5),{},{calendarWidth:k(ie,"270px"),closeButton:k(Ee,!1),closeButtonVariant:k(ie,"outline-secondary"),dark:k(Ee,!1),labelCloseButton:k(ie,"Close"),labelResetButton:k(ie,"Reset"),labelTodayButton:k(ie,"Select today"),noCloseOnSelect:k(Ee,!1),resetButton:k(Ee,!1),resetButtonVariant:k(ie,"outline-danger"),resetValue:k(Id),todayButton:k(Ee,!1),todayButtonVariant:k(ie,"outline-primary")})),lF),ER=ot({name:lF,mixins:[Ki,eY],props:iY,data:function(){return{localYMD:dn(this[TR])||"",isVisible:!1,localLocale:null,isRTL:!1,formattedValue:"",activeYMD:""}},computed:{calendarYM:function(){return this.activeYMD.slice(0,-3)},computedLang:function(){return(this.localLocale||"").replace(/-u-.*$/i,"")||null},computedResetValue:function(){return dn(rx(this.resetValue))||""}},watch:(a_={},P_(a_,TR,function(t){this.localYMD=dn(t)||""}),P_(a_,"localYMD",function(e){this.isVisible&&this.$emit(rY,this.valueAsDate?Gn(e)||null:e||"")}),P_(a_,"calendarYM",function(e,r){if(e!==r&&r)try{this.$refs.control.updatePopper()}catch{}}),a_),methods:{focus:function(){this.disabled||ii(this.$refs.control)},blur:function(){this.disabled||zs(this.$refs.control)},setAndClose:function(e){var r=this;this.localYMD=e,this.noCloseOnSelect||this.$nextTick(function(){r.$refs.control.hide(!0)})},onSelected:function(e){var r=this;this.$nextTick(function(){r.setAndClose(e)})},onInput:function(e){this.localYMD!==e&&(this.localYMD=e)},onContext:function(e){var r=e.activeYMD,s=e.isRTL,g=e.locale,T=e.selectedYMD,I=e.selectedFormatted;this.isRTL=s,this.localLocale=g,this.formattedValue=I,this.localYMD=T,this.activeYMD=r,this.$emit(Kp,e)},onTodayButton:function(){this.setAndClose(dn(rx(go(),this.min,this.max)))},onResetButton:function(){this.setAndClose(this.computedResetValue)},onCloseButton:function(){this.$refs.control.hide(!0)},onShow:function(){this.isVisible=!0},onShown:function(){var e=this;this.$nextTick(function(){ii(e.$refs.calendar),e.$emit(os)})},onHidden:function(){this.isVisible=!1,this.$emit(zn)},defaultButtonFn:function(e){var r=e.isHovered,s=e.hasFocus;return this.$createElement(r||s?rZ:tZ,{attrs:{"aria-hidden":"true"}})}},render:function(e){var r=this.localYMD,s=this.disabled,g=this.readonly,T=this.dark,I=this.$props,a=this.$scopedSlots,N=ji(this.placeholder)?this.labelNoDateSelected:this.placeholder,H=[];if(this.todayButton){var K=this.labelTodayButton;H.push(e(Ds,{props:{disabled:s||g,size:"sm",variant:this.todayButtonVariant},attrs:{"aria-label":K||null},on:{click:this.onTodayButton}},K))}if(this.resetButton){var ee=this.labelResetButton;H.push(e(Ds,{props:{disabled:s||g,size:"sm",variant:this.resetButtonVariant},attrs:{"aria-label":ee||null},on:{click:this.onResetButton}},ee))}if(this.closeButton){var ue=this.labelCloseButton;H.push(e(Ds,{props:{disabled:s,size:"sm",variant:this.closeButtonVariant},attrs:{"aria-label":ue||null},on:{click:this.onCloseButton}},ue))}H.length>0&&(H=[e("div",{staticClass:"b-form-date-controls d-flex flex-wrap",class:{"justify-content-between":H.length>1,"justify-content-end":H.length<2}},H)]);var Pe=e(_4,{staticClass:"b-form-date-calendar w-100",props:xc(xc({},mn(u5,I)),{},{hidden:!this.isVisible,value:r,valueAsDate:!1,width:this.calendarWidth}),on:{selected:this.onSelected,input:this.onInput,context:this.onContext},scopedSlots:sl(a,["nav-prev-decade","nav-prev-year","nav-prev-month","nav-this-month","nav-next-month","nav-next-year","nav-next-decade"]),key:"calendar",ref:"calendar"},H);return e(c5,{staticClass:"b-form-datepicker",props:xc(xc({},mn(h5,I)),{},{formattedValue:r?this.formattedValue:"",id:this.safeId(),lang:this.computedLang,menuClass:[{"bg-dark":T,"text-light":T},this.menuClass],placeholder:N,rtl:this.isRTL,value:r}),on:{show:this.onShow,shown:this.onShown,hidden:this.onHidden},scopedSlots:P_({},Ic,a[Ic]||this.defaultButtonFn),ref:"control"},[Pe])}}),nY=wr({components:{BFormDatepicker:ER,BDatepicker:ER}}),Zb;function SR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function _c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SR(Object(r),!0).forEach(function(s){b0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function b0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b1=Xn("value",{type:[ss,bz],defaultValue:null,validator:function(e){return e===""?(ao(cY,GO),!0):ji(e)||uY(e)}}),oY=b1.mixin,sY=b1.props,aY=b1.prop,lY=b1.event,cY='Setting "value"/"v-model" to an empty string for reset is deprecated. Set to "null" instead.',uY=function t(e){return mq(e)||Ni(e)&&e.every(function(r){return t(r)})},d5=function(e){return Mr(e.getAsEntry)?e.getAsEntry():Mr(e.webkitGetAsEntry)?e.webkitGetAsEntry():null},hY=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Promise.all(jd(e).filter(function(s){return s.kind==="file"}).map(function(s){var g=d5(s);if(g){if(g.isDirectory&&r)return dY(g.createReader(),"".concat(g.name,"/"));if(g.isFile)return new Promise(function(T){g.file(function(I){I.$path="",T(I)})})}return null}).filter($r))},dY=function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Promise(function(s){var g=[],T=function I(){e.readEntries(function(a){a.length===0?s(Promise.all(g).then(function(N){return pW(N)})):(g.push(Promise.all(a.map(function(N){if(N){if(N.isDirectory)return t(N.createReader(),"".concat(r).concat(N.name,"/"));if(N.isFile)return new Promise(function(H){N.file(function(K){K.$path="".concat(r).concat(K.name),H(K)})})}return null}).filter($r))),I())})};T()})},fY=Ct(vr(_c(_c(_c(_c(_c(_c(_c({},Hi),sY),cl),ky),hl),ul),{},{accept:k(ie,""),browseText:k(ie,"Browse"),capture:k(Ee,!1),directory:k(Ee,!1),dropPlaceholder:k(ie,"Drop files here"),fileNameFormatter:k(ls),multiple:k(Ee,!1),noDrop:k(Ee,!1),noDropPlaceholder:k(ie,"Not allowed"),noTraverse:k(Ee,!1),placeholder:k(ie,"No file chosen")})),GO),OR=ot({name:GO,mixins:[lo,Ki,oY,Ur,Yd,Xl,g1,Ur],inheritAttrs:!1,props:fY,data:function(){return{files:[],dragging:!1,dropAllowed:!this.noDrop,hasFocus:!1}},computed:{computedAccept:function(){var e=this.accept;return e=(e||"").trim().split(/[,\s]+/).filter($r),e.length===0?null:e.map(function(r){var s="name",g="^",T="$";$H.test(r)?g="":(s="type",XH.test(r)&&(T=".+$",r=r.slice(0,-1))),r=XO(r);var I=new RegExp("".concat(g).concat(r).concat(T));return{rx:I,prop:s}})},computedCapture:function(){var e=this.capture;return e===!0||e===""?!0:e||null},computedAttrs:function(){var e=this.name,r=this.disabled,s=this.required,g=this.form,T=this.computedCapture,I=this.accept,a=this.multiple,N=this.directory;return _c(_c({},this.bvAttrs),{},{type:"file",id:this.safeId(),name:e,disabled:r,required:s,form:g||null,capture:T,accept:I||null,multiple:a,directory:N,webkitdirectory:N,"aria-required":s?"true":null})},computedFileNameFormatter:function(){var e=this.fileNameFormatter;return Gl(e)?e:this.defaultFileNameFormatter},clonedFiles:function(){return Ra(this.files)},flattenedFiles:function(){return i_(this.files)},fileNames:function(){return this.flattenedFiles.map(function(e){return e.name})},labelContent:function(){if(this.dragging&&!this.noDrop)return this.normalizeSlot(D7,{allowed:this.dropAllowed})||(this.dropAllowed?this.dropPlaceholder:this.$createElement("span",{staticClass:"text-danger"},this.noDropPlaceholder));if(this.files.length===0)return this.normalizeSlot(sW)||this.placeholder;var e=this.flattenedFiles,r=this.clonedFiles,s=this.fileNames,g=this.computedFileNameFormatter;return this.hasNormalizedSlot(gI)?this.normalizeSlot(gI,{files:e,filesTraversed:r,names:s}):g(e,r,s)}},watch:(Zb={},b0(Zb,aY,function(t){(!t||Ni(t)&&t.length===0)&&this.reset()}),b0(Zb,"files",function(e,r){if(!Ci(e,r)){var s=this.multiple,g=this.noTraverse,T=!s||g?i_(e):e;this.$emit(lY,s?T:T[0]||null)}}),Zb),created:function(){this.$_form=null},mounted:function(){var e=Ms("form",this.$el);e&&(pn(e,"reset",this.reset,Os),this.$_form=e)},beforeDestroy:function(){var e=this.$_form;e&&Tn(e,"reset",this.reset,Os)},methods:{isFileValid:function(e){if(!e)return!1;var r=this.computedAccept;return r?r.some(function(s){return s.rx.test(e[s.prop])}):!0},isFilesArrayValid:function(e){var r=this;return Ni(e)?e.every(function(s){return r.isFileValid(s)}):this.isFileValid(e)},defaultFileNameFormatter:function(e,r,s){return s.join(", ")},setFiles:function(e){this.dropAllowed=!this.noDrop,this.dragging=!1,this.files=this.multiple?this.directory?e:i_(e):i_(e).slice(0,1)},setInputFiles:function(e){try{var r=new ClipboardEvent("").clipboardData||new DataTransfer;i_(Ra(e)).forEach(function(s){delete s.$path,r.items.add(s)}),this.$refs.input.files=r.files}catch{}},reset:function(){try{var e=this.$refs.input;e.value="",e.type="",e.type="file"}catch{}this.files=[]},handleFiles:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r){var s=e.filter(this.isFilesArrayValid);s.length>0&&(this.setFiles(s),this.setInputFiles(s))}else this.setFiles(e)},focusHandler:function(e){this.plain||e.type==="focusout"?this.hasFocus=!1:this.hasFocus=!0},onChange:function(e){var r=this,s=e.type,g=e.target,T=e.dataTransfer,I=T===void 0?{}:T,a=s==="drop";this.$emit(Bs,e);var N=jd(I.items||[]);if(fz&&N.length>0&&!fn(d5(N[0])))hY(N,this.directory).then(function(K){return r.handleFiles(K,a)});else{var H=jd(g.files||I.files||[]).map(function(K){return K.$path=K.webkitRelativePath||"",K});this.handleFiles(H,a)}},onDragenter:function(e){ei(e),this.dragging=!0;var r=e.dataTransfer,s=r===void 0?{}:r;if(this.noDrop||this.disabled||!this.dropAllowed){s.dropEffect="none",this.dropAllowed=!1;return}s.dropEffect="copy"},onDragover:function(e){ei(e),this.dragging=!0;var r=e.dataTransfer,s=r===void 0?{}:r;if(this.noDrop||this.disabled||!this.dropAllowed){s.dropEffect="none",this.dropAllowed=!1;return}s.dropEffect="copy"},onDragleave:function(e){var r=this;ei(e),this.$nextTick(function(){r.dragging=!1,r.dropAllowed=!r.noDrop})},onDrop:function(e){var r=this;if(ei(e),this.dragging=!1,this.noDrop||this.disabled||!this.dropAllowed){this.$nextTick(function(){r.dropAllowed=!r.noDrop});return}this.onChange(e)}},render:function(e){var r=this.custom,s=this.plain,g=this.size,T=this.dragging,I=this.stateClass,a=this.bvAttrs,N=e("input",{class:[{"form-control-file":s,"custom-file-input":r,focus:r&&this.hasFocus},I],style:r?{zIndex:-5}:{},attrs:this.computedAttrs,on:{change:this.onChange,focusin:this.focusHandler,focusout:this.focusHandler,reset:this.reset},ref:"input"});if(s)return N;var H=e("label",{staticClass:"custom-file-label",class:{dragging:T},attrs:{for:this.safeId(),"data-browse":this.browseText||null}},[e("span",{staticClass:"d-block form-file-text",style:{pointerEvents:"none"}},[this.labelContent])]);return e("div",{staticClass:"custom-file b-form-file",class:[b0({},"b-custom-control-".concat(g),g),I,a.class],style:a.style,attrs:{id:this.safeId("_BV_file_outer_")},on:{dragenter:this.onDragenter,dragover:this.onDragover,dragleave:this.onDragleave,drop:this.onDrop}},[N,H])}}),pY=wr({components:{BFormFile:OR,BFile:OR}}),hE=function(e){return"\\"+e},f5=function(e){e=Lr(e);var r=e.length,s=e.charCodeAt(0);return e.split("").reduce(function(g,T,I){var a=e.charCodeAt(I);return a===0?g+"\uFFFD":a===127||a>=1&&a<=31||I===0&&a>=48&&a<=57||I===1&&a>=48&&a<=57&&s===45?g+hE("".concat(a.toString(16)," ")):I===0&&a===45&&r===1?g+hE(T):a>=128||a===45||a===95||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?g+T:g+hE(T)},"")};function PR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Xb(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PR(Object(r),!0).forEach(function(s){A_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function A_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mY=["auto","start","end","center","baseline","stretch"],gY=function(e,r,s){var g=e;if(!(ji(s)||s===!1))return r&&(g+="-".concat(r)),e==="col"&&(s===""||s===!0)||(g+="-".concat(s)),X0(g)},_Y=Ay(gY),zS=qu(null),yY=function(){var e=cy().filter($r),r=e.reduce(function(T,I){return T[I]=k(ay),T},qu(null)),s=e.reduce(function(T,I){return T[Qu(I,"offset")]=k(dr),T},qu(null)),g=e.reduce(function(T,I){return T[Qu(I,"order")]=k(dr),T},qu(null));return zS=Oy(qu(null),{col:Gr(r),offset:Gr(s),order:Gr(g)}),Ct(vr(Xb(Xb(Xb(Xb({},r),s),g),{},{alignSelf:k(ie,null,function(T){return Vr(mY,T)}),col:k(Ee,!1),cols:k(dr),offset:k(dr),order:k(dr),tag:k(ie,"div")})),Zz)},x0={name:Zz,functional:!0,get props(){return delete this.props,this.props=yY()},render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.cols,N=g.offset,H=g.order,K=g.alignSelf,ee=[];for(var ue in zS)for(var Pe=zS[ue],xe=0;xe<Pe.length;xe++){var Ie=_Y(ue,Pe[xe].replace(ue,""),g[Pe[xe]]);Ie&&ee.push(Ie)}var dt=ee.some(function(Le){return lq.test(Le)});return ee.push((s={col:g.col||!dt&&!a},A_(s,"col-".concat(a),a),A_(s,"offset-".concat(N),N),A_(s,"order-".concat(H),H),A_(s,"align-self-".concat(K),K),s)),e(g.tag,Sr(T,{class:ee}),I)}};function AR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Rp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?AR(Object(r),!0).forEach(function(s){vY(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):AR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function vY(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p5=["input","select","textarea"],bY=p5.map(function(t){return"".concat(t,":not([disabled])")}).join(),xY=[].concat(p5,["a","button","label"]),wY=function(){return Ct(vr(Rp(Rp(Rp(Rp({},Hi),hl),cy().reduce(function(e,r){return e[Qu(r,"contentCols")]=k(ay),e[Qu(r,"labelAlign")]=k(ie),e[Qu(r,"labelCols")]=k(ay),e},qu(null))),{},{description:k(ie),disabled:k(Ee,!1),feedbackAriaLive:k(ie,"assertive"),invalidFeedback:k(ie),label:k(ie),labelClass:k(Nr),labelFor:k(ie),labelSize:k(ie),labelSrOnly:k(Ee,!1),tooltip:k(Ee,!1),validFeedback:k(ie),validated:k(Ee,!1)})),cF)},CR={name:cF,mixins:[Ki,Xl,Ur],get props(){return delete this.props,this.props=wY()},data:function(){return{ariaDescribedby:null}},computed:{contentColProps:function(){return this.getColProps(this.$props,"content")},labelAlignClasses:function(){return this.getAlignClasses(this.$props,"label")},labelColProps:function(){return this.getColProps(this.$props,"label")},isHorizontal:function(){return Gr(this.contentColProps).length>0||Gr(this.labelColProps).length>0}},watch:{ariaDescribedby:function(e,r){e!==r&&this.updateAriaDescribedby(e,r)}},mounted:function(){var e=this;this.$nextTick(function(){e.updateAriaDescribedby(e.ariaDescribedby)})},methods:{getAlignClasses:function(e,r){return cy().reduce(function(s,g){var T=e[Qu(g,"".concat(r,"Align"))]||null;return T&&s.push(["text",g,T].filter($r).join("-")),s},[])},getColProps:function(e,r){return cy().reduce(function(s,g){var T=e[Qu(g,"".concat(r,"Cols"))];return T=T===""?!0:T||!1,!Da(T)&&T!=="auto"&&(T=or(T,0),T=T>0?T:!1),T&&(s[g||(Da(T)?"col":"cols")]=T),s},{})},updateAriaDescribedby:function(e,r){var s=this.labelFor;if(Xi&&s){var g=sa("#".concat(f5(s)),this.$refs.content);if(g){var T="aria-describedby",I=(e||"").split(l0),a=(r||"").split(l0),N=(aa(g,T)||"").split(l0).filter(function(H){return!Vr(a,H)}).concat(I).filter(function(H,K,ee){return ee.indexOf(H)===K}).filter($r).join(" ").trim();N?yn(g,T,N):Nl(g,T)}}},onLegendClick:function(e){if(!this.labelFor){var r=e.target,s=r?r.tagName:"";if(xY.indexOf(s)===-1){var g=ca(bY,this.$refs.content).filter(il);g.length===1&&ii(g[0])}}}},render:function(e){var r=this.computedState,s=this.feedbackAriaLive,g=this.isHorizontal,T=this.labelFor,I=this.normalizeSlot,a=this.safeId,N=this.tooltip,H=a(),K=!T,ee=e(),ue=I(BN)||this.label,Pe=ue?a("_BV_label_"):null;if(ue||g){var xe=this.labelSize,Ie=this.labelColProps,dt=K?"legend":"label";this.labelSrOnly?(ue&&(ee=e(dt,{class:"sr-only",attrs:{id:Pe,for:T||null}},[ue])),ee=e(g?x0:"div",{props:g?Ie:{}},[ee])):ee=e(g?x0:dt,{on:K?{click:this.onLegendClick}:{},props:g?Rp(Rp({},Ie),{},{tag:dt}):{},attrs:{id:Pe,for:T||null,tabindex:K?"-1":null},class:[K?"bv-no-focus-ring":"",g||K?"col-form-label":"",!g&&K?"pt-0":"",!g&&!K?"d-block":"",xe?"col-form-label-".concat(xe):"",this.labelAlignClasses,this.labelClass]},[ue])}var Le=e(),De=I(U7)||this.invalidFeedback,Ye=De?a("_BV_feedback_invalid_"):null;De&&(Le=e(hx,{props:{ariaLive:s,id:Ye,state:r,tooltip:N},attrs:{tabindex:De?"-1":null}},[De]));var He=e(),ht=I(fW)||this.validFeedback,St=ht?a("_BV_feedback_valid_"):null;ht&&(He=e(n5,{props:{ariaLive:s,id:St,state:r,tooltip:N},attrs:{tabindex:ht?"-1":null}},[ht]));var st=e(),gt=I(M7)||this.description,Tt=gt?a("_BV_description_"):null;gt&&(st=e(ux,{attrs:{id:Tt,tabindex:"-1"}},[gt]));var at=this.ariaDescribedby=[Tt,r===!1?Ye:null,r===!0?St:null].filter($r).join(" ")||null,ft=e(g?x0:"div",{props:g?this.contentColProps:{},ref:"content"},[I(eo,{ariaDescribedby:at,descriptionId:Tt,id:H,labelId:Pe})||e(),Le,He,st]);return e(K?"fieldset":g?dx:"div",{staticClass:"form-group",class:[{"was-validated":this.validated},this.stateClass],attrs:{id:H,disabled:K?this.disabled:null,role:K?null:"group","aria-invalid":this.computedAriaInvalid,"aria-labelledby":K&&g?Pe:null}},g&&K?[e(dx,[ee,ft])]:[ee,ft])}},TY=wr({components:{BFormGroup:CR,BFormFieldset:CR}}),m5=ot({computed:{selectionStart:{cache:!1,get:function(){return this.$refs.input.selectionStart},set:function(e){this.$refs.input.selectionStart=e}},selectionEnd:{cache:!1,get:function(){return this.$refs.input.selectionEnd},set:function(e){this.$refs.input.selectionEnd=e}},selectionDirection:{cache:!1,get:function(){return this.$refs.input.selectionDirection},set:function(e){this.$refs.input.selectionDirection=e}}},methods:{select:function(){var e;(e=this.$refs.input).select.apply(e,arguments)},setSelectionRange:function(){var e;(e=this.$refs.input).setSelectionRange.apply(e,arguments)},setRangeText:function(){var e;(e=this.$refs.input).setRangeText.apply(e,arguments)}}});function MR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function IR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MR(Object(r),!0).forEach(function(s){g5(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function g5(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var x1=Xn("value",{type:dr,defaultValue:"",event:v7}),EY=x1.mixin,SY=x1.props,DR=x1.prop,OY=x1.event,TP=Ct(vr(IR(IR({},SY),{},{ariaInvalid:k(qo,!1),autocomplete:k(ie),debounce:k(dr,0),formatter:k(ls),lazy:k(Ee,!1),lazyFormatter:k(Ee,!1),number:k(Ee,!1),placeholder:k(ie),plaintext:k(Ee,!1),readonly:k(Ee,!1),trim:k(Ee,!1)})),"formTextControls"),_5=ot({mixins:[EY],props:TP,data:function(){var e=this[DR];return{localValue:Lr(e),vModelValue:this.modifyValue(e)}},computed:{computedClass:function(){var e=this.plaintext,r=this.type,s=r==="range",g=r==="color";return[{"custom-range":s,"form-control-plaintext":e&&!s&&!g,"form-control":g||!e&&!s},this.sizeFormClass,this.stateClass]},computedDebounce:function(){return Li(or(this.debounce,0),0)},hasFormatter:function(){return Gl(this.formatter)}},watch:g5({},DR,function(t){var e=Lr(t),r=this.modifyValue(t);(e!==this.localValue||r!==this.vModelValue)&&(this.clearDebounce(),this.localValue=e,this.vModelValue=r)}),created:function(){this.$_inputDebounceTimer=null},beforeDestroy:function(){this.clearDebounce()},methods:{clearDebounce:function(){clearTimeout(this.$_inputDebounceTimer),this.$_inputDebounceTimer=null},formatValue:function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e=Lr(e),this.hasFormatter&&(!this.lazyFormatter||s)&&(e=this.formatter(e,r)),e},modifyValue:function(e){return e=Lr(e),this.trim&&(e=e.trim()),this.number&&(e=hi(e,e)),e},updateValue:function(e){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=this.lazy;if(!(g&&!s)){this.clearDebounce();var T=function(){if(e=r.modifyValue(e),e!==r.vModelValue)r.vModelValue=e,r.$emit(OY,e);else if(r.hasFormatter){var N=r.$refs.input;N&&e!==N.value&&(N.value=e)}},I=this.computedDebounce;I>0&&!g&&!s?this.$_inputDebounceTimer=setTimeout(T,I):T()}},onInput:function(e){if(!e.target.composing){var r=e.target.value,s=this.formatValue(r,e);if(s===!1||e.defaultPrevented){ei(e,{propagation:!1});return}this.localValue=s,this.updateValue(s),this.$emit(bN,s)}},onChange:function(e){var r=e.target.value,s=this.formatValue(r,e);if(s===!1||e.defaultPrevented){ei(e,{propagation:!1});return}this.localValue=s,this.updateValue(s,!0),this.$emit(Bs,s)},onBlur:function(e){var r=e.target.value,s=this.formatValue(r,e,!0);s!==!1&&(this.localValue=Lr(this.modifyValue(s)),this.updateValue(s,!0)),this.$emit(_N,e)},focus:function(){this.disabled||ii(this.$el)},blur:function(){this.disabled||zs(this.$el)}}}),y5=ot({computed:{validity:{cache:!1,get:function(){return this.$refs.input.validity}},validationMessage:{cache:!1,get:function(){return this.$refs.input.validationMessage}},willValidate:{cache:!1,get:function(){return this.$refs.input.willValidate}}},methods:{setCustomValidity:function(){var e;return(e=this.$refs.input).setCustomValidity.apply(e,arguments)},checkValidity:function(){var e;return(e=this.$refs.input).checkValidity.apply(e,arguments)},reportValidity:function(){var e;return(e=this.$refs.input).reportValidity.apply(e,arguments)}}});function RR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Vu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RR(Object(r),!0).forEach(function(s){PY(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function PY(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var v5=["text","password","email","number","url","tel","search","range","color","date","time","datetime","datetime-local","month","week"],AY=Ct(vr(Vu(Vu(Vu(Vu(Vu(Vu({},Hi),cl),ul),hl),TP),{},{list:k(ie),max:k(dr),min:k(dr),noWheel:k(Ee,!1),step:k(dr),type:k(ie,"text",function(t){return Vr(v5,t)})})),uF),LR=ot({name:uF,mixins:[Fc,Ki,Yd,Nc,Xl,_5,m5,y5],props:AY,computed:{localType:function(){var e=this.type;return Vr(v5,e)?e:"text"},computedAttrs:function(){var e=this.localType,r=this.name,s=this.form,g=this.disabled,T=this.placeholder,I=this.required,a=this.min,N=this.max,H=this.step;return{id:this.safeId(),name:r,form:s,type:e,disabled:g,placeholder:T,required:I,autocomplete:this.autocomplete||null,readonly:this.readonly||this.plaintext,min:a,max:N,step:H,list:e!=="password"?this.list:null,"aria-required":I?"true":null,"aria-invalid":this.computedAriaInvalid}},computedListeners:function(){return Vu(Vu({},this.bvListeners),{},{input:this.onInput,change:this.onChange,blur:this.onBlur})}},watch:{noWheel:function(e){this.setWheelStopper(e)}},mounted:function(){this.setWheelStopper(this.noWheel)},deactivated:function(){this.setWheelStopper(!1)},activated:function(){this.setWheelStopper(this.noWheel)},beforeDestroy:function(){this.setWheelStopper(!1)},methods:{setWheelStopper:function(e){var r=this.$el;nl(e,r,"focus",this.onWheelFocus),nl(e,r,"blur",this.onWheelBlur),e||Tn(document,"wheel",this.stopWheel)},onWheelFocus:function(){pn(document,"wheel",this.stopWheel)},onWheelBlur:function(){Tn(document,"wheel",this.stopWheel)},stopWheel:function(e){ei(e,{propagation:!1}),zs(this.$el)}},render:function(e){return e("input",{class:this.computedClass,attrs:this.computedAttrs,domProps:{value:this.localValue},on:this.computedListeners,ref:"input"})}}),CY=wr({components:{BFormInput:LR,BInput:LR}}),MY=Ct(xP,fF),BR=ot({name:fF,mixins:[s5],provide:function(){var e=this;return{getBvRadioGroup:function(){return e}}},props:MY,computed:{isRadioGroup:function(){return!0}}}),IY=wr({components:{BFormRadio:LS,BRadio:LS,BFormRadioGroup:BR,BRadioGroup:BR}}),l_;function kR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function c_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kR(Object(r),!0).forEach(function(s){w0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function w0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w1=Xn("value",{type:dr,event:Bs}),DY=w1.mixin,RY=w1.props,zR=w1.prop,LY=w1.event,b5=3,x5=5,FR=function(e){return Li(b5,or(e,x5))},ad=function(e,r,s){return Li(Ec(e,s),r)},BY=ot({name:Vq,mixins:[Ur],props:{disabled:k(Ee,!1),focused:k(Ee,!1),hasClear:k(Ee,!1),rating:k(Uo,0),readonly:k(Ee,!1),star:k(Uo,0),variant:k(ie)},methods:{onClick:function(e){!this.disabled&&!this.readonly&&(ei(e,{propagation:!1}),this.$emit(PN,this.star))}},render:function(e){var r=this.rating,s=this.star,g=this.focused,T=this.hasClear,I=this.variant,a=this.disabled,N=this.readonly,H=T?0:1,K=r>=s?"full":r>=s-.5?"half":"empty",ee={variant:I,disabled:a,readonly:N};return e("span",{staticClass:"b-rating-star",class:{focused:g&&r===s||!or(r)&&s===H,"b-rating-star-empty":K==="empty","b-rating-star-half":K==="half","b-rating-star-full":K==="full"},attrs:{tabindex:!a&&!N?"-1":null},on:{click:this.onClick}},[e("span",{staticClass:"b-rating-icon"},[this.normalizeSlot(K,ee)])])}}),kY=Ct(vr(c_(c_(c_(c_(c_({},Hi),RY),oi(cl,["required","autofocus"])),ul),{},{color:k(ie),iconClear:k(ie,"x"),iconEmpty:k(ie,"star"),iconFull:k(ie,"star-fill"),iconHalf:k(ie,"star-half"),inline:k(Ee,!1),locale:k(Ho),noBorder:k(Ee,!1),precision:k(dr),readonly:k(Ee,!1),showClear:k(Ee,!1),showValue:k(Ee,!1),showValueMax:k(Ee,!1),stars:k(dr,x5,function(t){return or(t)>=b5}),variant:k(ie)})),pF),NR=ot({name:pF,components:{BIconStar:cZ,BIconStarHalf:hZ,BIconStarFill:uZ,BIconX:JN},mixins:[Ki,DY,Nc],props:kY,data:function(){var e=hi(this[zR],null),r=FR(this.stars);return{localValue:fn(e)?null:ad(e,0,r),hasFocus:!1}},computed:{computedStars:function(){return FR(this.stars)},computedRating:function(){var e=hi(this.localValue,0),r=or(this.precision,3);return ad(hi(e.toFixed(r)),0,this.computedStars)},computedLocale:function(){var e=bi(this.locale).filter($r),r=new Intl.NumberFormat(e);return r.resolvedOptions().locale},isInteractive:function(){return!this.disabled&&!this.readonly},isRTL:function(){return a1(this.computedLocale)},formattedRating:function(){var e=or(this.precision),r=this.showValueMax,s=this.computedLocale,g={notation:"standard",minimumFractionDigits:isNaN(e)?0:e,maximumFractionDigits:isNaN(e)?3:e},T=this.computedStars.toLocaleString(s),I=this.localValue;return I=fn(I)?r?"-":"":I.toLocaleString(s,g),r?"".concat(I,"/").concat(T):I}},watch:(l_={},w0(l_,zR,function(t,e){if(t!==e){var r=hi(t,null);this.localValue=fn(r)?null:ad(r,0,this.computedStars)}}),w0(l_,"localValue",function(e,r){e!==r&&e!==(this.value||0)&&this.$emit(LY,e||null)}),w0(l_,"disabled",function(e){e&&(this.hasFocus=!1,this.blur())}),l_),methods:{focus:function(){this.disabled||ii(this.$el)},blur:function(){this.disabled||zs(this.$el)},onKeydown:function(e){var r=e.keyCode;if(this.isInteractive&&Vr([ol,as,Rc,Is],r)){ei(e,{propagation:!1});var s=or(this.localValue,0),g=this.showClear?0:1,T=this.computedStars,I=this.isRTL?-1:1;r===ol?this.localValue=ad(s-I,g,T)||null:r===Rc?this.localValue=ad(s+I,g,T):r===as?this.localValue=ad(s-1,g,T)||null:r===Is&&(this.localValue=ad(s+1,g,T))}},onSelected:function(e){this.isInteractive&&(this.localValue=e)},onFocus:function(e){this.hasFocus=this.isInteractive?e.type==="focus":!1},renderIcon:function(e){return this.$createElement(K0,{props:{icon:e,variant:this.disabled||this.color?null:this.variant||null}})},iconEmptyFn:function(){return this.renderIcon(this.iconEmpty)},iconHalfFn:function(){return this.renderIcon(this.iconHalf)},iconFullFn:function(){return this.renderIcon(this.iconFull)},iconClearFn:function(){return this.$createElement(K0,{props:{icon:this.iconClear}})}},render:function(e){var r=this,s=this.disabled,g=this.readonly,T=this.name,I=this.form,a=this.inline,N=this.variant,H=this.color,K=this.noBorder,ee=this.hasFocus,ue=this.computedRating,Pe=this.computedStars,xe=this.formattedRating,Ie=this.showClear,dt=this.isRTL,Le=this.isInteractive,De=this.$scopedSlots,Ye=[];if(Ie&&!s&&!g){var He=e("span",{staticClass:"b-rating-icon"},[(De[z7]||this.iconClearFn)()]);Ye.push(e("span",{staticClass:"b-rating-star b-rating-star-clear flex-grow-1",class:{focused:ee&&ue===0},attrs:{tabindex:Le?"-1":null},on:{click:function(){return r.onSelected(null)}},key:"clear"},[He]))}for(var ht=0;ht<Pe;ht++){var St=ht+1;Ye.push(e(BY,{staticClass:"flex-grow-1",style:H&&!s?{color:H}:{},props:{rating:ue,star:St,variant:s?null:N||null,disabled:s,readonly:g,focused:ee,hasClear:Ie},on:{selected:this.onSelected},scopedSlots:{empty:De[F7]||this.iconEmptyFn,half:De[$7]||this.iconHalfFn,full:De[N7]||this.iconFullFn},key:ht}))}return T&&Ye.push(e("input",{attrs:{type:"hidden",value:fn(this.localValue)?"":ue,name:T,form:I||null},key:"hidden"})),this.showValue&&Ye.push(e("b",{staticClass:"b-rating-value flex-grow-1",attrs:{"aria-hidden":"true"},key:"value"},Lr(xe))),e("output",{staticClass:"b-rating form-control align-items-center",class:[{"d-inline-flex":a,"d-flex":!a,"border-0":K,disabled:s,readonly:!s&&g},this.sizeFormClass],attrs:{id:this.safeId(),dir:dt?"rtl":"ltr",tabindex:s?null:"0",disabled:s,role:"slider","aria-disabled":s?"true":null,"aria-readonly":!s&&g?"true":null,"aria-live":"off","aria-valuemin":Ie?"0":"1","aria-valuemax":Lr(Pe),"aria-valuenow":ue?Lr(ue):null},on:{keydown:this.onKeydown,focus:this.onFocus,blur:this.onFocus}},Ye)}}),zY=wr({components:{BFormRating:NR,BRating:NR}}),T1=Xn("value"),FY=T1.mixin,NY=T1.props,$Y=T1.prop,jY=T1.event;function $R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function jR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$R(Object(r),!0).forEach(function(s){VY(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$R(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function VY(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var UY=Ct(vr(jR(jR({},By),{},{labelField:k(ie,"label"),optionsField:k(ie,"options")})),"formOptions"),GY=ot({mixins:[m1],props:UY,methods:{normalizeOption:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(Go(e)){var s=Io(e,this.valueField),g=Io(e,this.textField),T=Io(e,this.optionsField,null);return fn(T)?{value:Fn(s)?r||g:s,text:String(Fn(g)?r:g),html:Io(e,this.htmlField),disabled:Boolean(Io(e,this.disabledField))}:{label:String(Io(e,this.labelField)||g),options:this.normalizeOptions(T)}}return{value:r||e,text:String(e),disabled:!1}}}}),HY=Ct({disabled:k(Ee,!1),value:k(Yp,void 0,!0)},_F),px=ot({name:_F,functional:!0,props:HY,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.value,a=s.disabled;return e("option",Sr(g,{attrs:{disabled:a},domProps:{value:I}}),T)}});function VR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function UR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VR(Object(r),!0).forEach(function(s){qY(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function qY(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var WY=Ct(vr(UR(UR({},By),{},{label:k(ie,void 0,!0)})),yF),FS=ot({name:yF,mixins:[Ur,m1],props:WY,render:function(e){var r=this.label,s=this.formOptions.map(function(g,T){var I=g.value,a=g.text,N=g.html,H=g.disabled;return e(px,{attrs:{value:I,disabled:H},domProps:En(N,a),key:"option_".concat(T)})});return e("optgroup",{attrs:{label:r}},[this.normalizeSlot(WO),s,this.normalizeSlot()])}});function GR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function ld(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GR(Object(r),!0).forEach(function(s){ZY(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ZY(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var XY=Ct(vr(ld(ld(ld(ld(ld(ld(ld({},Hi),NY),cl),ky),ul),hl),{},{ariaInvalid:k(qo,!1),multiple:k(Ee,!1),selectSize:k(Uo,0)})),gF),HR=ot({name:gF,mixins:[Ki,FY,Yd,Nc,Xl,g1,GY,Ur],props:XY,data:function(){return{localValue:this[$Y]}},computed:{computedSelectSize:function(){return!this.plain&&this.selectSize===0?null:this.selectSize},inputClass:function(){return[this.plain?"form-control":"custom-select",this.size&&this.plain?"form-control-".concat(this.size):null,this.size&&!this.plain?"custom-select-".concat(this.size):null,this.stateClass]}},watch:{value:function(e){this.localValue=e},localValue:function(){this.$emit(jY,this.localValue)}},methods:{focus:function(){ii(this.$refs.input)},blur:function(){zs(this.$refs.input)},onChange:function(e){var r=this,s=e.target,g=jd(s.options).filter(function(T){return T.selected}).map(function(T){return"_value"in T?T._value:T.value});this.localValue=s.multiple?g:g[0],this.$nextTick(function(){r.$emit(Bs,r.localValue)})}},render:function(e){var r=this.name,s=this.disabled,g=this.required,T=this.computedSelectSize,I=this.localValue,a=this.formOptions.map(function(N,H){var K=N.value,ee=N.label,ue=N.options,Pe=N.disabled,xe="option_".concat(H);return Ni(ue)?e(FS,{props:{label:ee,options:ue},key:xe}):e(px,{props:{value:K,disabled:Pe},domProps:En(N.html,N.text),key:xe})});return e("select",{class:this.inputClass,attrs:{id:this.safeId(),name:r,form:this.form||null,multiple:this.multiple||null,size:T,disabled:s,required:g,"aria-required":g?"true":null,"aria-invalid":this.computedAriaInvalid},on:{change:this.onChange},directives:[{name:"model",value:I}],ref:"input"},[this.normalizeSlot(WO),a,this.normalizeSlot()])}}),KY=wr({components:{BFormSelect:HR,BFormSelectOption:px,BFormSelectOptionGroup:FS,BSelect:HR,BSelectOption:px,BSelectOptionGroup:FS}}),bp;function qR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Bl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qR(Object(r),!0).forEach(function(s){C_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function C_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var E1=Xn("value",{type:T7}),YY=E1.mixin,JY=E1.props,WR=E1.prop,QY=E1.event,w5=1,T5=100,E5=1,S5=500,O5=100,P5=10,A5=4,ZR=[Is,as,ch,lh,J0,Y0],C5=Ct(vr(Bl(Bl(Bl(Bl(Bl(Bl({},Hi),JY),oi(cl,["required","autofocus"])),ul),hl),{},{ariaControls:k(ie),ariaLabel:k(ie),formatterFn:k(ls),inline:k(Ee,!1),labelDecrement:k(ie,"Decrement"),labelIncrement:k(ie,"Increment"),locale:k(Ho),max:k(dr,T5),min:k(dr,w5),placeholder:k(ie),readonly:k(Ee,!1),repeatDelay:k(dr,S5),repeatInterval:k(dr,O5),repeatStepMultiplier:k(dr,A5),repeatThreshold:k(dr,P5),step:k(dr,E5),vertical:k(Ee,!1),wrap:k(Ee,!1)})),vF),NS=ot({name:vF,mixins:[lo,Ki,YY,Nc,Xl,Ur],inheritAttrs:!1,props:C5,data:function(){return{localValue:hi(this[WR],null),hasFocus:!1}},computed:{required:function(){return!1},spinId:function(){return this.safeId()},computedInline:function(){return this.inline&&!this.vertical},computedReadonly:function(){return this.readonly&&!this.disabled},computedRequired:function(){return this.required&&!this.computedReadonly&&!this.disabled},computedStep:function(){return hi(this.step,E5)},computedMin:function(){return hi(this.min,w5)},computedMax:function(){var e=hi(this.max,T5),r=this.computedStep,s=this.computedMin;return uy((e-s)/r)*r+s},computedDelay:function(){var e=or(this.repeatDelay,0);return e>0?e:S5},computedInterval:function(){var e=or(this.repeatInterval,0);return e>0?e:O5},computedThreshold:function(){return Li(or(this.repeatThreshold,P5),1)},computedStepMultiplier:function(){return Li(or(this.repeatStepMultiplier,A5),1)},computedPrecision:function(){var e=this.computedStep;return uy(e)===e?0:(e.toString().split(".")[1]||"").length},computedMultiplier:function(){return WN(10,this.computedPrecision||0)},valueAsFixed:function(){var e=this.localValue;return fn(e)?"":e.toFixed(this.computedPrecision)},computedLocale:function(){var e=bi(this.locale).filter($r),r=new Intl.NumberFormat(e);return r.resolvedOptions().locale},computedRTL:function(){return a1(this.computedLocale)},defaultFormatter:function(){var e=this.computedPrecision,r=new Intl.NumberFormat(this.computedLocale,{style:"decimal",useGrouping:!1,minimumIntegerDigits:1,minimumFractionDigits:e,maximumFractionDigits:e,notation:"standard"});return r.format},computedFormatter:function(){var e=this.formatterFn;return Gl(e)?e:this.defaultFormatter},computedAttrs:function(){return Bl(Bl({},this.bvAttrs),{},{role:"group",lang:this.computedLocale,tabindex:this.disabled?null:"-1",title:this.ariaLabel})},computedSpinAttrs:function(){var e=this.spinId,r=this.localValue,s=this.computedRequired,g=this.disabled,T=this.state,I=this.computedFormatter,a=!fn(r);return Bl(Bl({dir:this.computedRTL?"rtl":"ltr"},this.bvAttrs),{},{id:e,role:"spinbutton",tabindex:g?null:"0","aria-live":"off","aria-label":this.ariaLabel||null,"aria-controls":this.ariaControls||null,"aria-invalid":T===!1||!a&&s?"true":null,"aria-required":s?"true":null,"aria-valuemin":Lr(this.computedMin),"aria-valuemax":Lr(this.computedMax),"aria-valuenow":a?r:null,"aria-valuetext":a?I(r):null})}},watch:(bp={},C_(bp,WR,function(t){this.localValue=hi(t,null)}),C_(bp,"localValue",function(e){this.$emit(QY,e)}),C_(bp,"disabled",function(e){e&&this.clearRepeat()}),C_(bp,"readonly",function(e){e&&this.clearRepeat()}),bp),created:function(){this.$_autoDelayTimer=null,this.$_autoRepeatTimer=null,this.$_keyIsDown=!1},beforeDestroy:function(){this.clearRepeat()},deactivated:function(){this.clearRepeat()},methods:{focus:function(){this.disabled||ii(this.$refs.spinner)},blur:function(){this.disabled||zs(this.$refs.spinner)},emitChange:function(){this.$emit(Bs,this.localValue)},stepValue:function(e){var r=this.localValue;if(!this.disabled&&!fn(r)){var s=this.computedStep*e,g=this.computedMin,T=this.computedMax,I=this.computedMultiplier,a=this.wrap;r=gS((r-g)/s)*s+g+s,r=gS(r*I)/I,this.localValue=r>T?a?g:T:r<g?a?T:g:r}},onFocusBlur:function(e){this.hasFocus=this.disabled?!1:e.type==="focus"},stepUp:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=this.localValue;fn(r)?this.localValue=this.computedMin:this.stepValue(1*e)},stepDown:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=this.localValue;fn(r)?this.localValue=this.wrap?this.computedMax:this.computedMin:this.stepValue(-1*e)},onKeydown:function(e){var r=e.keyCode,s=e.altKey,g=e.ctrlKey,T=e.metaKey;if(!(this.disabled||this.readonly||s||g||T)&&Vr(ZR,r)){if(ei(e,{propagation:!1}),this.$_keyIsDown)return;this.resetTimers(),Vr([Is,as],r)?(this.$_keyIsDown=!0,r===Is?this.handleStepRepeat(e,this.stepUp):r===as&&this.handleStepRepeat(e,this.stepDown)):r===J0?this.stepUp(this.computedStepMultiplier):r===Y0?this.stepDown(this.computedStepMultiplier):r===ch?this.localValue=this.computedMin:r===lh&&(this.localValue=this.computedMax)}},onKeyup:function(e){var r=e.keyCode,s=e.altKey,g=e.ctrlKey,T=e.metaKey;this.disabled||this.readonly||s||g||T||Vr(ZR,r)&&(ei(e,{propagation:!1}),this.resetTimers(),this.$_keyIsDown=!1,this.emitChange())},handleStepRepeat:function(e,r){var s=this,g=e||{},T=g.type,I=g.button;if(!this.disabled&&!this.readonly){if(T==="mousedown"&&I)return;this.resetTimers(),r(1);var a=this.computedThreshold,N=this.computedStepMultiplier,H=this.computedDelay,K=this.computedInterval;this.$_autoDelayTimer=setTimeout(function(){var ee=0;s.$_autoRepeatTimer=setInterval(function(){r(ee<a?1:N),ee++},K)},H)}},onMouseup:function(e){var r=e||{},s=r.type,g=r.button;s==="mouseup"&&g||(ei(e,{propagation:!1}),this.resetTimers(),this.setMouseup(!1),this.emitChange())},setMouseup:function(e){try{nl(e,document.body,"mouseup",this.onMouseup,!1),nl(e,document.body,"touchend",this.onMouseup,!1)}catch{}},resetTimers:function(){clearTimeout(this.$_autoDelayTimer),clearInterval(this.$_autoRepeatTimer),this.$_autoDelayTimer=null,this.$_autoRepeatTimer=null},clearRepeat:function(){this.resetTimers(),this.setMouseup(!1),this.$_keyIsDown=!1}},render:function(e){var r=this,s=this.spinId,g=this.localValue,T=this.computedInline,I=this.computedReadonly,a=this.vertical,N=this.disabled,H=this.computedFormatter,K=!fn(g),ee=function(Le,De,Ye,He,ht,St,st){var gt=e(Ye,{props:{scale:r.hasFocus?1.5:1.25},attrs:{"aria-hidden":"true"}}),Tt={hasFocus:r.hasFocus},at=function(gr){!N&&!I&&(ei(gr,{propagation:!1}),r.setMouseup(!0),ii(gr.currentTarget),r.handleStepRepeat(gr,Le))};return e("button",{staticClass:"btn btn-sm border-0 rounded-0",class:{"py-0":!a},attrs:{tabindex:"-1",type:"button",disabled:N||I||St,"aria-disabled":N||I||St?"true":null,"aria-controls":s,"aria-label":De||null,"aria-keyshortcuts":ht||null},on:{mousedown:at,touchstart:at},key:He||null,ref:He},[r.normalizeSlot(st,Tt)||gt])},ue=ee(this.stepUp,this.labelIncrement,lZ,"inc","ArrowUp",!1,V7),Pe=ee(this.stepDown,this.labelDecrement,sZ,"dec","ArrowDown",!1,C7),xe=e();this.name&&!N&&(xe=e("input",{attrs:{type:"hidden",name:this.name,form:this.form||null,value:this.valueAsFixed},key:"hidden"}));var Ie=e("output",{staticClass:"flex-grow-1",class:{"d-flex":a,"align-self-center":!a,"align-items-center":a,"border-top":a,"border-bottom":a,"border-left":!a,"border-right":!a},attrs:this.computedSpinAttrs,key:"output",ref:"spinner"},[e("bdi",K?H(g):this.placeholder||"")]);return e("div",{staticClass:"b-form-spinbutton form-control",class:[{disabled:N,readonly:I,focus:this.hasFocus,"d-inline-flex":T||a,"d-flex":!T&&!a,"align-items-stretch":!a,"flex-column":a},this.sizeFormClass,this.stateClass],attrs:this.computedAttrs,on:{keydown:this.onKeydown,keyup:this.onKeyup,"!focus":this.onFocusBlur,"!blur":this.onFocusBlur}},a?[ue,xe,Ie,Pe]:[Pe,xe,Ie,ue])}}),eJ=wr({components:{BFormSpinbutton:NS,BSpinbutton:NS}});function XR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function KR(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XR(Object(r),!0).forEach(function(s){tJ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function tJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var rJ=Ct(vr(KR(KR({},Hi),{},{disabled:k(Ee,!1),noRemove:k(Ee,!1),pill:k(Ee,!1),removeLabel:k(ie,"Remove tag"),tag:k(ie,"span"),title:k(ie),variant:k(ie,"secondary")})),bF),$S=ot({name:bF,mixins:[Ki,Ur],props:rJ,methods:{onRemove:function(e){var r=e.type,s=e.keyCode;!this.disabled&&(r==="click"||r==="keydown"&&s===e4)&&this.$emit(l7)}},render:function(e){var r=this.title,s=this.tag,g=this.variant,T=this.pill,I=this.disabled,a=this.safeId(),N=this.safeId("_taglabel_"),H=e();!this.noRemove&&!I&&(H=e(Ud,{staticClass:"b-form-tag-remove",props:{ariaLabel:this.removeLabel},attrs:{"aria-controls":a,"aria-describedby":N,"aria-keyshortcuts":"Delete"},on:{click:this.onRemove,keydown:this.onRemove}}));var K=e("span",{staticClass:"b-form-tag-content flex-grow-1 text-truncate",attrs:{id:N}},this.normalizeSlot()||r);return e(d4,{staticClass:"b-form-tag d-inline-flex align-items-baseline mw-100",class:{disabled:I},props:{tag:s,variant:g,pill:T},attrs:{id:a,title:r||null,"aria-labelledby":N}},[K,H])}}),u_;function YR(t){return sJ(t)||oJ(t)||nJ(t)||iJ()}function iJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nJ(t,e){if(!!t){if(typeof t=="string")return jS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jS(t,e)}}function oJ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sJ(t){if(Array.isArray(t))return jS(t)}function jS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function JR(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function ta(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?JR(Object(r),!0).forEach(function(s){T0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):JR(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function T0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var S1=Xn("value",{type:ss,defaultValue:[]}),aJ=S1.mixin,lJ=S1.props,dE=S1.prop,cJ=S1.event,M5=["text","email","tel","url","number"],uJ=[".b-form-tag","button","input","select"].join(" "),hJ=function(e){return XO(e).replace(_z,"\\s")},QR=function(e){return bi(e).map(function(r){return Ju(Lr(r))}).filter(function(r,s,g){return r.length>0&&g.indexOf(r)===s})},eL=function(e){return _i(e)?e:kd(e)&&e.target.value||""},fE=function(){return{all:[],valid:[],invalid:[],duplicate:[]}},dJ=Ct(vr(ta(ta(ta(ta(ta(ta({},Hi),lJ),cl),ul),hl),{},{addButtonText:k(ie,"Add"),addButtonVariant:k(ie,"outline-secondary"),addOnChange:k(Ee,!1),duplicateTagText:k(ie,"Duplicate tag(s)"),feedbackAriaLive:k(ie,"assertive"),ignoreInputFocusSelector:k(Ho,uJ),inputAttrs:k(Zn,{}),inputClass:k(Nr),inputId:k(ie),inputType:k(ie,"text",function(t){return Vr(M5,t)}),invalidTagText:k(ie,"Invalid tag(s)"),limit:k(Uo),limitTagsText:k(ie,"Tag limit reached"),noAddOnEnter:k(Ee,!1),noOuterFocus:k(Ee,!1),noTagRemove:k(Ee,!1),placeholder:k(ie,"Add tag..."),removeOnDelete:k(Ee,!1),separator:k(Ho),tagClass:k(Nr),tagPills:k(Ee,!1),tagRemoveLabel:k(ie,"Remove tag"),tagRemovedLabel:k(ie,"Tag removed"),tagValidator:k(ls),tagVariant:k(ie,"secondary")})),xF),tL=ot({name:xF,mixins:[Fc,Ki,aJ,Yd,Nc,Xl,Ur],props:dJ,data:function(){return{hasFocus:!1,newTag:"",tags:[],removedTags:[],tagsState:fE(),focusState:null}},computed:{computedInputId:function(){return this.inputId||this.safeId("__input__")},computedInputType:function(){return Vr(M5,this.inputType)?this.inputType:"text"},computedInputAttrs:function(){var e=this.disabled,r=this.form;return ta(ta({},this.inputAttrs),{},{id:this.computedInputId,value:this.newTag,disabled:e,form:r})},computedInputHandlers:function(){return ta(ta({},oi(this.bvListeners,[q0,W0])),{},{blur:this.onInputBlur,change:this.onInputChange,focus:this.onInputFocus,input:this.onInputInput,keydown:this.onInputKeydown,reset:this.reset})},computedSeparator:function(){return bi(this.separator).filter(_i).filter($r).join("")},computedSeparatorRegExp:function(){var e=this.computedSeparator;return e?new RegExp("[".concat(hJ(e),"]+")):null},computedJoiner:function(){var e=this.computedSeparator.charAt(0);return e!==" "?"".concat(e," "):e},computeIgnoreInputFocusSelector:function(){return bi(this.ignoreInputFocusSelector).filter($r).join(",").trim()},disableAddButton:function(){var e=this,r=Ju(this.newTag);return r===""||!this.splitTags(r).some(function(s){return!Vr(e.tags,s)&&e.validateTag(s)})},duplicateTags:function(){return this.tagsState.duplicate},hasDuplicateTags:function(){return this.duplicateTags.length>0},invalidTags:function(){return this.tagsState.invalid},hasInvalidTags:function(){return this.invalidTags.length>0},isLimitReached:function(){var e=this.limit;return rl(e)&&e>=0&&this.tags.length>=e}},watch:(u_={},T0(u_,dE,function(t){this.tags=QR(t)}),T0(u_,"tags",function(e,r){Ci(e,this[dE])||this.$emit(cJ,e),Ci(e,r)||(e=bi(e).filter($r),r=bi(r).filter($r),this.removedTags=r.filter(function(s){return!Vr(e,s)}))}),T0(u_,"tagsState",function(e,r){Ci(e,r)||this.$emit(_7,e.valid,e.invalid,e.duplicate)}),u_),created:function(){this.tags=QR(this[dE])},mounted:function(){var e=Ms("form",this.$el);e&&pn(e,"reset",this.reset,Os)},beforeDestroy:function(){var e=Ms("form",this.$el);e&&Tn(e,"reset",this.reset,Os)},methods:{addTag:function(e){if(e=_i(e)?e:this.newTag,!(this.disabled||Ju(e)===""||this.isLimitReached)){var r=this.parseTags(e);if(r.valid.length>0||r.all.length===0)if(Pc(this.getInput(),"select"))this.newTag="";else{var s=[].concat(YR(r.invalid),YR(r.duplicate));this.newTag=r.all.filter(function(g){return Vr(s,g)}).join(this.computedJoiner).concat(s.length>0?this.computedJoiner.charAt(0):"")}r.valid.length>0&&(this.tags=bi(this.tags,r.valid)),this.tagsState=r,this.focus()}},removeTag:function(e){this.disabled||(this.tags=this.tags.filter(function(r){return r!==e}))},reset:function(){var e=this;this.newTag="",this.tags=[],this.$nextTick(function(){e.removedTags=[],e.tagsState=fE()})},onInputInput:function(e){if(!(this.disabled||kd(e)&&e.target.composing)){var r=eL(e),s=this.computedSeparatorRegExp;this.newTag!==r&&(this.newTag=r),r=gW(r),s&&s.test(r.slice(-1))?this.addTag():this.tagsState=r===""?fE():this.parseTags(r)}},onInputChange:function(e){if(!this.disabled&&this.addOnChange){var r=eL(e);this.newTag!==r&&(this.newTag=r),this.addTag()}},onInputKeydown:function(e){if(!(this.disabled||!kd(e))){var r=e.keyCode,s=e.target.value||"";!this.noAddOnEnter&&r===zc?(ei(e,{propagation:!1}),this.addTag()):this.removeOnDelete&&(r===mZ||r===e4)&&s===""&&(ei(e,{propagation:!1}),this.tags=this.tags.slice(0,-1))}},onClick:function(e){var r=this,s=this.computeIgnoreInputFocusSelector;(!s||!Ms(s,e.target,!0))&&this.$nextTick(function(){r.focus()})},onInputFocus:function(e){var r=this;this.focusState!=="out"&&(this.focusState="in",this.$nextTick(function(){Vi(function(){r.hasFocus&&(r.$emit(i7,e),r.focusState=null)})}))},onInputBlur:function(e){var r=this;this.focusState!=="in"&&(this.focusState="out",this.$nextTick(function(){Vi(function(){r.hasFocus||(r.$emit(_N,e),r.focusState=null)})}))},onFocusin:function(e){this.hasFocus=!0,this.$emit(q0,e)},onFocusout:function(e){this.hasFocus=!1,this.$emit(W0,e)},handleAutofocus:function(){var e=this;this.$nextTick(function(){Vi(function(){e.autofocus&&e.focus()})})},focus:function(){this.disabled||ii(this.getInput())},blur:function(){this.disabled||zs(this.getInput())},splitTags:function(e){e=Lr(e);var r=this.computedSeparatorRegExp;return(r?e.split(r):[e]).map(Ju).filter($r)},parseTags:function(e){var r=this,s=this.splitTags(e),g={all:s,valid:[],invalid:[],duplicate:[]};return s.forEach(function(T){Vr(r.tags,T)||Vr(g.valid,T)?Vr(g.duplicate,T)||g.duplicate.push(T):r.validateTag(T)?g.valid.push(T):Vr(g.invalid,T)||g.invalid.push(T)}),g},validateTag:function(e){var r=this.tagValidator;return Gl(r)?r(e):!0},getInput:function(){return sa("#".concat(f5(this.computedInputId)),this.$el)},defaultRender:function(e){var r=e.addButtonText,s=e.addButtonVariant,g=e.addTag,T=e.disableAddButton,I=e.disabled,a=e.duplicateTagText,N=e.inputAttrs,H=e.inputClass,K=e.inputHandlers,ee=e.inputType,ue=e.invalidTagText,Pe=e.isDuplicate,xe=e.isInvalid,Ie=e.isLimitReached,dt=e.limitTagsText,Le=e.noTagRemove,De=e.placeholder,Ye=e.removeTag,He=e.tagClass,ht=e.tagPills,St=e.tagRemoveLabel,st=e.tagVariant,gt=e.tags,Tt=this.$createElement,at=gt.map(function(yi){return yi=Lr(yi),Tt($S,{class:He,props:{disabled:I,noRemove:Le,pill:ht,removeLabel:St,tag:"li",title:yi,variant:st},on:{remove:function(){return Ye(yi)}},key:"tags_".concat(yi)},yi)}),ft=ue&&xe?this.safeId("__invalid_feedback__"):null,gr=a&&Pe?this.safeId("__duplicate_feedback__"):null,xr=dt&&Ie?this.safeId("__limit_feedback__"):null,Jt=[N["aria-describedby"],ft,gr,xr].filter($r).join(" "),Zt=Tt("input",{staticClass:"b-form-tags-input w-100 flex-grow-1 p-0 m-0 bg-transparent border-0",class:H,style:{outline:0,minWidth:"5rem"},attrs:ta(ta({},N),{},{"aria-describedby":Jt||null,type:ee,placeholder:De||null}),domProps:{value:N.value},on:K,directives:[{name:"model",value:N.value}],ref:"input"}),Et=Tt(Ds,{staticClass:"b-form-tags-button py-0",class:{invisible:T},style:{fontSize:"90%"},props:{disabled:T||Ie,variant:s},on:{click:function(){return g()}},ref:"button"},[this.normalizeSlot(P7)||r]),fr=this.safeId("__tag_list__"),jr=Tt("li",{staticClass:"b-form-tags-field flex-grow-1",attrs:{role:"none","aria-live":"off","aria-controls":fr},key:"tags_field"},[Tt("div",{staticClass:"d-flex",attrs:{role:"group"}},[Zt,Et])]),er=Tt("ul",{staticClass:"b-form-tags-list list-unstyled mb-0 d-flex flex-wrap align-items-center",attrs:{id:fr},key:"tags_list"},[at,jr]),tn=Tt();if(ue||a||dt){var ln=this.feedbackAriaLive,Yi=this.computedJoiner,ir=Tt();ft&&(ir=Tt(hx,{props:{id:ft,ariaLive:ln,forceShow:!0},key:"tags_invalid_feedback"},[this.invalidTagText,": ",this.invalidTags.join(Yi)]));var us=Tt();gr&&(us=Tt(ux,{props:{id:gr,ariaLive:ln},key:"tags_duplicate_feedback"},[this.duplicateTagText,": ",this.duplicateTags.join(Yi)]));var rn=Tt();xr&&(rn=Tt(ux,{props:{id:xr,ariaLive:ln},key:"tags_limit_feedback"},[dt])),tn=Tt("div",{attrs:{"aria-live":"polite","aria-atomic":"true"},key:"tags_feedback"},[ir,us,rn])}return[er,tn]}},render:function(e){var r=this.name,s=this.disabled,g=this.required,T=this.form,I=this.tags,a=this.computedInputId,N=this.hasFocus,H=this.noOuterFocus,K=ta({tags:I.slice(),inputAttrs:this.computedInputAttrs,inputType:this.computedInputType,inputHandlers:this.computedInputHandlers,removeTag:this.removeTag,addTag:this.addTag,reset:this.reset,inputId:a,isInvalid:this.hasInvalidTags,invalidTags:this.invalidTags.slice(),isDuplicate:this.hasDuplicateTags,duplicateTags:this.duplicateTags.slice(),isLimitReached:this.isLimitReached,disableAddButton:this.disableAddButton},sl(this.$props,["addButtonText","addButtonVariant","disabled","duplicateTagText","form","inputClass","invalidTagText","limit","limitTagsText","noTagRemove","placeholder","required","separator","size","state","tagClass","tagPills","tagRemoveLabel","tagVariant"])),ee=this.normalizeSlot(eo,K)||this.defaultRender(K),ue=e("output",{staticClass:"sr-only",attrs:{id:this.safeId("__selected_tags__"),role:"status",for:a,"aria-live":N?"polite":"off","aria-atomic":"true","aria-relevant":"additions text"}},this.tags.join(", ")),Pe=e("div",{staticClass:"sr-only",attrs:{id:this.safeId("__removed_tags__"),role:"status","aria-live":N?"assertive":"off","aria-atomic":"true"}},this.removedTags.length>0?"(".concat(this.tagRemovedLabel,") ").concat(this.removedTags.join(", ")):""),xe=e();if(r&&!s){var Ie=I.length>0;xe=(Ie?I:[""]).map(function(dt){return e("input",{class:{"sr-only":!Ie},attrs:{type:Ie?"hidden":"text",value:dt,required:g,name:r,form:T},key:"tag_input_".concat(dt)})})}return e("div",{staticClass:"b-form-tags form-control h-auto",class:[{focus:N&&!H&&!s,disabled:s},this.sizeFormClass,this.stateClass],attrs:{id:this.safeId(),role:"group",tabindex:s||H?null:"-1","aria-describedby":this.safeId("__selected_tags__")},on:{click:this.onClick,focusin:this.onFocusin,focusout:this.onFocusout}},[ue,Pe,ee,xe])}}),fJ=wr({components:{BFormTags:tL,BTags:tL,BFormTag:$S,BTag:$S}});function rL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Uu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rL(Object(r),!0).forEach(function(s){pJ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function pJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mJ=Ct(vr(Uu(Uu(Uu(Uu(Uu(Uu({},Hi),cl),ul),hl),TP),{},{maxRows:k(dr),noAutoShrink:k(Ee,!1),noResize:k(Ee,!1),rows:k(dr,2),wrap:k(ie,"soft")})),TF),iL=ot({name:TF,directives:{"b-visible":lP},mixins:[Fc,Ki,al,Yd,Nc,Xl,_5,m5,y5],props:mJ,data:function(){return{heightInPx:null}},computed:{type:function(){return null},computedStyle:function(){var e={resize:!this.computedRows||this.noResize?"none":null};return this.computedRows||(e.height=this.heightInPx,e.overflowY="scroll"),e},computedMinRows:function(){return Li(or(this.rows,2),2)},computedMaxRows:function(){return Li(this.computedMinRows,or(this.maxRows,0))},computedRows:function(){return this.computedMinRows===this.computedMaxRows?this.computedMinRows:null},computedAttrs:function(){var e=this.disabled,r=this.required;return{id:this.safeId(),name:this.name||null,form:this.form||null,disabled:e,placeholder:this.placeholder||null,required:r,autocomplete:this.autocomplete||null,readonly:this.readonly||this.plaintext,rows:this.computedRows,wrap:this.wrap||null,"aria-required":this.required?"true":null,"aria-invalid":this.computedAriaInvalid}},computedListeners:function(){return Uu(Uu({},this.bvListeners),{},{input:this.onInput,change:this.onChange,blur:this.onBlur})}},watch:{localValue:function(){this.setHeight()}},mounted:function(){this.setHeight()},methods:{visibleCallback:function(e){e&&this.$nextTick(this.setHeight)},setHeight:function(){var e=this;this.$nextTick(function(){Vi(function(){e.heightInPx=e.computeHeight()})})},computeHeight:function(){if(this.$isServer||!fn(this.computedRows))return null;var e=this.$el;if(!il(e))return null;var r=ia(e),s=hi(r.lineHeight,1),g=hi(r.borderTopWidth,0)+hi(r.borderBottomWidth,0),T=hi(r.paddingTop,0)+hi(r.paddingBottom,0),I=g+T,a=s*this.computedMinRows+I,N=Mp(e,"height")||r.height;Co(e,"height","auto");var H=e.scrollHeight;Co(e,"height",N);var K=Li((H-T)/s,2),ee=Ec(Li(K,this.computedMinRows),this.computedMaxRows),ue=Li(qN(ee*s+I),a);return this.noAutoShrink&&hi(N,0)>ue?N:"".concat(ue,"px")}},render:function(e){return e("textarea",{class:this.computedClass,style:this.computedStyle,directives:[{name:"b-visible",value:this.visibleCallback,modifiers:{640:!0}}],attrs:this.computedAttrs,domProps:{value:this.localValue},on:this.computedListeners,ref:"input"})}}),gJ=wr({components:{BFormTextarea:iL,BTextarea:iL}}),cd;function nL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function M_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nL(Object(r),!0).forEach(function(s){md(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function md(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _J(t,e){return xJ(t)||bJ(t,e)||vJ(t,e)||yJ()}function yJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vJ(t,e){if(!!t){if(typeof t=="string")return oL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oL(t,e)}}function oL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function bJ(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var s=[],g=!0,T=!1,I,a;try{for(r=r.call(t);!(g=(I=r.next()).done)&&(s.push(I.value),!(e&&s.length===e));g=!0);}catch(N){T=!0,a=N}finally{try{!g&&r.return!=null&&r.return()}finally{if(T)throw a}}return s}}function xJ(t){if(Array.isArray(t))return t}var O1=Xn("value",{type:ie,defaultValue:""}),wJ=O1.mixin,TJ=O1.props,sL=O1.prop,EJ=O1.event,xp="numeric",SJ=function(e){return"00".concat(e||"").slice(-2)},Kb=function(e){e=Lr(e);var r=null,s=null,g=null;if(rq.test(e)){var T=e.split(":").map(function(a){return or(a,null)}),I=_J(T,3);r=I[0],s=I[1],g=I[2]}return{hours:ji(r)?null:r,minutes:ji(s)?null:s,seconds:ji(g)?null:g,ampm:ji(r)||r<12?0:1}},OJ=function(e){var r=e.hours,s=e.minutes,g=e.seconds,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(fn(r)||fn(s)||T&&fn(g))return"";var I=[r,s,T?g:0];return I.map(SJ).join(":")},I5=Ct(vr(M_(M_(M_(M_({},Hi),TJ),sl(C5,["labelIncrement","labelDecrement"])),{},{ariaLabelledby:k(ie),disabled:k(Ee,!1),footerTag:k(ie,"footer"),headerTag:k(ie,"header"),hidden:k(Ee,!1),hideHeader:k(Ee,!1),hour12:k(Ee,null),labelAm:k(ie,"AM"),labelAmpm:k(ie,"AM/PM"),labelHours:k(ie,"Hours"),labelMinutes:k(ie,"Minutes"),labelNoTimeSelected:k(ie,"No time selected"),labelPm:k(ie,"PM"),labelSeconds:k(ie,"Seconds"),labelSelected:k(ie,"Selected time"),locale:k(Ho),minutesStep:k(dr,1),readonly:k(Ee,!1),secondsStep:k(dr,1),showSeconds:k(Ee,!1)})),pN),D5=ot({name:pN,mixins:[Ki,wJ,Ur],props:I5,data:function(){var e=Kb(this[sL]||"");return{modelHours:e.hours,modelMinutes:e.minutes,modelSeconds:e.seconds,modelAmpm:e.ampm,isLive:!1}},computed:{computedHMS:function(){var e=this.modelHours,r=this.modelMinutes,s=this.modelSeconds;return OJ({hours:e,minutes:r,seconds:s},this.showSeconds)},resolvedOptions:function(){var e=bi(this.locale).filter($r),r={hour:xp,minute:xp,second:xp};ji(this.hour12)||(r.hour12=!!this.hour12);var s=new Intl.DateTimeFormat(e,r),g=s.resolvedOptions(),T=g.hour12||!1,I=g.hourCycle||(T?"h12":"h23");return{locale:g.locale,hour12:T,hourCycle:I}},computedLocale:function(){return this.resolvedOptions.locale},computedLang:function(){return(this.computedLocale||"").replace(/-u-.*$/,"")},computedRTL:function(){return a1(this.computedLang)},computedHourCycle:function(){return this.resolvedOptions.hourCycle},is12Hour:function(){return!!this.resolvedOptions.hour12},context:function(){return{locale:this.computedLocale,isRTL:this.computedRTL,hourCycle:this.computedHourCycle,hour12:this.is12Hour,hours:this.modelHours,minutes:this.modelMinutes,seconds:this.showSeconds?this.modelSeconds:0,value:this.computedHMS,formatted:this.formattedTimeString}},valueId:function(){return this.safeId()||null},computedAriaLabelledby:function(){return[this.ariaLabelledby,this.valueId].filter($r).join(" ")||null},timeFormatter:function(){var e={hour12:this.is12Hour,hourCycle:this.computedHourCycle,hour:xp,minute:xp,timeZone:"UTC"};return this.showSeconds&&(e.second=xp),E_(this.computedLocale,e)},numberFormatter:function(){var e=new Intl.NumberFormat(this.computedLocale,{style:"decimal",minimumIntegerDigits:2,minimumFractionDigits:0,maximumFractionDigits:0,notation:"standard"});return e.format},formattedTimeString:function(){var e=this.modelHours,r=this.modelMinutes,s=this.showSeconds&&this.modelSeconds||0;return this.computedHMS?this.timeFormatter(go(Date.UTC(0,0,1,e,r,s))):this.labelNoTimeSelected||" "},spinScopedSlots:function(){var e=this.$createElement;return{increment:function(s){var g=s.hasFocus;return e($I,{props:{scale:g?1.5:1.25},attrs:{"aria-hidden":"true"}})},decrement:function(s){var g=s.hasFocus;return e($I,{props:{flipV:!0,scale:g?1.5:1.25},attrs:{"aria-hidden":"true"}})}}}},watch:(cd={},md(cd,sL,function(t,e){if(t!==e&&!Ci(Kb(t),Kb(this.computedHMS))){var r=Kb(t),s=r.hours,g=r.minutes,T=r.seconds,I=r.ampm;this.modelHours=s,this.modelMinutes=g,this.modelSeconds=T,this.modelAmpm=I}}),md(cd,"computedHMS",function(e,r){e!==r&&this.$emit(EJ,e)}),md(cd,"context",function(e,r){Ci(e,r)||this.$emit(Kp,e)}),md(cd,"modelAmpm",function(e,r){var s=this;if(e!==r){var g=fn(this.modelHours)?0:this.modelHours;this.$nextTick(function(){e===0&&g>11?s.modelHours=g-12:e===1&&g<12&&(s.modelHours=g+12)})}}),md(cd,"modelHours",function(e,r){e!==r&&(this.modelAmpm=e>11?1:0)}),cd),created:function(){var e=this;this.$nextTick(function(){e.$emit(Kp,e.context)})},mounted:function(){this.setLive(!0)},activated:function(){this.setLive(!0)},deactivated:function(){this.setLive(!1)},beforeDestroy:function(){this.setLive(!1)},methods:{focus:function(){this.disabled||ii(this.$refs.spinners[0])},blur:function(){if(!this.disabled){var e=ah();qn(this.$el,e)&&zs(e)}},formatHours:function(e){var r=this.computedHourCycle;return e=this.is12Hour&&e>12?e-12:e,e=e===0&&r==="h12"?12:e===0&&r==="h24"?24:e===12&&r==="h11"?0:e,this.numberFormatter(e)},formatMinutes:function(e){return this.numberFormatter(e)},formatSeconds:function(e){return this.numberFormatter(e)},formatAmpm:function(e){return e===0?this.labelAm:e===1?this.labelPm:""},setHours:function(e){this.modelHours=e},setMinutes:function(e){this.modelMinutes=e},setSeconds:function(e){this.modelSeconds=e},setAmpm:function(e){this.modelAmpm=e},onSpinLeftRight:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.type,s=e.keyCode;if(!this.disabled&&r==="keydown"&&(s===ol||s===Rc)){ei(e);var g=this.$refs.spinners||[],T=g.map(function(I){return!!I.hasFocus}).indexOf(!0);T=T+(s===ol?-1:1),T=T>=g.length?0:T<0?g.length-1:T,ii(g[T])}},setLive:function(e){var r=this;e?this.$nextTick(function(){Vi(function(){r.isLive=!0})}):this.isLive=!1}},render:function(e){var r=this;if(this.hidden)return e();var s=this.disabled,g=this.readonly,T=this.computedLocale,I=this.computedAriaLabelledby,a=this.labelIncrement,N=this.labelDecrement,H=this.valueId,K=this.focus,ee=[],ue=function(He,ht,St){var st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},gt=r.safeId("_spinbutton_".concat(ht,"_"))||null;return ee.push(gt),e(NS,md({class:St,props:M_({id:gt,placeholder:"--",vertical:!0,required:!0,disabled:s,readonly:g,locale:T,labelIncrement:a,labelDecrement:N,wrap:!0,ariaControls:H,min:0},st),scopedSlots:r.spinScopedSlots,on:{change:He},key:ht,ref:"spinners"},NO,!0))},Pe=function(){return e("div",{staticClass:"d-flex flex-column",class:{"text-muted":s||g},attrs:{"aria-hidden":"true"}},[e(_S,{props:{shiftV:4,scale:.5}}),e(_S,{props:{shiftV:-4,scale:.5}})])},xe=[];xe.push(ue(this.setHours,"hours","b-time-hours",{value:this.modelHours,max:23,step:1,formatterFn:this.formatHours,ariaLabel:this.labelHours})),xe.push(Pe()),xe.push(ue(this.setMinutes,"minutes","b-time-minutes",{value:this.modelMinutes,max:59,step:this.minutesStep||1,formatterFn:this.formatMinutes,ariaLabel:this.labelMinutes})),this.showSeconds&&(xe.push(Pe()),xe.push(ue(this.setSeconds,"seconds","b-time-seconds",{value:this.modelSeconds,max:59,step:this.secondsStep||1,formatterFn:this.formatSeconds,ariaLabel:this.labelSeconds}))),this.is12Hour&&xe.push(ue(this.setAmpm,"ampm","b-time-ampm",{value:this.modelAmpm,max:1,formatterFn:this.formatAmpm,ariaLabel:this.labelAmpm,required:!1})),xe=e("div",{staticClass:"d-flex align-items-center justify-content-center mx-auto",attrs:{role:"group",tabindex:s||g?null:"-1","aria-labelledby":I},on:{keydown:this.onSpinLeftRight,click:function(He){He.target===He.currentTarget&&K()}}},xe);var Ie=e("output",{staticClass:"form-control form-control-sm text-center",class:{disabled:s||g},attrs:{id:H,role:"status",for:ee.filter($r).join(" ")||null,tabindex:s?null:"-1","aria-live":this.isLive?"polite":"off","aria-atomic":"true"},on:{click:K,focus:K}},[e("bdi",this.formattedTimeString),this.computedHMS?e("span",{staticClass:"sr-only"}," (".concat(this.labelSelected,") ")):""]),dt=e(this.headerTag,{staticClass:"b-time-header",class:{"sr-only":this.hideHeader}},[Ie]),Le=this.normalizeSlot(),De=Le?e(this.footerTag,{staticClass:"b-time-footer"},Le):e();return e("div",{staticClass:"b-time d-inline-flex flex-column text-center",attrs:{role:"group",lang:this.computedLang||null,"aria-labelledby":I||null,"aria-disabled":s?"true":null,"aria-readonly":g&&!s?"true":null}},[dt,xe,De])}}),Yb;function aL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function wc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aL(Object(r),!0).forEach(function(s){E0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function E0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var P1=Xn("value",{type:ie,defaultValue:""}),PJ=P1.mixin,AJ=P1.props,lL=P1.prop,CJ=P1.event,R5=oi(I5,["hidden","id","value"]),L5=oi(wP,["formattedValue","id","lang","rtl","value"]),MJ=Ct(vr(wc(wc(wc(wc(wc({},Hi),AJ),R5),L5),{},{closeButtonVariant:k(ie,"outline-secondary"),labelCloseButton:k(ie,"Close"),labelNowButton:k(ie,"Select now"),labelResetButton:k(ie,"Reset"),noCloseButton:k(Ee,!1),nowButton:k(Ee,!1),nowButtonVariant:k(ie,"outline-primary"),resetButton:k(Ee,!1),resetButtonVariant:k(ie,"outline-danger"),resetValue:k(Id)})),EF),cL=ot({name:EF,mixins:[Ki,PJ],props:MJ,data:function(){return{localHMS:this[lL]||"",localLocale:null,isRTL:!1,formattedValue:"",isVisible:!1}},computed:{computedLang:function(){return(this.localLocale||"").replace(/-u-.*$/i,"")||null}},watch:(Yb={},E0(Yb,lL,function(t){this.localHMS=t||""}),E0(Yb,"localHMS",function(e){this.isVisible&&this.$emit(CJ,e||"")}),Yb),methods:{focus:function(){this.disabled||ii(this.$refs.control)},blur:function(){this.disabled||zs(this.$refs.control)},setAndClose:function(e){var r=this;this.localHMS=e,this.$nextTick(function(){r.$refs.control.hide(!0)})},onInput:function(e){this.localHMS!==e&&(this.localHMS=e)},onContext:function(e){var r=e.isRTL,s=e.locale,g=e.value,T=e.formatted;this.isRTL=r,this.localLocale=s,this.formattedValue=T,this.localHMS=g||"",this.$emit(Kp,e)},onNowButton:function(){var e=new Date,r=e.getHours(),s=e.getMinutes(),g=this.showSeconds?e.getSeconds():0,T=[r,s,g].map(function(I){return"00".concat(I||"").slice(-2)}).join(":");this.setAndClose(T)},onResetButton:function(){this.setAndClose(this.resetValue)},onCloseButton:function(){this.$refs.control.hide(!0)},onShow:function(){this.isVisible=!0},onShown:function(){var e=this;this.$nextTick(function(){ii(e.$refs.time),e.$emit(os)})},onHidden:function(){this.isVisible=!1,this.$emit(zn)},defaultButtonFn:function(e){var r=e.isHovered,s=e.hasFocus;return this.$createElement(r||s?oZ:nZ,{attrs:{"aria-hidden":"true"}})}},render:function(e){var r=this.localHMS,s=this.disabled,g=this.readonly,T=this.$props,I=ji(this.placeholder)?this.labelNoTimeSelected:this.placeholder,a=[];if(this.nowButton){var N=this.labelNowButton;a.push(e(Ds,{props:{size:"sm",disabled:s||g,variant:this.nowButtonVariant},attrs:{"aria-label":N||null},on:{click:this.onNowButton},key:"now-btn"},N))}if(this.resetButton){a.length>0&&a.push(e("span","\xA0"));var H=this.labelResetButton;a.push(e(Ds,{props:{size:"sm",disabled:s||g,variant:this.resetButtonVariant},attrs:{"aria-label":H||null},on:{click:this.onResetButton},key:"reset-btn"},H))}if(!this.noCloseButton){a.length>0&&a.push(e("span","\xA0"));var K=this.labelCloseButton;a.push(e(Ds,{props:{size:"sm",disabled:s,variant:this.closeButtonVariant},attrs:{"aria-label":K||null},on:{click:this.onCloseButton},key:"close-btn"},K))}a.length>0&&(a=[e("div",{staticClass:"b-form-date-controls d-flex flex-wrap",class:{"justify-content-between":a.length>1,"justify-content-end":a.length<2}},a)]);var ee=e(D5,{staticClass:"b-form-time-control",props:wc(wc({},mn(R5,T)),{},{value:r,hidden:!this.isVisible}),on:{input:this.onInput,context:this.onContext},ref:"time"},a);return e(c5,{staticClass:"b-form-timepicker",props:wc(wc({},mn(L5,T)),{},{id:this.safeId(),value:r,formattedValue:r?this.formattedValue:"",placeholder:I,rtl:this.isRTL,lang:this.computedLang}),on:{show:this.onShow,shown:this.onShown,hidden:this.onHidden},scopedSlots:E0({},Ic,this.$scopedSlots[Ic]||this.defaultButtonFn),ref:"control"},[ee])}}),IJ=wr({components:{BFormTimepicker:cL,BTimepicker:cL}}),DJ=wr({components:{BImg:oP,BImgLazy:A4}}),RJ=Ct({tag:k(ie,"div")},RF),mx=ot({name:RF,functional:!0,props:RJ,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.tag,Sr(g,{staticClass:"input-group-text"}),T)}}),EP=Ct({append:k(Ee,!1),id:k(ie),isText:k(Ee,!1),tag:k(ie,"div")},MF),SP=ot({name:MF,functional:!0,props:EP,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.append;return e(s.tag,Sr(g,{class:{"input-group-append":I,"input-group-prepend":!I},attrs:{id:s.id}}),s.isText?[e(mx,T)]:T)}});function uL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function hL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uL(Object(r),!0).forEach(function(s){LJ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function LJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var BJ=Ct(oi(EP,["append"]),IF),B5=ot({name:IF,functional:!0,props:BJ,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(SP,Sr(g,{props:hL(hL({},s),{},{append:!0})}),T)}});function dL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function fL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dL(Object(r),!0).forEach(function(s){kJ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function kJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var zJ=Ct(oi(EP,["append"]),DF),k5=ot({name:DF,functional:!0,props:zJ,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(SP,Sr(g,{props:fL(fL({},s),{},{append:!1})}),T)}});function FJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var NJ=Ct({append:k(ie),appendHtml:k(ie),id:k(ie),prepend:k(ie),prependHtml:k(ie),size:k(ie),tag:k(ie,"div")},CF),$J=ot({name:CF,functional:!0,props:NJ,render:function(e,r){var s=r.props,g=r.data,T=r.slots,I=r.scopedSlots,a=s.prepend,N=s.prependHtml,H=s.append,K=s.appendHtml,ee=s.size,ue=I||{},Pe=T(),xe={},Ie=e(),dt=Dc(bI,ue,Pe);(dt||a||N)&&(Ie=e(k5,[dt?vo(bI,xe,ue,Pe):e(mx,{domProps:En(N,a)})]));var Le=e(),De=Dc(dI,ue,Pe);return(De||H||K)&&(Le=e(B5,[De?vo(dI,xe,ue,Pe):e(mx,{domProps:En(K,H)})])),e(s.tag,Sr(g,{staticClass:"input-group",class:FJ({},"input-group-".concat(ee),ee),attrs:{id:s.id||null,role:"group"}}),[Ie,vo(eo,xe,ue,Pe),Le])}}),jJ=wr({components:{BInputGroup:$J,BInputGroupAddon:SP,BInputGroupPrepend:k5,BInputGroupAppend:B5,BInputGroupText:mx}});function VJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var UJ=Ct({fluid:k(qo,!1),tag:k(ie,"div")},Xz),z5=ot({name:Xz,functional:!0,props:UJ,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.fluid;return e(s.tag,Sr(g,{class:VJ({container:!(I||I===""),"container-fluid":I===!0||I===""},"container-".concat(I),I&&I!==!0)}),T)}});function h_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var GJ=Ct({bgVariant:k(ie),borderVariant:k(ie),containerFluid:k(qo,!1),fluid:k(Ee,!1),header:k(ie),headerHtml:k(ie),headerLevel:k(dr,3),headerTag:k(ie,"h1"),lead:k(ie),leadHtml:k(ie),leadTag:k(ie,"p"),tag:k(ie,"div"),textVariant:k(ie)},LF),HJ=ot({name:LF,functional:!0,props:GJ,render:function(e,r){var s,g=r.props,T=r.data,I=r.slots,a=r.scopedSlots,N=g.header,H=g.headerHtml,K=g.lead,ee=g.leadHtml,ue=g.textVariant,Pe=g.bgVariant,xe=g.borderVariant,Ie=a||{},dt=I(),Le={},De=e(),Ye=Dc(sh,Ie,dt);if(Ye||N||H){var He=g.headerLevel;De=e(g.headerTag,{class:h_({},"display-".concat(He),He),domProps:Ye?{}:En(H,N)},vo(sh,Le,Ie,dt))}var ht=e(),St=Dc(_I,Ie,dt);(St||K||ee)&&(ht=e(g.leadTag,{staticClass:"lead",domProps:St?{}:En(ee,K)},vo(_I,Le,Ie,dt)));var st=[De,ht,vo(eo,Le,Ie,dt)];return g.fluid&&(st=[e(z5,{props:{fluid:g.containerFluid}},st)]),e(g.tag,Sr(T,{staticClass:"jumbotron",class:(s={"jumbotron-fluid":g.fluid},h_(s,"text-".concat(ue),ue),h_(s,"bg-".concat(Pe),Pe),h_(s,"border-".concat(xe),xe),h_(s,"border",xe),s)}),st)}}),qJ=wr({components:{BJumbotron:HJ}});function pL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function mL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?pL(Object(r),!0).forEach(function(s){S0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):pL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function S0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var pE=["start","end","center"],WJ=Ay(function(t,e){return e=Ju(Lr(e)),e?X0(["row-cols",t,e].filter($r).join("-")):null}),ZJ=Ay(function(t){return X0(t.replace("cols",""))}),F5=[],XJ=function(){var e=cy().reduce(function(r,s){return r[Qu(s,"cols")]=k(dr),r},qu(null));return F5=Gr(e),Ct(vr(mL(mL({},e),{},{alignContent:k(ie,null,function(r){return Vr(bi(pE,"between","around","stretch"),r)}),alignH:k(ie,null,function(r){return Vr(bi(pE,"between","around"),r)}),alignV:k(ie,null,function(r){return Vr(bi(pE,"baseline","stretch"),r)}),noGutters:k(Ee,!1),tag:k(ie,"div")})),YF)},KJ={name:YF,functional:!0,get props(){return delete this.props,this.props=XJ(),this.props},render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.alignV,N=g.alignH,H=g.alignContent,K=[];return F5.forEach(function(ee){var ue=WJ(ZJ(ee),g[ee]);ue&&K.push(ue)}),K.push((s={"no-gutters":g.noGutters},S0(s,"align-items-".concat(a),a),S0(s,"justify-content-".concat(N),N),S0(s,"align-content-".concat(H),H),s)),e(g.tag,Sr(T,{staticClass:"row",class:K}),I)}},YJ=wr({components:{BContainer:z5,BRow:KJ,BCol:x0,BFormRow:dx}}),JJ=wr({components:{BLink:ks}});function QJ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var eQ=Ct({flush:k(Ee,!1),horizontal:k(qo,!1),tag:k(ie,"div")},BF),tQ=ot({name:BF,functional:!0,props:eQ,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.horizontal===""?!0:s.horizontal;I=s.flush?!1:I;var a={staticClass:"list-group",class:QJ({"list-group-flush":s.flush,"list-group-horizontal":I===!0},"list-group-horizontal-".concat(I),_i(I))};return e(s.tag,Sr(g,a),T)}});function gL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function _L(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gL(Object(r),!0).forEach(function(s){I_(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function I_(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var rQ=["a","router-link","button","b-link"],A1=oi(ll,["event","routerTag"]);delete A1.href.default;delete A1.to.default;var iQ=Ct(vr(_L(_L({},A1),{},{action:k(Ee,!1),button:k(Ee,!1),tag:k(ie,"div"),variant:k(ie)})),kF),nQ=ot({name:kF,functional:!0,props:iQ,render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.button,N=g.variant,H=g.active,K=g.disabled,ee=Cy(g),ue=a?"button":ee?ks:g.tag,Pe=!!(g.action||ee||a||Vr(rQ,g.tag)),xe={},Ie={};return Wl(ue,"button")?((!T.attrs||!T.attrs.type)&&(xe.type="button"),g.disabled&&(xe.disabled=!0)):Ie=mn(A1,g),e(ue,Sr(T,{attrs:xe,props:Ie,staticClass:"list-group-item",class:(s={},I_(s,"list-group-item-".concat(N),N),I_(s,"list-group-item-action",Pe),I_(s,"active",H),I_(s,"disabled",K),s)}),I)}}),oQ=wr({components:{BListGroup:tQ,BListGroupItem:nQ}});function sQ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var aQ=Ct({right:k(Ee,!1),tag:k(ie,"div"),verticalAlign:k(ie,"top")},FF),N5=ot({name:FF,functional:!0,props:aQ,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.verticalAlign,a=I==="top"?"start":I==="bottom"?"end":I;return e(s.tag,Sr(g,{staticClass:"media-aside",class:sQ({"media-aside-right":s.right},"align-self-".concat(a),a)}),T)}}),lQ=Ct({tag:k(ie,"div")},NF),$5=ot({name:NF,functional:!0,props:lQ,render:function(e,r){var s=r.props,g=r.data,T=r.children;return e(s.tag,Sr(g,{staticClass:"media-body"}),T)}}),cQ=Ct({noBody:k(Ee,!1),rightAlign:k(Ee,!1),tag:k(ie,"div"),verticalAlign:k(ie,"top")},zF),uQ=ot({name:zF,functional:!0,props:cQ,render:function(e,r){var s=r.props,g=r.data,T=r.slots,I=r.scopedSlots,a=r.children,N=s.noBody,H=s.rightAlign,K=s.verticalAlign,ee=N?a:[];if(!N){var ue={},Pe=T(),xe=I||{};ee.push(e($5,vo(eo,ue,xe,Pe)));var Ie=vo(A7,ue,xe,Pe);Ie&&ee[H?"push":"unshift"](e(N5,{props:{right:H,verticalAlign:K}},Ie))}return e(s.tag,Sr(g,{staticClass:"media"}),ee)}}),hQ=wr({components:{BMedia:uQ,BMediaAside:N5,BMediaBody:$5}}),Ks="$_documentListeners",dQ=ot({created:function(){this[Ks]={}},beforeDestroy:function(){var e=this;Gr(this[Ks]||{}).forEach(function(r){e[Ks][r].forEach(function(s){e.listenOffDocument(r,s)})}),this[Ks]=null},methods:{registerDocumentListener:function(e,r){this[Ks]&&(this[Ks][e]=this[Ks][e]||[],Vr(this[Ks][e],r)||this[Ks][e].push(r))},unregisterDocumentListener:function(e,r){this[Ks]&&this[Ks][e]&&(this[Ks][e]=this[Ks][e].filter(function(s){return s!==r}))},listenDocument:function(e,r,s){e?this.listenOnDocument(r,s):this.listenOffDocument(r,s)},listenOnDocument:function(e,r){Xi&&(pn(document,e,r,gi),this.registerDocumentListener(e,r))},listenOffDocument:function(e,r){Xi&&Tn(document,e,r,gi),this.unregisterDocumentListener(e,r)}}}),Ys="$_windowListeners",fQ=ot({created:function(){this[Ys]={}},beforeDestroy:function(){var e=this;Gr(this[Ys]||{}).forEach(function(r){e[Ys][r].forEach(function(s){e.listenOffWindow(r,s)})}),this[Ys]=null},methods:{registerWindowListener:function(e,r){this[Ys]&&(this[Ys][e]=this[Ys][e]||[],Vr(this[Ys][e],r)||this[Ys][e].push(r))},unregisterWindowListener:function(e,r){this[Ys]&&this[Ys][e]&&(this[Ys][e]=this[Ys][e].filter(function(s){return s!==r}))},listenWindow:function(e,r,s){e?this.listenOnWindow(r,s):this.listenOffWindow(r,s)},listenOnWindow:function(e,r){Xi&&(pn(window,e,r,gi),this.registerWindowListener(e,r))},listenOffWindow:function(e,r){Xi&&Tn(window,e,r,gi),this.unregisterWindowListener(e,r)}}}),fh=ot({computed:{bvParent:function(){return this.$parent||this.$root===this&&this.$options.bvParent}}}),im=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return e&&e.$options._scopeId||r};function pQ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var OP=ot({mixins:[fh],computed:{scopedStyleAttrs:function(){var e=im(this.bvParent);return e?pQ({},e,""):{}}}});function yL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function vL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yL(Object(r),!0).forEach(function(s){mQ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function mQ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ph=function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},g=e.$root?e.$root.$options.bvEventRoot||e.$root:null;return new r(vL(vL({},s),{},{bvParent:e,bvEventRoot:g}))},gQ=ot({abstract:!0,name:Yq,props:{nodes:k(DN)},data:function(e){return{updatedNodes:e.nodes}},destroyed:function(){xW(this.$el)},render:function(e){var r=this.updatedNodes,s=Mr(r)?r({}):r;return s=bi(s).filter($r),s&&s.length>0&&!s[0].text?s[0]:e()}}),j5={container:k([Yu,ie],"body"),disabled:k(Ee,!1),tag:k(ie,"div")},_Q=ot({name:gN,mixins:[Ur],props:j5,watch:{disabled:{immediate:!0,handler:function(e){e?this.unmountTarget():this.$nextTick(this.mountTarget)}}},created:function(){this.$_defaultFn=null,this.$_target=null},beforeMount:function(){this.mountTarget()},updated:function(){this.updateTarget()},beforeDestroy:function(){this.unmountTarget(),this.$_defaultFn=null},methods:{getContainer:function(){if(Xi){var e=this.container;return _i(e)?sa(e):e}else return null},mountTarget:function(){if(!this.$_target){var e=this.getContainer();if(e){var r=document.createElement("div");e.appendChild(r),this.$_target=ph(this,gQ,{el:r,propsData:{nodes:bi(this.normalizeSlot())}})}}},updateTarget:function(){if(Xi&&this.$_target){var e=this.$scopedSlots.default;this.disabled||(e&&this.$_defaultFn!==e?this.$_target.updatedNodes=e:e||(this.$_target.updatedNodes=this.$slots.default)),this.$_defaultFn=e}},unmountTarget:function(){this.$_target&&this.$_target.$destroy(),this.$_target=null}},render:function(e){if(this.disabled){var r=bi(this.normalizeSlot()).filter($r);if(r.length>0&&!r[0].text)return r[0]}return e()}}),yQ=ot({name:gN,mixins:[Ur],props:j5,render:function(e){if(this.disabled){var r=bi(this.normalizeSlot()).filter($r);if(r.length>0)return r[0]}return e(An.Teleport,{to:this.container},this.normalizeSlot())}}),vQ=cs?yQ:_Q;function VS(t){return VS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VS(t)}function bL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function xL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bL(Object(r),!0).forEach(function(s){bQ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function bQ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wL(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function wQ(t,e,r){return e&&wL(t.prototype,e),r&&wL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function O0(){return typeof Reflect<"u"&&Reflect.get?O0=Reflect.get:O0=function(e,r,s){var g=TQ(e,r);if(!!g){var T=Object.getOwnPropertyDescriptor(g,r);return T.get?T.get.call(arguments.length<3?e:s):T.value}},O0.apply(this,arguments)}function TQ(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=nm(t),t!==null););return t}function EQ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&US(t,e)}function US(t,e){return US=Object.setPrototypeOf||function(s,g){return s.__proto__=g,s},US(t,e)}function SQ(t){var e=PQ();return function(){var s=nm(t),g;if(e){var T=nm(this).constructor;g=Reflect.construct(s,arguments,T)}else g=s.apply(this,arguments);return OQ(this,g)}}function OQ(t,e){if(e&&(VS(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V5(t)}function V5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nm(t){return nm=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},nm(t)}var AQ=function(t){EQ(r,t);var e=SQ(r);function r(s){var g,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return xQ(this,r),g=e.call(this,s,T),Jx(V5(g),{trigger:Ia()}),g}return wQ(r,null,[{key:"Defaults",get:function(){return xL(xL({},O0(nm(r),"Defaults",this)),{},{trigger:null})}}]),r}(Kd),TL=1040,CQ=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",MQ=".sticky-top",IQ=".navbar-toggler",DQ=ot({data:function(){return{modals:[],baseZIndex:null,scrollbarWidth:null,isBodyOverflowing:!1}},computed:{modalCount:function(){return this.modals.length},modalsAreOpen:function(){return this.modalCount>0}},watch:{modalCount:function(e,r){Xi&&(this.getScrollbarWidth(),e>0&&r===0?(this.checkScrollbar(),this.setScrollbar(),ns(document.body,"modal-open")):e===0&&r>0&&(this.resetScrollbar(),jo(document.body,"modal-open")),yn(document.body,"data-modal-open-count",String(e)))},modals:function(e){var r=this;this.checkScrollbar(),Vi(function(){r.updateModals(e||[])})}},methods:{registerModal:function(e){e&&this.modals.indexOf(e)===-1&&this.modals.push(e)},unregisterModal:function(e){var r=this.modals.indexOf(e);r>-1&&(this.modals.splice(r,1),!e._isBeingDestroyed&&!e._isDestroyed&&this.resetModal(e))},getBaseZIndex:function(){if(Xi&&fn(this.baseZIndex)){var e=document.createElement("div");ns(e,"modal-backdrop"),ns(e,"d-none"),Co(e,"display","none"),document.body.appendChild(e),this.baseZIndex=or(ia(e).zIndex,TL),document.body.removeChild(e)}return this.baseZIndex||TL},getScrollbarWidth:function(){if(Xi&&fn(this.scrollbarWidth)){var e=document.createElement("div");ns(e,"modal-scrollbar-measure"),document.body.appendChild(e),this.scrollbarWidth=Vd(e).width-e.clientWidth,document.body.removeChild(e)}return this.scrollbarWidth||0},updateModals:function(e){var r=this,s=this.getBaseZIndex(),g=this.getScrollbarWidth();e.forEach(function(T,I){T.zIndex=s+I,T.scrollbarWidth=g,T.isTop=I===r.modals.length-1,T.isBodyOverflowing=r.isBodyOverflowing})},resetModal:function(e){e&&(e.zIndex=this.getBaseZIndex(),e.isTop=!0,e.isBodyOverflowing=!1)},checkScrollbar:function(){var e=Vd(document.body),r=e.left,s=e.right;this.isBodyOverflowing=r+s<window.innerWidth},setScrollbar:function(){var e=document.body;if(e._paddingChangedForModal=e._paddingChangedForModal||[],e._marginChangedForModal=e._marginChangedForModal||[],this.isBodyOverflowing){var r=this.scrollbarWidth;ca(CQ).forEach(function(g){var T=Mp(g,"paddingRight")||"";yn(g,"data-padding-right",T),Co(g,"paddingRight","".concat(hi(ia(g).paddingRight,0)+r,"px")),e._paddingChangedForModal.push(g)}),ca(MQ).forEach(function(g){var T=Mp(g,"marginRight")||"";yn(g,"data-margin-right",T),Co(g,"marginRight","".concat(hi(ia(g).marginRight,0)-r,"px")),e._marginChangedForModal.push(g)}),ca(IQ).forEach(function(g){var T=Mp(g,"marginRight")||"";yn(g,"data-margin-right",T),Co(g,"marginRight","".concat(hi(ia(g).marginRight,0)+r,"px")),e._marginChangedForModal.push(g)});var s=Mp(e,"paddingRight")||"";yn(e,"data-padding-right",s),Co(e,"paddingRight","".concat(hi(ia(e).paddingRight,0)+r,"px"))}},resetScrollbar:function(){var e=document.body;e._paddingChangedForModal&&e._paddingChangedForModal.forEach(function(r){$l(r,"data-padding-right")&&(Co(r,"paddingRight",aa(r,"data-padding-right")||""),Nl(r,"data-padding-right"))}),e._marginChangedForModal&&e._marginChangedForModal.forEach(function(r){$l(r,"data-margin-right")&&(Co(r,"marginRight",aa(r,"data-margin-right")||""),Nl(r,"data-margin-right"))}),e._paddingChangedForModal=null,e._marginChangedForModal=null,$l(e,"data-padding-right")&&(Co(e,"paddingRight",aa(e,"data-padding-right")||""),Nl(e,"data-padding-right"))}}}),wp=new DQ;function EL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Gu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EL(Object(r),!0).forEach(function(s){Js(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Js(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var C1=Xn("visible",{type:Ee,defaultValue:!1,event:Bs}),RQ=C1.mixin,LQ=C1.props,mE=C1.prop,BQ=C1.event,kQ="backdrop",zQ="esc",FQ="FORCE",NQ="toggle",P0="cancel",A0="headerclose",C0="ok",$Q=[P0,A0,C0],jQ={subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["style","class"]},U5=Ct(vr(Gu(Gu(Gu({},Hi),LQ),{},{ariaLabel:k(ie),autoFocusButton:k(ie,null,function(t){return ji(t)||Vr($Q,t)}),bodyBgVariant:k(ie),bodyClass:k(Nr),bodyTextVariant:k(ie),busy:k(Ee,!1),buttonSize:k(ie),cancelDisabled:k(Ee,!1),cancelTitle:k(ie,"Cancel"),cancelTitleHtml:k(ie),cancelVariant:k(ie,"secondary"),centered:k(Ee,!1),contentClass:k(Nr),dialogClass:k(Nr),footerBgVariant:k(ie),footerBorderVariant:k(ie),footerClass:k(Nr),footerTag:k(ie,"footer"),footerTextVariant:k(ie),headerBgVariant:k(ie),headerBorderVariant:k(ie),headerClass:k(Nr),headerCloseContent:k(ie,"&times;"),headerCloseLabel:k(ie,"Close"),headerCloseVariant:k(ie),headerTag:k(ie,"header"),headerTextVariant:k(ie),hideBackdrop:k(Ee,!1),hideFooter:k(Ee,!1),hideHeader:k(Ee,!1),hideHeaderClose:k(Ee,!1),ignoreEnforceFocusSelector:k(Ho),lazy:k(Ee,!1),modalClass:k(Nr),noCloseOnBackdrop:k(Ee,!1),noCloseOnEsc:k(Ee,!1),noEnforceFocus:k(Ee,!1),noFade:k(Ee,!1),noStacking:k(Ee,!1),okDisabled:k(Ee,!1),okOnly:k(Ee,!1),okTitle:k(ie,"OK"),okTitleHtml:k(ie),okVariant:k(ie,"primary"),returnFocus:k([Yu,Zn,ie]),scrollable:k(Ee,!1),size:k(ie,"md"),static:k(Ee,!1),title:k(ie),titleClass:k(Nr),titleHtml:k(ie),titleSrOnly:k(Ee,!1),titleTag:k(ie,"h5")})),Es),G5=ot({name:Es,mixins:[lo,Ki,RQ,dQ,al,fQ,Ur,OP],inheritAttrs:!1,props:U5,data:function(){return{isHidden:!0,isVisible:!1,isTransitioning:!1,isShow:!1,isBlock:!1,isOpening:!1,isClosing:!1,ignoreBackdropClick:!1,isModalOverflowing:!1,scrollbarWidth:0,zIndex:wp.getBaseZIndex(),isTop:!0,isBodyOverflowing:!1}},computed:{modalId:function(){return this.safeId()},modalOuterId:function(){return this.safeId("__BV_modal_outer_")},modalHeaderId:function(){return this.safeId("__BV_modal_header_")},modalBodyId:function(){return this.safeId("__BV_modal_body_")},modalTitleId:function(){return this.safeId("__BV_modal_title_")},modalContentId:function(){return this.safeId("__BV_modal_content_")},modalFooterId:function(){return this.safeId("__BV_modal_footer_")},modalBackdropId:function(){return this.safeId("__BV_modal_backdrop_")},modalClasses:function(){return[{fade:!this.noFade,show:this.isShow},this.modalClass]},modalStyles:function(){var e="".concat(this.scrollbarWidth,"px");return{paddingLeft:!this.isBodyOverflowing&&this.isModalOverflowing?e:"",paddingRight:this.isBodyOverflowing&&!this.isModalOverflowing?e:"",display:this.isBlock?"block":"none"}},dialogClasses:function(){var e;return[(e={},Js(e,"modal-".concat(this.size),this.size),Js(e,"modal-dialog-centered",this.centered),Js(e,"modal-dialog-scrollable",this.scrollable),e),this.dialogClass]},headerClasses:function(){var e;return[(e={},Js(e,"bg-".concat(this.headerBgVariant),this.headerBgVariant),Js(e,"text-".concat(this.headerTextVariant),this.headerTextVariant),Js(e,"border-".concat(this.headerBorderVariant),this.headerBorderVariant),e),this.headerClass]},titleClasses:function(){return[{"sr-only":this.titleSrOnly},this.titleClass]},bodyClasses:function(){var e;return[(e={},Js(e,"bg-".concat(this.bodyBgVariant),this.bodyBgVariant),Js(e,"text-".concat(this.bodyTextVariant),this.bodyTextVariant),e),this.bodyClass]},footerClasses:function(){var e;return[(e={},Js(e,"bg-".concat(this.footerBgVariant),this.footerBgVariant),Js(e,"text-".concat(this.footerTextVariant),this.footerTextVariant),Js(e,"border-".concat(this.footerBorderVariant),this.footerBorderVariant),e),this.footerClass]},modalOuterStyle:function(){return{position:"absolute",zIndex:this.zIndex}},slotScope:function(){return{cancel:this.onCancel,close:this.onClose,hide:this.hide,ok:this.onOk,visible:this.isVisible}},computeIgnoreEnforceFocusSelector:function(){return bi(this.ignoreEnforceFocusSelector).filter($r).join(",").trim()},computedAttrs:function(){var e=this.static?{}:this.scopedStyleAttrs;return Gu(Gu(Gu({},e),this.bvAttrs),{},{id:this.modalOuterId})},computedModalAttrs:function(){var e=this.isVisible,r=this.ariaLabel;return{id:this.modalId,role:"dialog","aria-hidden":e?null:"true","aria-modal":e?"true":null,"aria-label":r,"aria-labelledby":this.hideHeader||r||!(this.hasNormalizedSlot(NT)||this.titleHtml||this.title)?null:this.modalTitleId,"aria-describedby":this.modalBodyId}}},watch:Js({},mE,function(t,e){t!==e&&this[t?"show":"hide"]()}),created:function(){this.$_observer=null,this.$_returnFocus=this.returnFocus||null},mounted:function(){this.zIndex=wp.getBaseZIndex(),this.listenOnRoot(Wn(Es,yo),this.showHandler),this.listenOnRoot(Wn(Es,Cs),this.hideHandler),this.listenOnRoot(Wn(Es,AN),this.toggleHandler),this.listenOnRoot(Cn(Es,yo),this.modalListener),this[mE]===!0&&this.$nextTick(this.show)},beforeDestroy:function(){wp.unregisterModal(this),this.setObserver(!1),this.isVisible&&(this.isVisible=!1,this.isShow=!1,this.isTransitioning=!1)},methods:{setObserver:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.$_observer&&this.$_observer.disconnect(),this.$_observer=null,e&&(this.$_observer=dy(this.$refs.content,this.checkModalOverflow.bind(this),jQ))},updateModel:function(e){e!==this[mE]&&this.$emit(BQ,e)},buildEvent:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new AQ(e,Gu(Gu({cancelable:!1,target:this.$refs.modal||this.$el||null,relatedTarget:null,trigger:null},r),{},{vueTarget:this,componentId:this.modalId}))},show:function(){if(!(this.isVisible||this.isOpening)){if(this.isClosing){this.$once(zn,this.show);return}this.isOpening=!0,this.$_returnFocus=this.$_returnFocus||this.getActiveElement();var e=this.buildEvent(yo,{cancelable:!0});if(this.emitEvent(e),e.defaultPrevented||this.isVisible){this.isOpening=!1,this.updateModel(!1);return}this.doShow()}},hide:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(!(!this.isVisible||this.isClosing)){this.isClosing=!0;var r=this.buildEvent(Cs,{cancelable:e!==FQ,trigger:e||null});if(e===C0?this.$emit(o7,r):e===P0?this.$emit(Qq,r):e===A0&&this.$emit(aS,r),this.emitEvent(r),r.defaultPrevented||!this.isVisible){this.isClosing=!1,this.updateModel(!0);return}this.setObserver(!1),this.isVisible=!1,this.updateModel(!1)}},toggle:function(e){e&&(this.$_returnFocus=e),this.isVisible?this.hide(NQ):this.show()},getActiveElement:function(){var e=ah(Xi?[document.body]:[]);return e&&e.focus?e:null},doShow:function(){var e=this;if(wp.modalsAreOpen&&this.noStacking){this.listenOnRootOnce(Cn(Es,zn),this.doShow);return}wp.registerModal(this),this.isHidden=!1,this.$nextTick(function(){e.isVisible=!0,e.isOpening=!1,e.updateModel(!0),e.$nextTick(function(){e.setObserver(!0)})})},onBeforeEnter:function(){this.isTransitioning=!0,this.setResizeEvent(!0)},onEnter:function(){var e=this;this.isBlock=!0,Vi(function(){Vi(function(){e.isShow=!0})})},onAfterEnter:function(){var e=this;this.checkModalOverflow(),this.isTransitioning=!1,Vi(function(){e.emitEvent(e.buildEvent(os)),e.setEnforceFocus(!0),e.$nextTick(function(){e.focusFirst()})})},onBeforeLeave:function(){this.isTransitioning=!0,this.setResizeEvent(!1),this.setEnforceFocus(!1)},onLeave:function(){this.isShow=!1},onAfterLeave:function(){var e=this;this.isBlock=!1,this.isTransitioning=!1,this.isModalOverflowing=!1,this.isHidden=!0,this.$nextTick(function(){e.isClosing=!1,wp.unregisterModal(e),e.returnFocusTo(),e.emitEvent(e.buildEvent(zn))})},emitEvent:function(e){var r=e.type;this.emitOnRoot(Cn(Es,r),e,e.componentId),this.$emit(r,e)},onDialogMousedown:function(){var e=this,r=this.$refs.modal,s=function g(T){Tn(r,"mouseup",g,gi),T.target===r&&(e.ignoreBackdropClick=!0)};pn(r,"mouseup",s,gi)},onClickOut:function(e){if(this.ignoreBackdropClick){this.ignoreBackdropClick=!1;return}!this.isVisible||this.noCloseOnBackdrop||!qn(document.body,e.target)||qn(this.$refs.content,e.target)||this.hide(kQ)},onOk:function(){this.hide(C0)},onCancel:function(){this.hide(P0)},onClose:function(){this.hide(A0)},onEsc:function(e){e.keyCode===QO&&this.isVisible&&!this.noCloseOnEsc&&this.hide(zQ)},focusHandler:function(e){var r=this.$refs.content,s=e.target;if(!(this.noEnforceFocus||!this.isTop||!this.isVisible||!r||document===s||qn(r,s)||this.computeIgnoreEnforceFocusSelector&&Ms(this.computeIgnoreEnforceFocusSelector,s,!0))){var g=pS(this.$refs.content),T=this.$refs["bottom-trap"],I=this.$refs["top-trap"];if(T&&s===T){if(ii(g[0]))return}else if(I&&s===I&&ii(g[g.length-1]))return;ii(r,{preventScroll:!0})}},setEnforceFocus:function(e){this.listenDocument(e,"focusin",this.focusHandler)},setResizeEvent:function(e){this.listenWindow(e,"resize",this.checkModalOverflow),this.listenWindow(e,"orientationchange",this.checkModalOverflow)},showHandler:function(e,r){e===this.modalId&&(this.$_returnFocus=r||this.getActiveElement(),this.show())},hideHandler:function(e){e===this.modalId&&this.hide("event")},toggleHandler:function(e,r){e===this.modalId&&this.toggle(r)},modalListener:function(e){this.noStacking&&e.vueTarget!==this&&this.hide()},focusFirst:function(){var e=this;Xi&&Vi(function(){var r=e.$refs.modal,s=e.$refs.content,g=e.getActiveElement();if(r&&s&&!(g&&qn(s,g))){var T=e.$refs["ok-button"],I=e.$refs["cancel-button"],a=e.$refs["close-button"],N=e.autoFocusButton,H=N===C0&&T?T.$el||T:N===P0&&I?I.$el||I:N===A0&&a?a.$el||a:s;ii(H),H===s&&e.$nextTick(function(){r.scrollTop=0})}})},returnFocusTo:function(){var e=this.returnFocus||this.$_returnFocus||null;this.$_returnFocus=null,this.$nextTick(function(){e=_i(e)?sa(e):e,e&&(e=e.$el||e,ii(e))})},checkModalOverflow:function(){if(this.isVisible){var e=this.$refs.modal;this.isModalOverflowing=e.scrollHeight>document.documentElement.clientHeight}},makeModal:function(e){var r=e();if(!this.hideHeader){var s=this.normalizeSlot(Z7,this.slotScope);if(!s){var g=e();this.hideHeaderClose||(g=e(Ud,{props:{content:this.headerCloseContent,disabled:this.isTransitioning,ariaLabel:this.headerCloseLabel,textVariant:this.headerCloseVariant||this.headerTextVariant},on:{click:this.onClose},ref:"close-button"},[this.normalizeSlot(X7)])),s=[e(this.titleTag,{staticClass:"modal-title",class:this.titleClasses,attrs:{id:this.modalTitleId},domProps:this.hasNormalizedSlot(NT)?{}:En(this.titleHtml,this.title)},this.normalizeSlot(NT,this.slotScope)),g]}r=e(this.headerTag,{staticClass:"modal-header",class:this.headerClasses,attrs:{id:this.modalHeaderId},ref:"header"},[s])}var T=e("div",{staticClass:"modal-body",class:this.bodyClasses,attrs:{id:this.modalBodyId},ref:"body"},this.normalizeSlot(eo,this.slotScope)),I=e();if(!this.hideFooter){var a=this.normalizeSlot(W7,this.slotScope);if(!a){var N=e();this.okOnly||(N=e(Ds,{props:{variant:this.cancelVariant,size:this.buttonSize,disabled:this.cancelDisabled||this.busy||this.isTransitioning},domProps:this.hasNormalizedSlot(yI)?{}:En(this.cancelTitleHtml,this.cancelTitle),on:{click:this.onCancel},ref:"cancel-button"},this.normalizeSlot(yI)));var H=e(Ds,{props:{variant:this.okVariant,size:this.buttonSize,disabled:this.okDisabled||this.busy||this.isTransitioning},domProps:this.hasNormalizedSlot(vI)?{}:En(this.okTitleHtml,this.okTitle),on:{click:this.onOk},ref:"ok-button"},this.normalizeSlot(vI));a=[N,H]}I=e(this.footerTag,{staticClass:"modal-footer",class:this.footerClasses,attrs:{id:this.modalFooterId},ref:"footer"},[a])}var K=e("div",{staticClass:"modal-content",class:this.contentClass,attrs:{id:this.modalContentId,tabindex:"-1"},ref:"content"},[r,T,I]),ee=e(),ue=e();this.isVisible&&!this.noEnforceFocus&&(ee=e("span",{attrs:{tabindex:"0"},ref:"top-trap"}),ue=e("span",{attrs:{tabindex:"0"},ref:"bottom-trap"}));var Pe=e("div",{staticClass:"modal-dialog",class:this.dialogClasses,on:{mousedown:this.onDialogMousedown},ref:"dialog"},[ee,K,ue]),xe=e("div",{staticClass:"modal",class:this.modalClasses,style:this.modalStyles,attrs:this.computedModalAttrs,on:{keydown:this.onEsc,click:this.onClickOut},directives:[{name:"show",value:this.isVisible}],ref:"modal"},[Pe]);xe=e("transition",{props:{enterClass:"",enterToClass:"",enterActiveClass:"",leaveClass:"",leaveActiveClass:"",leaveToClass:""},on:{beforeEnter:this.onBeforeEnter,enter:this.onEnter,afterEnter:this.onAfterEnter,beforeLeave:this.onBeforeLeave,leave:this.onLeave,afterLeave:this.onAfterLeave}},[xe]);var Ie=e();return!this.hideBackdrop&&this.isVisible&&(Ie=e("div",{staticClass:"modal-backdrop",attrs:{id:this.modalBackdropId}},this.normalizeSlot(q7))),Ie=e(Zd,{props:{noFade:this.noFade}},[Ie]),e("div",{style:this.modalOuterStyle,attrs:this.computedAttrs,key:"modal-outer-".concat(this[Oc])},[xe,Ie])}},render:function(e){return this.static?this.lazy&&this.isHidden?e():this.makeModal(e):this.isHidden?e():e(vQ,[this.makeModal(e)])}}),VQ=Wn(Es,yo),gx="__bv_modal_directive__",H5=function(e){var r=e.modifiers,s=r===void 0?{}:r,g=e.arg,T=e.value;return _i(T)?T:_i(g)?g:Gr(s).reverse()[0]},q5=function(e){return e&&Pc(e,".dropdown-menu > li, li.nav-item")&&sa("a, button",e)||e},W5=function(e){e&&e.tagName!=="BUTTON"&&($l(e,"role")||yn(e,"role","button"),e.tagName!=="A"&&!$l(e,"tabindex")&&yn(e,"tabindex","0"))},UQ=function(e,r,s){var g=H5(r),T=q5(e);if(g&&T){var I=function(N){var H=N.currentTarget;if(!Td(H)){var K=N.type,ee=N.keyCode;(K==="click"||K==="keydown"&&(ee===zc||ee===Zl))&&Hl(jl(s,r)).$emit(VQ,g,H)}};e[gx]={handler:I,target:g,trigger:T},W5(T),pn(T,"click",I,Os),T.tagName!=="BUTTON"&&aa(T,"role")==="button"&&pn(T,"keydown",I,Os)}},Z5=function(e){var r=e[gx]||{},s=r.trigger,g=r.handler;s&&g&&(Tn(s,"click",g,Os),Tn(s,"keydown",g,Os),Tn(e,"click",g,Os),Tn(e,"keydown",g,Os)),delete e[gx]},SL=function(e,r,s){var g=e[gx]||{},T=H5(r),I=q5(e);(T!==g.target||I!==g.trigger)&&(Z5(e),UQ(e,r,s)),W5(I)},GQ=function(){},X5={inserted:SL,updated:GQ,componentUpdated:SL,unbind:Z5};function HQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OL(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function qQ(t,e,r){return e&&OL(t.prototype,e),r&&OL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function pc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PL(Object(r),!0).forEach(function(s){WQ(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function WQ(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZQ(t){return JQ(t)||YQ(t)||KQ(t)||XQ()}function XQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KQ(t,e){if(!!t){if(typeof t=="string")return GS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GS(t,e)}}function YQ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function JQ(t){if(Array.isArray(t))return GS(t)}function GS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}var ud="$bvModal",gE="_bv__modal",QQ=["id"].concat(ZQ(Gr(oi(U5,["busy","lazy","noStacking","static","visible"])))),eee=function(){},_E={msgBoxContent:"default",title:"modal-title",okTitle:"modal-ok",cancelTitle:"modal-cancel"},AL=function(e){return QQ.reduce(function(r,s){return Fn(e[s])||(r[s]=e[s]),r},{})},tee=function(e){var r=e.extend({name:Fq,extends:G5,mixins:[fh],destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},mounted:function(){var a=this,N=function(){a.$nextTick(function(){Vi(function(){a.$destroy()})})};this.bvParent.$once(sy,N),this.$once(zn,N),this.$router&&this.$route&&this.$once(CN,this.$watch("$router",N)),this.show()}}),s=function(a,N){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:eee;if(!(H0(ud)||aI(ud))){var K=ph(a,r,{propsData:pc(pc(pc({},AL(na(Es))),{},{hideHeaderClose:!0,hideHeader:!(N.title||N.titleHtml)},oi(N,Gr(_E))),{},{lazy:!1,busy:!1,visible:!1,noStacking:!1,noEnforceFocus:!1})});return Gr(_E).forEach(function(ee){Fn(N[ee])||(K.$slots[_E[ee]]=bi(N[ee]))}),new Promise(function(ee,ue){var Pe=!1;K.$once(sy,function(){Pe||ue(new Error("BootstrapVue MsgBox destroyed before resolve"))}),K.$on(Cs,function(Ie){if(!Ie.defaultPrevented){var dt=H(Ie);Ie.defaultPrevented||(Pe=!0,ee(dt))}});var xe=document.createElement("div");document.body.appendChild(xe),K.$mount(xe)})}},g=function(a,N){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!(!N||aI(ud)||H0(ud)||!Mr(K)))return s(a,pc(pc({},AL(H)),{},{msgBoxContent:N}),K)},T=function(){function I(a){HQ(this,I),Oy(this,{_vm:a,_root:Hl(a)}),Jx(this,{_vm:Ia(),_root:Ia()})}return qQ(I,[{key:"show",value:function(N){if(N&&this._root){for(var H,K=arguments.length,ee=new Array(K>1?K-1:0),ue=1;ue<K;ue++)ee[ue-1]=arguments[ue];(H=this._root).$emit.apply(H,[Wn(Es,"show"),N].concat(ee))}}},{key:"hide",value:function(N){if(N&&this._root){for(var H,K=arguments.length,ee=new Array(K>1?K-1:0),ue=1;ue<K;ue++)ee[ue-1]=arguments[ue];(H=this._root).$emit.apply(H,[Wn(Es,"hide"),N].concat(ee))}}},{key:"msgBoxOk",value:function(N){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},K=pc(pc({},H),{},{okOnly:!0,okDisabled:!1,hideFooter:!1,msgBoxContent:N});return g(this._vm,N,K,function(){return!0})}},{key:"msgBoxConfirm",value:function(N){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},K=pc(pc({},H),{},{okOnly:!1,okDisabled:!1,cancelDisabled:!1,hideFooter:!1});return g(this._vm,N,K,function(ee){var ue=ee.trigger;return ue==="ok"?!0:ue==="cancel"?!1:null})}}]),I}();e.mixin({beforeCreate:function(){this[gE]=new T(this)}}),Fd(e.prototype,ud)||VO(e.prototype,ud,{get:function(){return(!this||!this[gE])&&ao('"'.concat(ud,'" must be accessed from a Vue instance "this" context.'),Es),this[gE]}})},ree=wr({plugins:{plugin:tee}}),iee=wr({components:{BModal:G5},directives:{VBModal:X5},plugins:{BVModalPlugin:ree}});function CL(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var nee=function(e){return e=e==="left"?"start":e==="right"?"end":e,"justify-content-".concat(e)},PP=Ct({align:k(ie),cardHeader:k(Ee,!1),fill:k(Ee,!1),justified:k(Ee,!1),pills:k(Ee,!1),small:k(Ee,!1),tabs:k(Ee,!1),tag:k(ie,"ul"),vertical:k(Ee,!1)},$F),K5=ot({name:$F,functional:!0,props:PP,render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.tabs,N=g.pills,H=g.vertical,K=g.align,ee=g.cardHeader;return e(g.tag,Sr(T,{staticClass:"nav",class:(s={"nav-tabs":a,"nav-pills":N&&!a,"card-header-tabs":!H&&ee&&a,"card-header-pills":!H&&ee&&N&&!a,"flex-column":H,"nav-fill":!H&&g.fill,"nav-justified":!H&&g.justified},CL(s,nee(K),!H&&K),CL(s,"small",g.small),s)}),I)}});function ML(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function IL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ML(Object(r),!0).forEach(function(s){oee(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ML(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function oee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Y5=oi(ll,["event","routerTag"]),see=Ct(vr(IL(IL({},Y5),{},{linkAttrs:k(Zn,{}),linkClasses:k(Nr)})),qF),aee=ot({name:qF,functional:!0,props:see,render:function(e,r){var s=r.props,g=r.data,T=r.listeners,I=r.children;return e("li",Sr(oi(g,["on"]),{staticClass:"nav-item"}),[e(ks,{staticClass:"nav-link",class:s.linkClasses,attrs:s.linkAttrs,props:mn(Y5,s),on:T},I)])}}),lee={},cee=ot({name:Nq,functional:!0,props:lee,render:function(e,r){var s=r.data,g=r.children;return e("li",Sr(s,{staticClass:"navbar-text"}),g)}});function DL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function _x(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DL(Object(r),!0).forEach(function(s){uee(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function uee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var J5=oi(gP,["inline"]),hee=Ct(vr(_x(_x({},J5),{},{formClass:k(Nr)})),HF),dee=ot({name:HF,functional:!0,props:hee,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=r.listeners,a=e(_P,{class:s.formClass,props:_x(_x({},mn(J5,s)),{},{inline:!0}),attrs:g.attrs,on:I},T);return e("li",Sr(oi(g,["attrs","on"]),{staticClass:"form-inline"}),[a])}});function fee(t){return _ee(t)||gee(t)||mee(t)||pee()}function pee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mee(t,e){if(!!t){if(typeof t=="string")return HS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HS(t,e)}}function gee(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _ee(t){if(Array.isArray(t))return HS(t)}function HS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function RL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function LL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RL(Object(r),!0).forEach(function(s){yee(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function yee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var vee=Ct(vr(LL(LL({},Hi),sl(Q4,[].concat(fee(Gr(p1)),["html","lazy","menuClass","noCaret","role","text","toggleClass"])))),WF),Jb=ot({name:WF,mixins:[Ki,mP,Ur],props:vee,computed:{toggleId:function(){return this.safeId("_BV_toggle_")},menuId:function(){return this.safeId("_BV_toggle_menu_")},dropdownClasses:function(){return[this.directionClass,this.boundaryClass,{show:this.visible}]},menuClasses:function(){return[this.menuClass,{"dropdown-menu-right":this.right,show:this.visible}]},toggleClasses:function(){return[this.toggleClass,{"dropdown-toggle-no-caret":this.noCaret}]}},render:function(e){var r=this.toggleId,s=this.menuId,g=this.visible,T=this.hide,I=e(ks,{staticClass:"nav-link dropdown-toggle",class:this.toggleClasses,props:{href:"#".concat(this.id||""),disabled:this.disabled},attrs:{id:r,role:"button","aria-haspopup":"true","aria-expanded":g?"true":"false","aria-controls":s},on:{mousedown:this.onMousedown,click:this.toggle,keydown:this.toggle},ref:"toggle"},[this.normalizeSlot([Ic,uW])||e("span",{domProps:En(this.html,this.text)})]),a=e("ul",{staticClass:"dropdown-menu",class:this.menuClasses,attrs:{tabindex:"-1","aria-labelledby":r,id:s},on:{keydown:this.onKeydown},ref:"menu"},!this.lazy||g?this.normalizeSlot(eo,{hide:T}):[e()]);return e("li",{staticClass:"nav-item b-nav-dropdown dropdown",class:this.dropdownClasses,attrs:{id:this.safeId()}},[I,a])}}),Q5=wr({components:{BNav:K5,BNavItem:aee,BNavText:cee,BNavForm:dee,BNavItemDropdown:Jb,BNavItemDd:Jb,BNavDropdown:Jb,BNavDd:Jb},plugins:{DropdownPlugin:yP}});function yE(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bee=Ct({fixed:k(ie),print:k(Ee,!1),sticky:k(Ee,!1),tag:k(ie,"nav"),toggleable:k(qo,!1),type:k(ie,"light"),variant:k(ie)},jF),xee=ot({name:jF,mixins:[Ur],provide:function(){var e=this;return{getBvNavbar:function(){return e}}},props:bee,computed:{breakpointClass:function(){var e=this.toggleable,r=FN()[0],s=null;return e&&_i(e)&&e!==r?s="navbar-expand-".concat(e):e===!1&&(s="navbar-expand"),s}},render:function(e){var r,s=this.tag,g=this.type,T=this.variant,I=this.fixed;return e(s,{staticClass:"navbar",class:[(r={"d-print":this.print,"sticky-top":this.sticky},yE(r,"navbar-".concat(g),g),yE(r,"bg-".concat(T),T),yE(r,"fixed-".concat(I),I),r),this.breakpointClass],attrs:{role:Wl(s,"nav")?null:"navigation"}},[this.normalizeSlot()])}});function BL(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var wee=function(e){return e=e==="left"?"start":e==="right"?"end":e,"justify-content-".concat(e)},Tee=Ct(sl(PP,["tag","fill","justified","align","small"]),UF),Eee=ot({name:UF,functional:!0,props:Tee,render:function(e,r){var s,g=r.props,T=r.data,I=r.children,a=g.align;return e(g.tag,Sr(T,{staticClass:"navbar-nav",class:(s={"nav-fill":g.fill,"nav-justified":g.justified},BL(s,wee(a),a),BL(s,"small",g.small),s)}),I)}});function kL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function zL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kL(Object(r),!0).forEach(function(s){See(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function See(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var M1=oi(ll,["event","routerTag"]);M1.href.default=void 0;M1.to.default=void 0;var Oee=Ct(vr(zL(zL({},M1),{},{tag:k(ie,"div")})),VF),Pee=ot({name:VF,functional:!0,props:Oee,render:function(e,r){var s=r.props,g=r.data,T=r.children,I=s.to||s.href,a=I?ks:s.tag;return e(a,Sr(g,{staticClass:"navbar-brand",props:I?mn(M1,s):{}}),T)}}),FL="navbar-toggler",Aee=Cn(Ro,"state"),Cee=Cn(Ro,"sync-state"),Mee=Ct({disabled:k(Ee,!1),label:k(ie,"Toggle navigation"),target:k(Ho,void 0,!0)},GF),NL=ot({name:GF,directives:{VBToggle:k4},mixins:[al,Ur],props:Mee,data:function(){return{toggleState:!1}},created:function(){this.listenOnRoot(Aee,this.handleStateEvent),this.listenOnRoot(Cee,this.handleStateEvent)},methods:{onClick:function(e){this.disabled||this.$emit(Ba,e)},handleStateEvent:function(e,r){e===this.target&&(this.toggleState=r)}},render:function(e){var r=this.disabled;return e("button",{staticClass:FL,class:{disabled:r},directives:[{name:"VBToggle",value:this.target}],attrs:{type:"button",disabled:r,"aria-label":this.label},on:{click:this.onClick}},[this.normalizeSlot(eo,{expanded:this.toggleState})||e("span",{staticClass:"".concat(FL,"-icon")})])}}),Iee=wr({components:{BNavbar:xee,BNavbarNav:Eee,BNavbarBrand:Pee,BNavbarToggle:NL,BNavToggle:NL},plugins:{NavPlugin:Q5,CollapsePlugin:z4,DropdownPlugin:yP}});function vE(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dee=Ct({label:k(ie),role:k(ie,"status"),small:k(Ee,!1),tag:k(ie,"span"),type:k(ie,"border"),variant:k(ie)},nN),e$=ot({name:nN,functional:!0,props:Dee,render:function(e,r){var s,g=r.props,T=r.data,I=r.slots,a=r.scopedSlots,N=I(),H=a||{},K=vo(BN,{},H,N)||g.label;return K&&(K=e("span",{staticClass:"sr-only"},K)),e(g.tag,Sr(T,{attrs:{role:K?g.role||"status":null,"aria-hidden":K?null:"true"},class:(s={},vE(s,"spinner-".concat(g.type),g.type),vE(s,"spinner-".concat(g.type,"-sm"),g.small),vE(s,"text-".concat(g.variant),g.variant),s)}),[K||e()])}});function $L(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function d_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$L(Object(r),!0).forEach(function(s){Ree(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$L(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ree(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bE={top:0,left:0,bottom:0,right:0},Lee=Ct({bgColor:k(ie),blur:k(ie,"2px"),fixed:k(Ee,!1),noCenter:k(Ee,!1),noFade:k(Ee,!1),noWrap:k(Ee,!1),opacity:k(dr,.85,function(t){var e=hi(t,0);return e>=0&&e<=1}),overlayTag:k(ie,"div"),rounded:k(qo,!1),show:k(Ee,!1),spinnerSmall:k(Ee,!1),spinnerType:k(ie,"border"),spinnerVariant:k(ie),variant:k(ie,"light"),wrapTag:k(ie,"div"),zIndex:k(dr,10)},ZF),Bee=ot({name:ZF,mixins:[Ur],props:Lee,computed:{computedRounded:function(){var e=this.rounded;return e===!0||e===""?"rounded":e?"rounded-".concat(e):""},computedVariant:function(){var e=this.variant;return e&&!this.bgColor?"bg-".concat(e):""},slotScope:function(){return{spinnerType:this.spinnerType||null,spinnerVariant:this.spinnerVariant||null,spinnerSmall:this.spinnerSmall}}},methods:{defaultOverlayFn:function(e){var r=e.spinnerType,s=e.spinnerVariant,g=e.spinnerSmall;return this.$createElement(e$,{props:{type:r,variant:s,small:g}})}},render:function(e){var r=this,s=this.show,g=this.fixed,T=this.noFade,I=this.noWrap,a=this.slotScope,N=e();if(s){var H=e("div",{staticClass:"position-absolute",class:[this.computedVariant,this.computedRounded],style:d_(d_({},bE),{},{opacity:this.opacity,backgroundColor:this.bgColor||null,backdropFilter:this.blur?"blur(".concat(this.blur,")"):null})}),K=e("div",{staticClass:"position-absolute",style:this.noCenter?d_({},bE):{top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)"}},[this.normalizeSlot(nW,a)||this.defaultOverlayFn(a)]);N=e(this.overlayTag,{staticClass:"b-overlay",class:{"position-absolute":!I||I&&!g,"position-fixed":I&&g},style:d_(d_({},bE),{},{zIndex:this.zIndex||10}),on:{click:function(ue){return r.$emit(Ba,ue)}},key:"overlay"},[H,K])}return N=e(Zd,{props:{noFade:T,appear:!0},on:{"after-enter":function(){return r.$emit(os)},"after-leave":function(){return r.$emit(zn)}}},[N]),I?N:e(this.wrapTag,{staticClass:"b-overlay-wrap position-relative",attrs:{"aria-busy":s?"true":null}},I?[N]:[this.normalizeSlot(),N])}}),kee=wr({components:{BOverlay:Bee}}),f_;function jL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function VL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jL(Object(r),!0).forEach(function(s){M0(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function M0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var I1=Xn("value",{type:ay,defaultValue:null,validator:function(e){return!fn(e)&&or(e,0)<1?(ao('"v-model" value must be a number greater than "0"',Qx),!1):!0}}),zee=I1.mixin,Fee=I1.props,qS=I1.prop,Nee=I1.event,Qb=3,AP=5,$ee=function(e,r){return $_(r,function(s,g){return{number:e+g,classes:null}})},UL=function(e){var r=or(e)||1;return r<1?AP:r},GL=function(e,r){var s=or(e)||1;return s>r?r:s<1?1:s},HL=function(e){if(e.keyCode===Zl)return ei(e,{immediatePropagation:!0}),e.currentTarget.click(),!1},CP=Ct(vr(VL(VL({},Fee),{},{align:k(ie,"left"),ariaLabel:k(ie,"Pagination"),disabled:k(Ee,!1),ellipsisClass:k(Nr),ellipsisText:k(ie,"\u2026"),firstClass:k(Nr),firstNumber:k(Ee,!1),firstText:k(ie,"\xAB"),hideEllipsis:k(Ee,!1),hideGotoEndButtons:k(Ee,!1),labelFirstPage:k(ie,"Go to first page"),labelLastPage:k(ie,"Go to last page"),labelNextPage:k(ie,"Go to next page"),labelPage:k(E7,"Go to page"),labelPrevPage:k(ie,"Go to previous page"),lastClass:k(Nr),lastNumber:k(Ee,!1),lastText:k(ie,"\xBB"),limit:k(dr,AP,function(t){return or(t,0)<1?(ao('Prop "limit" must be a number greater than "0"',Qx),!1):!0}),nextClass:k(Nr),nextText:k(ie,"\u203A"),pageClass:k(Nr),pills:k(Ee,!1),prevClass:k(Nr),prevText:k(ie,"\u2039"),size:k(ie)})),"pagination"),t$=ot({mixins:[zee,Ur],props:CP,data:function(){var e=or(this[qS],0);return e=e>0?e:-1,{currentPage:e,localNumberOfPages:1,localLimit:AP}},computed:{btnSize:function(){var e=this.size;return e?"pagination-".concat(e):""},alignment:function(){var e=this.align;return e==="center"?"justify-content-center":e==="end"||e==="right"?"justify-content-end":e==="fill"?"text-center":""},styleClass:function(){return this.pills?"b-pagination-pills":""},computedCurrentPage:function(){return GL(this.currentPage,this.localNumberOfPages)},paginationParams:function(){var e=this.localLimit,r=this.localNumberOfPages,s=this.computedCurrentPage,g=this.hideEllipsis,T=this.firstNumber,I=this.lastNumber,a=!1,N=!1,H=e,K=1;r<=e?H=r:s<e-1&&e>Qb?((!g||I)&&(N=!0,H=e-(T?0:1)),H=Ec(H,e)):r-s+2<e&&e>Qb?((!g||T)&&(a=!0,H=e-(I?0:1)),K=r-H+1):(e>Qb&&(H=e-(g?0:2),a=!!(!g||T),N=!!(!g||I)),K=s-uy(H/2)),K<1?(K=1,a=!1):K>r-H&&(K=r-H+1,N=!1),a&&T&&K<4&&(H=H+2,K=1,a=!1);var ee=K+H-1;return N&&I&&ee>r-3&&(H=H+(ee===r-2?2:3),N=!1),e<=Qb&&(T&&K===1?H=Ec(H+1,r,e+1):I&&r===K+H-1&&(K=Li(K-1,1),H=Ec(r-K+1,r,e+1))),H=Ec(H,r-K+1),{showFirstDots:a,showLastDots:N,numberOfLinks:H,startNumber:K}},pageList:function(){var e=this.paginationParams,r=e.numberOfLinks,s=e.startNumber,g=this.computedCurrentPage,T=$ee(s,r);if(T.length>3){var I=g-s,a="bv-d-xs-down-none";if(I===0)for(var N=3;N<T.length;N++)T[N].classes=a;else if(I===T.length-1)for(var H=0;H<T.length-3;H++)T[H].classes=a;else{for(var K=0;K<I-1;K++)T[K].classes=a;for(var ee=T.length-1;ee>I+1;ee--)T[ee].classes=a}}return T}},watch:(f_={},M0(f_,qS,function(t,e){t!==e&&(this.currentPage=GL(t,this.localNumberOfPages))}),M0(f_,"currentPage",function(e,r){e!==r&&this.$emit(Nee,e>0?e:null)}),M0(f_,"limit",function(e,r){e!==r&&(this.localLimit=UL(e))}),f_),created:function(){var e=this;this.localLimit=UL(this.limit),this.$nextTick(function(){e.currentPage=e.currentPage>e.localNumberOfPages?e.localNumberOfPages:e.currentPage})},methods:{handleKeyNav:function(e){var r=e.keyCode,s=e.shiftKey;this.isNav||(r===ol||r===Is?(ei(e,{propagation:!1}),s?this.focusFirst():this.focusPrev()):(r===Rc||r===as)&&(ei(e,{propagation:!1}),s?this.focusLast():this.focusNext()))},getButtons:function(){return ca("button.page-link, a.page-link",this.$el).filter(function(e){return il(e)})},focusCurrent:function(){var e=this;this.$nextTick(function(){var r=e.getButtons().find(function(s){return or(aa(s,"aria-posinset"),0)===e.computedCurrentPage});ii(r)||e.focusFirst()})},focusFirst:function(){var e=this;this.$nextTick(function(){var r=e.getButtons().find(function(s){return!Td(s)});ii(r)})},focusLast:function(){var e=this;this.$nextTick(function(){var r=e.getButtons().reverse().find(function(s){return!Td(s)});ii(r)})},focusPrev:function(){var e=this;this.$nextTick(function(){var r=e.getButtons(),s=r.indexOf(ah());s>0&&!Td(r[s-1])&&ii(r[s-1])})},focusNext:function(){var e=this;this.$nextTick(function(){var r=e.getButtons(),s=r.indexOf(ah());s<r.length-1&&!Td(r[s+1])&&ii(r[s+1])})}},render:function(e){var r=this,s=Bn(this),g=s.disabled,T=s.labelPage,I=s.ariaLabel,a=s.isNav,N=s.localNumberOfPages,H=s.computedCurrentPage,K=this.pageList.map(function(gt){return gt.number}),ee=this.paginationParams,ue=ee.showFirstDots,Pe=ee.showLastDots,xe=this.align==="fill",Ie=[],dt=function(Tt){return Tt===H},Le=this.currentPage<1,De=function(Tt,at,ft,gr,xr,Jt,Zt){var Et=g||dt(Jt)||Le||Tt<1||Tt>N,fr=Tt<1?1:Tt>N?N:Tt,jr={disabled:Et,page:fr,index:fr-1},er=r.normalizeSlot(ft,jr)||Lr(gr)||e(),tn=e(Et?"span":a?ks:"button",{staticClass:"page-link",class:{"flex-grow-1":!a&&!Et&&xe},props:Et||!a?{}:r.linkProps(Tt),attrs:{role:a?null:"menuitem",type:a||Et?null:"button",tabindex:Et||a?null:"-1","aria-label":at,"aria-controls":Bn(r).ariaControls||null,"aria-disabled":Et?"true":null},on:Et?{}:{"!click":function(Yi){r.onClick(Yi,Tt)},keydown:HL}},[er]);return e("li",{key:Zt,staticClass:"page-item",class:[{disabled:Et,"flex-fill":xe,"d-flex":xe&&!a&&!Et},xr],attrs:{role:a?null:"presentation","aria-hidden":Et?"true":null}},[tn])},Ye=function(Tt){return e("li",{staticClass:"page-item",class:["disabled","bv-d-xs-down-none",xe?"flex-fill":"",r.ellipsisClass],attrs:{role:"separator"},key:"ellipsis-".concat(Tt?"last":"first")},[e("span",{staticClass:"page-link"},[r.normalizeSlot(R7)||Lr(r.ellipsisText)||e()])])},He=function(Tt,at){var ft=Tt.number,gr=dt(ft)&&!Le,xr=g?null:gr||Le&&at===0?"0":"-1",Jt={role:a?null:"menuitemradio",type:a||g?null:"button","aria-disabled":g?"true":null,"aria-controls":Bn(r).ariaControls||null,"aria-label":Gl(T)?T(ft):"".concat(Mr(T)?T():T," ").concat(ft),"aria-checked":a?null:gr?"true":"false","aria-current":a&&gr?"page":null,"aria-posinset":a?null:ft,"aria-setsize":a?null:N,tabindex:a?null:xr},Zt=Lr(r.makePage(ft)),Et={page:ft,index:ft-1,content:Zt,active:gr,disabled:g},fr=e(g?"span":a?ks:"button",{props:g||!a?{}:r.linkProps(ft),staticClass:"page-link",class:{"flex-grow-1":!a&&!g&&xe},attrs:Jt,on:g?{}:{"!click":function(er){r.onClick(er,ft)},keydown:HL}},[r.normalizeSlot(oW,Et)||Zt]);return e("li",{staticClass:"page-item",class:[{disabled:g,active:gr,"flex-fill":xe,"d-flex":xe&&!a&&!g},Tt.classes,r.pageClass],attrs:{role:a?null:"presentation"},key:"page-".concat(ft)},[fr])},ht=e();!this.firstNumber&&!this.hideGotoEndButtons&&(ht=De(1,this.labelFirstPage,B7,this.firstText,this.firstClass,1,"pagination-goto-first")),Ie.push(ht),Ie.push(De(H-1,this.labelPrevPage,aW,this.prevText,this.prevClass,1,"pagination-goto-prev")),Ie.push(this.firstNumber&&K[0]!==1?He({number:1},0):e()),Ie.push(ue?Ye(!1):e()),this.pageList.forEach(function(gt,Tt){var at=ue&&r.firstNumber&&K[0]!==1?1:0;Ie.push(He(gt,Tt+at))}),Ie.push(Pe?Ye(!0):e()),Ie.push(this.lastNumber&&K[K.length-1]!==N?He({number:N},-1):e()),Ie.push(De(H+1,this.labelNextPage,iW,this.nextText,this.nextClass,N,"pagination-goto-next"));var St=e();!this.lastNumber&&!this.hideGotoEndButtons&&(St=De(N,this.labelLastPage,G7,this.lastText,this.lastClass,N,"pagination-goto-last")),Ie.push(St);var st=e("ul",{staticClass:"pagination",class:["b-pagination",this.btnSize,this.alignment,this.styleClass],attrs:{role:a?null:"menubar","aria-disabled":g?"true":"false","aria-label":a?null:I||null},on:a?{}:{keydown:this.handleKeyNav},ref:"ul"},Ie);return a?e("nav",{attrs:{"aria-disabled":g?"true":null,"aria-hidden":g?"true":"false","aria-label":a&&I||null}},[st]):st}});function qL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function WL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qL(Object(r),!0).forEach(function(s){jee(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function jee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var r$=20,i$=0,ZL=function(e){return Li(or(e)||r$,1)},XL=function(e){return Li(or(e)||i$,0)},Vee=Ct(vr(WL(WL({},CP),{},{ariaControls:k(ie),perPage:k(dr,r$),totalRows:k(dr,i$)})),Qx),Uee=ot({name:Qx,mixins:[t$],props:Vee,computed:{numberOfPages:function(){var e=qN(XL(this.totalRows)/ZL(this.perPage));return e<1?1:e},pageSizeNumberOfPages:function(){return{perPage:ZL(this.perPage),totalRows:XL(this.totalRows),numberOfPages:this.numberOfPages}}},watch:{pageSizeNumberOfPages:function(e,r){ji(r)||(e.perPage!==r.perPage&&e.totalRows===r.totalRows?this.currentPage=1:e.numberOfPages!==r.numberOfPages&&this.currentPage>e.numberOfPages&&(this.currentPage=1)),this.localNumberOfPages=e.numberOfPages}},created:function(){var e=this;this.localNumberOfPages=this.numberOfPages;var r=or(this[qS],0);r>0?this.currentPage=r:this.$nextTick(function(){e.currentPage=0})},methods:{onClick:function(e,r){var s=this;if(r!==this.currentPage){var g=e.target,T=new Kd(SN,{cancelable:!0,vueTarget:this,target:g});this.$emit(T.type,T,r),!T.defaultPrevented&&(this.currentPage=r,this.$emit(Bs,this.currentPage),this.$nextTick(function(){il(g)&&s.$el.contains(g)?ii(g):s.focusCurrent()}))}},makePage:function(e){return e},linkProps:function(){return{}}}}),Gee=wr({components:{BPagination:Uee}});function KL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function xE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KL(Object(r),!0).forEach(function(s){Hee(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Hee(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var qee=function(e){return Li(or(e,0),1)},n$=oi(ll,["event","routerTag"]),Wee=Ct(vr(xE(xE(xE({},CP),n$),{},{baseUrl:k(ie,"/"),linkGen:k(ls),noPageDetect:k(Ee,!1),numberOfPages:k(dr,1,function(t){var e=or(t,0);return e<1?(ao('Prop "number-of-pages" must be a number greater than "0"',sS),!1):!0}),pageGen:k(ls),pages:k(ss),useRouter:k(Ee,!1)})),sS),Zee=ot({name:sS,mixins:[t$],props:Wee,computed:{isNav:function(){return!0},computedValue:function(){var e=or(this.value,0);return e<1?null:e}},watch:{numberOfPages:function(){var e=this;this.$nextTick(function(){e.setNumberOfPages()})},pages:function(){var e=this;this.$nextTick(function(){e.setNumberOfPages()})}},created:function(){this.setNumberOfPages()},mounted:function(){var e=this;this.$router&&this.$watch("$route",function(){e.$nextTick(function(){Vi(function(){e.guessCurrentPage()})})})},methods:{setNumberOfPages:function(){var e=this;Ni(this.pages)&&this.pages.length>0?this.localNumberOfPages=this.pages.length:this.localNumberOfPages=qee(this.numberOfPages),this.$nextTick(function(){e.guessCurrentPage()})},onClick:function(e,r){var s=this;if(r!==this.currentPage){var g=e.currentTarget||e.target,T=new Kd(SN,{cancelable:!0,vueTarget:this,target:g});this.$emit(T.type,T,r),!T.defaultPrevented&&(Vi(function(){s.currentPage=r,s.$emit(Bs,r)}),this.$nextTick(function(){zs(g)}))}},getPageInfo:function(e){if(!Ni(this.pages)||this.pages.length===0||Fn(this.pages[e-1])){var r="".concat(this.baseUrl).concat(e);return{link:this.useRouter?{path:r}:r,text:Lr(e)}}var s=this.pages[e-1];if(kn(s)){var g=s.link;return{link:kn(g)?g:this.useRouter?{path:g}:g,text:Lr(s.text||e)}}else return{link:Lr(s),text:Lr(e)}},makePage:function(e){var r=this.pageGen,s=this.getPageInfo(e);return Gl(r)?r(e,s):s.text},makeLink:function(e){var r=this.linkGen,s=this.getPageInfo(e);return Gl(r)?r(e,s):s.link},linkProps:function(e){var r=mn(n$,this),s=this.makeLink(e);return this.useRouter||kn(s)?r.to=s:r.href=s,r},resolveLink:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r;try{r=document.createElement("a"),r.href=YN({to:e},"a","/","/"),document.body.appendChild(r);var s=r,g=s.pathname,T=s.hash,I=s.search;return document.body.removeChild(r),{path:g,hash:T,query:DI(I)}}catch{try{r&&r.parentNode&&r.parentNode.removeChild(r)}catch{}return{}}},resolveRoute:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";try{var r=this.$router.resolve(e,this.$route).route;return{path:r.path,hash:r.hash,query:r.query}}catch{return{}}},guessCurrentPage:function(){var e=this.$router,r=this.$route,s=this.computedValue;if(!this.noPageDetect&&!s&&(Xi||!Xi&&e))for(var g=e&&r?{path:r.path,hash:r.hash,query:r.query}:{},T=Xi?window.location||document.location:null,I=T?{path:T.pathname,hash:T.hash,query:DI(T.search)}:{},a=1;!s&&a<=this.localNumberOfPages;a++){var N=this.makeLink(a);e&&(kn(N)||this.useRouter)?s=Ci(this.resolveRoute(N),g)?a:null:Xi?s=Ci(this.resolveLink(N),I)?a:null:s=-1}this.currentPage=s>0?s:0}}}),Xee=wr({components:{BPaginationNav:Zee}}),Kee={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",TOPLEFT:"top",TOPRIGHT:"top",RIGHTTOP:"right",RIGHTBOTTOM:"right",BOTTOMLEFT:"bottom",BOTTOMRIGHT:"bottom",LEFTTOP:"left",LEFTBOTTOM:"left"},Yee={AUTO:0,TOPLEFT:-1,TOP:0,TOPRIGHT:1,RIGHTTOP:-1,RIGHT:0,RIGHTBOTTOM:1,BOTTOMLEFT:-1,BOTTOM:0,BOTTOMRIGHT:1,LEFTTOP:-1,LEFT:0,LEFTBOTTOM:1},Jee={arrowPadding:k(dr,6),boundary:k([Yu,ie],"scrollParent"),boundaryPadding:k(dr,5),fallbackPlacement:k(Ho,"flip"),offset:k(dr,0),placement:k(ie,"top"),target:k([Yu,vz])},Qee=ot({name:Hq,mixins:[fh],props:Jee,data:function(){return{noFade:!1,localShow:!0,attachment:this.getAttachment(this.placement)}},computed:{templateType:function(){return"unknown"},popperConfig:function(){var e=this,r=this.placement;return{placement:this.getAttachment(r),modifiers:{offset:{offset:this.getOffset(r)},flip:{behavior:this.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{padding:this.boundaryPadding,boundariesElement:this.boundary}},onCreate:function(g){g.originalPlacement!==g.placement&&e.popperPlacementChange(g)},onUpdate:function(g){e.popperPlacementChange(g)}}}},created:function(){var e=this;this.$_popper=null,this.localShow=!0,this.$on(yo,function(s){e.popperCreate(s)});var r=function(){e.$nextTick(function(){Vi(function(){e.$destroy()})})};this.bvParent.$once(sy,r),this.$once(zn,r)},beforeMount:function(){this.attachment=this.getAttachment(this.placement)},updated:function(){this.updatePopper()},beforeDestroy:function(){this.destroyPopper()},destroyed:function(){var e=this.$el;e&&e.parentNode&&e.parentNode.removeChild(e)},methods:{hide:function(){this.localShow=!1},getAttachment:function(e){return Kee[String(e).toUpperCase()]||"auto"},getOffset:function(e){if(!this.offset){var r=this.$refs.arrow||sa(".arrow",this.$el),s=hi(ia(r).width,0)+hi(this.arrowPadding,0);switch(Yee[String(e).toUpperCase()]||0){case 1:return"+50%p - ".concat(s,"px");case-1:return"-50%p + ".concat(s,"px");default:return 0}}return this.offset},popperCreate:function(e){this.destroyPopper(),this.$_popper=new DS(this.target,e,this.popperConfig)},destroyPopper:function(){this.$_popper&&this.$_popper.destroy(),this.$_popper=null},updatePopper:function(){this.$_popper&&this.$_popper.scheduleUpdate()},popperPlacementChange:function(e){this.attachment=this.getAttachment(e.placement)},renderTemplate:function(e){return e("div")}},render:function(e){var r=this,s=this.noFade;return e(Zd,{props:{appear:!0,noFade:s},on:{beforeEnter:function(T){return r.$emit(yo,T)},afterEnter:function(T){return r.$emit(os,T)},beforeLeave:function(T){return r.$emit(Cs,T)},afterLeave:function(T){return r.$emit(zn,T)}}},[this.localShow?this.renderTemplate(e):e()])}});function YL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function JL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YL(Object(r),!0).forEach(function(s){WS(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function WS(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ete={html:k(Ee,!1),id:k(ie)},o$=ot({name:Xq,extends:Qee,mixins:[OP],props:ete,data:function(){return{title:"",content:"",variant:null,customClass:null,interactive:!0}},computed:{templateType:function(){return"tooltip"},templateClasses:function(){var e,r=this.variant,s=this.attachment,g=this.templateType;return[(e={noninteractive:!this.interactive},WS(e,"b-".concat(g,"-").concat(r),r),WS(e,"bs-".concat(g,"-").concat(s),s),e),this.customClass]},templateAttributes:function(){var e=this.id;return JL(JL({},this.bvParent.bvParent.$attrs),{},{id:e,role:"tooltip",tabindex:"-1"},this.scopedStyleAttrs)},templateListeners:function(){var e=this;return{mouseenter:function(s){e.$emit(wN,s)},mouseleave:function(s){e.$emit(TN,s)},focusin:function(s){e.$emit(q0,s)},focusout:function(s){e.$emit(W0,s)}}}},methods:{renderTemplate:function(e){var r=this.title,s=Mr(r)?r({}):r,g=this.html&&!Mr(r)?{innerHTML:r}:{};return e("div",{staticClass:"tooltip b-tooltip",class:this.templateClasses,attrs:this.templateAttributes,on:this.templateListeners},[e("div",{staticClass:"arrow",ref:"arrow"}),e("div",{staticClass:"tooltip-inner",domProps:g},[s])])}}});function QL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function wE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QL(Object(r),!0).forEach(function(s){tte(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QL(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function tte(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s$=".modal-content",rte=Cn(Es,zn),ite=".b-sidebar",nte=[s$,ite].join(", "),ote="dropdown",ste=".dropdown-menu.show",e0="data-original-title",eB={title:"",content:"",variant:null,customClass:null,triggers:"",placement:"auto",fallbackPlacement:"flip",target:null,container:null,noFade:!1,boundary:"scrollParent",boundaryPadding:5,offset:0,delay:0,arrowPadding:6,interactive:!0,disabled:!1,id:null,html:!1},MP=ot({name:Zq,mixins:[al,fh],data:function(){return wE(wE({},eB),{},{activeTrigger:{hover:!1,click:!1,focus:!1},localShow:!1})},computed:{templateType:function(){return"tooltip"},computedId:function(){return this.id||"__bv_".concat(this.templateType,"_").concat(this[Oc],"__")},computedDelay:function(){var e={show:0,hide:0};return Go(this.delay)?(e.show=Li(or(this.delay.show,0),0),e.hide=Li(or(this.delay.hide,0),0)):(rl(this.delay)||_i(this.delay))&&(e.show=e.hide=Li(or(this.delay,0),0)),e},computedTriggers:function(){return bi(this.triggers).filter($r).join(" ").trim().toLowerCase().split(/\s+/).sort()},isWithActiveTrigger:function(){for(var e in this.activeTrigger)if(this.activeTrigger[e])return!0;return!1},computedTemplateData:function(){var e=this.title,r=this.content,s=this.variant,g=this.customClass,T=this.noFade,I=this.interactive;return{title:e,content:r,variant:s,customClass:g,noFade:T,interactive:I}}},watch:{computedTriggers:function(e,r){var s=this;Ci(e,r)||this.$nextTick(function(){s.unListen(),r.forEach(function(g){Vr(e,g)||s.activeTrigger[g]&&(s.activeTrigger[g]=!1)}),s.listen()})},computedTemplateData:function(){this.handleTemplateUpdate()},title:function(e,r){e!==r&&!e&&this.hide()},disabled:function(e){e?this.disable():this.enable()}},created:function(){var e=this;this.$_tip=null,this.$_hoverTimeout=null,this.$_hoverState="",this.$_visibleInterval=null,this.$_enabled=!this.disabled,this.$_noop=hy.bind(this),this.bvParent&&this.bvParent.$once(CN,function(){e.$nextTick(function(){Vi(function(){e.$destroy()})})}),this.$nextTick(function(){var r=e.getTarget();r&&qn(document.body,r)?(e.scopeId=im(e.bvParent),e.listen()):ao(_i(e.target)?'Unable to find target element by ID "#'.concat(e.target,'" in document.'):"The provided target is no valid HTML element.",e.templateType)})},updated:function(){this.$nextTick(this.handleTemplateUpdate)},deactivated:function(){this.forceHide()},beforeDestroy:function(){this.unListen(),this.setWhileOpenListeners(!1),this.clearHoverTimeout(),this.clearVisibilityInterval(),this.destroyTemplate(),this.$_noop=null},methods:{getTemplate:function(){return o$},updateData:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=!1;Gr(eB).forEach(function(g){!Fn(r[g])&&e[g]!==r[g]&&(e[g]=r[g],g==="title"&&(s=!0))}),s&&this.localShow&&this.fixTitle()},createTemplateAndShow:function(){var e=this.getContainer(),r=this.getTemplate(),s=this.$_tip=ph(this,r,{propsData:{id:this.computedId,html:this.html,placement:this.placement,fallbackPlacement:this.fallbackPlacement,target:this.getPlacementTarget(),boundary:this.getBoundary(),offset:or(this.offset,0),arrowPadding:or(this.arrowPadding,0),boundaryPadding:or(this.boundaryPadding,0)}});this.handleTemplateUpdate(),s.$once(yo,this.onTemplateShow),s.$once(os,this.onTemplateShown),s.$once(Cs,this.onTemplateHide),s.$once(zn,this.onTemplateHidden),s.$once(sy,this.destroyTemplate),s.$on(q0,this.handleEvent),s.$on(W0,this.handleEvent),s.$on(wN,this.handleEvent),s.$on(TN,this.handleEvent),s.$mount(e.appendChild(document.createElement("div")))},hideTemplate:function(){this.$_tip&&this.$_tip.hide(),this.clearActiveTriggers(),this.$_hoverState=""},destroyTemplate:function(){this.setWhileOpenListeners(!1),this.clearHoverTimeout(),this.$_hoverState="",this.clearActiveTriggers(),this.localPlacementTarget=null;try{this.$_tip.$destroy()}catch{}this.$_tip=null,this.removeAriaDescribedby(),this.restoreTitle(),this.localShow=!1},getTemplateElement:function(){return this.$_tip?this.$_tip.$el:null},handleTemplateUpdate:function(){var e=this,r=this.$_tip;if(r){var s=["title","content","variant","customClass","noFade","interactive"];s.forEach(function(g){r[g]!==e[g]&&(r[g]=e[g])})}},show:function(){var e=this.getTarget();if(!(!e||!qn(document.body,e)||!il(e)||this.dropdownOpen()||(ji(this.title)||this.title==="")&&(ji(this.content)||this.content===""))&&!(this.$_tip||this.localShow)){this.localShow=!0;var r=this.buildEvent(yo,{cancelable:!0});if(this.emitEvent(r),r.defaultPrevented){this.destroyTemplate();return}this.fixTitle(),this.addAriaDescribedby(),this.createTemplateAndShow()}},hide:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.getTemplateElement();if(!r||!this.localShow){this.restoreTitle();return}var s=this.buildEvent(Cs,{cancelable:!e});this.emitEvent(s),!s.defaultPrevented&&this.hideTemplate()},forceHide:function(){var e=this.getTemplateElement();!e||!this.localShow||(this.setWhileOpenListeners(!1),this.clearHoverTimeout(),this.$_hoverState="",this.clearActiveTriggers(),this.$_tip&&(this.$_tip.noFade=!0),this.hide(!0))},enable:function(){this.$_enabled=!0,this.emitEvent(this.buildEvent(h0))},disable:function(){this.$_enabled=!1,this.emitEvent(this.buildEvent(u0))},onTemplateShow:function(){this.setWhileOpenListeners(!0)},onTemplateShown:function(){var e=this.$_hoverState;this.$_hoverState="",e==="out"&&this.leave(null),this.emitEvent(this.buildEvent(os))},onTemplateHide:function(){this.setWhileOpenListeners(!1)},onTemplateHidden:function(){this.destroyTemplate(),this.emitEvent(this.buildEvent(zn))},getTarget:function(){var e=this.target;return _i(e)?e=dS(e.replace(/^#/,"")):Mr(e)?e=e():e&&(e=e.$el||e),an(e)?e:null},getPlacementTarget:function(){return this.getTarget()},getTargetId:function(){var e=this.getTarget();return e&&e.id?e.id:null},getContainer:function(){var e=this.container?this.container.$el||this.container:!1,r=document.body,s=this.getTarget();return e===!1?Ms(nte,s)||r:_i(e)&&dS(e.replace(/^#/,""))||r},getBoundary:function(){return this.boundary?this.boundary.$el||this.boundary:"scrollParent"},isInModal:function(){var e=this.getTarget();return e&&Ms(s$,e)},isDropdown:function(){var e=this.getTarget();return e&&ly(e,ote)},dropdownOpen:function(){var e=this.getTarget();return this.isDropdown()&&e&&sa(ste,e)},clearHoverTimeout:function(){clearTimeout(this.$_hoverTimeout),this.$_hoverTimeout=null},clearVisibilityInterval:function(){clearInterval(this.$_visibleInterval),this.$_visibleInterval=null},clearActiveTriggers:function(){for(var e in this.activeTrigger)this.activeTrigger[e]=!1},addAriaDescribedby:function(){var e=this.getTarget(),r=aa(e,"aria-describedby")||"";r=r.split(/\s+/).concat(this.computedId).join(" ").trim(),yn(e,"aria-describedby",r)},removeAriaDescribedby:function(){var e=this,r=this.getTarget(),s=aa(r,"aria-describedby")||"";s=s.split(/\s+/).filter(function(g){return g!==e.computedId}).join(" ").trim(),s?yn(r,"aria-describedby",s):Nl(r,"aria-describedby")},fixTitle:function(){var e=this.getTarget();if($l(e,"title")){var r=aa(e,"title");yn(e,"title",""),r&&yn(e,e0,r)}},restoreTitle:function(){var e=this.getTarget();if($l(e,e0)){var r=aa(e,e0);Nl(e,e0),r&&yn(e,"title",r)}},buildEvent:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Kd(e,wE({cancelable:!1,target:this.getTarget(),relatedTarget:this.getTemplateElement()||null,componentId:this.computedId,vueTarget:this},r))},emitEvent:function(e){var r=e.type;this.emitOnRoot(Cn(this.templateType,r),e),this.$emit(r,e)},listen:function(){var e=this,r=this.getTarget();!r||(this.setRootListener(!0),this.computedTriggers.forEach(function(s){s==="click"?pn(r,"click",e.handleEvent,gi):s==="focus"?(pn(r,"focusin",e.handleEvent,gi),pn(r,"focusout",e.handleEvent,gi)):s==="blur"?pn(r,"focusout",e.handleEvent,gi):s==="hover"&&(pn(r,"mouseenter",e.handleEvent,gi),pn(r,"mouseleave",e.handleEvent,gi))},this))},unListen:function(){var e=this,r=["click","focusin","focusout","mouseenter","mouseleave"],s=this.getTarget();this.setRootListener(!1),r.forEach(function(g){s&&Tn(s,g,e.handleEvent,gi)},this)},setRootListener:function(e){var r=e?"listenOnRoot":"listenOffRoot",s=this.templateType;this[r](Wn(s,Cs),this.doHide),this[r](Wn(s,yo),this.doShow),this[r](Wn(s,lS),this.doDisable),this[r](Wn(s,cS),this.doEnable)},setWhileOpenListeners:function(e){this.setModalListener(e),this.setDropdownListener(e),this.visibleCheck(e),this.setOnTouchStartListener(e)},visibleCheck:function(e){var r=this;this.clearVisibilityInterval();var s=this.getTarget();e&&(this.$_visibleInterval=setInterval(function(){var g=r.getTemplateElement();g&&r.localShow&&(!s.parentNode||!il(s))&&r.forceHide()},100))},setModalListener:function(e){this.isInModal()&&this[e?"listenOnRoot":"listenOffRoot"](rte,this.forceHide)},setOnTouchStartListener:function(e){var r=this;"ontouchstart"in document.documentElement&&jd(document.body.children).forEach(function(s){nl(e,s,"mouseover",r.$_noop)})},setDropdownListener:function(e){var r=this.getTarget();if(!(!r||!this.bvEventRoot||!this.isDropdown)){var s=dK(r);s&&s[e?"$on":"$off"](os,this.forceHide)}},handleEvent:function(e){var r=this.getTarget();if(!(!r||Td(r)||!this.$_enabled||this.dropdownOpen())){var s=e.type,g=this.computedTriggers;if(s==="click"&&Vr(g,"click"))this.click(e);else if(s==="mouseenter"&&Vr(g,"hover"))this.enter(e);else if(s==="focusin"&&Vr(g,"focus"))this.enter(e);else if(s==="focusout"&&(Vr(g,"focus")||Vr(g,"blur"))||s==="mouseleave"&&Vr(g,"hover")){var T=this.getTemplateElement(),I=e.target,a=e.relatedTarget;if(T&&qn(T,I)&&qn(r,a)||T&&qn(r,I)&&qn(T,a)||T&&qn(T,I)&&qn(T,a)||qn(r,I)&&qn(r,a))return;this.leave(e)}}},doHide:function(e){(!e||this.getTargetId()===e||this.computedId===e)&&this.forceHide()},doShow:function(e){(!e||this.getTargetId()===e||this.computedId===e)&&this.show()},doDisable:function(e){(!e||this.getTargetId()===e||this.computedId===e)&&this.disable()},doEnable:function(e){(!e||this.getTargetId()===e||this.computedId===e)&&this.enable()},click:function(e){!this.$_enabled||this.dropdownOpen()||(ii(e.currentTarget),this.activeTrigger.click=!this.activeTrigger.click,this.isWithActiveTrigger?this.enter(null):this.leave(null))},toggle:function(){!this.$_enabled||this.dropdownOpen()||(this.localShow?this.leave(null):this.enter(null))},enter:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(r&&(this.activeTrigger[r.type==="focusin"?"focus":"hover"]=!0),this.localShow||this.$_hoverState==="in"){this.$_hoverState="in";return}this.clearHoverTimeout(),this.$_hoverState="in",this.computedDelay.show?(this.fixTitle(),this.$_hoverTimeout=setTimeout(function(){e.$_hoverState==="in"?e.show():e.localShow||e.restoreTitle()},this.computedDelay.show)):this.show()},leave:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;r&&(this.activeTrigger[r.type==="focusout"?"focus":"hover"]=!1,r.type==="focusout"&&Vr(this.computedTriggers,"blur")&&(this.activeTrigger.click=!1,this.activeTrigger.hover=!1)),!this.isWithActiveTrigger&&(this.clearHoverTimeout(),this.$_hoverState="out",this.computedDelay.hide?this.$_hoverTimeout=setTimeout(function(){e.$_hoverState==="out"&&e.hide()},this.computedDelay.hide):this.hide())}}}),vs,hd;function tB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function ate(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tB(Object(r),!0).forEach(function(s){mo(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function mo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var H_="disabled",rB=dh+H_,yx="show",lte=dh+yx,a$=Ct((vs={boundary:k([Yu,Zn,ie],"scrollParent"),boundaryPadding:k(dr,50),container:k([Yu,Zn,ie]),customClass:k(ie),delay:k(S7,50)},mo(vs,H_,k(Ee,!1)),mo(vs,"fallbackPlacement",k(Ho,"flip")),mo(vs,"id",k(ie)),mo(vs,"noFade",k(Ee,!1)),mo(vs,"noninteractive",k(Ee,!1)),mo(vs,"offset",k(dr,0)),mo(vs,"placement",k(ie,"top")),mo(vs,yx,k(Ee,!1)),mo(vs,"target",k([Yu,vz,ls,Zn,ie],void 0,!0)),mo(vs,"title",k(ie)),mo(vs,"triggers",k(Ho,"hover focus")),mo(vs,"variant",k(ie)),vs),bd),l$=ot({name:bd,mixins:[Ur,fh],inheritAttrs:!1,props:a$,data:function(){return{localShow:this[yx],localTitle:"",localContent:""}},computed:{templateData:function(){return ate({title:this.localTitle,content:this.localContent,interactive:!this.noninteractive},sl(this.$props,["boundary","boundaryPadding","container","customClass","delay","fallbackPlacement","id","noFade","offset","placement","target","target","triggers","variant",H_]))},templateTitleContent:function(){var e=this.title,r=this.content;return{title:e,content:r}}},watch:(hd={},mo(hd,yx,function(t,e){t!==e&&t!==this.localShow&&this.$_toolpop&&(t?this.$_toolpop.show():this.$_toolpop.forceHide())}),mo(hd,H_,function(t){t?this.doDisable():this.doEnable()}),mo(hd,"localShow",function(e){this.$emit(lte,e)}),mo(hd,"templateData",function(){var e=this;this.$nextTick(function(){e.$_toolpop&&e.$_toolpop.updateData(e.templateData)})}),mo(hd,"templateTitleContent",function(){this.$nextTick(this.updateContent)}),hd),created:function(){this.$_toolpop=null},updated:function(){this.$nextTick(this.updateContent)},beforeDestroy:function(){this.$off(hI,this.doOpen),this.$off(aS,this.doClose),this.$off(lS,this.doDisable),this.$off(cS,this.doEnable),this.$_toolpop&&(this.$_toolpop.$destroy(),this.$_toolpop=null)},mounted:function(){var e=this;this.$nextTick(function(){var r=e.getComponent();e.updateContent();var s=im(e)||im(e.bvParent),g=e.$_toolpop=ph(e,r,{_scopeId:s||void 0});g.updateData(e.templateData),g.$on(yo,e.onShow),g.$on(os,e.onShown),g.$on(Cs,e.onHide),g.$on(zn,e.onHidden),g.$on(u0,e.onDisabled),g.$on(h0,e.onEnabled),e[H_]&&e.doDisable(),e.$on(hI,e.doOpen),e.$on(aS,e.doClose),e.$on(lS,e.doDisable),e.$on(cS,e.doEnable),e.localShow&&g.show()})},methods:{getComponent:function(){return MP},updateContent:function(){this.setTitle(this.normalizeSlot()||this.title)},setTitle:function(e){e=ji(e)?"":e,this.localTitle!==e&&(this.localTitle=e)},setContent:function(e){e=ji(e)?"":e,this.localContent!==e&&(this.localContent=e)},onShow:function(e){this.$emit(yo,e),e&&(this.localShow=!e.defaultPrevented)},onShown:function(e){this.localShow=!0,this.$emit(os,e)},onHide:function(e){this.$emit(Cs,e)},onHidden:function(e){this.$emit(zn,e),this.localShow=!1},onDisabled:function(e){e&&e.type===u0&&(this.$emit(rB,!0),this.$emit(u0,e))},onEnabled:function(e){e&&e.type===h0&&(this.$emit(rB,!1),this.$emit(h0,e))},doOpen:function(){!this.localShow&&this.$_toolpop&&this.$_toolpop.show()},doClose:function(){this.localShow&&this.$_toolpop&&this.$_toolpop.hide()},doDisable:function(){this.$_toolpop&&this.$_toolpop.disable()},doEnable:function(){this.$_toolpop&&this.$_toolpop.enable()}},render:function(e){return e()}}),cte=ot({name:Gq,extends:o$,computed:{templateType:function(){return"popover"}},methods:{renderTemplate:function(e){var r=this.title,s=this.content,g=Mr(r)?r({}):r,T=Mr(s)?s({}):s,I=this.html&&!Mr(r)?{innerHTML:r}:{},a=this.html&&!Mr(s)?{innerHTML:s}:{};return e("div",{staticClass:"popover b-popover",class:this.templateClasses,attrs:this.templateAttributes,on:this.templateListeners},[e("div",{staticClass:"arrow",ref:"arrow"}),ji(g)||g===""?e():e("h3",{staticClass:"popover-header",domProps:I},[g]),ji(T)||T===""?e():e("div",{staticClass:"popover-body",domProps:a},[T])])}}}),c$=ot({name:Uq,extends:MP,computed:{templateType:function(){return"popover"}},methods:{getTemplate:function(){return cte}}});function iB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function nB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iB(Object(r),!0).forEach(function(s){ute(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ute(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var hte=Ct(vr(nB(nB({},a$),{},{content:k(ie),placement:k(ie,"right"),triggers:k(Ho,Ba)})),vd),dte=ot({name:vd,extends:l$,inheritAttrs:!1,props:hte,methods:{getComponent:function(){return c$},updateContent:function(){this.setContent(this.normalizeSlot()||this.content),this.setTitle(this.normalizeSlot(Py)||this.title)}}});function oB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function sB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oB(Object(r),!0).forEach(function(s){fte(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function fte(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ca="__BV_Popover__",pte="click",aB={focus:!0,hover:!0,click:!0,blur:!0,manual:!0},mte=/^html$/i,gte=/^nofade$/i,_te=/^(auto|top(left|right)?|bottom(left|right)?|left(top|bottom)?|right(top|bottom)?)$/i,yte=/^(window|viewport|scrollParent)$/i,vte=/^d\d+$/i,bte=/^ds\d+$/i,xte=/^dh\d+$/i,wte=/^o-?\d+$/i,Tte=/^v-.+$/i,Ete=/\s+/,Ste=function(e,r){var s={title:void 0,content:void 0,trigger:"",placement:"right",fallbackPlacement:"flip",container:!1,animation:!0,offset:0,disabled:!1,id:null,html:!1,delay:na(vd,"delay",50),boundary:String(na(vd,"boundary","scrollParent")),boundaryPadding:or(na(vd,"boundaryPadding",5),0),variant:na(vd,"variant"),customClass:na(vd,"customClass")};if(_i(e.value)||rl(e.value)||Mr(e.value)?s.content=e.value:Go(e.value)&&(s=sB(sB({},s),e.value)),e.arg&&(s.container="#".concat(e.arg)),Fn(s.title)){var g=r.data||{};s.title=g.attrs&&!ji(g.attrs.title)?g.attrs.title:void 0}Go(s.delay)||(s.delay={show:or(s.delay,0),hide:or(s.delay,0)}),Gr(e.modifiers).forEach(function(I){if(mte.test(I))s.html=!0;else if(gte.test(I))s.animation=!1;else if(_te.test(I))s.placement=I;else if(yte.test(I))I=I==="scrollparent"?"scrollParent":I,s.boundary=I;else if(vte.test(I)){var a=or(I.slice(1),0);s.delay.show=a,s.delay.hide=a}else bte.test(I)?s.delay.show=or(I.slice(2),0):xte.test(I)?s.delay.hide=or(I.slice(2),0):wte.test(I)?s.offset=or(I.slice(1),0):Tte.test(I)&&(s.variant=I.slice(2)||null)});var T={};return bi(s.trigger||"").filter($r).join(" ").trim().toLowerCase().split(Ete).forEach(function(I){aB[I]&&(T[I]=!0)}),Gr(e.modifiers).forEach(function(I){I=I.toLowerCase(),aB[I]&&(T[I]=!0)}),s.trigger=Gr(T).join(" "),s.trigger==="blur"&&(s.trigger="focus"),s.trigger||(s.trigger=pte),s},lB=function(e,r,s){if(!!Xi){var g=Ste(r,s);if(!e[Ca]){var T=jl(s,r);e[Ca]=ph(T,c$,{_scopeId:im(T,void 0)}),e[Ca].__bv_prev_data__={},e[Ca].$on(yo,function(){var H={};Mr(g.title)&&(H.title=g.title(e)),Mr(g.content)&&(H.content=g.content(e)),Gr(H).length>0&&e[Ca].updateData(H)})}var I={title:g.title,content:g.content,triggers:g.trigger,placement:g.placement,fallbackPlacement:g.fallbackPlacement,variant:g.variant,customClass:g.customClass,container:g.container,boundary:g.boundary,delay:g.delay,offset:g.offset,noFade:!g.animation,id:g.id,disabled:g.disabled,html:g.html},a=e[Ca].__bv_prev_data__;if(e[Ca].__bv_prev_data__=I,!Ci(I,a)){var N={target:e};Gr(I).forEach(function(H){I[H]!==a[H]&&(N[H]=(H==="title"||H==="content")&&Mr(I[H])?I[H](e):I[H])}),e[Ca].updateData(N)}}},Ote=function(e){e[Ca]&&(e[Ca].$destroy(),e[Ca]=null),delete e[Ca]},Pte={bind:function(e,r,s){lB(e,r,s)},componentUpdated:function(e,r,s){$O(function(){lB(e,r,s)})},unbind:function(e){Ote(e)}},u$=wr({directives:{VBPopover:Pte}}),Ate=wr({components:{BPopover:dte},plugins:{VBPopoverPlugin:u$}}),h$=Ct({animated:k(Ee,null),label:k(ie),labelHtml:k(ie),max:k(dr,null),precision:k(dr,null),showProgress:k(Ee,null),showValue:k(Ee,null),striped:k(Ee,null),value:k(dr,0),variant:k(ie)},KF),d$=ot({name:KF,mixins:[Ur],inject:{getBvProgress:{default:function(){return function(){return{}}}}},props:h$,computed:{bvProgress:function(){return this.getBvProgress()},progressBarClasses:function(){var e=this.computedAnimated,r=this.computedVariant;return[r?"bg-".concat(r):"",this.computedStriped||e?"progress-bar-striped":"",e?"progress-bar-animated":""]},progressBarStyles:function(){return{width:100*(this.computedValue/this.computedMax)+"%"}},computedValue:function(){return hi(this.value,0)},computedMax:function(){var e=hi(this.max)||hi(this.bvProgress.max,0);return e>0?e:100},computedPrecision:function(){return Li(or(this.precision,or(this.bvProgress.precision,0)),0)},computedProgress:function(){var e=this.computedPrecision,r=WN(10,e);return $T(100*r*this.computedValue/this.computedMax/r,e)},computedVariant:function(){return this.variant||this.bvProgress.variant},computedStriped:function(){return Da(this.striped)?this.striped:this.bvProgress.striped||!1},computedAnimated:function(){return Da(this.animated)?this.animated:this.bvProgress.animated||!1},computedShowProgress:function(){return Da(this.showProgress)?this.showProgress:this.bvProgress.showProgress||!1},computedShowValue:function(){return Da(this.showValue)?this.showValue:this.bvProgress.showValue||!1}},render:function(e){var r=this.label,s=this.labelHtml,g=this.computedValue,T=this.computedPrecision,I,a={};return this.hasNormalizedSlot()?I=this.normalizeSlot():r||s?a=En(s,r):this.computedShowProgress?I=this.computedProgress:this.computedShowValue&&(I=$T(g,T)),e("div",{staticClass:"progress-bar",class:this.progressBarClasses,style:this.progressBarStyles,attrs:{role:"progressbar","aria-valuemin":"0","aria-valuemax":Lr(this.computedMax),"aria-valuenow":$T(g,T)},domProps:a},I)}});function cB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function uB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cB(Object(r),!0).forEach(function(s){Cte(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Cte(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f$=oi(h$,["label","labelHtml"]),Mte=Ct(vr(uB(uB({},f$),{},{animated:k(Ee,!1),height:k(ie),max:k(dr,100),precision:k(dr,0),showProgress:k(Ee,!1),showValue:k(Ee,!1),striped:k(Ee,!1)})),XF),Ite=ot({name:XF,mixins:[Ur],provide:function(){var e=this;return{getBvProgress:function(){return e}}},props:Mte,computed:{progressHeight:function(){return{height:this.height||null}}},render:function(e){var r=this.normalizeSlot();return r||(r=e(d$,{props:mn(f$,this.$props)})),e("div",{staticClass:"progress",style:this.progressHeight},[r])}}),Dte=wr({components:{BProgress:Ite,BProgressBar:d$}}),p_;function hB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function q_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hB(Object(r),!0).forEach(function(s){yc(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function yc(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var py="b-sidebar",Rte=Wn(Ro,"request-state"),Lte=Wn(Ro,"toggle"),Bte=Cn(Ro,"state"),kte=Cn(Ro,"sync-state"),D1=Xn("visible",{type:Ee,defaultValue:!1,event:Bs}),zte=D1.mixin,Fte=D1.props,dB=D1.prop,Nte=D1.event,$te=Ct(vr(q_(q_(q_({},Hi),Fte),{},{ariaLabel:k(ie),ariaLabelledby:k(ie),backdrop:k(Ee,!1),backdropVariant:k(ie,"dark"),bgVariant:k(ie,"light"),bodyClass:k(Nr),closeLabel:k(ie),footerClass:k(Nr),footerTag:k(ie,"footer"),headerClass:k(Nr),headerTag:k(ie,"header"),lazy:k(Ee,!1),noCloseOnBackdrop:k(Ee,!1),noCloseOnEsc:k(Ee,!1),noCloseOnRouteChange:k(Ee,!1),noEnforceFocus:k(Ee,!1),noHeader:k(Ee,!1),noHeaderClose:k(Ee,!1),noSlide:k(Ee,!1),right:k(Ee,!1),shadow:k(qo,!1),sidebarClass:k(Nr),tag:k(ie,"div"),textVariant:k(ie,"dark"),title:k(ie),width:k(ie),zIndex:k(dr)})),JF),jte=function(e,r){var s=r.normalizeSlot(Py,r.slotScope)||r.title;return s?e("strong",{attrs:{id:r.safeId("__title__")}},[s]):e("span")},Vte=function(e,r){if(r.noHeaderClose)return e();var s=r.closeLabel,g=r.textVariant,T=r.hide;return e(Ud,{props:{ariaLabel:s,textVariant:g},on:{click:T},ref:"close-button"},[r.normalizeSlot(k7)||e(JN)])},Ute=function(e,r){if(r.noHeader)return e();var s=r.normalizeSlot(sh,r.slotScope);if(!s){var g=jte(e,r),T=Vte(e,r);s=r.right?[T,g]:[g,T]}return e(r.headerTag,{staticClass:"".concat(py,"-header"),class:r.headerClass,key:"header"},s)},Gte=function(e,r){return e("div",{staticClass:"".concat(py,"-body"),class:r.bodyClass,key:"body"},[r.normalizeSlot(eo,r.slotScope)])},Hte=function(e,r){var s=r.normalizeSlot(hS,r.slotScope);return s?e(r.footerTag,{staticClass:"".concat(py,"-footer"),class:r.footerClass,key:"footer"},[s]):e()},qte=function(e,r){var s=Ute(e,r);return r.lazy&&!r.isOpen?s:[s,Gte(e,r),Hte(e,r)]},Wte=function(e,r){if(!r.backdrop)return e();var s=r.backdropVariant;return e("div",{directives:[{name:"show",value:r.localShow}],staticClass:"b-sidebar-backdrop",class:yc({},"bg-".concat(s),s),on:{click:r.onBackdropClick}})},Zte=ot({name:JF,mixins:[lo,Ki,zte,al,Ur],inheritAttrs:!1,props:$te,data:function(){var e=!!this[dB];return{localShow:e,isOpen:e}},computed:{transitionProps:function(){return this.noSlide?{css:!0}:{css:!0,enterClass:"",enterActiveClass:"slide",enterToClass:"show",leaveClass:"show",leaveActiveClass:"slide",leaveToClass:""}},slotScope:function(){var e=this.hide,r=this.right,s=this.localShow;return{hide:e,right:r,visible:s}},hasTitle:function(){var e=this.$scopedSlots,r=this.$slots;return!this.noHeader&&!this.hasNormalizedSlot(sh)&&!!(this.normalizeSlot(Py,this.slotScope,e,r)||this.title)},titleId:function(){return this.hasTitle?this.safeId("__title__"):null},computedAttrs:function(){return q_(q_({},this.bvAttrs),{},{id:this.safeId(),tabindex:"-1",role:"dialog","aria-modal":this.backdrop?"true":"false","aria-hidden":this.localShow?null:"true","aria-label":this.ariaLabel||null,"aria-labelledby":this.ariaLabelledby||this.titleId||null})}},watch:(p_={},yc(p_,dB,function(t,e){t!==e&&(this.localShow=t)}),yc(p_,"localShow",function(e,r){e!==r&&(this.emitState(e),this.$emit(Nte,e))}),yc(p_,"$route",function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};!this.noCloseOnRouteChange&&e.fullPath!==r.fullPath&&this.hide()}),p_),created:function(){this.$_returnFocusEl=null},mounted:function(){var e=this;this.listenOnRoot(Lte,this.handleToggle),this.listenOnRoot(Rte,this.handleSync),this.$nextTick(function(){e.emitState(e.localShow)})},activated:function(){this.emitSync()},beforeDestroy:function(){this.localShow=!1,this.$_returnFocusEl=null},methods:{hide:function(){this.localShow=!1},emitState:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.localShow;this.emitOnRoot(Bte,this.safeId(),e)},emitSync:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.localShow;this.emitOnRoot(kte,this.safeId(),e)},handleToggle:function(e){e&&e===this.safeId()&&(this.localShow=!this.localShow)},handleSync:function(e){var r=this;e&&e===this.safeId()&&this.$nextTick(function(){r.emitSync(r.localShow)})},onKeydown:function(e){var r=e.keyCode;!this.noCloseOnEsc&&r===QO&&this.localShow&&this.hide()},onBackdropClick:function(){this.localShow&&!this.noCloseOnBackdrop&&this.hide()},onTopTrapFocus:function(){var e=pS(this.$refs.content);this.enforceFocus(e.reverse()[0])},onBottomTrapFocus:function(){var e=pS(this.$refs.content);this.enforceFocus(e[0])},onBeforeEnter:function(){this.$_returnFocusEl=ah(Xi?[document.body]:[]),this.isOpen=!0},onAfterEnter:function(e){qn(e,ah())||this.enforceFocus(e),this.$emit(os)},onAfterLeave:function(){this.enforceFocus(this.$_returnFocusEl),this.$_returnFocusEl=null,this.isOpen=!1,this.$emit(zn)},enforceFocus:function(e){this.noEnforceFocus||ii(e)}},render:function(e){var r,s=this.bgVariant,g=this.width,T=this.textVariant,I=this.localShow,a=this.shadow===""?!0:this.shadow,N=e(this.tag,{staticClass:py,class:[(r={shadow:a===!0},yc(r,"shadow-".concat(a),a&&a!==!0),yc(r,"".concat(py,"-right"),this.right),yc(r,"bg-".concat(s),s),yc(r,"text-".concat(T),T),r),this.sidebarClass],style:{width:g},attrs:this.computedAttrs,directives:[{name:"show",value:I}],ref:"content"},[qte(e,this)]);N=e("transition",{props:this.transitionProps,on:{beforeEnter:this.onBeforeEnter,afterEnter:this.onAfterEnter,afterLeave:this.onAfterLeave}},[N]);var H=e(Zd,{props:{noFade:this.noSlide}},[Wte(e,this)]),K=e(),ee=e();return this.backdrop&&I&&(K=e("div",{attrs:{tabindex:"0"},on:{focus:this.onTopTrapFocus}}),ee=e("div",{attrs:{tabindex:"0"},on:{focus:this.onBottomTrapFocus}})),e("div",{staticClass:"b-sidebar-outer",style:{zIndex:this.zIndex},attrs:{tabindex:"-1"},on:{keydown:this.onKeydown}},[K,N,ee,H])}}),Xte=wr({components:{BSidebar:Zte},plugins:{VBTogglePlugin:cP}});function TE(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Kte=Ct({animation:k(ie,"wave"),height:k(ie),size:k(ie),type:k(ie,"text"),variant:k(ie),width:k(ie)},QF),vx=ot({name:QF,functional:!0,props:Kte,render:function(e,r){var s,g=r.data,T=r.props,I=T.size,a=T.animation,N=T.variant;return e("div",Sr(g,{staticClass:"b-skeleton",style:{width:I||T.width,height:I||T.height},class:(s={},TE(s,"b-skeleton-".concat(T.type),!0),TE(s,"b-skeleton-animate-".concat(a),a),TE(s,"bg-".concat(N),N),s)}))}});function fB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function pB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fB(Object(r),!0).forEach(function(s){p$(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function p$(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Yte=Ct({animation:k(ie,"wave"),icon:k(ie),iconProps:k(Zn,{})},eN),Jte=ot({name:eN,functional:!0,props:Yte,render:function(e,r){var s=r.data,g=r.props,T=g.icon,I=g.animation,a=e(K0,{staticClass:"b-skeleton-icon",props:pB(pB({},g.iconProps),{},{icon:T})});return e("div",Sr(s,{staticClass:"b-skeleton-icon-wrapper position-relative d-inline-block overflow-hidden",class:p$({},"b-skeleton-animate-".concat(I),I)}),[a])}});function Qte(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ere=Ct({animation:k(ie),aspect:k(ie,"16:9"),cardImg:k(ie),height:k(ie),noAspect:k(Ee,!1),variant:k(ie),width:k(ie)},tN),tre=ot({name:tN,functional:!0,props:ere,render:function(e,r){var s=r.data,g=r.props,T=g.aspect,I=g.width,a=g.height,N=g.animation,H=g.variant,K=g.cardImg,ee=e(vx,Sr(s,{props:{type:"img",width:I,height:a,animation:N,variant:H},class:Qte({},"card-img-".concat(K),K)}));return g.noAspect?ee:e(ZN,{props:{aspect:T}},[ee])}}),IP=ot({methods:{hasListener:function(e){if(cs)return!0;var r=this.$listeners||{},s=this._events||{};return!Fn(r[e])||Ni(s[e])&&s[e].length>0}}});function mB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function rre(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mB(Object(r),!0).forEach(function(s){ire(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ire(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var gB="light",_B="dark",nre=Ct({variant:k(ie)},mN),Lc=ot({name:mN,mixins:[lo,Fc,Ur],provide:function(){var e=this;return{getBvTableTr:function(){return e}}},inject:{getBvTableRowGroup:{default:function(){return function(){return{}}}}},inheritAttrs:!1,props:nre,computed:{bvTableRowGroup:function(){return this.getBvTableRowGroup()},inTbody:function(){return this.bvTableRowGroup.isTbody},inThead:function(){return this.bvTableRowGroup.isThead},inTfoot:function(){return this.bvTableRowGroup.isTfoot},isDark:function(){return this.bvTableRowGroup.isDark},isStacked:function(){return this.bvTableRowGroup.isStacked},isResponsive:function(){return this.bvTableRowGroup.isResponsive},isStickyHeader:function(){return this.bvTableRowGroup.isStickyHeader},hasStickyHeader:function(){return!this.isStacked&&this.bvTableRowGroup.hasStickyHeader},tableVariant:function(){return this.bvTableRowGroup.tableVariant},headVariant:function(){return this.inThead?this.bvTableRowGroup.headVariant:null},footVariant:function(){return this.inTfoot?this.bvTableRowGroup.footVariant:null},isRowDark:function(){return this.headVariant===gB||this.footVariant===gB?!1:this.headVariant===_B||this.footVariant===_B?!0:this.isDark},trClasses:function(){var e=this.variant;return[e?"".concat(this.isRowDark?"bg":"table","-").concat(e):null]},trAttrs:function(){return rre({role:"row"},this.bvAttrs)}},render:function(e){return e("tr",{class:this.trClasses,attrs:this.trAttrs,on:this.bvListeners},this.normalizeSlot())}}),m$={},ore=ot({props:m$,methods:{renderBottomRow:function(){var e=this.computedFields,r=this.stacked,s=this.tbodyTrClass,g=this.tbodyTrAttr,T=this.$createElement;return!this.hasNormalizedSlot(pI)||r===!0||r===""?T():T(Lc,{staticClass:"b-table-bottom-row",class:[Mr(s)?s(null,"row-bottom"):s],attrs:Mr(g)?g(null,"row-bottom"):g,key:"b-bottom-row"},this.normalizeSlot(pI,{columns:e.length,fields:e}))}}});function yB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function vB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yB(Object(r),!0).forEach(function(s){sre(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function sre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ZS=function(e){return e=or(e,0),e>0?e:null},bB=function(e){return ji(e)||ZS(e)>0},g$=Ct({colspan:k(dr,null,bB),rowspan:k(dr,null,bB),stackedHeading:k(ie),stickyColumn:k(Ee,!1),variant:k(ie)},sN),om=ot({name:sN,mixins:[lo,Fc,Ur],inject:{getBvTableTr:{default:function(){return function(){return{}}}}},inheritAttrs:!1,props:g$,computed:{bvTableTr:function(){return this.getBvTableTr()},tag:function(){return"td"},inTbody:function(){return this.bvTableTr.inTbody},inThead:function(){return this.bvTableTr.inThead},inTfoot:function(){return this.bvTableTr.inTfoot},isDark:function(){return this.bvTableTr.isDark},isStacked:function(){return this.bvTableTr.isStacked},isStackedCell:function(){return this.inTbody&&this.isStacked},isResponsive:function(){return this.bvTableTr.isResponsive},isStickyHeader:function(){return this.bvTableTr.isStickyHeader},hasStickyHeader:function(){return this.bvTableTr.hasStickyHeader},isStickyColumn:function(){return!this.isStacked&&(this.isResponsive||this.hasStickyHeader)&&this.stickyColumn},rowVariant:function(){return this.bvTableTr.variant},headVariant:function(){return this.bvTableTr.headVariant},footVariant:function(){return this.bvTableTr.footVariant},tableVariant:function(){return this.bvTableTr.tableVariant},computedColspan:function(){return ZS(this.colspan)},computedRowspan:function(){return ZS(this.rowspan)},cellClasses:function(){var e=this.variant,r=this.headVariant,s=this.isStickyColumn;return(!e&&this.isStickyHeader&&!r||!e&&s&&this.inTfoot&&!this.footVariant||!e&&s&&this.inThead&&!r||!e&&s&&this.inTbody)&&(e=this.rowVariant||this.tableVariant||"b-table-default"),[e?"".concat(this.isDark?"bg":"table","-").concat(e):null,s?"b-table-sticky-column":null]},cellAttrs:function(){var e=this.stackedHeading,r=this.inThead||this.inTfoot,s=this.computedColspan,g=this.computedRowspan,T="cell",I=null;return r?(T="columnheader",I=s>0?"colspan":"col"):Wl(this.tag,"th")&&(T="rowheader",I=g>0?"rowgroup":"row"),vB(vB({colspan:s,rowspan:g,role:T,scope:I},this.bvAttrs),{},{"data-label":this.isStackedCell&&!ji(e)?Lr(e):null})}},render:function(e){var r=[this.normalizeSlot()];return e(this.tag,{class:this.cellClasses,attrs:this.cellAttrs,on:this.bvListeners},[this.isStackedCell?e("div",[r]):r])}});function are(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var DP="busy",lre=dh+DP,_$=are({},DP,k(Ee,!1)),cre=ot({props:_$,data:function(){return{localBusy:!1}},computed:{computedBusy:function(){return this[DP]||this.localBusy}},watch:{localBusy:function(e,r){e!==r&&this.$emit(lre,e)}},methods:{stopIfBusy:function(e){return this.computedBusy?(ei(e),!0):!1},renderBusy:function(){var e=this.tbodyTrClass,r=this.tbodyTrAttr,s=this.$createElement;return this.computedBusy&&this.hasNormalizedSlot(w_)?s(Lc,{staticClass:"b-table-busy-slot",class:[Mr(e)?e(null,w_):e],attrs:Mr(r)?r(null,w_):r,key:"table-busy-slot"},[s(om,{props:{colspan:this.computedFields.length||null}},[this.normalizeSlot(w_)])]):null}}}),RP={caption:k(ie),captionHtml:k(ie)},y$=ot({props:RP,computed:{captionId:function(){return this.isStacked?this.safeId("_caption_"):null}},methods:{renderCaption:function(){var e=this.caption,r=this.captionHtml,s=this.$createElement,g=s(),T=this.hasNormalizedSlot(xI);return(T||e||r)&&(g=s("caption",{attrs:{id:this.captionId},domProps:T?{}:En(r,e),key:"caption",ref:"caption"},this.normalizeSlot(xI))),g}}}),v$={},b$=ot({methods:{renderColgroup:function(){var e=this.computedFields,r=this.$createElement,s=r();return this.hasNormalizedSlot(wI)&&(s=r("colgroup",{key:"colgroup"},[this.normalizeSlot(wI,{columns:e.length,fields:e})])),s}}}),x$={emptyFilteredHtml:k(ie),emptyFilteredText:k(ie,"There are no records matching your request"),emptyHtml:k(ie),emptyText:k(ie,"There are no records to show"),showEmpty:k(Ee,!1)},ure=ot({props:x$,methods:{renderEmpty:function(){var e=Bn(this),r=e.computedItems,s=e.computedBusy,g=this.$createElement,T=g();if(this.showEmpty&&(!r||r.length===0)&&!(s&&this.hasNormalizedSlot(w_))){var I=this.computedFields,a=this.isFiltered,N=this.emptyText,H=this.emptyHtml,K=this.emptyFilteredText,ee=this.emptyFilteredHtml,ue=this.tbodyTrClass,Pe=this.tbodyTrAttr;T=this.normalizeSlot(a?L7:LN,{emptyFilteredHtml:ee,emptyFilteredText:K,emptyHtml:H,emptyText:N,fields:I,items:r}),T||(T=g("div",{class:["text-center","my-2"],domProps:a?En(ee,K):En(H,N)})),T=g(om,{props:{colspan:I.length||null}},[g("div",{attrs:{role:"alert","aria-live":"polite"}},[T])]),T=g(Lc,{staticClass:"b-table-empty-row",class:[Mr(ue)?ue(null,"row-empty"):ue],attrs:Mr(Pe)?Pe(null,"row-empty"):Pe,key:a?"b-empty-filtered-row":"b-empty-row"},[T])}return T}}}),XS=function t(e){return ji(e)?"":kn(e)&&!Xp(e)?Gr(e).sort().map(function(r){return t(e[r])}).filter(function(r){return!!r}).join(" "):Lr(e)};function xB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function wB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xB(Object(r),!0).forEach(function(s){w$(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function w$(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var I0="_cellVariants",KS="_rowVariant",D_="_showDetails",T$=[I0,KS,D_].reduce(function(t,e){return wB(wB({},t),{},w$({},e,!0))},{}),hre=["a","a *","button","button *","input:not(.disabled):not([disabled])","select:not(.disabled):not([disabled])","textarea:not(.disabled):not([disabled])",'[role="link"]','[role="link"] *','[role="button"]','[role="button"] *',"[tabindex]:not(.disabled):not([disabled])"].join(","),YS=function(e,r,s){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},T=Gr(g).reduce(function(a,N){var H=g[N],K=H.filterByFormatted,ee=Mr(K)?K:K?H.formatter:null;return Mr(ee)&&(a[N]=ee(e[N],N,e)),a},hh(e)),I=Gr(T).filter(function(a){return!T$[a]&&!(Ni(r)&&r.length>0&&Vr(r,a))&&!(Ni(s)&&s.length>0&&!Vr(s,a))});return sl(T,I)},dre=function(e,r,s,g){return kn(e)?XS(YS(e,r,s,g)):""};function fre(t){return _re(t)||gre(t)||mre(t)||pre()}function pre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mre(t,e){if(!!t){if(typeof t=="string")return JS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JS(t,e)}}function gre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _re(t){if(Array.isArray(t))return JS(t)}function JS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}var yre='Prop "filter-debounce" is deprecated. Use the debounce feature of "<b-form-input>" instead.',E$={filter:k([].concat(fre(Nr),[x7])),filterDebounce:k(dr,0,function(t){return gz.test(String(t))}),filterFunction:k(ls),filterIgnoredFields:k(ss,[]),filterIncludedFields:k(ss,[])},vre=ot({props:E$,data:function(){return{isFiltered:!1,localFilter:this.filterSanitize(this.filter)}},computed:{computedFilterIgnored:function(){return bi(this.filterIgnoredFields||[]).filter($r)},computedFilterIncluded:function(){return bi(this.filterIncludedFields||[]).filter($r)},computedFilterDebounce:function(){var e=or(this.filterDebounce,0);return e>0&&ao(yre,$d),e},localFiltering:function(){return this.hasProvider?!!this.noProviderFiltering:!0},filteredCheck:function(){var e=this.filteredItems,r=this.localItems,s=this.localFilter;return{filteredItems:e,localItems:r,localFilter:s}},localFilterFn:function(){var e=this.filterFunction;return Gl(e)?e:null},filteredItems:function(){var e=this.localItems,r=this.localFilter,s=this.localFiltering?this.filterFnFactory(this.localFilterFn,r)||this.defaultFilterFnFactory(r):null;return s&&e.length>0?e.filter(s):e}},watch:{computedFilterDebounce:function(e){!e&&this.$_filterTimer&&(this.clearFilterTimer(),this.localFilter=this.filterSanitize(this.filter))},filter:{deep:!0,handler:function(e){var r=this,s=this.computedFilterDebounce;this.clearFilterTimer(),s&&s>0?this.$_filterTimer=setTimeout(function(){r.localFilter=r.filterSanitize(e)},s):this.localFilter=this.filterSanitize(e)}},filteredCheck:function(e){var r=e.filteredItems,s=e.localFilter,g=!1;s?Ci(s,[])||Ci(s,{})?g=!1:s&&(g=!0):g=!1,g&&this.$emit(uS,r,r.length),this.isFiltered=g},isFiltered:function(e,r){if(e===!1&&r===!0){var s=this.localItems;this.$emit(uS,s,s.length)}}},created:function(){var e=this;this.$_filterTimer=null,this.$nextTick(function(){e.isFiltered=Boolean(e.localFilter)})},beforeDestroy:function(){this.clearFilterTimer()},methods:{clearFilterTimer:function(){clearTimeout(this.$_filterTimer),this.$_filterTimer=null},filterSanitize:function(e){return this.localFiltering&&!this.localFilterFn&&!(_i(e)||tI(e))?"":Ra(e)},filterFnFactory:function(e,r){if(!e||!Mr(e)||!r||Ci(r,[])||Ci(r,{}))return null;var s=function(T){return e(T,r)};return s},defaultFilterFnFactory:function(e){var r=this;if(!e||!(_i(e)||tI(e)))return null;var s=e;if(_i(s)){var g=XO(e).replace(_z,"\\s+");s=new RegExp(".*".concat(g,".*"),"i")}var T=function(a){return s.lastIndex=0,s.test(dre(a,r.computedFilterIgnored,r.computedFilterIncluded,r.computedFieldsObj))};return T}}}),bre=function(e,r){var s=null;return _i(r)?s={key:e,label:r}:Mr(r)?s={key:e,formatter:r}:kn(r)?(s=hh(r),s.key=s.key||e):r!==!1&&(s={key:e}),s},xre=function(e,r){var s=[];if(Ni(e)&&e.filter($r).forEach(function(I){if(_i(I))s.push({key:I,label:d0(I)});else if(kn(I)&&I.key&&_i(I.key))s.push(hh(I));else if(kn(I)&&Gr(I).length===1){var a=Gr(I)[0],N=bre(a,I[a]);N&&s.push(N)}}),s.length===0&&Ni(r)&&r.length>0){var g=r[0];Gr(g).forEach(function(I){T$[I]||s.push({key:I,label:d0(I)})})}var T={};return s.filter(function(I){return T[I.key]?!1:(T[I.key]=!0,I.label=_i(I.label)?I.label:d0(I.key),!0)})};function TB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function EB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?TB(Object(r),!0).forEach(function(s){S$(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):TB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function S$(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var R1=Xn("value",{type:ss,defaultValue:[]}),wre=R1.mixin,Tre=R1.props,Ere=R1.prop,SB=R1.event,LP=vr(EB(EB({},Tre),{},S$({fields:k(ss,null),items:k(ss,[]),primaryKey:k(ie)},Ere,k(ss,[])))),O$=ot({mixins:[wre,fh],props:LP,data:function(){var e=this.items;return{localItems:Ni(e)?e.slice():[]}},computed:{computedFields:function(){return xre(this.fields,this.localItems)},computedFieldsObj:function(){var e=this.bvParent;return this.computedFields.reduce(function(r,s){if(r[s.key]=hh(s),s.formatter){var g=s.formatter;_i(g)&&Mr(e[g])?g=e[g]:Mr(g)||(g=void 0),r[s.key].formatter=g}return r},{})},computedItems:function(){var e=Bn(this),r=e.paginatedItems,s=e.sortedItems,g=e.filteredItems,T=e.localItems;return(r||s||g||T||[]).slice()},context:function(){var e=Bn(this),r=e.perPage,s=e.currentPage;return{filter:this.localFilter,sortBy:this.localSortBy,sortDesc:this.localSortDesc,perPage:Li(or(r,0),0),currentPage:Li(or(s,0),1),apiUrl:this.apiUrl}}},watch:{items:function(e){this.localItems=Ni(e)?e.slice():[]},computedItems:function(e,r){Ci(e,r)||this.$emit(SB,e)},context:function(e,r){Ci(e,r)||this.$emit(yN,e)}},mounted:function(){this.$emit(SB,this.computedItems)},methods:{getFieldFormatter:function(e){var r=this.computedFieldsObj[e];return r?r.formatter:void 0}}}),P$={currentPage:k(dr,1),perPage:k(dr,0)},Sre=ot({props:P$,computed:{localPaging:function(){return this.hasProvider?!!this.noProviderPaging:!0},paginatedItems:function(){var e=Bn(this),r=e.sortedItems,s=e.filteredItems,g=e.localItems,T=r||s||g||[],I=Li(or(this.currentPage,1),1),a=Li(or(this.perPage,0),0);return this.localPaging&&a&&(T=T.slice((I-1)*a,I*a)),T}}}),Ore=Cn($d,x_),Pre=Wn($d,a7),A$={apiUrl:k(ie),items:k(DN,[]),noProviderFiltering:k(Ee,!1),noProviderPaging:k(Ee,!1),noProviderSorting:k(Ee,!1)},Are=ot({mixins:[al],props:A$,computed:{hasProvider:function(){return Mr(this.items)},providerTriggerContext:function(){var e={apiUrl:this.apiUrl,filter:null,sortBy:null,sortDesc:null,perPage:null,currentPage:null};return this.noProviderFiltering||(e.filter=this.localFilter),this.noProviderSorting||(e.sortBy=this.localSortBy,e.sortDesc=this.localSortDesc),this.noProviderPaging||(e.perPage=this.perPage,e.currentPage=this.currentPage),hh(e)}},watch:{items:function(e){(this.hasProvider||Mr(e))&&this.$nextTick(this._providerUpdate)},providerTriggerContext:function(e,r){Ci(e,r)||this.$nextTick(this._providerUpdate)}},mounted:function(){var e=this;this.hasProvider&&(!this.localItems||this.localItems.length===0)&&this._providerUpdate(),this.listenOnRoot(Pre,function(r){(r===e.id||r===e)&&e.refresh()})},methods:{refresh:function(){var e=Bn(this),r=e.items,s=e.refresh,g=e.computedBusy;this.$off(x_,s),g?this.localBusy&&this.hasProvider&&this.$on(x_,s):(this.clearSelected(),this.hasProvider?this.$nextTick(this._providerUpdate):this.localItems=Ni(r)?r.slice():[])},_providerSetLocal:function(e){this.localItems=Ni(e)?e.slice():[],this.localBusy=!1,this.$emit(x_),this.id&&this.emitOnRoot(Ore,this.id)},_providerUpdate:function(){var e=this;if(!!this.hasProvider){if(Bn(this).computedBusy){this.$nextTick(this.refresh);return}this.localBusy=!0,this.$nextTick(function(){try{var r=e.items(e.context,e._providerSetLocal);gq(r)?r.then(function(s){e._providerSetLocal(s)}):Ni(r)?e._providerSetLocal(r):e.items.length!==2&&(ao("Provider function didn't request callback and did not return a promise or data.",$d),e.localBusy=!1)}catch(s){ao("Provider function error [".concat(s.name,"] ").concat(s.message,"."),$d),e.localBusy=!1,e.$off(x_,e.refresh)}})}}}});function t0(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Cre=["range","multi","single"],OB="grid",C$={noSelectOnClick:k(Ee,!1),selectMode:k(ie,"multi",function(t){return Vr(Cre,t)}),selectable:k(Ee,!1),selectedVariant:k(ie,"active")},Mre=ot({props:C$,data:function(){return{selectedRows:[],selectedLastRow:-1}},computed:{isSelectable:function(){return this.selectable&&this.selectMode},hasSelectableRowClick:function(){return this.isSelectable&&!this.noSelectOnClick},supportsSelectableRows:function(){return!0},selectableHasSelection:function(){var e=this.selectedRows;return this.isSelectable&&e&&e.length>0&&e.some($r)},selectableIsMultiSelect:function(){return this.isSelectable&&Vr(["range","multi"],this.selectMode)},selectableTableClasses:function(){var e,r=this.isSelectable;return e={"b-table-selectable":r},t0(e,"b-table-select-".concat(this.selectMode),r),t0(e,"b-table-selecting",this.selectableHasSelection),t0(e,"b-table-selectable-no-click",r&&!this.hasSelectableRowClick),e},selectableTableAttrs:function(){if(!this.isSelectable)return{};var e=this.bvAttrs.role||OB;return{role:e,"aria-multiselectable":e===OB?Lr(this.selectableIsMultiSelect):null}}},watch:{computedItems:function(e,r){var s=!1;if(this.isSelectable&&this.selectedRows.length>0){s=Ni(e)&&Ni(r)&&e.length===r.length;for(var g=0;s&&g<e.length;g++)s=Ci(YS(e[g]),YS(r[g]))}s||this.clearSelected()},selectable:function(e){this.clearSelected(),this.setSelectionHandlers(e)},selectMode:function(){this.clearSelected()},hasSelectableRowClick:function(e){this.clearSelected(),this.setSelectionHandlers(!e)},selectedRows:function(e,r){var s=this;if(this.isSelectable&&!Ci(e,r)){var g=[];e.forEach(function(T,I){T&&g.push(s.computedItems[I])}),this.$emit(f7,g)}}},beforeMount:function(){this.isSelectable&&this.setSelectionHandlers(!0)},methods:{selectRow:function(e){if(this.isSelectable&&rl(e)&&e>=0&&e<this.computedItems.length&&!this.isRowSelected(e)){var r=this.selectableIsMultiSelect?this.selectedRows.slice():[];r[e]=!0,this.selectedLastClicked=-1,this.selectedRows=r}},unselectRow:function(e){if(this.isSelectable&&rl(e)&&this.isRowSelected(e)){var r=this.selectedRows.slice();r[e]=!1,this.selectedLastClicked=-1,this.selectedRows=r}},selectAllRows:function(){var e=this.computedItems.length;this.isSelectable&&e>0&&(this.selectedLastClicked=-1,this.selectedRows=this.selectableIsMultiSelect?$_(e,!0):[!0])},isRowSelected:function(e){return!!(rl(e)&&this.selectedRows[e])},clearSelected:function(){this.selectedLastClicked=-1,this.selectedRows=[]},selectableRowClasses:function(e){if(this.isSelectable&&this.isRowSelected(e)){var r=this.selectedVariant;return t0({"b-table-row-selected":!0},"".concat(this.dark?"bg":"table","-").concat(r),r)}return{}},selectableRowAttrs:function(e){return{"aria-selected":this.isSelectable?this.isRowSelected(e)?"true":"false":null}},setSelectionHandlers:function(e){var r=e&&!this.noSelectOnClick?"$on":"$off";this[r](Z0,this.selectionHandler),this[r](uS,this.clearSelected),this[r](yN,this.clearSelected)},selectionHandler:function(e,r,s){if(!this.isSelectable||this.noSelectOnClick){this.clearSelected();return}var g=this.selectMode,T=this.selectedLastRow,I=this.selectedRows.slice(),a=!I[r];if(g==="single")I=[];else if(g==="range")if(T>-1&&s.shiftKey){for(var N=Ec(T,r);N<=Li(T,r);N++)I[N]=!0;a=!0}else s.ctrlKey||s.metaKey||(I=[],a=!0),a&&(this.selectedLastRow=r);I[r]=a,this.selectedRows=I}}}),M$=function(e,r){return e.map(function(s,g){return[g,s]}).sort(function(s,g){return this(s[1],g[1])||s[0]-g[0]}.bind(r)).map(function(s){return s[1]})},PB=function(e){return ji(e)?"":F_(e)?hi(e,e):e},Ire=function(e,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},g=s.sortBy,T=g===void 0?null:g,I=s.formatter,a=I===void 0?null:I,N=s.locale,H=N===void 0?void 0:N,K=s.localeOptions,ee=K===void 0?{}:K,ue=s.nullLast,Pe=ue===void 0?!1:ue,xe=Io(e,T,null),Ie=Io(r,T,null);return Mr(a)&&(xe=a(xe,T,e),Ie=a(Ie,T,r)),xe=PB(xe),Ie=PB(Ie),Xp(xe)&&Xp(Ie)||rl(xe)&&rl(Ie)?xe<Ie?-1:xe>Ie?1:0:Pe&&xe===""&&Ie!==""?1:Pe&&xe!==""&&Ie===""?-1:XS(xe).localeCompare(XS(Ie),H,ee)},Cl,Tp;function AB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function CB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?AB(Object(r),!0).forEach(function(s){ea(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):AB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ea(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var bx="sortBy",Dre=dh+bx,xx="sortDesc",Rre=dh+xx,wx="asc",QS="desc",Lre="last",Bre=[wx,QS,Lre],I$=(Cl={labelSortAsc:k(ie,"Click to sort ascending"),labelSortClear:k(ie,"Click to clear sorting"),labelSortDesc:k(ie,"Click to sort descending"),noFooterSorting:k(Ee,!1),noLocalSorting:k(Ee,!1),noSortReset:k(Ee,!1)},ea(Cl,bx,k(ie)),ea(Cl,"sortCompare",k(ls)),ea(Cl,"sortCompareLocale",k(Ho)),ea(Cl,"sortCompareOptions",k(Zn,{numeric:!0})),ea(Cl,xx,k(Ee,!1)),ea(Cl,"sortDirection",k(ie,wx,function(t){return Vr(Bre,t)})),ea(Cl,"sortIconLeft",k(Ee,!1)),ea(Cl,"sortNullLast",k(Ee,!1)),Cl),kre=ot({props:I$,data:function(){return{localSortBy:this[bx]||"",localSortDesc:this[xx]||!1}},computed:{localSorting:function(){return this.hasProvider?!!this.noProviderSorting:!this.noLocalSorting},isSortable:function(){return this.computedFields.some(function(e){return e.sortable})},sortedItems:function(){var e=Bn(this),r=e.localSortBy,s=e.localSortDesc,g=e.sortCompareLocale,T=e.sortNullLast,I=e.sortCompare,a=e.localSorting,N=e.filteredItems,H=e.localItems,K=(N||H||[]).slice(),ee=CB(CB({},this.sortCompareOptions),{},{usage:"sort"});if(r&&a){var ue=this.computedFieldsObj[r]||{},Pe=ue.sortByFormatted,xe=Mr(Pe)?Pe:Pe?this.getFieldFormatter(r):void 0;return M$(K,function(Ie,dt){var Le=null;return Mr(I)&&(Le=I(Ie,dt,r,s,xe,ee,g)),(ji(Le)||Le===!1)&&(Le=Ire(Ie,dt,{sortBy:r,formatter:xe,locale:g,localeOptions:ee,nullLast:T})),(Le||0)*(s?-1:1)})}return K}},watch:(Tp={isSortable:function(e){e?this.isSortable&&this.$on(N_,this.handleSort):this.$off(N_,this.handleSort)}},ea(Tp,xx,function(t){t!==this.localSortDesc&&(this.localSortDesc=t||!1)}),ea(Tp,bx,function(t){t!==this.localSortBy&&(this.localSortBy=t||"")}),ea(Tp,"localSortDesc",function(e,r){e!==r&&this.$emit(Rre,e)}),ea(Tp,"localSortBy",function(e,r){e!==r&&this.$emit(Dre,e)}),Tp),created:function(){this.isSortable&&this.$on(N_,this.handleSort)},methods:{handleSort:function(e,r,s,g){var T=this;if(!!this.isSortable&&!(g&&this.noFooterSorting)){var I=!1,a=function(){var K=r.sortDirection||T.sortDirection;K===wx?T.localSortDesc=!1:K===QS&&(T.localSortDesc=!0)};if(r.sortable){var N=!this.localSorting&&r.sortKey?r.sortKey:e;this.localSortBy===N?this.localSortDesc=!this.localSortDesc:(this.localSortBy=N,a()),I=!0}else this.localSortBy&&!this.noSortReset&&(this.localSortBy="",a(),I=!0);I&&this.$emit(g7,this.context)}},sortTheadThClasses:function(e,r,s){return{"b-table-sort-icon-left":r.sortable&&this.sortIconLeft&&!(s&&this.noFooterSorting)}},sortTheadThAttrs:function(e,r,s){var g,T=this.isSortable,I=this.noFooterSorting,a=this.localSortDesc,N=this.localSortBy,H=this.localSorting;if(!T||s&&I)return{};var K=r.sortable,ee=H?e:(g=r.sortKey)!==null&&g!==void 0?g:e,ue=K&&N===ee?a?"descending":"ascending":K?"none":null;return{"aria-sort":ue}},sortTheadThLabel:function(e,r,s){if(!this.isSortable||s&&this.noFooterSorting)return null;var g=this.localSortBy,T=this.localSortDesc,I=this.labelSortAsc,a=this.labelSortDesc,N=r.sortable,H="";if(N)if(g===e)H=T?I:a;else{H=T?a:I;var K=this.sortDirection||r.sortDirection;K===wx?H=I:K===QS&&(H=a)}else this.noSortReset||(H=g?this.labelSortClear:"");return Ju(H)||null}}});function zre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var L1={stacked:k(qo,!1)},Tx=ot({props:L1,computed:{isStacked:function(){var e=this.stacked;return e===""?!0:e},isStackedAlways:function(){return this.isStacked===!0},stackedTableClasses:function(){var e=this.isStackedAlways;return zre({"b-table-stacked":e},"b-table-stacked-".concat(this.stacked),!e&&this.isStacked)}}});function MB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function EE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MB(Object(r),!0).forEach(function(s){Fre(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Fre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var B1={bordered:k(Ee,!1),borderless:k(Ee,!1),captionTop:k(Ee,!1),dark:k(Ee,!1),fixed:k(Ee,!1),hover:k(Ee,!1),noBorderCollapse:k(Ee,!1),outlined:k(Ee,!1),responsive:k(qo,!1),small:k(Ee,!1),stickyHeader:k(qo,!1),striped:k(Ee,!1),tableClass:k(Nr),tableVariant:k(ie)},BP=ot({mixins:[lo],provide:function(){var e=this;return{getBvTable:function(){return e}}},inheritAttrs:!1,props:B1,computed:{isTableSimple:function(){return!1},isResponsive:function(){var e=this.responsive;return e===""?!0:e},isStickyHeader:function(){var e=this.stickyHeader;return e=e===""?!0:e,this.isStacked?!1:e},wrapperClasses:function(){var e=this.isResponsive;return[this.isStickyHeader?"b-table-sticky-header":"",e===!0?"table-responsive":e?"table-responsive-".concat(this.responsive):""].filter($r)},wrapperStyles:function(){var e=this.isStickyHeader;return e&&!Da(e)?{maxHeight:e}:{}},tableClasses:function(){var e=Bn(this),r=e.hover,s=e.tableVariant,g=e.selectableTableClasses,T=e.stackedTableClasses,I=e.tableClass,a=e.computedBusy;return r=this.isTableSimple?r:r&&this.computedItems.length>0&&!a,[I,{"table-striped":this.striped,"table-hover":r,"table-dark":this.dark,"table-bordered":this.bordered,"table-borderless":this.borderless,"table-sm":this.small,border:this.outlined,"b-table-fixed":this.fixed,"b-table-caption-top":this.captionTop,"b-table-no-border-collapse":this.noBorderCollapse},s?"".concat(this.dark?"bg":"table","-").concat(s):"",T,g]},tableAttrs:function(){var e=Bn(this),r=e.computedItems,s=e.filteredItems,g=e.computedFields,T=e.selectableTableAttrs,I=e.computedBusy,a=this.isTableSimple?{}:{"aria-busy":Lr(I),"aria-colcount":Lr(g.length),"aria-describedby":this.bvAttrs["aria-describedby"]||this.$refs.caption?this.captionId:null},N=r&&s&&s.length>r.length?Lr(s.length):null;return EE(EE(EE({"aria-rowcount":N},this.bvAttrs),{},{id:this.safeId(),role:this.bvAttrs.role||"table"},a),T)}},render:function(e){var r=Bn(this),s=r.wrapperClasses,g=r.renderCaption,T=r.renderColgroup,I=r.renderThead,a=r.renderTbody,N=r.renderTfoot,H=[];this.isTableSimple?H.push(this.normalizeSlot()):(H.push(g?g():null),H.push(T?T():null),H.push(I?I():null),H.push(a?a():null),H.push(N?N():null));var K=e("table",{staticClass:"table b-table",class:this.tableClasses,attrs:this.tableAttrs,key:"b-table"},H.filter($r));return s.length>0?e("div",{class:s,style:this.wrapperStyles,key:"wrap"},[K]):K}});function IB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function SE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?IB(Object(r),!0).forEach(function(s){Nre(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):IB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Nre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kP=Ct({tbodyTransitionHandlers:k(Zn),tbodyTransitionProps:k(Zn)},uN),D$=ot({name:uN,mixins:[lo,Fc,Ur],provide:function(){var e=this;return{getBvTableRowGroup:function(){return e}}},inject:{getBvTable:{default:function(){return function(){return{}}}}},inheritAttrs:!1,props:kP,computed:{bvTable:function(){return this.getBvTable()},isTbody:function(){return!0},isDark:function(){return this.bvTable.dark},isStacked:function(){return this.bvTable.isStacked},isResponsive:function(){return this.bvTable.isResponsive},isStickyHeader:function(){return!1},hasStickyHeader:function(){return!this.isStacked&&this.bvTable.stickyHeader},tableVariant:function(){return this.bvTable.tableVariant},isTransitionGroup:function(){return this.tbodyTransitionProps||this.tbodyTransitionHandlers},tbodyAttrs:function(){return SE({role:"rowgroup"},this.bvAttrs)},tbodyProps:function(){var e=this.tbodyTransitionProps;return e?SE(SE({},e),{},{tag:"tbody"}):{}}},render:function(e){var r={props:this.tbodyProps,attrs:this.tbodyAttrs};return this.isTransitionGroup?(r.on=this.tbodyTransitionHandlers||{},r.nativeOn=this.bvListeners):r.on=this.bvListeners,e(this.isTransitionGroup?"transition-group":"tbody",r,this.normalizeSlot())}}),$re=["TD","TH","TR"],eO=function(e){if(!e||!e.target)return!1;var r=e.target;if(r.disabled||$re.indexOf(r.tagName)!==-1)return!1;if(Ms(".dropdown-menu",r))return!0;var s=r.tagName==="LABEL"?r:Ms("label",r);if(s){var g=aa(s,"for"),T=g?dS(g):sa("input, select, textarea",s);if(T&&!T.disabled)return!0}return Pc(r,hre)},R$=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,r=wW();return r&&r.toString().trim()!==""&&r.containsNode&&an(e)?r.containsNode(e,!0):!1},jre=Ct(g$,dN),zP=ot({name:dN,extends:om,props:jre,computed:{tag:function(){return"th"}}});function DB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function m_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DB(Object(r),!0).forEach(function(s){L$(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function L$(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vre(t){return qre(t)||Hre(t)||Gre(t)||Ure()}function Ure(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gre(t,e){if(!!t){if(typeof t=="string")return tO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tO(t,e)}}function Hre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qre(t){if(Array.isArray(t))return tO(t)}function tO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}var B$={detailsTdClass:k(Nr),tbodyTrAttr:k(O7),tbodyTrClass:k([].concat(Vre(Nr),[ls]))},Wre=ot({mixins:[fh],props:B$,methods:{getTdValues:function(e,r,s,g){var T=this.bvParent;if(s){var I=Io(e,r,"");return Mr(s)?s(I,r,e):_i(s)&&Mr(T[s])?T[s](I,r,e):s}return g},getThValues:function(e,r,s,g,T){var I=this.bvParent;if(s){var a=Io(e,r,"");return Mr(s)?s(a,r,e,g):_i(s)&&Mr(I[s])?I[s](a,r,e,g):s}return T},getFormattedValue:function(e,r){var s=r.key,g=this.getFieldFormatter(s),T=Io(e,s,null);return Mr(g)&&(T=g(T,s,e)),ji(T)?"":T},toggleDetailsFactory:function(e,r){var s=this;return function(){e&&s.$set(r,D_,!r[D_])}},rowHovered:function(e){this.tbodyRowEventStopped(e)||this.emitTbodyRowEvent(h7,e)},rowUnhovered:function(e){this.tbodyRowEventStopped(e)||this.emitTbodyRowEvent(p7,e)},renderTbodyRowCell:function(e,r,s,g){var T=this,I=this.isStacked,a=e.key,N=e.label,H=e.isRowHeader,K=this.$createElement,ee=this.hasNormalizedSlot(r_),ue=this.getFormattedValue(s,e),Pe=!I&&(this.isResponsive||this.stickyHeader)&&e.stickyColumn,xe=Pe?H?zP:om:H?"th":"td",Ie=s[I0]&&s[I0][a]?s[I0][a]:e.variant||null,dt={class:[e.class?e.class:"",this.getTdValues(s,a,e.tdClass,"")],props:{},attrs:m_({"aria-colindex":String(r+1)},H?this.getThValues(s,a,e.thAttr,"row",{}):this.getTdValues(s,a,e.tdAttr,{})),key:"row-".concat(g,"-cell-").concat(r,"-").concat(a)};Pe?dt.props={stackedHeading:I?N:null,stickyColumn:!0,variant:Ie}:(dt.attrs["data-label"]=I&&!ji(N)?Lr(N):null,dt.attrs.role=H?"rowheader":"cell",dt.attrs.scope=H?"row":null,Ie&&dt.class.push("".concat(this.dark?"bg":"table","-").concat(Ie)));var Le={item:s,index:g,field:e,unformatted:Io(s,a,""),value:ue,toggleDetails:this.toggleDetailsFactory(ee,s),detailsShowing:Boolean(s[D_])};Bn(this).supportsSelectableRows&&(Le.rowSelected=this.isRowSelected(g),Le.selectRow=function(){return T.selectRow(g)},Le.unselectRow=function(){return T.unselectRow(g)});var De=this.$_bodyFieldSlotNameCache[a],Ye=De?this.normalizeSlot(De,Le):Lr(ue);return this.isStacked&&(Ye=[K("div",[Ye])]),K(xe,dt,[Ye])},renderTbodyRow:function(e,r){var s=this,g=Bn(this),T=g.computedFields,I=g.striped,a=g.primaryKey,N=g.currentPage,H=g.perPage,K=g.tbodyTrClass,ee=g.tbodyTrAttr,ue=g.hasSelectableRowClick,Pe=this.$createElement,xe=this.hasNormalizedSlot(r_),Ie=e[D_]&&xe,dt=this.$listeners[Z0]||ue,Le=[],De=Ie?this.safeId("_details_".concat(r,"_")):null,Ye=T.map(function(Et,fr){return s.renderTbodyRowCell(Et,fr,e,r)}),He=null;N&&H&&H>0&&(He=String((N-1)*H+r+1));var ht=Lr(Io(e,a))||null,St=ht||Lr(r),st=ht?this.safeId("_row_".concat(ht)):null,gt=Bn(this).selectableRowClasses?this.selectableRowClasses(r):{},Tt=Bn(this).selectableRowAttrs?this.selectableRowAttrs(r):{},at=Mr(K)?K(e,"row"):K,ft=Mr(ee)?ee(e,"row"):ee;if(Le.push(Pe(Lc,L$({class:[at,gt,Ie?"b-table-has-details":""],props:{variant:e[KS]||null},attrs:m_(m_({id:st},ft),{},{tabindex:dt?"0":null,"data-pk":ht||null,"aria-details":De,"aria-owns":De,"aria-rowindex":He},Tt),on:{mouseenter:this.rowHovered,mouseleave:this.rowUnhovered},key:"__b-table-row-".concat(St,"__"),ref:"item-rows"},NO,!0),Ye)),Ie){var gr={item:e,index:r,fields:T,toggleDetails:this.toggleDetailsFactory(xe,e)};Bn(this).supportsSelectableRows&&(gr.rowSelected=this.isRowSelected(r),gr.selectRow=function(){return s.selectRow(r)},gr.unselectRow=function(){return s.unselectRow(r)});var xr=Pe(om,{props:{colspan:T.length},class:this.detailsTdClass},[this.normalizeSlot(r_,gr)]);I&&Le.push(Pe("tr",{staticClass:"d-none",attrs:{"aria-hidden":"true",role:"presentation"},key:"__b-table-details-stripe__".concat(St)}));var Jt=Mr(this.tbodyTrClass)?this.tbodyTrClass(e,r_):this.tbodyTrClass,Zt=Mr(this.tbodyTrAttr)?this.tbodyTrAttr(e,r_):this.tbodyTrAttr;Le.push(Pe(Lc,{staticClass:"b-table-details",class:[Jt],props:{variant:e[KS]||null},attrs:m_(m_({},Zt),{},{id:De,tabindex:"-1"}),key:"__b-table-details__".concat(St)},[xr]))}else xe&&(Le.push(Pe()),I&&Le.push(Pe()));return Le}}});function RB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function OE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?RB(Object(r),!0).forEach(function(s){Zre(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):RB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Zre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var PE=function(e){return"cell(".concat(e||"",")")},FP=vr(OE(OE(OE({},kP),B$),{},{tbodyClass:k(Nr)})),k$=ot({mixins:[Wre],props:FP,beforeDestroy:function(){this.$_bodyFieldSlotNameCache=null},methods:{getTbodyTrs:function(){var e=this.$refs,r=e.tbody?e.tbody.$el||e.tbody:null,s=(e["item-rows"]||[]).map(function(g){return g.$el||g});return r&&r.children&&r.children.length>0&&s&&s.length>0?jd(r.children).filter(function(g){return Vr(s,g)}):[]},getTbodyTrIndex:function(e){if(!an(e))return-1;var r=e.tagName==="TR"?e:Ms("tr",e,!0);return r?this.getTbodyTrs().indexOf(r):-1},emitTbodyRowEvent:function(e,r){if(e&&this.hasListener(e)&&r&&r.target){var s=this.getTbodyTrIndex(r.target);if(s>-1){var g=this.computedItems[s];this.$emit(e,g,s,r)}}},tbodyRowEventStopped:function(e){return this.stopIfBusy&&this.stopIfBusy(e)},onTbodyRowKeydown:function(e){var r=e.target,s=e.keyCode;if(!(this.tbodyRowEventStopped(e)||r.tagName!=="TR"||!KO(r)||r.tabIndex!==0)){if(Vr([zc,Zl],s))ei(e),this.onTBodyRowClicked(e);else if(Vr([Is,as,ch,lh],s)){var g=this.getTbodyTrIndex(r);if(g>-1){ei(e);var T=this.getTbodyTrs(),I=e.shiftKey;s===ch||I&&s===Is?ii(T[0]):s===lh||I&&s===as?ii(T[T.length-1]):s===Is&&g>0?ii(T[g-1]):s===as&&g<T.length-1&&ii(T[g+1])}}}},onTBodyRowClicked:function(e){var r=this.$refs,s=r.tbody?r.tbody.$el||r.tbody:null;this.tbodyRowEventStopped(e)||eO(e)||R$(s||this.$el)||this.emitTbodyRowEvent(Z0,e)},onTbodyRowMiddleMouseRowClicked:function(e){!this.tbodyRowEventStopped(e)&&e.which===2&&this.emitTbodyRowEvent(d7,e)},onTbodyRowContextmenu:function(e){this.tbodyRowEventStopped(e)||this.emitTbodyRowEvent(c7,e)},onTbodyRowDblClicked:function(e){!this.tbodyRowEventStopped(e)&&!eO(e)&&this.emitTbodyRowEvent(u7,e)},renderTbody:function(){var e=this,r=Bn(this),s=r.computedItems,g=r.renderBusy,T=r.renderTopRow,I=r.renderEmpty,a=r.renderBottomRow,N=r.hasSelectableRowClick,H=this.$createElement,K=this.hasListener(Z0)||N,ee=[],ue=g?g():null;if(ue)ee.push(ue);else{var Pe={},xe=PE();xe=this.hasNormalizedSlot(xe)?xe:null,this.computedFields.forEach(function(Le){var De=Le.key,Ye=PE(De),He=PE(De.toLowerCase());Pe[De]=e.hasNormalizedSlot(Ye)?Ye:e.hasNormalizedSlot(He)?He:xe}),this.$_bodyFieldSlotNameCache=Pe,ee.push(T?T():H()),s.forEach(function(Le,De){ee.push(e.renderTbodyRow(Le,De))}),ee.push(I?I():H()),ee.push(a?a():H())}var Ie={auxclick:this.onTbodyRowMiddleMouseRowClicked,contextmenu:this.onTbodyRowContextmenu,dblclick:this.onTbodyRowDblClicked};K&&(Ie.click=this.onTBodyRowClicked,Ie.keydown=this.onTbodyRowKeydown);var dt=H(D$,{class:this.tbodyClass||null,props:mn(kP,this.$props),on:Ie,ref:"tbody"},ee);return dt}}});function LB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function BB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?LB(Object(r),!0).forEach(function(s){Xre(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):LB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Xre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Kre=Ct({footVariant:k(ie)},hN),NP=ot({name:hN,mixins:[lo,Fc,Ur],provide:function(){var e=this;return{getBvTableRowGroup:function(){return e}}},inject:{getBvTable:{default:function(){return function(){return{}}}}},inheritAttrs:!1,props:Kre,computed:{bvTable:function(){return this.getBvTable()},isTfoot:function(){return!0},isDark:function(){return this.bvTable.dark},isStacked:function(){return this.bvTable.isStacked},isResponsive:function(){return this.bvTable.isResponsive},isStickyHeader:function(){return!1},hasStickyHeader:function(){return!this.isStacked&&this.bvTable.stickyHeader},tableVariant:function(){return this.bvTable.tableVariant},tfootClasses:function(){return[this.footVariant?"thead-".concat(this.footVariant):null]},tfootAttrs:function(){return BB(BB({},this.bvAttrs),{},{role:"rowgroup"})}},render:function(e){return e("tfoot",{class:this.tfootClasses,attrs:this.tfootAttrs,on:this.bvListeners},this.normalizeSlot())}}),$P={footClone:k(Ee,!1),footRowVariant:k(ie),footVariant:k(ie),tfootClass:k(Nr),tfootTrClass:k(Nr)},z$=ot({props:$P,methods:{renderTFootCustom:function(){var e=this.$createElement;return this.hasNormalizedSlot(mI)?e(NP,{class:this.tfootClass||null,props:{footVariant:this.footVariant||this.headVariant||null},key:"bv-tfoot-custom"},this.normalizeSlot(mI,{items:this.computedItems.slice(),fields:this.computedFields.slice(),columns:this.computedFields.length})):e()},renderTfoot:function(){return this.footClone?this.renderThead(!0):this.renderTFootCustom()}}});function kB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Yre(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kB(Object(r),!0).forEach(function(s){Jre(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Jre(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Qre=Ct({headVariant:k(ie)},fN),F$=ot({name:fN,mixins:[lo,Fc,Ur],provide:function(){var e=this;return{getBvTableRowGroup:function(){return e}}},inject:{getBvTable:{default:function(){return function(){return{}}}}},inheritAttrs:!1,props:Qre,computed:{bvTable:function(){return this.getBvTable()},isThead:function(){return!0},isDark:function(){return this.bvTable.dark},isStacked:function(){return this.bvTable.isStacked},isResponsive:function(){return this.bvTable.isResponsive},isStickyHeader:function(){return!this.isStacked&&this.bvTable.stickyHeader},hasStickyHeader:function(){return!this.isStacked&&this.bvTable.stickyHeader},tableVariant:function(){return this.bvTable.tableVariant},theadClasses:function(){return[this.headVariant?"thead-".concat(this.headVariant):null]},theadAttrs:function(){return Yre({role:"rowgroup"},this.bvAttrs)}},render:function(e){return e("thead",{class:this.theadClasses,attrs:this.theadAttrs,on:this.bvListeners},this.normalizeSlot())}});function eie(t){return nie(t)||iie(t)||rie(t)||tie()}function tie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rie(t,e){if(!!t){if(typeof t=="string")return rO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rO(t,e)}}function iie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nie(t){if(Array.isArray(t))return rO(t)}function rO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}function zB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function FB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zB(Object(r),!0).forEach(function(s){oie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function oie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var AE=function(e){return"head(".concat(e||"",")")},CE=function(e){return"foot(".concat(e||"",")")},jP={headRowVariant:k(ie),headVariant:k(ie),theadClass:k(Nr),theadTrClass:k(Nr)},N$=ot({props:jP,methods:{fieldClasses:function(e){return[e.class?e.class:"",e.thClass?e.thClass:""]},headClicked:function(e,r,s){if(!(this.stopIfBusy&&this.stopIfBusy(e))){{if(eO(e))return;if(R$(this.$el))return}ei(e),this.$emit(N_,r.key,r,e,s)}},renderThead:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=Bn(this),g=s.computedFields,T=s.isSortable,I=s.isSelectable,a=s.headVariant,N=s.footVariant,H=s.headRowVariant,K=s.footRowVariant,ee=this.$createElement;if(this.isStackedAlways||g.length===0)return ee();var ue=T||this.hasListener(N_),Pe=I?this.selectAllRows:hy,xe=I?this.clearSelected:hy,Ie=function(He,ht){var St=He.label,st=He.labelHtml,gt=He.variant,Tt=He.stickyColumn,at=He.key,ft=null;!He.label.trim()&&!He.headerTitle&&(ft=d0(He.key));var gr={};ue&&(gr.click=function(ln){e.headClicked(ln,He,r)},gr.keydown=function(ln){var Yi=ln.keyCode;(Yi===zc||Yi===Zl)&&e.headClicked(ln,He,r)});var xr=T?e.sortTheadThAttrs(at,He,r):{},Jt=T?e.sortTheadThClasses(at,He,r):null,Zt=T?e.sortTheadThLabel(at,He,r):null,Et={class:[{"position-relative":Zt},e.fieldClasses(He),Jt],props:{variant:gt,stickyColumn:Tt},style:He.thStyle||{},attrs:FB(FB({tabindex:ue&&He.sortable?"0":null,abbr:He.headerAbbr||null,title:He.headerTitle||null,"aria-colindex":ht+1,"aria-label":ft},e.getThValues(null,at,He.thAttr,r?"foot":"head",{})),xr),on:gr,key:at},fr=[AE(at),AE(at.toLowerCase()),AE()];r&&(fr=[CE(at),CE(at.toLowerCase()),CE()].concat(eie(fr)));var jr={label:St,column:at,field:He,isFoot:r,selectAllRows:Pe,clearSelected:xe},er=e.normalizeSlot(fr,jr)||ee("div",{domProps:En(st,St)}),tn=Zt?ee("span",{staticClass:"sr-only"}," (".concat(Zt,")")):null;return ee(zP,Et,[er,tn].filter($r))},dt=g.map(Ie).filter($r),Le=[];if(r)Le.push(ee(Lc,{class:this.tfootTrClass,props:{variant:ji(K)?H:K}},dt));else{var De={columns:g.length,fields:g,selectAllRows:Pe,clearSelected:xe};Le.push(this.normalizeSlot(hW,De)||ee()),Le.push(ee(Lc,{class:this.theadTrClass,props:{variant:H}},dt))}return ee(r?NP:F$,{class:(r?this.tfootClass:this.theadClass)||null,props:r?{footVariant:N||a||null}:{headVariant:a||null},key:r?"bv-tfoot":"bv-thead"},Le)}}}),sie={},aie=ot({methods:{renderTopRow:function(){var e=this.computedFields,r=this.stacked,s=this.tbodyTrClass,g=this.tbodyTrAttr,T=this.$createElement;return!this.hasNormalizedSlot(TI)||r===!0||r===""?T():T(Lc,{staticClass:"b-table-top-row",class:[Mr(s)?s(null,"row-top"):s],attrs:Mr(g)?g(null,"row-top"):g,key:"b-top-row"},[this.normalizeSlot(TI,{columns:e.length,fields:e})])}}});function NB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function po(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?NB(Object(r),!0).forEach(function(s){lie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):NB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function lie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var cie=Ct(vr(po(po(po(po(po(po(po(po(po(po(po(po(po(po(po(po(po(po({},Hi),m$),_$),RP),v$),x$),E$),LP),P$),A$),C$),I$),L1),B1),FP),$P),jP),sie)),$d),uie=ot({name:$d,mixins:[lo,IP,Ki,Ur,O$,BP,Tx,N$,z$,k$,Tx,vre,kre,Sre,y$,b$,Mre,ure,aie,ore,cre,Are],props:cie});function $B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function mc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$B(Object(r),!0).forEach(function(s){hie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$B(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function hie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var die=Ct(vr(mc(mc(mc(mc(mc(mc(mc(mc(mc({},Hi),RP),v$),LP),L1),B1),FP),$P),jP)),aN),fie=ot({name:aN,mixins:[lo,IP,Ki,Ur,O$,BP,Tx,N$,z$,k$,y$,b$],props:die});function jB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function ME(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jB(Object(r),!0).forEach(function(s){pie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function pie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var mie=Ct(vr(ME(ME(ME({},Hi),L1),B1)),lN),$$=ot({name:lN,mixins:[lo,IP,Ki,Ur,BP,Tx],props:mie,computed:{isTableSimple:function(){return!0}}}),gie=wr({components:{BTableLite:fie}}),_ie=wr({components:{BTableSimple:$$,BTbody:D$,BThead:F$,BTfoot:NP,BTr:Lc,BTd:om,BTh:zP}}),yie=wr({components:{BTable:uie},plugins:{TableLitePlugin:gie,TableSimplePlugin:_ie}});function VB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function vie(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VB(Object(r),!0).forEach(function(s){bie(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function bie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var UB=function(e){return e>0},xie=Ct({animation:k(ie),columns:k(Uo,5,UB),hideHeader:k(Ee,!1),rows:k(Uo,3,UB),showFooter:k(Ee,!1),tableProps:k(Zn,{})},rN),wie=ot({name:rN,functional:!0,props:xie,render:function(e,r){var s=r.data,g=r.props,T=g.animation,I=g.columns,a=e("th",[e(vx,{props:{animation:T}})]),N=e("tr",$_(I,a)),H=e("td",[e(vx,{props:{width:"75%",animation:T}})]),K=e("tr",$_(I,H)),ee=e("tbody",$_(g.rows,K)),ue=g.hideHeader?e():e("thead",[N]),Pe=g.showFooter?e("tfoot",[N]):e();return e($$,Sr(s,{props:vie({},g.tableProps)}),[ue,ee,Pe])}}),Tie=Ct({loading:k(Ee,!1)},iN),Eie=ot({name:iN,functional:!0,props:Tie,render:function(e,r){var s=r.data,g=r.props,T=r.slots,I=r.scopedSlots,a=T(),N=I||{},H={};return g.loading?e("div",Sr(s,{attrs:{role:"alert","aria-live":"polite","aria-busy":!0},staticClass:"b-skeleton-wrapper",key:"loading"}),vo(H7,H,N,a)):vo(eo,H,N,a)}}),Sie=wr({components:{BSkeleton:vx,BSkeletonIcon:Jte,BSkeletonImg:tre,BSkeletonTable:wie,BSkeletonWrapper:Eie}}),Oie=wr({components:{BSpinner:e$}}),Ep;function GB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function Lp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?GB(Object(r),!0).forEach(function(s){Ja(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):GB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Ja(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var k1=Xn("value",{type:Uo}),Pie=k1.mixin,Aie=k1.props,IE=k1.prop,HB=k1.event,dd=function(e){return!e.disabled},Cie=ot({name:qq,inject:{getBvTabs:{default:function(){return function(){return{}}}}},props:{controls:k(ie),id:k(ie),noKeyNav:k(Ee,!1),posInSet:k(Uo),setSize:k(Uo),tab:k(),tabIndex:k(Uo)},computed:{bvTabs:function(){return this.getBvTabs()}},methods:{focus:function(){ii(this.$refs.link)},handleEvent:function(e){if(!this.tab.disabled){var r=e.type,s=e.keyCode,g=e.shiftKey;r==="click"?(ei(e),this.$emit(Ba,e)):r==="keydown"&&s===Zl?(ei(e),this.$emit(Ba,e)):r==="keydown"&&!this.noKeyNav&&([Is,ol,ch].indexOf(s)!==-1?(ei(e),g||s===ch?this.$emit(vN,e):this.$emit(ON,e)):[as,Rc,lh].indexOf(s)!==-1&&(ei(e),g||s===lh?this.$emit(xN,e):this.$emit(EN,e)))}}},render:function(e){var r=this.id,s=this.tabIndex,g=this.setSize,T=this.posInSet,I=this.controls,a=this.handleEvent,N=this.tab,H=N.title,K=N.localActive,ee=N.disabled,ue=N.titleItemClass,Pe=N.titleLinkClass,xe=N.titleLinkAttributes,Ie=e(ks,{staticClass:"nav-link",class:[{active:K&&!ee,disabled:ee},Pe,K?this.bvTabs.activeNavItemClass:null],props:{disabled:ee},attrs:Lp(Lp({},xe),{},{id:r,role:"tab",tabindex:s,"aria-selected":K&&!ee?"true":"false","aria-setsize":g,"aria-posinset":T,"aria-controls":I}),on:{click:a,keydown:a},ref:"link"},[this.tab.normalizeSlot(Py)||H]);return e("li",{staticClass:"nav-item",class:[ue],attrs:{role:"presentation"}},[Ie])}}),Mie=oi(PP,["tabs","isNavBar","cardHeader"]),Iie=Ct(vr(Lp(Lp(Lp(Lp({},Hi),Aie),Mie),{},{activeNavItemClass:k(Nr),activeTabClass:k(Nr),card:k(Ee,!1),contentClass:k(Nr),end:k(Ee,!1),lazy:k(Ee,!1),navClass:k(Nr),navWrapperClass:k(Nr),noFade:k(Ee,!1),noKeyNav:k(Ee,!1),noNavStyle:k(Ee,!1),tag:k(ie,"div")})),cN),Die=ot({name:cN,mixins:[Ki,Pie,Ur],provide:function(){var e=this;return{getBvTabs:function(){return e}}},props:Iie,data:function(){return{currentTab:or(this[IE],-1),tabs:[],registeredTabs:[]}},computed:{fade:function(){return!this.noFade},localNavClass:function(){var e=[];return this.card&&this.vertical&&e.push("card-header","h-100","border-bottom-0","rounded-0"),[].concat(e,[this.navClass])}},watch:(Ep={},Ja(Ep,IE,function(t,e){if(t!==e){t=or(t,-1),e=or(e,0);var r=this.tabs[t];r&&!r.disabled?this.activateTab(r):t<e?this.previousTab():this.nextTab()}}),Ja(Ep,"currentTab",function(e){var r=-1;this.tabs.forEach(function(s,g){g===e&&!s.disabled?(s.localActive=!0,r=g):s.localActive=!1}),this.$emit(HB,r)}),Ja(Ep,"tabs",function(e,r){var s=this;Ci(e.map(function(g){return g[Oc]}),r.map(function(g){return g[Oc]}))||this.$nextTick(function(){s.$emit(e7,e.slice(),r.slice())})}),Ja(Ep,"registeredTabs",function(){this.updateTabs()}),Ep),created:function(){this.$_observer=null},mounted:function(){this.setObserver(!0)},beforeDestroy:function(){this.setObserver(!1),this.tabs=[]},methods:{registerTab:function(e){Vr(this.registeredTabs,e)||this.registeredTabs.push(e)},unregisterTab:function(e){this.registeredTabs=this.registeredTabs.slice().filter(function(r){return r!==e})},setObserver:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.$_observer&&this.$_observer.disconnect(),this.$_observer=null,r){var s=function(){e.$nextTick(function(){Vi(function(){e.updateTabs()})})};this.$_observer=dy(this.$refs.content,s,{childList:!0,subtree:!1,attributes:!0,attributeFilter:["id"]})}},getTabs:function(){var e=this.registeredTabs,r=[];if(Xi&&e.length>0){var s=e.map(function(g){return"#".concat(g.safeId())}).join(", ");r=ca(s,this.$el).map(function(g){return g.id}).filter($r)}return M$(e,function(g,T){return r.indexOf(g.safeId())-r.indexOf(T.safeId())})},updateTabs:function(){var e=this.getTabs(),r=e.indexOf(e.slice().reverse().find(function(g){return g.localActive&&!g.disabled}));if(r<0){var s=this.currentTab;s>=e.length?r=e.indexOf(e.slice().reverse().find(dd)):e[s]&&!e[s].disabled&&(r=s)}r<0&&(r=e.indexOf(e.find(dd))),e.forEach(function(g,T){g.localActive=T===r}),this.tabs=e,this.currentTab=r},getButtonForTab:function(e){return(this.$refs.buttons||[]).find(function(r){return r.tab===e})},updateButton:function(e){var r=this.getButtonForTab(e);r&&r.$forceUpdate&&r.$forceUpdate()},activateTab:function(e){var r=this.currentTab,s=this.tabs,g=!1;if(e){var T=s.indexOf(e);if(T!==r&&T>-1&&!e.disabled){var I=new Kd(Jq,{cancelable:!0,vueTarget:this,componentId:this.safeId()});this.$emit(I.type,T,r,I),I.defaultPrevented||(this.currentTab=T,g=!0)}}return!g&&this[IE]!==r&&this.$emit(HB,r),g},deactivateTab:function(e){return e?this.activateTab(this.tabs.filter(function(r){return r!==e}).find(dd)):!1},focusButton:function(e){var r=this;this.$nextTick(function(){ii(r.getButtonForTab(e))})},emitTabClick:function(e,r){kd(r)&&e&&e.$emit&&!e.disabled&&e.$emit(Ba,r)},clickTab:function(e,r){this.activateTab(e),this.emitTabClick(e,r)},firstTab:function(e){var r=this.tabs.find(dd);this.activateTab(r)&&e&&(this.focusButton(r),this.emitTabClick(r,e))},previousTab:function(e){var r=Li(this.currentTab,0),s=this.tabs.slice(0,r).reverse().find(dd);this.activateTab(s)&&e&&(this.focusButton(s),this.emitTabClick(s,e))},nextTab:function(e){var r=Li(this.currentTab,-1),s=this.tabs.slice(r+1).find(dd);this.activateTab(s)&&e&&(this.focusButton(s),this.emitTabClick(s,e))},lastTab:function(e){var r=this.tabs.slice().reverse().find(dd);this.activateTab(r)&&e&&(this.focusButton(r),this.emitTabClick(r,e))}},render:function(e){var r=this,s=this.align,g=this.card,T=this.end,I=this.fill,a=this.firstTab,N=this.justified,H=this.lastTab,K=this.nextTab,ee=this.noKeyNav,ue=this.noNavStyle,Pe=this.pills,xe=this.previousTab,Ie=this.small,dt=this.tabs,Le=this.vertical,De=dt.find(function(Tt){return Tt.localActive&&!Tt.disabled}),Ye=dt.find(function(Tt){return!Tt.disabled}),He=dt.map(function(Tt,at){var ft,gr=Tt.safeId,xr=null;return ee||(xr=-1,(Tt===De||!De&&Tt===Ye)&&(xr=null)),e(Cie,Ja({props:{controls:gr?gr():null,id:Tt.controlledBy||(gr?gr("_BV_tab_button_"):null),noKeyNav:ee,posInSet:at+1,setSize:dt.length,tab:Tt,tabIndex:xr},on:(ft={},Ja(ft,Ba,function(Jt){r.clickTab(Tt,Jt)}),Ja(ft,vN,a),Ja(ft,ON,xe),Ja(ft,EN,K),Ja(ft,xN,H),ft),key:Tt[Oc]||at,ref:"buttons"},NO,!0))}),ht=e(K5,{class:this.localNavClass,attrs:{role:"tablist",id:this.safeId("_BV_tab_controls_")},props:{fill:I,justified:N,align:s,tabs:!ue&&!Pe,pills:!ue&&Pe,vertical:Le,small:Ie,cardHeader:g&&!Le},ref:"nav"},[this.normalizeSlot(cW)||e(),He,this.normalizeSlot(lW)||e()]);ht=e("div",{class:[{"card-header":g&&!Le&&!T,"card-footer":g&&!Le&&T,"col-auto":Le},this.navWrapperClass],key:"bv-tabs-nav"},[ht]);var St=this.normalizeSlot()||[],st=e();St.length===0&&(st=e("div",{class:["tab-pane","active",{"card-body":g}],key:"bv-empty-tab"},this.normalizeSlot(LN)));var gt=e("div",{staticClass:"tab-content",class:[{col:Le},this.contentClass],attrs:{id:this.safeId("_BV_tab_container_")},key:"bv-content",ref:"content"},[St,st]);return e(this.tag,{staticClass:"tabs",class:{row:Le,"no-gutters":Le&&g},attrs:{id:this.safeId()}},[T?gt:e(),ht,T?e():gt])}}),Oa,g_;function qB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function WB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qB(Object(r),!0).forEach(function(s){ws(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function ws(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ex="active",ZB=dh+Ex,Rie=Ct(vr(WB(WB({},Hi),{},(Oa={},ws(Oa,Ex,k(Ee,!1)),ws(Oa,"buttonId",k(ie)),ws(Oa,"disabled",k(Ee,!1)),ws(Oa,"lazy",k(Ee,!1)),ws(Oa,"noBody",k(Ee,!1)),ws(Oa,"tag",k(ie,"div")),ws(Oa,"title",k(ie)),ws(Oa,"titleItemClass",k(Nr)),ws(Oa,"titleLinkAttributes",k(Zn)),ws(Oa,"titleLinkClass",k(Nr)),Oa))),oN),Lie=ot({name:oN,mixins:[Ki,Ur],inject:{getBvTabs:{default:function(){return function(){return{}}}}},props:Rie,data:function(){return{localActive:this[Ex]&&!this.disabled}},computed:{bvTabs:function(){return this.getBvTabs()},_isTab:function(){return!0},tabClasses:function(){var e=this.localActive,r=this.disabled;return[{active:e,disabled:r,"card-body":this.bvTabs.card&&!this.noBody},e?this.bvTabs.activeTabClass:null]},controlledBy:function(){return this.buttonId||this.safeId("__BV_tab_button__")},computedNoFade:function(){return!this.bvTabs.fade},computedLazy:function(){return this.bvTabs.lazy||this.lazy}},watch:(g_={},ws(g_,Ex,function(t,e){t!==e&&(t?this.activate():this.deactivate()||this.$emit(ZB,this.localActive))}),ws(g_,"disabled",function(e,r){if(e!==r){var s=this.bvTabs.firstTab;e&&this.localActive&&s&&(this.localActive=!1,s())}}),ws(g_,"localActive",function(e){this.$emit(ZB,e)}),g_),mounted:function(){this.registerTab()},updated:function(){var e=this.bvTabs.updateButton;e&&this.hasNormalizedSlot(Py)&&e(this)},beforeDestroy:function(){this.unregisterTab()},methods:{registerTab:function(){var e=this.bvTabs.registerTab;e&&e(this)},unregisterTab:function(){var e=this.bvTabs.unregisterTab;e&&e(this)},activate:function(){var e=this.bvTabs.activateTab;return e&&!this.disabled?e(this):!1},deactivate:function(){var e=this.bvTabs.deactivateTab;return e&&this.localActive?e(this):!1}},render:function(e){var r=this.localActive,s=e(this.tag,{staticClass:"tab-pane",class:this.tabClasses,directives:[{name:"show",value:r}],attrs:{role:"tabpanel",id:this.safeId(),"aria-hidden":r?"false":"true","aria-labelledby":this.controlledBy||null},ref:"panel"},[r||!this.computedLazy?this.normalizeSlot():e()]);return e(Zd,{props:{mode:"out-in",noFade:this.computedNoFade}},[s])}}),Bie=wr({components:{BTabs:Die,BTab:Lie}}),kie=wr({components:{BTime:D5}});function D0(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?D0=function(e){return typeof e}:D0=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D0(t)}function zie(t){return Fie(t)||Nie(t)||$ie()}function Fie(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function Nie(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function $ie(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var r0=typeof window<"u";function jie(t){return Array.isArray(t)||D0(t)==="object"?Object.freeze(t):t}function Vie(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return t.reduce(function(r,s){var g=s.passengers[0],T=typeof g=="function"?g(e):s.passengers;return r.concat(T)},[])}function Uie(t,e){return t.map(function(r,s){return[s,r]}).sort(function(r,s){return e(r[1],s[1])||r[0]-s[0]}).map(function(r){return r[1]})}function XB(t,e){return e.reduce(function(r,s){return t.hasOwnProperty(s)&&(r[s]=t[s]),r},{})}var j$={},Gie={},Hie={},qie=An.extend({data:function(){return{transports:j$,targets:Gie,sources:Hie,trackInstances:r0}},methods:{open:function(e){if(!!r0){var r=e.to,s=e.from,g=e.passengers,T=e.order,I=T===void 0?1/0:T;if(!(!r||!s||!g)){var a={to:r,from:s,passengers:jie(g),order:I},N=Object.keys(this.transports);N.indexOf(r)===-1&&An.set(this.transports,r,[]);var H=this.$_getTransportIndex(a),K=this.transports[r].slice(0);H===-1?K.push(a):K[H]=a,this.transports[r]=Uie(K,function(ee,ue){return ee.order-ue.order})}}},close:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=e.to,g=e.from;if(!(!s||!g&&r===!1)&&!!this.transports[s])if(r)this.transports[s]=[];else{var T=this.$_getTransportIndex(e);if(T>=0){var I=this.transports[s].slice(0);I.splice(T,1),this.transports[s]=I}}},registerTarget:function(e,r,s){!r0||(this.trackInstances&&!s&&this.targets[e]&&console.warn("[portal-vue]: Target ".concat(e," already exists")),this.$set(this.targets,e,Object.freeze([r])))},unregisterTarget:function(e){this.$delete(this.targets,e)},registerSource:function(e,r,s){!r0||(this.trackInstances&&!s&&this.sources[e]&&console.warn("[portal-vue]: source ".concat(e," already exists")),this.$set(this.sources,e,Object.freeze([r])))},unregisterSource:function(e){this.$delete(this.sources,e)},hasTarget:function(e){return!!(this.targets[e]&&this.targets[e][0])},hasSource:function(e){return!!(this.sources[e]&&this.sources[e][0])},hasContentFor:function(e){return!!this.transports[e]&&!!this.transports[e].length},$_getTransportIndex:function(e){var r=e.to,s=e.from;for(var g in this.transports[r])if(this.transports[r][g].from===s)return+g;return-1}}}),oa=new qie(j$),Wie=1,V$=An.extend({name:"portal",props:{disabled:{type:Boolean},name:{type:String,default:function(){return String(Wie++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(Math.random()*1e7))}}},created:function(){var e=this;this.$nextTick(function(){oa.registerSource(e.name,e)})},mounted:function(){this.disabled||this.sendUpdate()},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){oa.unregisterSource(this.name),this.clear()},watch:{to:function(e,r){r&&r!==e&&this.clear(r),this.sendUpdate()}},methods:{clear:function(e){var r={from:this.name,to:e||this.to};oa.close(r)},normalizeSlots:function(){return this.$scopedSlots.default?[this.$scopedSlots.default]:this.$slots.default},normalizeOwnChildren:function(e){return typeof e=="function"?e(this.slotProps):e},sendUpdate:function(){var e=this.normalizeSlots();if(e){var r={from:this.name,to:this.to,passengers:zie(e),order:this.order};oa.open(r)}else this.clear()}},render:function(e){var r=this.$slots.default||this.$scopedSlots.default||[],s=this.tag;return r&&this.disabled?r.length<=1&&this.slim?this.normalizeOwnChildren(r)[0]:e(s,[this.normalizeOwnChildren(r)]):this.slim?e():e(s,{class:{"v-portal":!0},style:{display:"none"},key:"v-portal-placeholder"})}}),U$=An.extend({name:"portalTarget",props:{multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},data:function(){return{transports:oa.transports,firstRender:!0}},created:function(){var e=this;this.$nextTick(function(){oa.registerTarget(e.name,e)})},watch:{ownTransports:function(){this.$emit("change",this.children().length>0)},name:function(e,r){oa.unregisterTarget(r),oa.registerTarget(e,this)}},mounted:function(){var e=this;this.transition&&this.$nextTick(function(){e.firstRender=!1})},beforeDestroy:function(){oa.unregisterTarget(this.name)},computed:{ownTransports:function(){var e=this.transports[this.name]||[];return this.multiple?e:e.length===0?[]:[e[e.length-1]]},passengers:function(){return Vie(this.ownTransports,this.slotProps)}},methods:{children:function(){return this.passengers.length!==0?this.passengers:this.$scopedSlots.default?this.$scopedSlots.default(this.slotProps):this.$slots.default||[]},noWrapper:function(){var e=this.slim&&!this.transition;return e&&this.children().length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),e}},render:function(e){var r=this.noWrapper(),s=this.children(),g=this.transition||this.tag;return r?s[0]:this.slim&&!g?e():e(g,{props:{tag:this.transition&&this.tag?this.tag:void 0},class:{"vue-portal-target":!0}},s)}}),Zie=0,Xie=["disabled","name","order","slim","slotProps","tag","to"],Kie=["multiple","transition"];An.extend({name:"MountingPortal",inheritAttrs:!1,props:{append:{type:[Boolean,String]},bail:{type:Boolean},mountTo:{type:String,required:!0},disabled:{type:Boolean},name:{type:String,default:function(){return"mounted_"+String(Zie++)}},order:{type:Number,default:0},slim:{type:Boolean},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"DIV"},to:{type:String,default:function(){return String(Math.round(Math.random()*1e7))}},multiple:{type:Boolean,default:!1},targetSlim:{type:Boolean},targetSlotProps:{type:Object,default:function(){return{}}},targetTag:{type:String,default:"div"},transition:{type:[String,Object,Function]}},created:function(){if(!(typeof document>"u")){var e=document.querySelector(this.mountTo);if(!e){console.error("[portal-vue]: Mount Point '".concat(this.mountTo,"' not found in document"));return}var r=this.$props;if(oa.targets[r.name]){r.bail?console.warn("[portal-vue]: Target ".concat(r.name,` is already mounted.
        Aborting because 'bail: true' is set`)):this.portalTarget=oa.targets[r.name];return}var s=r.append;if(s){var g=typeof s=="string"?s:"DIV",T=document.createElement(g);e.appendChild(T),e=T}var I=XB(this.$props,Kie);I.slim=this.targetSlim,I.tag=this.targetTag,I.slotProps=this.targetSlotProps,I.name=this.to,this.portalTarget=new U$({el:e,parent:this.$parent||this,propsData:I})}},beforeDestroy:function(){var e=this.portalTarget;if(this.append){var r=e.$el;r.parentNode.removeChild(r)}e.$destroy()},render:function(e){if(!this.portalTarget)return console.warn("[portal-vue] Target wasn't mounted"),e();if(!this.$scopedSlots.manual){var r=XB(this.$props,Xie);return e(V$,{props:r,attrs:this.$attrs,on:this.$listeners,scopedSlots:this.$scopedSlots},this.$slots.default)}var s=this.$scopedSlots.manual({to:this.to});return Array.isArray(s)&&(s=s[0]),s||e()}});var Yie=ot({mixins:[Ur],data:function(){return{name:"b-toaster"}},methods:{onAfterEnter:function(e){var r=this;Vi(function(){jo(e,"".concat(r.name,"-enter-to"))})}},render:function(e){return e("transition-group",{props:{tag:"div",name:this.name},on:{afterEnter:this.onAfterEnter}},this.normalizeSlot())}}),Jie=Ct({ariaAtomic:k(ie),ariaLive:k(ie),name:k(ie,void 0,!0),role:k(ie)},Vp),G$=ot({name:Vp,mixins:[al],props:Jie,data:function(){return{doRender:!1,dead:!1,staticName:this.name}},beforeMount:function(){var e=this.name;this.staticName=e,oa.hasTarget(e)?(ao('A "<portal-target>" with name "'.concat(e,'" already exists in the document.'),Vp),this.dead=!0):this.doRender=!0},beforeDestroy:function(){this.doRender&&this.emitOnRoot(Cn(Vp,qO),this.name)},destroyed:function(){var e=this.$el;e&&e.parentNode&&e.parentNode.removeChild(e)},render:function(e){var r=e("div",{class:["d-none",{"b-dead-toaster":this.dead}]});if(this.doRender){var s=e(U$,{staticClass:"b-toaster-slot",props:{name:this.staticName,multiple:!0,tag:"div",slim:!1,transition:Yie}});r=e("div",{staticClass:"b-toaster",class:[this.staticName],attrs:{id:this.staticName,role:this.role||null,"aria-live":this.ariaLive,"aria-atomic":this.ariaAtomic}},[s])}return r}}),Sp;function KB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function kl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KB(Object(r),!0).forEach(function(s){Cp(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Cp(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var z1=Xn("visible",{type:Ee,defaultValue:!1,event:Bs}),Qie=z1.mixin,ene=z1.props,DE=z1.prop,tne=z1.event,YB=1e3,H$=sl(ll,["href","to"]),q$=Ct(vr(kl(kl(kl(kl({},Hi),ene),H$),{},{appendToast:k(Ee,!1),autoHideDelay:k(dr,5e3),bodyClass:k(Nr),headerClass:k(Nr),headerTag:k(ie,"header"),isStatus:k(Ee,!1),noAutoHide:k(Ee,!1),noCloseButton:k(Ee,!1),noFade:k(Ee,!1),noHoverPause:k(Ee,!1),solid:k(Ee,!1),static:k(Ee,!1),title:k(ie),toastClass:k(Nr),toaster:k(ie,"b-toaster-top-right"),variant:k(ie)})),Tc),W$=ot({name:Tc,mixins:[lo,Ki,Qie,al,Ur,OP],inheritAttrs:!1,props:q$,data:function(){return{isMounted:!1,doRender:!1,localShow:!1,isTransitioning:!1,isHiding:!1,order:0,dismissStarted:0,resumeDismiss:0}},computed:{toastClasses:function(){var e=this.appendToast,r=this.variant;return Cp({"b-toast-solid":this.solid,"b-toast-append":e,"b-toast-prepend":!e},"b-toast-".concat(r),r)},slotScope:function(){var e=this.hide;return{hide:e}},computedDuration:function(){return Li(or(this.autoHideDelay,0),YB)},computedToaster:function(){return String(this.toaster)},transitionHandlers:function(){return{beforeEnter:this.onBeforeEnter,afterEnter:this.onAfterEnter,beforeLeave:this.onBeforeLeave,afterLeave:this.onAfterLeave}},computedAttrs:function(){return kl(kl({},this.bvAttrs),{},{id:this.safeId(),tabindex:"0"})}},watch:(Sp={},Cp(Sp,DE,function(t){this[t?"show":"hide"]()}),Cp(Sp,"localShow",function(e){e!==this[DE]&&this.$emit(tne,e)}),Cp(Sp,"toaster",function(){this.$nextTick(this.ensureToaster)}),Cp(Sp,"static",function(e){e&&this.localShow&&this.ensureToaster()}),Sp),created:function(){this.$_dismissTimer=null},mounted:function(){var e=this;this.isMounted=!0,this.$nextTick(function(){e[DE]&&Vi(function(){e.show()})}),this.listenOnRoot(Wn(Tc,yo),function(r){r===e.safeId()&&e.show()}),this.listenOnRoot(Wn(Tc,Cs),function(r){(!r||r===e.safeId())&&e.hide()}),this.listenOnRoot(Cn(Vp,qO),function(r){r===e.computedToaster&&e.hide()})},beforeDestroy:function(){this.clearDismissTimer()},methods:{show:function(){var e=this;if(!this.localShow){this.ensureToaster();var r=this.buildEvent(yo);this.emitEvent(r),this.dismissStarted=this.resumeDismiss=0,this.order=Date.now()*(this.appendToast?1:-1),this.isHiding=!1,this.doRender=!0,this.$nextTick(function(){Vi(function(){e.localShow=!0})})}},hide:function(){var e=this;if(this.localShow){var r=this.buildEvent(Cs);this.emitEvent(r),this.setHoverHandler(!1),this.dismissStarted=this.resumeDismiss=0,this.clearDismissTimer(),this.isHiding=!0,Vi(function(){e.localShow=!1})}},buildEvent:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Kd(e,kl(kl({cancelable:!1,target:this.$el||null,relatedTarget:null},r),{},{vueTarget:this,componentId:this.safeId()}))},emitEvent:function(e){var r=e.type;this.emitOnRoot(Cn(Tc,r),e),this.$emit(r,e)},ensureToaster:function(){if(!this.static){var e=this.computedToaster;if(!oa.hasTarget(e)){var r=document.createElement("div");document.body.appendChild(r);var s=ph(this.bvEventRoot,G$,{propsData:{name:e}});s.$mount(r)}}},startDismissTimer:function(){this.clearDismissTimer(),this.noAutoHide||(this.$_dismissTimer=setTimeout(this.hide,this.resumeDismiss||this.computedDuration),this.dismissStarted=Date.now(),this.resumeDismiss=0)},clearDismissTimer:function(){clearTimeout(this.$_dismissTimer),this.$_dismissTimer=null},setHoverHandler:function(e){var r=this.$refs["b-toast"];nl(e,r,"mouseenter",this.onPause,gi),nl(e,r,"mouseleave",this.onUnPause,gi)},onPause:function(){if(!(this.noAutoHide||this.noHoverPause||!this.$_dismissTimer||this.resumeDismiss)){var e=Date.now()-this.dismissStarted;e>0&&(this.clearDismissTimer(),this.resumeDismiss=Li(this.computedDuration-e,YB))}},onUnPause:function(){if(this.noAutoHide||this.noHoverPause||!this.resumeDismiss){this.resumeDismiss=this.dismissStarted=0;return}this.startDismissTimer()},onLinkClick:function(){var e=this;this.$nextTick(function(){Vi(function(){e.hide()})})},onBeforeEnter:function(){this.isTransitioning=!0},onAfterEnter:function(){this.isTransitioning=!1;var e=this.buildEvent(os);this.emitEvent(e),this.startDismissTimer(),this.setHoverHandler(!0)},onBeforeLeave:function(){this.isTransitioning=!0},onAfterLeave:function(){this.isTransitioning=!1,this.order=0,this.resumeDismiss=this.dismissStarted=0;var e=this.buildEvent(zn);this.emitEvent(e),this.doRender=!1},makeToast:function(e){var r=this,s=this.title,g=this.slotScope,T=Cy(this),I=[],a=this.normalizeSlot(dW,g);a?I.push(a):s&&I.push(e("strong",{staticClass:"mr-2"},s)),this.noCloseButton||I.push(e(Ud,{staticClass:"ml-auto mb-1",on:{click:function(){r.hide()}}}));var N=e();I.length>0&&(N=e(this.headerTag,{staticClass:"toast-header",class:this.headerClass},I));var H=e(T?ks:"div",{staticClass:"toast-body",class:this.bodyClass,props:T?mn(H$,this):{},on:T?{click:this.onLinkClick}:{}},this.normalizeSlot(eo,g));return e("div",{staticClass:"toast",class:this.toastClass,attrs:this.computedAttrs,key:"toast-".concat(this[Oc]),ref:"toast"},[N,H])}},render:function(e){if(!this.doRender||!this.isMounted)return e();var r=this.order,s=this.static,g=this.isHiding,T=this.isStatus,I="b-toast-".concat(this[Oc]),a=e("div",{staticClass:"b-toast",class:this.toastClasses,attrs:kl(kl({},s?{}:this.scopedStyleAttrs),{},{id:this.safeId("_toast_outer"),role:g?null:T?"status":"alert","aria-live":g?null:T?"polite":"assertive","aria-atomic":g?null:"true"}),key:I,ref:"b-toast"},[e(Zd,{props:{noFade:this.noFade},on:this.transitionHandlers},[this.localShow?this.makeToast(e):e()])]);return e(V$,{props:{name:I,to:this.computedToaster,order:r,slim:!0,disabled:s}},[a])}});function rne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JB(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function ine(t,e,r){return e&&JB(t.prototype,e),r&&JB(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function QB(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function __(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?QB(Object(r),!0).forEach(function(s){nne(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):QB(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function nne(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function one(t){return cne(t)||lne(t)||ane(t)||sne()}function sne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ane(t,e){if(!!t){if(typeof t=="string")return iO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iO(t,e)}}function lne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cne(t){if(Array.isArray(t))return iO(t)}function iO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}var y_="$bvToast",RE="_bv__toast",une=["id"].concat(one(Gr(oi(q$,["static","visible"])))),LE={toastContent:"default",title:"toast-title"},ek=function(e){return une.reduce(function(r,s){return Fn(e[s])||(r[s]=e[s]),r},{})},hne=function(e){var r=e.extend({name:Wq,extends:W$,mixins:[fh],destroyed:function(){var I=this.$el;I&&I.parentNode&&I.parentNode.removeChild(I)},mounted:function(){var I=this,a=function(){I.localShow=!1,I.doRender=!1,I.$nextTick(function(){I.$nextTick(function(){Vi(function(){I.$destroy()})})})};this.bvParent.$once(sy,a),this.$once(zn,a),this.listenOnRoot(Cn(Vp,qO),function(N){N===I.toaster&&a()})}}),s=function(I,a){if(!H0(y_)){var N=ph(a,r,{propsData:__(__(__({},ek(na(Tc))),oi(I,Gr(LE))),{},{static:!1,visible:!0})});Gr(LE).forEach(function(K){var ee=I[K];Fn(ee)||(K==="title"&&_i(ee)&&(ee=[a.$createElement("strong",{class:"mr-2"},ee)]),N.$slots[LE[K]]=bi(ee))});var H=document.createElement("div");document.body.appendChild(H),N.$mount(H)}},g=function(){function T(I){rne(this,T),Oy(this,{_vm:I,_root:Hl(I)}),Jx(this,{_vm:Ia(),_root:Ia()})}return ine(T,[{key:"toast",value:function(a){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};!a||H0(y_)||s(__(__({},ek(N)),{},{toastContent:a}),this._vm)}},{key:"show",value:function(a){a&&this._root.$emit(Wn(Tc,yo),a)}},{key:"hide",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this._root.$emit(Wn(Tc,Cs),a)}}]),T}();e.mixin({beforeCreate:function(){this[RE]=new g(this)}}),Fd(e.prototype,y_)||VO(e.prototype,y_,{get:function(){return(!this||!this[RE])&&ao('"'.concat(y_,'" must be accessed from a Vue instance "this" context.'),Tc),this[RE]}})},dne=wr({plugins:{plugin:hne}}),fne=wr({components:{BToast:W$,BToaster:G$},plugins:{BVToastPlugin:dne}});function tk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function rk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tk(Object(r),!0).forEach(function(s){pne(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tk(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function pne(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ma="__BV_Tooltip__",mne="hover focus",ik={focus:!0,hover:!0,click:!0,blur:!0,manual:!0},gne=/^html$/i,_ne=/^noninteractive$/i,yne=/^nofade$/i,vne=/^(auto|top(left|right)?|bottom(left|right)?|left(top|bottom)?|right(top|bottom)?)$/i,bne=/^(window|viewport|scrollParent)$/i,xne=/^d\d+$/i,wne=/^ds\d+$/i,Tne=/^dh\d+$/i,Ene=/^o-?\d+$/i,Sne=/^v-.+$/i,One=/\s+/,Pne=function(e,r){var s={title:void 0,trigger:"",placement:"top",fallbackPlacement:"flip",container:!1,animation:!0,offset:0,id:null,html:!1,interactive:!0,disabled:!1,delay:na(bd,"delay",50),boundary:String(na(bd,"boundary","scrollParent")),boundaryPadding:or(na(bd,"boundaryPadding",5),0),variant:na(bd,"variant"),customClass:na(bd,"customClass")};if(_i(e.value)||rl(e.value)||Mr(e.value)?s.title=e.value:Go(e.value)&&(s=rk(rk({},s),e.value)),Fn(s.title)){var g=cs?r.props:(r.data||{}).attrs;s.title=g&&!ji(g.title)?g.title:void 0}Go(s.delay)||(s.delay={show:or(s.delay,0),hide:or(s.delay,0)}),e.arg&&(s.container="#".concat(e.arg)),Gr(e.modifiers).forEach(function(I){if(gne.test(I))s.html=!0;else if(_ne.test(I))s.interactive=!1;else if(yne.test(I))s.animation=!1;else if(vne.test(I))s.placement=I;else if(bne.test(I))I=I==="scrollparent"?"scrollParent":I,s.boundary=I;else if(xne.test(I)){var a=or(I.slice(1),0);s.delay.show=a,s.delay.hide=a}else wne.test(I)?s.delay.show=or(I.slice(2),0):Tne.test(I)?s.delay.hide=or(I.slice(2),0):Ene.test(I)?s.offset=or(I.slice(1),0):Sne.test(I)&&(s.variant=I.slice(2)||null)});var T={};return bi(s.trigger||"").filter($r).join(" ").trim().toLowerCase().split(One).forEach(function(I){ik[I]&&(T[I]=!0)}),Gr(e.modifiers).forEach(function(I){I=I.toLowerCase(),ik[I]&&(T[I]=!0)}),s.trigger=Gr(T).join(" "),s.trigger==="blur"&&(s.trigger="focus"),s.trigger||(s.trigger=mne),s},nk=function(e,r,s){if(!!Xi){var g=Pne(r,s);if(!e[Ma]){var T=jl(s,r);e[Ma]=ph(T,MP,{_scopeId:im(T,void 0)}),e[Ma].__bv_prev_data__={},e[Ma].$on(yo,function(){Mr(g.title)&&e[Ma].updateData({title:g.title(e)})})}var I={title:g.title,triggers:g.trigger,placement:g.placement,fallbackPlacement:g.fallbackPlacement,variant:g.variant,customClass:g.customClass,container:g.container,boundary:g.boundary,delay:g.delay,offset:g.offset,noFade:!g.animation,id:g.id,interactive:g.interactive,disabled:g.disabled,html:g.html},a=e[Ma].__bv_prev_data__;if(e[Ma].__bv_prev_data__=I,!Ci(I,a)){var N={target:e};Gr(I).forEach(function(H){I[H]!==a[H]&&(N[H]=H==="title"&&Mr(I[H])?I[H](e):I[H])}),e[Ma].updateData(N)}}},Ane=function(e){e[Ma]&&(e[Ma].$destroy(),e[Ma]=null),delete e[Ma]},Cne={bind:function(e,r,s){nk(e,r,s)},componentUpdated:function(e,r,s){$O(function(){nk(e,r,s)})},unbind:function(e){Ane(e)}},Z$=wr({directives:{VBTooltip:Cne}}),Mne=wr({components:{BTooltip:l$},plugins:{VBTooltipPlugin:Z$}}),Ine=wr({plugins:{AlertPlugin:FW,AspectPlugin:HW,AvatarPlugin:NZ,BadgePlugin:VZ,BreadcrumbPlugin:ZZ,ButtonPlugin:XZ,ButtonGroupPlugin:YZ,ButtonToolbarPlugin:e9,CalendarPlugin:d9,CardPlugin:I9,CarouselPlugin:H9,CollapsePlugin:z4,DropdownPlugin:yP,EmbedPlugin:RK,FormPlugin:VK,FormCheckboxPlugin:YK,FormDatepickerPlugin:nY,FormFilePlugin:pY,FormGroupPlugin:TY,FormInputPlugin:CY,FormRadioPlugin:IY,FormRatingPlugin:zY,FormSelectPlugin:KY,FormSpinbuttonPlugin:eJ,FormTagsPlugin:fJ,FormTextareaPlugin:gJ,FormTimepickerPlugin:IJ,ImagePlugin:DJ,InputGroupPlugin:jJ,JumbotronPlugin:qJ,LayoutPlugin:YJ,LinkPlugin:JJ,ListGroupPlugin:oQ,MediaPlugin:hQ,ModalPlugin:iee,NavPlugin:Q5,NavbarPlugin:Iee,OverlayPlugin:kee,PaginationPlugin:Gee,PaginationNavPlugin:Xee,PopoverPlugin:Ate,ProgressPlugin:Dte,SidebarPlugin:Xte,SkeletonPlugin:Sie,SpinnerPlugin:Oie,TablePlugin:yie,TabsPlugin:Bie,TimePlugin:kie,ToastPlugin:fne,TooltipPlugin:Mne}}),Dne=wr({directives:{VBHover:l5}}),Rne=wr({directives:{VBModal:X5}});function ok(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(g){return Object.getOwnPropertyDescriptor(t,g).enumerable})),r.push.apply(r,s)}return r}function sk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ok(Object(r),!0).forEach(function(s){Lne(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ok(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function Lne(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ak(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function kne(t,e,r){return e&&ak(t.prototype,e),r&&ak(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var zne="v-b-scrollspy",Fne="dropdown-item",BE="active",Nne=".nav, .list-group",kE=".nav-link",zE=".nav-item",lk=".list-group-item",$ne=".dropdown, .dropup",jne=".dropdown-item",Vne=".dropdown-toggle",Une=Cn("BVScrollspy","activate"),Gne="offset",FE="position",Hne={element:"body",offset:10,method:"auto",throttle:75},qne={element:"(string|element|component)",offset:"number",method:"string",throttle:"number"},ck=["webkitTransitionEnd","transitionend","otransitionend","oTransitionEnd"],Wne=function(e){return _q(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},Zne=function(e,r,s){for(var g in s)if(Fd(s,g)){var T=s[g],I=r[g],a=I&&an(I)?"element":Wne(I);a=I&&I._isVue?"component":a,new RegExp(T).test(a)||ao("".concat(e,': Option "').concat(g,'" provided type "').concat(a,'" but expected type "').concat(T,'"'))}},X$=function(){function t(e,r,s){Bne(this,t),this.$el=e,this.$scroller=null,this.$selector=[kE,lk,jne].join(","),this.$offsets=[],this.$targets=[],this.$activeTarget=null,this.$scrollHeight=0,this.$resizeTimeout=null,this.$scrollerObserver=null,this.$targetsObserver=null,this.$root=s||null,this.$config=null,this.updateConfig(r)}return kne(t,[{key:"updateConfig",value:function(r,s){this.$scroller&&(this.unlisten(),this.$scroller=null);var g=sk(sk({},this.constructor.Default),r);if(s&&(this.$root=s),Zne(this.constructor.Name,g,this.constructor.DefaultType),this.$config=g,this.$root){var T=this;this.$root.$nextTick(function(){T.listen()})}else this.listen()}},{key:"dispose",value:function(){this.unlisten(),clearTimeout(this.$resizeTimeout),this.$resizeTimeout=null,this.$el=null,this.$config=null,this.$scroller=null,this.$selector=null,this.$offsets=null,this.$targets=null,this.$activeTarget=null,this.$scrollHeight=null}},{key:"listen",value:function(){var r=this,s=this.getScroller();s&&s.tagName!=="BODY"&&pn(s,"scroll",this,gi),pn(window,"scroll",this,gi),pn(window,"resize",this,gi),pn(window,"orientationchange",this,gi),ck.forEach(function(g){pn(window,g,r,gi)}),this.setObservers(!0),this.handleEvent("refresh")}},{key:"unlisten",value:function(){var r=this,s=this.getScroller();this.setObservers(!1),s&&s.tagName!=="BODY"&&Tn(s,"scroll",this,gi),Tn(window,"scroll",this,gi),Tn(window,"resize",this,gi),Tn(window,"orientationchange",this,gi),ck.forEach(function(g){Tn(window,g,r,gi)})}},{key:"setObservers",value:function(r){var s=this;this.$scrollerObserver&&this.$scrollerObserver.disconnect(),this.$targetsObserver&&this.$targetsObserver.disconnect(),this.$scrollerObserver=null,this.$targetsObserver=null,r&&(this.$targetsObserver=dy(this.$el,function(){s.handleEvent("mutation")},{subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]}),this.$scrollerObserver=dy(this.getScroller(),function(){s.handleEvent("mutation")},{subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["id","style","class"]}))}},{key:"handleEvent",value:function(r){var s=_i(r)?r:r.type,g=this,T=function(){g.$resizeTimeout||(g.$resizeTimeout=setTimeout(function(){g.refresh(),g.process(),g.$resizeTimeout=null},g.$config.throttle))};s==="scroll"?(this.$scrollerObserver||this.listen(),this.process()):/(resize|orientationchange|mutation|refresh)/.test(s)&&T()}},{key:"refresh",value:function(){var r=this,s=this.getScroller();if(!!s){var g=s!==s.window?FE:Gne,T=this.$config.method==="auto"?g:this.$config.method,I=T===FE?TW:fS,a=T===FE?this.getScrollTop():0;return this.$offsets=[],this.$targets=[],this.$scrollHeight=this.getScrollHeight(),ca(this.$selector,this.$el).map(function(N){return aa(N,"href")}).filter(function(N){return N&&eI.test(N||"")}).map(function(N){var H=N.replace(eI,"$1").trim();if(!H)return null;var K=sa(H,s);return K&&il(K)?{offset:or(I(K).top,0)+a,target:H}:null}).filter($r).sort(function(N,H){return N.offset-H.offset}).reduce(function(N,H){return N[H.target]||(r.$offsets.push(H.offset),r.$targets.push(H.target),N[H.target]=!0),N},{}),this}}},{key:"process",value:function(){var r=this.getScrollTop()+this.$config.offset,s=this.getScrollHeight(),g=this.$config.offset+s-this.getOffsetHeight();if(this.$scrollHeight!==s&&this.refresh(),r>=g){var T=this.$targets[this.$targets.length-1];this.$activeTarget!==T&&this.activate(T);return}if(this.$activeTarget&&r<this.$offsets[0]&&this.$offsets[0]>0){this.$activeTarget=null,this.clear();return}for(var I=this.$offsets.length;I--;){var a=this.$activeTarget!==this.$targets[I]&&r>=this.$offsets[I]&&(Fn(this.$offsets[I+1])||r<this.$offsets[I+1]);a&&this.activate(this.$targets[I])}}},{key:"getScroller",value:function(){if(this.$scroller)return this.$scroller;var r=this.$config.element;if(r)an(r.$el)?r=r.$el:_i(r)&&(r=sa(r));else return null;return r?(this.$scroller=r.tagName==="BODY"?window:r,this.$scroller):null}},{key:"getScrollTop",value:function(){var r=this.getScroller();return r===window?r.pageYOffset:r.scrollTop}},{key:"getScrollHeight",value:function(){return this.getScroller().scrollHeight||Li(document.body.scrollHeight,document.documentElement.scrollHeight)}},{key:"getOffsetHeight",value:function(){var r=this.getScroller();return r===window?window.innerHeight:Vd(r).height}},{key:"activate",value:function(r){var s=this;this.$activeTarget=r,this.clear();var g=ca(this.$selector.split(",").map(function(T){return"".concat(T,'[href$="').concat(r,'"]')}).join(","),this.$el);g.forEach(function(T){if(ly(T,Fne)){var I=Ms($ne,T);I&&s.setActiveState(sa(Vne,I),!0),s.setActiveState(T,!0)}else{s.setActiveState(T,!0),Pc(T.parentElement,zE)&&s.setActiveState(T.parentElement,!0);for(var a=T;a;){a=Ms(Nne,a);var N=a?a.previousElementSibling:null;N&&Pc(N,"".concat(kE,", ").concat(lk))&&s.setActiveState(N,!0),N&&Pc(N,zE)&&(s.setActiveState(sa(kE,N),!0),s.setActiveState(N,!0))}}}),g&&g.length>0&&this.$root&&this.$root.$emit(Une,r,g)}},{key:"clear",value:function(){var r=this;ca("".concat(this.$selector,", ").concat(zE),this.$el).filter(function(s){return ly(s,BE)}).forEach(function(s){return r.setActiveState(s,!1)})}},{key:"setActiveState",value:function(r,s){!r||(s?ns(r,BE):jo(r,BE))}}],[{key:"Name",get:function(){return zne}},{key:"Default",get:function(){return Hne}},{key:"DefaultType",get:function(){return qne}}]),t}(),Ed="__BV_Scrollspy__",Xne=/^\d+$/,Kne=/^(auto|position|offset)$/,Yne=function(e){var r={};return e.arg&&(r.element="#".concat(e.arg)),Gr(e.modifiers).forEach(function(s){Xne.test(s)?r.offset=or(s,0):Kne.test(s)&&(r.method=s)}),_i(e.value)?r.element=e.value:rl(e.value)?r.offset=gS(e.value):kn(e.value)&&Gr(e.value).filter(function(s){return!!X$.DefaultType[s]}).forEach(function(s){r[s]=e.value[s]}),r},i0=function(e,r,s){if(!!Xi){var g=Yne(r);e[Ed]?e[Ed].updateConfig(g,Hl(jl(s,r))):e[Ed]=new X$(e,g,Hl(jl(s,r)))}},Jne=function(e){e[Ed]&&(e[Ed].dispose(),e[Ed]=null,delete e[Ed])},Qne={bind:function(e,r,s){i0(e,r,s)},inserted:function(e,r,s){i0(e,r,s)},update:function(e,r,s){r.value!==r.oldValue&&i0(e,r,s)},componentUpdated:function(e,r,s){r.value!==r.oldValue&&i0(e,r,s)},unbind:function(e){Jne(e)}},eoe=wr({directives:{VBScrollspy:Qne}}),toe=wr({directives:{VBVisible:lP}}),roe=wr({plugins:{VBHoverPlugin:Dne,VBModalPlugin:Rne,VBPopoverPlugin:u$,VBScrollspyPlugin:eoe,VBTogglePlugin:cP,VBTooltipPlugin:Z$,VBVisiblePlugin:toe}});/*!
 * BootstrapVue 2.22.0
 *
 * @link https://bootstrap-vue.org
 * @source https://github.com/bootstrap-vue/bootstrap-vue
 * @copyright (c) 2016-2022 BootstrapVue
 * @license MIT
 * https://github.com/bootstrap-vue/bootstrap-vue/blob/master/LICENSE
 */var ioe="BootstrapVue",noe=Tz({plugins:{componentsPlugin:Ine,directivesPlugin:roe}}),ooe={install:noe,NAME:ioe};const soe=ooe;const VP=(t,e)=>{const r=t.__vccOpts||t;for(const[s,g]of e)r[s]=g;return r},aoe={__name:"ZipCodeForm",emits:["on-submit"],setup(t,{emit:e}){const r=Xu("");function s(g){document.activeElement&&document.activeElement.blur(),g.preventDefault(),e("on-submit",r.value)}return(g,T)=>{const I=wd("b-input"),a=wd("b-button");return ih(),$x("form",{onSubmit:s},[Bi(I,{class:"input",modelValue:r.value,"onUpdate:modelValue":T[0]||(T[0]=N=>r.value=N),placeholder:"Zip code"},null,8,["modelValue"]),Bi(a,{type:"submit"},{default:Gp(()=>[Ty("Button")]),_:1})],32)}}},loe=VP(aoe,[["__scopeId","data-v-8e37266a"]]);var coe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uoe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var K$={exports:{}};(function(t,e){(function(r,s){t.exports=s()})(coe,function(){var r,s,g;function T(a,N){if(!r)r=N;else if(!s)s=N;else{var H="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",K={};r(K),g=N(K),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(g.workerUrl=window.URL.createObjectURL(new Blob([H],{type:"text/javascript"})))}}T(["exports"],function(a){function N(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var H,K={},ee={};function ue(){if(H)return ee;H=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.setMatrixArrayType=function(p){ee.ARRAY_TYPE=i=p},ee.toRadian=function(p){return p*u},ee.equals=function(p,h){return Math.abs(p-h)<=c*Math.max(1,Math.abs(p),Math.abs(h))},ee.RANDOM=ee.ARRAY_TYPE=ee.EPSILON=void 0;var c=1e-6;ee.EPSILON=c;var i=typeof Float32Array<"u"?Float32Array:Array;ee.ARRAY_TYPE=i;var o=Math.random;ee.RANDOM=o;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var p=0,h=arguments.length;h--;)p+=arguments[h]*arguments[h];return Math.sqrt(p)}),ee}var Pe,xe={};function Ie(){if(Pe)return xe;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},c(h)}Pe=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.create=function(){var h=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},xe.clone=function(h){var m=new i.ARRAY_TYPE(4);return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m},xe.copy=function(h,m){return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h},xe.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},xe.fromValues=function(h,m,b,S){var A=new i.ARRAY_TYPE(4);return A[0]=h,A[1]=m,A[2]=b,A[3]=S,A},xe.set=function(h,m,b,S,A){return h[0]=m,h[1]=b,h[2]=S,h[3]=A,h},xe.transpose=function(h,m){if(h===m){var b=m[1];h[1]=m[2],h[2]=b}else h[0]=m[0],h[1]=m[2],h[2]=m[1],h[3]=m[3];return h},xe.invert=function(h,m){var b=m[0],S=m[1],A=m[2],y=m[3],w=b*y-A*S;return w?(h[0]=y*(w=1/w),h[1]=-S*w,h[2]=-A*w,h[3]=b*w,h):null},xe.adjoint=function(h,m){var b=m[0];return h[0]=m[3],h[1]=-m[1],h[2]=-m[2],h[3]=b,h},xe.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},xe.multiply=u,xe.rotate=function(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=Math.sin(b),E=Math.cos(b);return h[0]=S*E+y*P,h[1]=A*E+w*P,h[2]=S*-P+y*E,h[3]=A*-P+w*E,h},xe.scale=function(h,m,b){var S=m[1],A=m[2],y=m[3],w=b[0],P=b[1];return h[0]=m[0]*w,h[1]=S*w,h[2]=A*P,h[3]=y*P,h},xe.fromRotation=function(h,m){var b=Math.sin(m),S=Math.cos(m);return h[0]=S,h[1]=b,h[2]=-b,h[3]=S,h},xe.fromScaling=function(h,m){return h[0]=m[0],h[1]=0,h[2]=0,h[3]=m[1],h},xe.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},xe.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},xe.LDU=function(h,m,b,S){return h[2]=S[2]/S[0],b[0]=S[0],b[1]=S[1],b[3]=S[3]-h[2]*b[1],[h,m,b]},xe.add=function(h,m,b){return h[0]=m[0]+b[0],h[1]=m[1]+b[1],h[2]=m[2]+b[2],h[3]=m[3]+b[3],h},xe.subtract=p,xe.exactEquals=function(h,m){return h[0]===m[0]&&h[1]===m[1]&&h[2]===m[2]&&h[3]===m[3]},xe.equals=function(h,m){var b=h[0],S=h[1],A=h[2],y=h[3],w=m[0],P=m[1],E=m[2],O=m[3];return Math.abs(b-w)<=i.EPSILON*Math.max(1,Math.abs(b),Math.abs(w))&&Math.abs(S-P)<=i.EPSILON*Math.max(1,Math.abs(S),Math.abs(P))&&Math.abs(A-E)<=i.EPSILON*Math.max(1,Math.abs(A),Math.abs(E))&&Math.abs(y-O)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))},xe.multiplyScalar=function(h,m,b){return h[0]=m[0]*b,h[1]=m[1]*b,h[2]=m[2]*b,h[3]=m[3]*b,h},xe.multiplyScalarAndAdd=function(h,m,b,S){return h[0]=m[0]+b[0]*S,h[1]=m[1]+b[1]*S,h[2]=m[2]+b[2]*S,h[3]=m[3]+b[3]*S,h},xe.sub=xe.mul=void 0;var i=function(h,m){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var b=o(void 0);if(b&&b.has(h))return b.get(h);var S={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in h)if(y!=="default"&&Object.prototype.hasOwnProperty.call(h,y)){var w=A?Object.getOwnPropertyDescriptor(h,y):null;w&&(w.get||w.set)?Object.defineProperty(S,y,w):S[y]=h[y]}return S.default=h,b&&b.set(h,S),S}(ue());function o(h){if(typeof WeakMap!="function")return null;var m=new WeakMap,b=new WeakMap;return(o=function(S){return S?b:m})(h)}function u(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=b[0],E=b[1],O=b[2],M=b[3];return h[0]=S*P+y*E,h[1]=A*P+w*E,h[2]=S*O+y*M,h[3]=A*O+w*M,h}function p(h,m,b){return h[0]=m[0]-b[0],h[1]=m[1]-b[1],h[2]=m[2]-b[2],h[3]=m[3]-b[3],h}return xe.mul=u,xe.sub=p,xe}var dt,Le={};function De(){if(dt)return Le;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},c(h)}dt=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.create=function(){var h=new i.ARRAY_TYPE(6);return i.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},Le.clone=function(h){var m=new i.ARRAY_TYPE(6);return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[4]=h[4],m[5]=h[5],m},Le.copy=function(h,m){return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h},Le.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},Le.fromValues=function(h,m,b,S,A,y){var w=new i.ARRAY_TYPE(6);return w[0]=h,w[1]=m,w[2]=b,w[3]=S,w[4]=A,w[5]=y,w},Le.set=function(h,m,b,S,A,y,w){return h[0]=m,h[1]=b,h[2]=S,h[3]=A,h[4]=y,h[5]=w,h},Le.invert=function(h,m){var b=m[0],S=m[1],A=m[2],y=m[3],w=m[4],P=m[5],E=b*y-S*A;return E?(h[0]=y*(E=1/E),h[1]=-S*E,h[2]=-A*E,h[3]=b*E,h[4]=(A*P-y*w)*E,h[5]=(S*w-b*P)*E,h):null},Le.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},Le.multiply=u,Le.rotate=function(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=m[4],E=m[5],O=Math.sin(b),M=Math.cos(b);return h[0]=S*M+y*O,h[1]=A*M+w*O,h[2]=S*-O+y*M,h[3]=A*-O+w*M,h[4]=P,h[5]=E,h},Le.scale=function(h,m,b){var S=m[1],A=m[2],y=m[3],w=m[4],P=m[5],E=b[0],O=b[1];return h[0]=m[0]*E,h[1]=S*E,h[2]=A*O,h[3]=y*O,h[4]=w,h[5]=P,h},Le.translate=function(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=m[4],E=m[5],O=b[0],M=b[1];return h[0]=S,h[1]=A,h[2]=y,h[3]=w,h[4]=S*O+y*M+P,h[5]=A*O+w*M+E,h},Le.fromRotation=function(h,m){var b=Math.sin(m),S=Math.cos(m);return h[0]=S,h[1]=b,h[2]=-b,h[3]=S,h[4]=0,h[5]=0,h},Le.fromScaling=function(h,m){return h[0]=m[0],h[1]=0,h[2]=0,h[3]=m[1],h[4]=0,h[5]=0,h},Le.fromTranslation=function(h,m){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=m[0],h[5]=m[1],h},Le.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},Le.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},Le.add=function(h,m,b){return h[0]=m[0]+b[0],h[1]=m[1]+b[1],h[2]=m[2]+b[2],h[3]=m[3]+b[3],h[4]=m[4]+b[4],h[5]=m[5]+b[5],h},Le.subtract=p,Le.multiplyScalar=function(h,m,b){return h[0]=m[0]*b,h[1]=m[1]*b,h[2]=m[2]*b,h[3]=m[3]*b,h[4]=m[4]*b,h[5]=m[5]*b,h},Le.multiplyScalarAndAdd=function(h,m,b,S){return h[0]=m[0]+b[0]*S,h[1]=m[1]+b[1]*S,h[2]=m[2]+b[2]*S,h[3]=m[3]+b[3]*S,h[4]=m[4]+b[4]*S,h[5]=m[5]+b[5]*S,h},Le.exactEquals=function(h,m){return h[0]===m[0]&&h[1]===m[1]&&h[2]===m[2]&&h[3]===m[3]&&h[4]===m[4]&&h[5]===m[5]},Le.equals=function(h,m){var b=h[0],S=h[1],A=h[2],y=h[3],w=h[4],P=h[5],E=m[0],O=m[1],M=m[2],R=m[3],z=m[4],V=m[5];return Math.abs(b-E)<=i.EPSILON*Math.max(1,Math.abs(b),Math.abs(E))&&Math.abs(S-O)<=i.EPSILON*Math.max(1,Math.abs(S),Math.abs(O))&&Math.abs(A-M)<=i.EPSILON*Math.max(1,Math.abs(A),Math.abs(M))&&Math.abs(y-R)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(w-z)<=i.EPSILON*Math.max(1,Math.abs(w),Math.abs(z))&&Math.abs(P-V)<=i.EPSILON*Math.max(1,Math.abs(P),Math.abs(V))},Le.sub=Le.mul=void 0;var i=function(h,m){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var b=o(void 0);if(b&&b.has(h))return b.get(h);var S={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in h)if(y!=="default"&&Object.prototype.hasOwnProperty.call(h,y)){var w=A?Object.getOwnPropertyDescriptor(h,y):null;w&&(w.get||w.set)?Object.defineProperty(S,y,w):S[y]=h[y]}return S.default=h,b&&b.set(h,S),S}(ue());function o(h){if(typeof WeakMap!="function")return null;var m=new WeakMap,b=new WeakMap;return(o=function(S){return S?b:m})(h)}function u(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=m[4],E=m[5],O=b[0],M=b[1],R=b[2],z=b[3],V=b[4],G=b[5];return h[0]=S*O+y*M,h[1]=A*O+w*M,h[2]=S*R+y*z,h[3]=A*R+w*z,h[4]=S*V+y*G+P,h[5]=A*V+w*G+E,h}function p(h,m,b){return h[0]=m[0]-b[0],h[1]=m[1]-b[1],h[2]=m[2]-b[2],h[3]=m[3]-b[3],h[4]=m[4]-b[4],h[5]=m[5]-b[5],h}return Le.mul=u,Le.sub=p,Le}var Ye,He={};function ht(){if(Ye)return He;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},c(h)}Ye=1,Object.defineProperty(He,"__esModule",{value:!0}),He.create=function(){var h=new i.ARRAY_TYPE(9);return i.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},He.fromMat4=function(h,m){return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[4],h[4]=m[5],h[5]=m[6],h[6]=m[8],h[7]=m[9],h[8]=m[10],h},He.clone=function(h){var m=new i.ARRAY_TYPE(9);return m[0]=h[0],m[1]=h[1],m[2]=h[2],m[3]=h[3],m[4]=h[4],m[5]=h[5],m[6]=h[6],m[7]=h[7],m[8]=h[8],m},He.copy=function(h,m){return h[0]=m[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h},He.fromValues=function(h,m,b,S,A,y,w,P,E){var O=new i.ARRAY_TYPE(9);return O[0]=h,O[1]=m,O[2]=b,O[3]=S,O[4]=A,O[5]=y,O[6]=w,O[7]=P,O[8]=E,O},He.set=function(h,m,b,S,A,y,w,P,E,O){return h[0]=m,h[1]=b,h[2]=S,h[3]=A,h[4]=y,h[5]=w,h[6]=P,h[7]=E,h[8]=O,h},He.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},He.transpose=function(h,m){if(h===m){var b=m[1],S=m[2],A=m[5];h[1]=m[3],h[2]=m[6],h[3]=b,h[5]=m[7],h[6]=S,h[7]=A}else h[0]=m[0],h[1]=m[3],h[2]=m[6],h[3]=m[1],h[4]=m[4],h[5]=m[7],h[6]=m[2],h[7]=m[5],h[8]=m[8];return h},He.invert=function(h,m){var b=m[0],S=m[1],A=m[2],y=m[3],w=m[4],P=m[5],E=m[6],O=m[7],M=m[8],R=M*w-P*O,z=-M*y+P*E,V=O*y-w*E,G=b*R+S*z+A*V;return G?(h[0]=R*(G=1/G),h[1]=(-M*S+A*O)*G,h[2]=(P*S-A*w)*G,h[3]=z*G,h[4]=(M*b-A*E)*G,h[5]=(-P*b+A*y)*G,h[6]=V*G,h[7]=(-O*b+S*E)*G,h[8]=(w*b-S*y)*G,h):null},He.adjoint=function(h,m){var b=m[0],S=m[1],A=m[2],y=m[3],w=m[4],P=m[5],E=m[6],O=m[7],M=m[8];return h[0]=w*M-P*O,h[1]=A*O-S*M,h[2]=S*P-A*w,h[3]=P*E-y*M,h[4]=b*M-A*E,h[5]=A*y-b*P,h[6]=y*O-w*E,h[7]=S*E-b*O,h[8]=b*w-S*y,h},He.determinant=function(h){var m=h[3],b=h[4],S=h[5],A=h[6],y=h[7],w=h[8];return h[0]*(w*b-S*y)+h[1]*(-w*m+S*A)+h[2]*(y*m-b*A)},He.multiply=u,He.translate=function(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=m[4],E=m[5],O=m[6],M=m[7],R=m[8],z=b[0],V=b[1];return h[0]=S,h[1]=A,h[2]=y,h[3]=w,h[4]=P,h[5]=E,h[6]=z*S+V*w+O,h[7]=z*A+V*P+M,h[8]=z*y+V*E+R,h},He.rotate=function(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=m[4],E=m[5],O=m[6],M=m[7],R=m[8],z=Math.sin(b),V=Math.cos(b);return h[0]=V*S+z*w,h[1]=V*A+z*P,h[2]=V*y+z*E,h[3]=V*w-z*S,h[4]=V*P-z*A,h[5]=V*E-z*y,h[6]=O,h[7]=M,h[8]=R,h},He.scale=function(h,m,b){var S=b[0],A=b[1];return h[0]=S*m[0],h[1]=S*m[1],h[2]=S*m[2],h[3]=A*m[3],h[4]=A*m[4],h[5]=A*m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h},He.fromTranslation=function(h,m){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=m[0],h[7]=m[1],h[8]=1,h},He.fromRotation=function(h,m){var b=Math.sin(m),S=Math.cos(m);return h[0]=S,h[1]=b,h[2]=0,h[3]=-b,h[4]=S,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},He.fromScaling=function(h,m){return h[0]=m[0],h[1]=0,h[2]=0,h[3]=0,h[4]=m[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},He.fromMat2d=function(h,m){return h[0]=m[0],h[1]=m[1],h[2]=0,h[3]=m[2],h[4]=m[3],h[5]=0,h[6]=m[4],h[7]=m[5],h[8]=1,h},He.fromQuat=function(h,m){var b=m[0],S=m[1],A=m[2],y=m[3],w=b+b,P=S+S,E=A+A,O=b*w,M=S*w,R=S*P,z=A*w,V=A*P,G=A*E,F=y*w,q=y*P,W=y*E;return h[0]=1-R-G,h[3]=M-W,h[6]=z+q,h[1]=M+W,h[4]=1-O-G,h[7]=V-F,h[2]=z-q,h[5]=V+F,h[8]=1-O-R,h},He.normalFromMat4=function(h,m){var b=m[0],S=m[1],A=m[2],y=m[3],w=m[4],P=m[5],E=m[6],O=m[7],M=m[8],R=m[9],z=m[10],V=m[11],G=m[12],F=m[13],q=m[14],W=m[15],te=b*P-S*w,se=b*E-A*w,le=b*O-y*w,ne=S*E-A*P,me=S*O-y*P,he=A*O-y*E,_e=M*F-R*G,Ae=M*q-z*G,Me=M*W-V*G,Re=R*q-z*F,Be=R*W-V*F,Ge=z*W-V*q,Fe=te*Ge-se*Be+le*Re+ne*Me-me*Ae+he*_e;return Fe?(h[0]=(P*Ge-E*Be+O*Re)*(Fe=1/Fe),h[1]=(E*Me-w*Ge-O*Ae)*Fe,h[2]=(w*Be-P*Me+O*_e)*Fe,h[3]=(A*Be-S*Ge-y*Re)*Fe,h[4]=(b*Ge-A*Me+y*Ae)*Fe,h[5]=(S*Me-b*Be-y*_e)*Fe,h[6]=(F*he-q*me+W*ne)*Fe,h[7]=(q*le-G*he-W*se)*Fe,h[8]=(G*me-F*le+W*te)*Fe,h):null},He.projection=function(h,m,b){return h[0]=2/m,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/b,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},He.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},He.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},He.add=function(h,m,b){return h[0]=m[0]+b[0],h[1]=m[1]+b[1],h[2]=m[2]+b[2],h[3]=m[3]+b[3],h[4]=m[4]+b[4],h[5]=m[5]+b[5],h[6]=m[6]+b[6],h[7]=m[7]+b[7],h[8]=m[8]+b[8],h},He.subtract=p,He.multiplyScalar=function(h,m,b){return h[0]=m[0]*b,h[1]=m[1]*b,h[2]=m[2]*b,h[3]=m[3]*b,h[4]=m[4]*b,h[5]=m[5]*b,h[6]=m[6]*b,h[7]=m[7]*b,h[8]=m[8]*b,h},He.multiplyScalarAndAdd=function(h,m,b,S){return h[0]=m[0]+b[0]*S,h[1]=m[1]+b[1]*S,h[2]=m[2]+b[2]*S,h[3]=m[3]+b[3]*S,h[4]=m[4]+b[4]*S,h[5]=m[5]+b[5]*S,h[6]=m[6]+b[6]*S,h[7]=m[7]+b[7]*S,h[8]=m[8]+b[8]*S,h},He.exactEquals=function(h,m){return h[0]===m[0]&&h[1]===m[1]&&h[2]===m[2]&&h[3]===m[3]&&h[4]===m[4]&&h[5]===m[5]&&h[6]===m[6]&&h[7]===m[7]&&h[8]===m[8]},He.equals=function(h,m){var b=h[0],S=h[1],A=h[2],y=h[3],w=h[4],P=h[5],E=h[6],O=h[7],M=h[8],R=m[0],z=m[1],V=m[2],G=m[3],F=m[4],q=m[5],W=m[6],te=m[7],se=m[8];return Math.abs(b-R)<=i.EPSILON*Math.max(1,Math.abs(b),Math.abs(R))&&Math.abs(S-z)<=i.EPSILON*Math.max(1,Math.abs(S),Math.abs(z))&&Math.abs(A-V)<=i.EPSILON*Math.max(1,Math.abs(A),Math.abs(V))&&Math.abs(y-G)<=i.EPSILON*Math.max(1,Math.abs(y),Math.abs(G))&&Math.abs(w-F)<=i.EPSILON*Math.max(1,Math.abs(w),Math.abs(F))&&Math.abs(P-q)<=i.EPSILON*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(E-W)<=i.EPSILON*Math.max(1,Math.abs(E),Math.abs(W))&&Math.abs(O-te)<=i.EPSILON*Math.max(1,Math.abs(O),Math.abs(te))&&Math.abs(M-se)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(se))},He.sub=He.mul=void 0;var i=function(h,m){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var b=o(void 0);if(b&&b.has(h))return b.get(h);var S={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in h)if(y!=="default"&&Object.prototype.hasOwnProperty.call(h,y)){var w=A?Object.getOwnPropertyDescriptor(h,y):null;w&&(w.get||w.set)?Object.defineProperty(S,y,w):S[y]=h[y]}return S.default=h,b&&b.set(h,S),S}(ue());function o(h){if(typeof WeakMap!="function")return null;var m=new WeakMap,b=new WeakMap;return(o=function(S){return S?b:m})(h)}function u(h,m,b){var S=m[0],A=m[1],y=m[2],w=m[3],P=m[4],E=m[5],O=m[6],M=m[7],R=m[8],z=b[0],V=b[1],G=b[2],F=b[3],q=b[4],W=b[5],te=b[6],se=b[7],le=b[8];return h[0]=z*S+V*w+G*O,h[1]=z*A+V*P+G*M,h[2]=z*y+V*E+G*R,h[3]=F*S+q*w+W*O,h[4]=F*A+q*P+W*M,h[5]=F*y+q*E+W*R,h[6]=te*S+se*w+le*O,h[7]=te*A+se*P+le*M,h[8]=te*y+se*E+le*R,h}function p(h,m,b){return h[0]=m[0]-b[0],h[1]=m[1]-b[1],h[2]=m[2]-b[2],h[3]=m[3]-b[3],h[4]=m[4]-b[4],h[5]=m[5]-b[5],h[6]=m[6]-b[6],h[7]=m[7]-b[7],h[8]=m[8]-b[8],h}return He.mul=u,He.sub=p,He}var St,st={};function gt(){if(St)return st;function c(y){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},c(y)}St=1,Object.defineProperty(st,"__esModule",{value:!0}),st.create=function(){var y=new i.ARRAY_TYPE(16);return i.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=0,y[12]=0,y[13]=0,y[14]=0),y[0]=1,y[5]=1,y[10]=1,y[15]=1,y},st.clone=function(y){var w=new i.ARRAY_TYPE(16);return w[0]=y[0],w[1]=y[1],w[2]=y[2],w[3]=y[3],w[4]=y[4],w[5]=y[5],w[6]=y[6],w[7]=y[7],w[8]=y[8],w[9]=y[9],w[10]=y[10],w[11]=y[11],w[12]=y[12],w[13]=y[13],w[14]=y[14],w[15]=y[15],w},st.copy=function(y,w){return y[0]=w[0],y[1]=w[1],y[2]=w[2],y[3]=w[3],y[4]=w[4],y[5]=w[5],y[6]=w[6],y[7]=w[7],y[8]=w[8],y[9]=w[9],y[10]=w[10],y[11]=w[11],y[12]=w[12],y[13]=w[13],y[14]=w[14],y[15]=w[15],y},st.fromValues=function(y,w,P,E,O,M,R,z,V,G,F,q,W,te,se,le){var ne=new i.ARRAY_TYPE(16);return ne[0]=y,ne[1]=w,ne[2]=P,ne[3]=E,ne[4]=O,ne[5]=M,ne[6]=R,ne[7]=z,ne[8]=V,ne[9]=G,ne[10]=F,ne[11]=q,ne[12]=W,ne[13]=te,ne[14]=se,ne[15]=le,ne},st.set=function(y,w,P,E,O,M,R,z,V,G,F,q,W,te,se,le,ne){return y[0]=w,y[1]=P,y[2]=E,y[3]=O,y[4]=M,y[5]=R,y[6]=z,y[7]=V,y[8]=G,y[9]=F,y[10]=q,y[11]=W,y[12]=te,y[13]=se,y[14]=le,y[15]=ne,y},st.identity=u,st.transpose=function(y,w){if(y===w){var P=w[1],E=w[2],O=w[3],M=w[6],R=w[7],z=w[11];y[1]=w[4],y[2]=w[8],y[3]=w[12],y[4]=P,y[6]=w[9],y[7]=w[13],y[8]=E,y[9]=M,y[11]=w[14],y[12]=O,y[13]=R,y[14]=z}else y[0]=w[0],y[1]=w[4],y[2]=w[8],y[3]=w[12],y[4]=w[1],y[5]=w[5],y[6]=w[9],y[7]=w[13],y[8]=w[2],y[9]=w[6],y[10]=w[10],y[11]=w[14],y[12]=w[3],y[13]=w[7],y[14]=w[11],y[15]=w[15];return y},st.invert=function(y,w){var P=w[0],E=w[1],O=w[2],M=w[3],R=w[4],z=w[5],V=w[6],G=w[7],F=w[8],q=w[9],W=w[10],te=w[11],se=w[12],le=w[13],ne=w[14],me=w[15],he=P*z-E*R,_e=P*V-O*R,Ae=P*G-M*R,Me=E*V-O*z,Re=E*G-M*z,Be=O*G-M*V,Ge=F*le-q*se,Fe=F*ne-W*se,tt=F*me-te*se,ut=q*ne-W*le,Xe=q*me-te*le,Lt=W*me-te*ne,Pt=he*Lt-_e*Xe+Ae*ut+Me*tt-Re*Fe+Be*Ge;return Pt?(y[0]=(z*Lt-V*Xe+G*ut)*(Pt=1/Pt),y[1]=(O*Xe-E*Lt-M*ut)*Pt,y[2]=(le*Be-ne*Re+me*Me)*Pt,y[3]=(W*Re-q*Be-te*Me)*Pt,y[4]=(V*tt-R*Lt-G*Fe)*Pt,y[5]=(P*Lt-O*tt+M*Fe)*Pt,y[6]=(ne*Ae-se*Be-me*_e)*Pt,y[7]=(F*Be-W*Ae+te*_e)*Pt,y[8]=(R*Xe-z*tt+G*Ge)*Pt,y[9]=(E*tt-P*Xe-M*Ge)*Pt,y[10]=(se*Re-le*Ae+me*he)*Pt,y[11]=(q*Ae-F*Re-te*he)*Pt,y[12]=(z*Fe-R*ut-V*Ge)*Pt,y[13]=(P*ut-E*Fe+O*Ge)*Pt,y[14]=(le*_e-se*Me-ne*he)*Pt,y[15]=(F*Me-q*_e+W*he)*Pt,y):null},st.adjoint=function(y,w){var P=w[0],E=w[1],O=w[2],M=w[3],R=w[4],z=w[5],V=w[6],G=w[7],F=w[8],q=w[9],W=w[10],te=w[11],se=w[12],le=w[13],ne=w[14],me=w[15];return y[0]=z*(W*me-te*ne)-q*(V*me-G*ne)+le*(V*te-G*W),y[1]=-(E*(W*me-te*ne)-q*(O*me-M*ne)+le*(O*te-M*W)),y[2]=E*(V*me-G*ne)-z*(O*me-M*ne)+le*(O*G-M*V),y[3]=-(E*(V*te-G*W)-z*(O*te-M*W)+q*(O*G-M*V)),y[4]=-(R*(W*me-te*ne)-F*(V*me-G*ne)+se*(V*te-G*W)),y[5]=P*(W*me-te*ne)-F*(O*me-M*ne)+se*(O*te-M*W),y[6]=-(P*(V*me-G*ne)-R*(O*me-M*ne)+se*(O*G-M*V)),y[7]=P*(V*te-G*W)-R*(O*te-M*W)+F*(O*G-M*V),y[8]=R*(q*me-te*le)-F*(z*me-G*le)+se*(z*te-G*q),y[9]=-(P*(q*me-te*le)-F*(E*me-M*le)+se*(E*te-M*q)),y[10]=P*(z*me-G*le)-R*(E*me-M*le)+se*(E*G-M*z),y[11]=-(P*(z*te-G*q)-R*(E*te-M*q)+F*(E*G-M*z)),y[12]=-(R*(q*ne-W*le)-F*(z*ne-V*le)+se*(z*W-V*q)),y[13]=P*(q*ne-W*le)-F*(E*ne-O*le)+se*(E*W-O*q),y[14]=-(P*(z*ne-V*le)-R*(E*ne-O*le)+se*(E*V-O*z)),y[15]=P*(z*W-V*q)-R*(E*W-O*q)+F*(E*V-O*z),y},st.determinant=function(y){var w=y[0],P=y[1],E=y[2],O=y[3],M=y[4],R=y[5],z=y[6],V=y[7],G=y[8],F=y[9],q=y[10],W=y[11],te=y[12],se=y[13],le=y[14],ne=y[15];return(w*R-P*M)*(q*ne-W*le)-(w*z-E*M)*(F*ne-W*se)+(w*V-O*M)*(F*le-q*se)+(P*z-E*R)*(G*ne-W*te)-(P*V-O*R)*(G*le-q*te)+(E*V-O*z)*(G*se-F*te)},st.multiply=p,st.translate=function(y,w,P){var E,O,M,R,z,V,G,F,q,W,te,se,le=P[0],ne=P[1],me=P[2];return w===y?(y[12]=w[0]*le+w[4]*ne+w[8]*me+w[12],y[13]=w[1]*le+w[5]*ne+w[9]*me+w[13],y[14]=w[2]*le+w[6]*ne+w[10]*me+w[14],y[15]=w[3]*le+w[7]*ne+w[11]*me+w[15]):(O=w[1],M=w[2],R=w[3],z=w[4],V=w[5],G=w[6],F=w[7],q=w[8],W=w[9],te=w[10],se=w[11],y[0]=E=w[0],y[1]=O,y[2]=M,y[3]=R,y[4]=z,y[5]=V,y[6]=G,y[7]=F,y[8]=q,y[9]=W,y[10]=te,y[11]=se,y[12]=E*le+z*ne+q*me+w[12],y[13]=O*le+V*ne+W*me+w[13],y[14]=M*le+G*ne+te*me+w[14],y[15]=R*le+F*ne+se*me+w[15]),y},st.scale=function(y,w,P){var E=P[0],O=P[1],M=P[2];return y[0]=w[0]*E,y[1]=w[1]*E,y[2]=w[2]*E,y[3]=w[3]*E,y[4]=w[4]*O,y[5]=w[5]*O,y[6]=w[6]*O,y[7]=w[7]*O,y[8]=w[8]*M,y[9]=w[9]*M,y[10]=w[10]*M,y[11]=w[11]*M,y[12]=w[12],y[13]=w[13],y[14]=w[14],y[15]=w[15],y},st.rotate=function(y,w,P,E){var O,M,R,z,V,G,F,q,W,te,se,le,ne,me,he,_e,Ae,Me,Re,Be,Ge,Fe,tt,ut,Xe=E[0],Lt=E[1],Pt=E[2],bt=Math.hypot(Xe,Lt,Pt);return bt<i.EPSILON?null:(Xe*=bt=1/bt,Lt*=bt,Pt*=bt,O=Math.sin(P),M=Math.cos(P),V=w[1],G=w[2],F=w[3],W=w[5],te=w[6],se=w[7],ne=w[9],me=w[10],he=w[11],_e=Xe*Xe*(R=1-M)+M,Re=Xe*Lt*R-Pt*O,Be=Lt*Lt*R+M,Ge=Pt*Lt*R+Xe*O,Fe=Xe*Pt*R+Lt*O,tt=Lt*Pt*R-Xe*O,ut=Pt*Pt*R+M,y[0]=(z=w[0])*_e+(q=w[4])*(Ae=Lt*Xe*R+Pt*O)+(le=w[8])*(Me=Pt*Xe*R-Lt*O),y[1]=V*_e+W*Ae+ne*Me,y[2]=G*_e+te*Ae+me*Me,y[3]=F*_e+se*Ae+he*Me,y[4]=z*Re+q*Be+le*Ge,y[5]=V*Re+W*Be+ne*Ge,y[6]=G*Re+te*Be+me*Ge,y[7]=F*Re+se*Be+he*Ge,y[8]=z*Fe+q*tt+le*ut,y[9]=V*Fe+W*tt+ne*ut,y[10]=G*Fe+te*tt+me*ut,y[11]=F*Fe+se*tt+he*ut,w!==y&&(y[12]=w[12],y[13]=w[13],y[14]=w[14],y[15]=w[15]),y)},st.rotateX=function(y,w,P){var E=Math.sin(P),O=Math.cos(P),M=w[4],R=w[5],z=w[6],V=w[7],G=w[8],F=w[9],q=w[10],W=w[11];return w!==y&&(y[0]=w[0],y[1]=w[1],y[2]=w[2],y[3]=w[3],y[12]=w[12],y[13]=w[13],y[14]=w[14],y[15]=w[15]),y[4]=M*O+G*E,y[5]=R*O+F*E,y[6]=z*O+q*E,y[7]=V*O+W*E,y[8]=G*O-M*E,y[9]=F*O-R*E,y[10]=q*O-z*E,y[11]=W*O-V*E,y},st.rotateY=function(y,w,P){var E=Math.sin(P),O=Math.cos(P),M=w[0],R=w[1],z=w[2],V=w[3],G=w[8],F=w[9],q=w[10],W=w[11];return w!==y&&(y[4]=w[4],y[5]=w[5],y[6]=w[6],y[7]=w[7],y[12]=w[12],y[13]=w[13],y[14]=w[14],y[15]=w[15]),y[0]=M*O-G*E,y[1]=R*O-F*E,y[2]=z*O-q*E,y[3]=V*O-W*E,y[8]=M*E+G*O,y[9]=R*E+F*O,y[10]=z*E+q*O,y[11]=V*E+W*O,y},st.rotateZ=function(y,w,P){var E=Math.sin(P),O=Math.cos(P),M=w[0],R=w[1],z=w[2],V=w[3],G=w[4],F=w[5],q=w[6],W=w[7];return w!==y&&(y[8]=w[8],y[9]=w[9],y[10]=w[10],y[11]=w[11],y[12]=w[12],y[13]=w[13],y[14]=w[14],y[15]=w[15]),y[0]=M*O+G*E,y[1]=R*O+F*E,y[2]=z*O+q*E,y[3]=V*O+W*E,y[4]=G*O-M*E,y[5]=F*O-R*E,y[6]=q*O-z*E,y[7]=W*O-V*E,y},st.fromTranslation=function(y,w){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=w[0],y[13]=w[1],y[14]=w[2],y[15]=1,y},st.fromScaling=function(y,w){return y[0]=w[0],y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=w[1],y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=w[2],y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},st.fromRotation=function(y,w,P){var E,O,M,R=P[0],z=P[1],V=P[2],G=Math.hypot(R,z,V);return G<i.EPSILON?null:(R*=G=1/G,z*=G,V*=G,E=Math.sin(w),O=Math.cos(w),y[0]=R*R*(M=1-O)+O,y[1]=z*R*M+V*E,y[2]=V*R*M-z*E,y[3]=0,y[4]=R*z*M-V*E,y[5]=z*z*M+O,y[6]=V*z*M+R*E,y[7]=0,y[8]=R*V*M+z*E,y[9]=z*V*M-R*E,y[10]=V*V*M+O,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y)},st.fromXRotation=function(y,w){var P=Math.sin(w),E=Math.cos(w);return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=E,y[6]=P,y[7]=0,y[8]=0,y[9]=-P,y[10]=E,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},st.fromYRotation=function(y,w){var P=Math.sin(w),E=Math.cos(w);return y[0]=E,y[1]=0,y[2]=-P,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=P,y[9]=0,y[10]=E,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},st.fromZRotation=function(y,w){var P=Math.sin(w),E=Math.cos(w);return y[0]=E,y[1]=P,y[2]=0,y[3]=0,y[4]=-P,y[5]=E,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},st.fromRotationTranslation=h,st.fromQuat2=function(y,w){var P=new i.ARRAY_TYPE(3),E=-w[0],O=-w[1],M=-w[2],R=w[3],z=w[4],V=w[5],G=w[6],F=w[7],q=E*E+O*O+M*M+R*R;return q>0?(P[0]=2*(z*R+F*E+V*M-G*O)/q,P[1]=2*(V*R+F*O+G*E-z*M)/q,P[2]=2*(G*R+F*M+z*O-V*E)/q):(P[0]=2*(z*R+F*E+V*M-G*O),P[1]=2*(V*R+F*O+G*E-z*M),P[2]=2*(G*R+F*M+z*O-V*E)),h(y,w,P),y},st.getTranslation=function(y,w){return y[0]=w[12],y[1]=w[13],y[2]=w[14],y},st.getScaling=m,st.getRotation=function(y,w){var P=new i.ARRAY_TYPE(3);m(P,w);var E=1/P[0],O=1/P[1],M=1/P[2],R=w[0]*E,z=w[1]*O,V=w[2]*M,G=w[4]*E,F=w[5]*O,q=w[6]*M,W=w[8]*E,te=w[9]*O,se=w[10]*M,le=R+F+se,ne=0;return le>0?(ne=2*Math.sqrt(le+1),y[3]=.25*ne,y[0]=(q-te)/ne,y[1]=(W-V)/ne,y[2]=(z-G)/ne):R>F&&R>se?(ne=2*Math.sqrt(1+R-F-se),y[3]=(q-te)/ne,y[0]=.25*ne,y[1]=(z+G)/ne,y[2]=(W+V)/ne):F>se?(ne=2*Math.sqrt(1+F-R-se),y[3]=(W-V)/ne,y[0]=(z+G)/ne,y[1]=.25*ne,y[2]=(q+te)/ne):(ne=2*Math.sqrt(1+se-R-F),y[3]=(z-G)/ne,y[0]=(W+V)/ne,y[1]=(q+te)/ne,y[2]=.25*ne),y},st.fromRotationTranslationScale=function(y,w,P,E){var O=w[0],M=w[1],R=w[2],z=w[3],V=O+O,G=M+M,F=R+R,q=O*V,W=O*G,te=O*F,se=M*G,le=M*F,ne=R*F,me=z*V,he=z*G,_e=z*F,Ae=E[0],Me=E[1],Re=E[2];return y[0]=(1-(se+ne))*Ae,y[1]=(W+_e)*Ae,y[2]=(te-he)*Ae,y[3]=0,y[4]=(W-_e)*Me,y[5]=(1-(q+ne))*Me,y[6]=(le+me)*Me,y[7]=0,y[8]=(te+he)*Re,y[9]=(le-me)*Re,y[10]=(1-(q+se))*Re,y[11]=0,y[12]=P[0],y[13]=P[1],y[14]=P[2],y[15]=1,y},st.fromRotationTranslationScaleOrigin=function(y,w,P,E,O){var M=w[0],R=w[1],z=w[2],V=w[3],G=M+M,F=R+R,q=z+z,W=M*G,te=M*F,se=M*q,le=R*F,ne=R*q,me=z*q,he=V*G,_e=V*F,Ae=V*q,Me=E[0],Re=E[1],Be=E[2],Ge=O[0],Fe=O[1],tt=O[2],ut=(1-(le+me))*Me,Xe=(te+Ae)*Me,Lt=(se-_e)*Me,Pt=(te-Ae)*Re,bt=(1-(W+me))*Re,mt=(ne+he)*Re,Yt=(se+_e)*Be,Rt=(ne-he)*Be,$t=(1-(W+le))*Be;return y[0]=ut,y[1]=Xe,y[2]=Lt,y[3]=0,y[4]=Pt,y[5]=bt,y[6]=mt,y[7]=0,y[8]=Yt,y[9]=Rt,y[10]=$t,y[11]=0,y[12]=P[0]+Ge-(ut*Ge+Pt*Fe+Yt*tt),y[13]=P[1]+Fe-(Xe*Ge+bt*Fe+Rt*tt),y[14]=P[2]+tt-(Lt*Ge+mt*Fe+$t*tt),y[15]=1,y},st.fromQuat=function(y,w){var P=w[0],E=w[1],O=w[2],M=w[3],R=P+P,z=E+E,V=O+O,G=P*R,F=E*R,q=E*z,W=O*R,te=O*z,se=O*V,le=M*R,ne=M*z,me=M*V;return y[0]=1-q-se,y[1]=F+me,y[2]=W-ne,y[3]=0,y[4]=F-me,y[5]=1-G-se,y[6]=te+le,y[7]=0,y[8]=W+ne,y[9]=te-le,y[10]=1-G-q,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},st.frustum=function(y,w,P,E,O,M,R){var z=1/(P-w),V=1/(O-E),G=1/(M-R);return y[0]=2*M*z,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=2*M*V,y[6]=0,y[7]=0,y[8]=(P+w)*z,y[9]=(O+E)*V,y[10]=(R+M)*G,y[11]=-1,y[12]=0,y[13]=0,y[14]=R*M*2*G,y[15]=0,y},st.perspectiveNO=b,st.perspectiveZO=function(y,w,P,E,O){var M,R=1/Math.tan(w/2);return y[0]=R/P,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=R,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=-1,y[12]=0,y[13]=0,y[15]=0,O!=null&&O!==1/0?(y[10]=O*(M=1/(E-O)),y[14]=O*E*M):(y[10]=-1,y[14]=-E),y},st.perspectiveFromFieldOfView=function(y,w,P,E){var O=Math.tan(w.upDegrees*Math.PI/180),M=Math.tan(w.downDegrees*Math.PI/180),R=Math.tan(w.leftDegrees*Math.PI/180),z=Math.tan(w.rightDegrees*Math.PI/180),V=2/(R+z),G=2/(O+M);return y[0]=V,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=G,y[6]=0,y[7]=0,y[8]=-(R-z)*V*.5,y[9]=(O-M)*G*.5,y[10]=E/(P-E),y[11]=-1,y[12]=0,y[13]=0,y[14]=E*P/(P-E),y[15]=0,y},st.orthoNO=S,st.orthoZO=function(y,w,P,E,O,M,R){var z=1/(w-P),V=1/(E-O),G=1/(M-R);return y[0]=-2*z,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=-2*V,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=G,y[11]=0,y[12]=(w+P)*z,y[13]=(O+E)*V,y[14]=M*G,y[15]=1,y},st.lookAt=function(y,w,P,E){var O,M,R,z,V,G,F,q,W,te,se=w[0],le=w[1],ne=w[2],me=E[0],he=E[1],_e=E[2],Ae=P[0],Me=P[1],Re=P[2];return Math.abs(se-Ae)<i.EPSILON&&Math.abs(le-Me)<i.EPSILON&&Math.abs(ne-Re)<i.EPSILON?u(y):(F=se-Ae,q=le-Me,W=ne-Re,O=he*(W*=te=1/Math.hypot(F,q,W))-_e*(q*=te),M=_e*(F*=te)-me*W,R=me*q-he*F,(te=Math.hypot(O,M,R))?(O*=te=1/te,M*=te,R*=te):(O=0,M=0,R=0),z=q*R-W*M,V=W*O-F*R,G=F*M-q*O,(te=Math.hypot(z,V,G))?(z*=te=1/te,V*=te,G*=te):(z=0,V=0,G=0),y[0]=O,y[1]=z,y[2]=F,y[3]=0,y[4]=M,y[5]=V,y[6]=q,y[7]=0,y[8]=R,y[9]=G,y[10]=W,y[11]=0,y[12]=-(O*se+M*le+R*ne),y[13]=-(z*se+V*le+G*ne),y[14]=-(F*se+q*le+W*ne),y[15]=1,y)},st.targetTo=function(y,w,P,E){var O=w[0],M=w[1],R=w[2],z=E[0],V=E[1],G=E[2],F=O-P[0],q=M-P[1],W=R-P[2],te=F*F+q*q+W*W;te>0&&(F*=te=1/Math.sqrt(te),q*=te,W*=te);var se=V*W-G*q,le=G*F-z*W,ne=z*q-V*F;return(te=se*se+le*le+ne*ne)>0&&(se*=te=1/Math.sqrt(te),le*=te,ne*=te),y[0]=se,y[1]=le,y[2]=ne,y[3]=0,y[4]=q*ne-W*le,y[5]=W*se-F*ne,y[6]=F*le-q*se,y[7]=0,y[8]=F,y[9]=q,y[10]=W,y[11]=0,y[12]=O,y[13]=M,y[14]=R,y[15]=1,y},st.str=function(y){return"mat4("+y[0]+", "+y[1]+", "+y[2]+", "+y[3]+", "+y[4]+", "+y[5]+", "+y[6]+", "+y[7]+", "+y[8]+", "+y[9]+", "+y[10]+", "+y[11]+", "+y[12]+", "+y[13]+", "+y[14]+", "+y[15]+")"},st.frob=function(y){return Math.hypot(y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15])},st.add=function(y,w,P){return y[0]=w[0]+P[0],y[1]=w[1]+P[1],y[2]=w[2]+P[2],y[3]=w[3]+P[3],y[4]=w[4]+P[4],y[5]=w[5]+P[5],y[6]=w[6]+P[6],y[7]=w[7]+P[7],y[8]=w[8]+P[8],y[9]=w[9]+P[9],y[10]=w[10]+P[10],y[11]=w[11]+P[11],y[12]=w[12]+P[12],y[13]=w[13]+P[13],y[14]=w[14]+P[14],y[15]=w[15]+P[15],y},st.subtract=A,st.multiplyScalar=function(y,w,P){return y[0]=w[0]*P,y[1]=w[1]*P,y[2]=w[2]*P,y[3]=w[3]*P,y[4]=w[4]*P,y[5]=w[5]*P,y[6]=w[6]*P,y[7]=w[7]*P,y[8]=w[8]*P,y[9]=w[9]*P,y[10]=w[10]*P,y[11]=w[11]*P,y[12]=w[12]*P,y[13]=w[13]*P,y[14]=w[14]*P,y[15]=w[15]*P,y},st.multiplyScalarAndAdd=function(y,w,P,E){return y[0]=w[0]+P[0]*E,y[1]=w[1]+P[1]*E,y[2]=w[2]+P[2]*E,y[3]=w[3]+P[3]*E,y[4]=w[4]+P[4]*E,y[5]=w[5]+P[5]*E,y[6]=w[6]+P[6]*E,y[7]=w[7]+P[7]*E,y[8]=w[8]+P[8]*E,y[9]=w[9]+P[9]*E,y[10]=w[10]+P[10]*E,y[11]=w[11]+P[11]*E,y[12]=w[12]+P[12]*E,y[13]=w[13]+P[13]*E,y[14]=w[14]+P[14]*E,y[15]=w[15]+P[15]*E,y},st.exactEquals=function(y,w){return y[0]===w[0]&&y[1]===w[1]&&y[2]===w[2]&&y[3]===w[3]&&y[4]===w[4]&&y[5]===w[5]&&y[6]===w[6]&&y[7]===w[7]&&y[8]===w[8]&&y[9]===w[9]&&y[10]===w[10]&&y[11]===w[11]&&y[12]===w[12]&&y[13]===w[13]&&y[14]===w[14]&&y[15]===w[15]},st.equals=function(y,w){var P=y[0],E=y[1],O=y[2],M=y[3],R=y[4],z=y[5],V=y[6],G=y[7],F=y[8],q=y[9],W=y[10],te=y[11],se=y[12],le=y[13],ne=y[14],me=y[15],he=w[0],_e=w[1],Ae=w[2],Me=w[3],Re=w[4],Be=w[5],Ge=w[6],Fe=w[7],tt=w[8],ut=w[9],Xe=w[10],Lt=w[11],Pt=w[12],bt=w[13],mt=w[14],Yt=w[15];return Math.abs(P-he)<=i.EPSILON*Math.max(1,Math.abs(P),Math.abs(he))&&Math.abs(E-_e)<=i.EPSILON*Math.max(1,Math.abs(E),Math.abs(_e))&&Math.abs(O-Ae)<=i.EPSILON*Math.max(1,Math.abs(O),Math.abs(Ae))&&Math.abs(M-Me)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(Me))&&Math.abs(R-Re)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(Re))&&Math.abs(z-Be)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(Be))&&Math.abs(V-Ge)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ge))&&Math.abs(G-Fe)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(Fe))&&Math.abs(F-tt)<=i.EPSILON*Math.max(1,Math.abs(F),Math.abs(tt))&&Math.abs(q-ut)<=i.EPSILON*Math.max(1,Math.abs(q),Math.abs(ut))&&Math.abs(W-Xe)<=i.EPSILON*Math.max(1,Math.abs(W),Math.abs(Xe))&&Math.abs(te-Lt)<=i.EPSILON*Math.max(1,Math.abs(te),Math.abs(Lt))&&Math.abs(se-Pt)<=i.EPSILON*Math.max(1,Math.abs(se),Math.abs(Pt))&&Math.abs(le-bt)<=i.EPSILON*Math.max(1,Math.abs(le),Math.abs(bt))&&Math.abs(ne-mt)<=i.EPSILON*Math.max(1,Math.abs(ne),Math.abs(mt))&&Math.abs(me-Yt)<=i.EPSILON*Math.max(1,Math.abs(me),Math.abs(Yt))},st.sub=st.mul=st.ortho=st.perspective=void 0;var i=function(y,w){if(y&&y.__esModule)return y;if(y===null||c(y)!=="object"&&typeof y!="function")return{default:y};var P=o(void 0);if(P&&P.has(y))return P.get(y);var E={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var M in y)if(M!=="default"&&Object.prototype.hasOwnProperty.call(y,M)){var R=O?Object.getOwnPropertyDescriptor(y,M):null;R&&(R.get||R.set)?Object.defineProperty(E,M,R):E[M]=y[M]}return E.default=y,P&&P.set(y,E),E}(ue());function o(y){if(typeof WeakMap!="function")return null;var w=new WeakMap,P=new WeakMap;return(o=function(E){return E?P:w})(y)}function u(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y}function p(y,w,P){var E=w[0],O=w[1],M=w[2],R=w[3],z=w[4],V=w[5],G=w[6],F=w[7],q=w[8],W=w[9],te=w[10],se=w[11],le=w[12],ne=w[13],me=w[14],he=w[15],_e=P[0],Ae=P[1],Me=P[2],Re=P[3];return y[0]=_e*E+Ae*z+Me*q+Re*le,y[1]=_e*O+Ae*V+Me*W+Re*ne,y[2]=_e*M+Ae*G+Me*te+Re*me,y[3]=_e*R+Ae*F+Me*se+Re*he,y[4]=(_e=P[4])*E+(Ae=P[5])*z+(Me=P[6])*q+(Re=P[7])*le,y[5]=_e*O+Ae*V+Me*W+Re*ne,y[6]=_e*M+Ae*G+Me*te+Re*me,y[7]=_e*R+Ae*F+Me*se+Re*he,y[8]=(_e=P[8])*E+(Ae=P[9])*z+(Me=P[10])*q+(Re=P[11])*le,y[9]=_e*O+Ae*V+Me*W+Re*ne,y[10]=_e*M+Ae*G+Me*te+Re*me,y[11]=_e*R+Ae*F+Me*se+Re*he,y[12]=(_e=P[12])*E+(Ae=P[13])*z+(Me=P[14])*q+(Re=P[15])*le,y[13]=_e*O+Ae*V+Me*W+Re*ne,y[14]=_e*M+Ae*G+Me*te+Re*me,y[15]=_e*R+Ae*F+Me*se+Re*he,y}function h(y,w,P){var E=w[0],O=w[1],M=w[2],R=w[3],z=E+E,V=O+O,G=M+M,F=E*z,q=E*V,W=E*G,te=O*V,se=O*G,le=M*G,ne=R*z,me=R*V,he=R*G;return y[0]=1-(te+le),y[1]=q+he,y[2]=W-me,y[3]=0,y[4]=q-he,y[5]=1-(F+le),y[6]=se+ne,y[7]=0,y[8]=W+me,y[9]=se-ne,y[10]=1-(F+te),y[11]=0,y[12]=P[0],y[13]=P[1],y[14]=P[2],y[15]=1,y}function m(y,w){var P=w[4],E=w[5],O=w[6],M=w[8],R=w[9],z=w[10];return y[0]=Math.hypot(w[0],w[1],w[2]),y[1]=Math.hypot(P,E,O),y[2]=Math.hypot(M,R,z),y}function b(y,w,P,E,O){var M,R=1/Math.tan(w/2);return y[0]=R/P,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=R,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=-1,y[12]=0,y[13]=0,y[15]=0,O!=null&&O!==1/0?(y[10]=(O+E)*(M=1/(E-O)),y[14]=2*O*E*M):(y[10]=-1,y[14]=-2*E),y}function S(y,w,P,E,O,M,R){var z=1/(w-P),V=1/(E-O),G=1/(M-R);return y[0]=-2*z,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=-2*V,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=2*G,y[11]=0,y[12]=(w+P)*z,y[13]=(O+E)*V,y[14]=(R+M)*G,y[15]=1,y}function A(y,w,P){return y[0]=w[0]-P[0],y[1]=w[1]-P[1],y[2]=w[2]-P[2],y[3]=w[3]-P[3],y[4]=w[4]-P[4],y[5]=w[5]-P[5],y[6]=w[6]-P[6],y[7]=w[7]-P[7],y[8]=w[8]-P[8],y[9]=w[9]-P[9],y[10]=w[10]-P[10],y[11]=w[11]-P[11],y[12]=w[12]-P[12],y[13]=w[13]-P[13],y[14]=w[14]-P[14],y[15]=w[15]-P[15],y}return st.perspective=b,st.ortho=S,st.mul=p,st.sub=A,st}var Tt,at={},ft={};function gr(){if(Tt)return ft;function c(O){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},c(O)}Tt=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.create=u,ft.clone=function(O){var M=new i.ARRAY_TYPE(3);return M[0]=O[0],M[1]=O[1],M[2]=O[2],M},ft.length=p,ft.fromValues=function(O,M,R){var z=new i.ARRAY_TYPE(3);return z[0]=O,z[1]=M,z[2]=R,z},ft.copy=function(O,M){return O[0]=M[0],O[1]=M[1],O[2]=M[2],O},ft.set=function(O,M,R,z){return O[0]=M,O[1]=R,O[2]=z,O},ft.add=function(O,M,R){return O[0]=M[0]+R[0],O[1]=M[1]+R[1],O[2]=M[2]+R[2],O},ft.subtract=h,ft.multiply=m,ft.divide=b,ft.ceil=function(O,M){return O[0]=Math.ceil(M[0]),O[1]=Math.ceil(M[1]),O[2]=Math.ceil(M[2]),O},ft.floor=function(O,M){return O[0]=Math.floor(M[0]),O[1]=Math.floor(M[1]),O[2]=Math.floor(M[2]),O},ft.min=function(O,M,R){return O[0]=Math.min(M[0],R[0]),O[1]=Math.min(M[1],R[1]),O[2]=Math.min(M[2],R[2]),O},ft.max=function(O,M,R){return O[0]=Math.max(M[0],R[0]),O[1]=Math.max(M[1],R[1]),O[2]=Math.max(M[2],R[2]),O},ft.round=function(O,M){return O[0]=Math.round(M[0]),O[1]=Math.round(M[1]),O[2]=Math.round(M[2]),O},ft.scale=function(O,M,R){return O[0]=M[0]*R,O[1]=M[1]*R,O[2]=M[2]*R,O},ft.scaleAndAdd=function(O,M,R,z){return O[0]=M[0]+R[0]*z,O[1]=M[1]+R[1]*z,O[2]=M[2]+R[2]*z,O},ft.distance=S,ft.squaredDistance=A,ft.squaredLength=y,ft.negate=function(O,M){return O[0]=-M[0],O[1]=-M[1],O[2]=-M[2],O},ft.inverse=function(O,M){return O[0]=1/M[0],O[1]=1/M[1],O[2]=1/M[2],O},ft.normalize=function(O,M){var R=M[0],z=M[1],V=M[2],G=R*R+z*z+V*V;return G>0&&(G=1/Math.sqrt(G)),O[0]=M[0]*G,O[1]=M[1]*G,O[2]=M[2]*G,O},ft.dot=w,ft.cross=function(O,M,R){var z=M[0],V=M[1],G=M[2],F=R[0],q=R[1],W=R[2];return O[0]=V*W-G*q,O[1]=G*F-z*W,O[2]=z*q-V*F,O},ft.lerp=function(O,M,R,z){var V=M[0],G=M[1],F=M[2];return O[0]=V+z*(R[0]-V),O[1]=G+z*(R[1]-G),O[2]=F+z*(R[2]-F),O},ft.hermite=function(O,M,R,z,V,G){var F=G*G,q=F*(2*G-3)+1,W=F*(G-2)+G,te=F*(G-1),se=F*(3-2*G);return O[0]=M[0]*q+R[0]*W+z[0]*te+V[0]*se,O[1]=M[1]*q+R[1]*W+z[1]*te+V[1]*se,O[2]=M[2]*q+R[2]*W+z[2]*te+V[2]*se,O},ft.bezier=function(O,M,R,z,V,G){var F=1-G,q=F*F,W=G*G,te=q*F,se=3*G*q,le=3*W*F,ne=W*G;return O[0]=M[0]*te+R[0]*se+z[0]*le+V[0]*ne,O[1]=M[1]*te+R[1]*se+z[1]*le+V[1]*ne,O[2]=M[2]*te+R[2]*se+z[2]*le+V[2]*ne,O},ft.random=function(O,M){M=M||1;var R=2*i.RANDOM()*Math.PI,z=2*i.RANDOM()-1,V=Math.sqrt(1-z*z)*M;return O[0]=Math.cos(R)*V,O[1]=Math.sin(R)*V,O[2]=z*M,O},ft.transformMat4=function(O,M,R){var z=M[0],V=M[1],G=M[2],F=R[3]*z+R[7]*V+R[11]*G+R[15];return O[0]=(R[0]*z+R[4]*V+R[8]*G+R[12])/(F=F||1),O[1]=(R[1]*z+R[5]*V+R[9]*G+R[13])/F,O[2]=(R[2]*z+R[6]*V+R[10]*G+R[14])/F,O},ft.transformMat3=function(O,M,R){var z=M[0],V=M[1],G=M[2];return O[0]=z*R[0]+V*R[3]+G*R[6],O[1]=z*R[1]+V*R[4]+G*R[7],O[2]=z*R[2]+V*R[5]+G*R[8],O},ft.transformQuat=function(O,M,R){var z=R[0],V=R[1],G=R[2],F=M[0],q=M[1],W=M[2],te=V*W-G*q,se=G*F-z*W,le=z*q-V*F,ne=V*le-G*se,me=G*te-z*le,he=z*se-V*te,_e=2*R[3];return se*=_e,le*=_e,me*=2,he*=2,O[0]=F+(te*=_e)+(ne*=2),O[1]=q+se+me,O[2]=W+le+he,O},ft.rotateX=function(O,M,R,z){var V=[],G=[];return V[0]=M[0]-R[0],V[1]=M[1]-R[1],V[2]=M[2]-R[2],G[0]=V[0],G[1]=V[1]*Math.cos(z)-V[2]*Math.sin(z),G[2]=V[1]*Math.sin(z)+V[2]*Math.cos(z),O[0]=G[0]+R[0],O[1]=G[1]+R[1],O[2]=G[2]+R[2],O},ft.rotateY=function(O,M,R,z){var V=[],G=[];return V[0]=M[0]-R[0],V[1]=M[1]-R[1],V[2]=M[2]-R[2],G[0]=V[2]*Math.sin(z)+V[0]*Math.cos(z),G[1]=V[1],G[2]=V[2]*Math.cos(z)-V[0]*Math.sin(z),O[0]=G[0]+R[0],O[1]=G[1]+R[1],O[2]=G[2]+R[2],O},ft.rotateZ=function(O,M,R,z){var V=[],G=[];return V[0]=M[0]-R[0],V[1]=M[1]-R[1],V[2]=M[2]-R[2],G[0]=V[0]*Math.cos(z)-V[1]*Math.sin(z),G[1]=V[0]*Math.sin(z)+V[1]*Math.cos(z),G[2]=V[2],O[0]=G[0]+R[0],O[1]=G[1]+R[1],O[2]=G[2]+R[2],O},ft.angle=function(O,M){var R=O[0],z=O[1],V=O[2],G=M[0],F=M[1],q=M[2],W=Math.sqrt(R*R+z*z+V*V)*Math.sqrt(G*G+F*F+q*q),te=W&&w(O,M)/W;return Math.acos(Math.min(Math.max(te,-1),1))},ft.zero=function(O){return O[0]=0,O[1]=0,O[2]=0,O},ft.str=function(O){return"vec3("+O[0]+", "+O[1]+", "+O[2]+")"},ft.exactEquals=function(O,M){return O[0]===M[0]&&O[1]===M[1]&&O[2]===M[2]},ft.equals=function(O,M){var R=O[0],z=O[1],V=O[2],G=M[0],F=M[1],q=M[2];return Math.abs(R-G)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(G))&&Math.abs(z-F)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(F))&&Math.abs(V-q)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(q))},ft.forEach=ft.sqrLen=ft.len=ft.sqrDist=ft.dist=ft.div=ft.mul=ft.sub=void 0;var i=function(O,M){if(O&&O.__esModule)return O;if(O===null||c(O)!=="object"&&typeof O!="function")return{default:O};var R=o(void 0);if(R&&R.has(O))return R.get(O);var z={},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in O)if(G!=="default"&&Object.prototype.hasOwnProperty.call(O,G)){var F=V?Object.getOwnPropertyDescriptor(O,G):null;F&&(F.get||F.set)?Object.defineProperty(z,G,F):z[G]=O[G]}return z.default=O,R&&R.set(O,z),z}(ue());function o(O){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(o=function(z){return z?R:M})(O)}function u(){var O=new i.ARRAY_TYPE(3);return i.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0),O}function p(O){return Math.hypot(O[0],O[1],O[2])}function h(O,M,R){return O[0]=M[0]-R[0],O[1]=M[1]-R[1],O[2]=M[2]-R[2],O}function m(O,M,R){return O[0]=M[0]*R[0],O[1]=M[1]*R[1],O[2]=M[2]*R[2],O}function b(O,M,R){return O[0]=M[0]/R[0],O[1]=M[1]/R[1],O[2]=M[2]/R[2],O}function S(O,M){return Math.hypot(M[0]-O[0],M[1]-O[1],M[2]-O[2])}function A(O,M){var R=M[0]-O[0],z=M[1]-O[1],V=M[2]-O[2];return R*R+z*z+V*V}function y(O){var M=O[0],R=O[1],z=O[2];return M*M+R*R+z*z}function w(O,M){return O[0]*M[0]+O[1]*M[1]+O[2]*M[2]}ft.sub=h,ft.mul=m,ft.div=b,ft.dist=S,ft.sqrDist=A,ft.len=p,ft.sqrLen=y;var P,E=(P=u(),function(O,M,R,z,V,G){var F,q;for(M||(M=3),R||(R=0),q=z?Math.min(z*M+R,O.length):O.length,F=R;F<q;F+=M)P[0]=O[F],P[1]=O[F+1],P[2]=O[F+2],V(P,P,G),O[F]=P[0],O[F+1]=P[1],O[F+2]=P[2];return O});return ft.forEach=E,ft}var xr,Jt,Zt={};function Et(){if(xr)return Zt;function c(E){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},c(E)}xr=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.create=u,Zt.clone=function(E){var O=new i.ARRAY_TYPE(4);return O[0]=E[0],O[1]=E[1],O[2]=E[2],O[3]=E[3],O},Zt.fromValues=function(E,O,M,R){var z=new i.ARRAY_TYPE(4);return z[0]=E,z[1]=O,z[2]=M,z[3]=R,z},Zt.copy=function(E,O){return E[0]=O[0],E[1]=O[1],E[2]=O[2],E[3]=O[3],E},Zt.set=function(E,O,M,R,z){return E[0]=O,E[1]=M,E[2]=R,E[3]=z,E},Zt.add=function(E,O,M){return E[0]=O[0]+M[0],E[1]=O[1]+M[1],E[2]=O[2]+M[2],E[3]=O[3]+M[3],E},Zt.subtract=p,Zt.multiply=h,Zt.divide=m,Zt.ceil=function(E,O){return E[0]=Math.ceil(O[0]),E[1]=Math.ceil(O[1]),E[2]=Math.ceil(O[2]),E[3]=Math.ceil(O[3]),E},Zt.floor=function(E,O){return E[0]=Math.floor(O[0]),E[1]=Math.floor(O[1]),E[2]=Math.floor(O[2]),E[3]=Math.floor(O[3]),E},Zt.min=function(E,O,M){return E[0]=Math.min(O[0],M[0]),E[1]=Math.min(O[1],M[1]),E[2]=Math.min(O[2],M[2]),E[3]=Math.min(O[3],M[3]),E},Zt.max=function(E,O,M){return E[0]=Math.max(O[0],M[0]),E[1]=Math.max(O[1],M[1]),E[2]=Math.max(O[2],M[2]),E[3]=Math.max(O[3],M[3]),E},Zt.round=function(E,O){return E[0]=Math.round(O[0]),E[1]=Math.round(O[1]),E[2]=Math.round(O[2]),E[3]=Math.round(O[3]),E},Zt.scale=function(E,O,M){return E[0]=O[0]*M,E[1]=O[1]*M,E[2]=O[2]*M,E[3]=O[3]*M,E},Zt.scaleAndAdd=function(E,O,M,R){return E[0]=O[0]+M[0]*R,E[1]=O[1]+M[1]*R,E[2]=O[2]+M[2]*R,E[3]=O[3]+M[3]*R,E},Zt.distance=b,Zt.squaredDistance=S,Zt.length=A,Zt.squaredLength=y,Zt.negate=function(E,O){return E[0]=-O[0],E[1]=-O[1],E[2]=-O[2],E[3]=-O[3],E},Zt.inverse=function(E,O){return E[0]=1/O[0],E[1]=1/O[1],E[2]=1/O[2],E[3]=1/O[3],E},Zt.normalize=function(E,O){var M=O[0],R=O[1],z=O[2],V=O[3],G=M*M+R*R+z*z+V*V;return G>0&&(G=1/Math.sqrt(G)),E[0]=M*G,E[1]=R*G,E[2]=z*G,E[3]=V*G,E},Zt.dot=function(E,O){return E[0]*O[0]+E[1]*O[1]+E[2]*O[2]+E[3]*O[3]},Zt.cross=function(E,O,M,R){var z=M[0]*R[1]-M[1]*R[0],V=M[0]*R[2]-M[2]*R[0],G=M[0]*R[3]-M[3]*R[0],F=M[1]*R[2]-M[2]*R[1],q=M[1]*R[3]-M[3]*R[1],W=M[2]*R[3]-M[3]*R[2],te=O[0],se=O[1],le=O[2],ne=O[3];return E[0]=se*W-le*q+ne*F,E[1]=-te*W+le*G-ne*V,E[2]=te*q-se*G+ne*z,E[3]=-te*F+se*V-le*z,E},Zt.lerp=function(E,O,M,R){var z=O[0],V=O[1],G=O[2],F=O[3];return E[0]=z+R*(M[0]-z),E[1]=V+R*(M[1]-V),E[2]=G+R*(M[2]-G),E[3]=F+R*(M[3]-F),E},Zt.random=function(E,O){var M,R,z,V,G,F;O=O||1;do G=(M=2*i.RANDOM()-1)*M+(R=2*i.RANDOM()-1)*R;while(G>=1);do F=(z=2*i.RANDOM()-1)*z+(V=2*i.RANDOM()-1)*V;while(F>=1);var q=Math.sqrt((1-G)/F);return E[0]=O*M,E[1]=O*R,E[2]=O*z*q,E[3]=O*V*q,E},Zt.transformMat4=function(E,O,M){var R=O[0],z=O[1],V=O[2],G=O[3];return E[0]=M[0]*R+M[4]*z+M[8]*V+M[12]*G,E[1]=M[1]*R+M[5]*z+M[9]*V+M[13]*G,E[2]=M[2]*R+M[6]*z+M[10]*V+M[14]*G,E[3]=M[3]*R+M[7]*z+M[11]*V+M[15]*G,E},Zt.transformQuat=function(E,O,M){var R=O[0],z=O[1],V=O[2],G=M[0],F=M[1],q=M[2],W=M[3],te=W*R+F*V-q*z,se=W*z+q*R-G*V,le=W*V+G*z-F*R,ne=-G*R-F*z-q*V;return E[0]=te*W+ne*-G+se*-q-le*-F,E[1]=se*W+ne*-F+le*-G-te*-q,E[2]=le*W+ne*-q+te*-F-se*-G,E[3]=O[3],E},Zt.zero=function(E){return E[0]=0,E[1]=0,E[2]=0,E[3]=0,E},Zt.str=function(E){return"vec4("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+")"},Zt.exactEquals=function(E,O){return E[0]===O[0]&&E[1]===O[1]&&E[2]===O[2]&&E[3]===O[3]},Zt.equals=function(E,O){var M=E[0],R=E[1],z=E[2],V=E[3],G=O[0],F=O[1],q=O[2],W=O[3];return Math.abs(M-G)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(G))&&Math.abs(R-F)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(F))&&Math.abs(z-q)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(q))&&Math.abs(V-W)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(W))},Zt.forEach=Zt.sqrLen=Zt.len=Zt.sqrDist=Zt.dist=Zt.div=Zt.mul=Zt.sub=void 0;var i=function(E,O){if(E&&E.__esModule)return E;if(E===null||c(E)!=="object"&&typeof E!="function")return{default:E};var M=o(void 0);if(M&&M.has(E))return M.get(E);var R={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in E)if(V!=="default"&&Object.prototype.hasOwnProperty.call(E,V)){var G=z?Object.getOwnPropertyDescriptor(E,V):null;G&&(G.get||G.set)?Object.defineProperty(R,V,G):R[V]=E[V]}return R.default=E,M&&M.set(E,R),R}(ue());function o(E){if(typeof WeakMap!="function")return null;var O=new WeakMap,M=new WeakMap;return(o=function(R){return R?M:O})(E)}function u(){var E=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0,E[3]=0),E}function p(E,O,M){return E[0]=O[0]-M[0],E[1]=O[1]-M[1],E[2]=O[2]-M[2],E[3]=O[3]-M[3],E}function h(E,O,M){return E[0]=O[0]*M[0],E[1]=O[1]*M[1],E[2]=O[2]*M[2],E[3]=O[3]*M[3],E}function m(E,O,M){return E[0]=O[0]/M[0],E[1]=O[1]/M[1],E[2]=O[2]/M[2],E[3]=O[3]/M[3],E}function b(E,O){return Math.hypot(O[0]-E[0],O[1]-E[1],O[2]-E[2],O[3]-E[3])}function S(E,O){var M=O[0]-E[0],R=O[1]-E[1],z=O[2]-E[2],V=O[3]-E[3];return M*M+R*R+z*z+V*V}function A(E){return Math.hypot(E[0],E[1],E[2],E[3])}function y(E){var O=E[0],M=E[1],R=E[2],z=E[3];return O*O+M*M+R*R+z*z}Zt.sub=p,Zt.mul=h,Zt.div=m,Zt.dist=b,Zt.sqrDist=S,Zt.len=A,Zt.sqrLen=y;var w,P=(w=u(),function(E,O,M,R,z,V){var G,F;for(O||(O=4),M||(M=0),F=R?Math.min(R*O+M,E.length):E.length,G=M;G<F;G+=O)w[0]=E[G],w[1]=E[G+1],w[2]=E[G+2],w[3]=E[G+3],z(w,w,V),E[G]=w[0],E[G+1]=w[1],E[G+2]=w[2],E[G+3]=w[3];return E});return Zt.forEach=P,Zt}function fr(){if(Jt)return at;function c(he){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e},c(he)}Jt=1,Object.defineProperty(at,"__esModule",{value:!0}),at.create=b,at.identity=function(he){return he[0]=0,he[1]=0,he[2]=0,he[3]=1,he},at.setAxisAngle=S,at.getAxisAngle=function(he,_e){var Ae=2*Math.acos(_e[3]),Me=Math.sin(Ae/2);return Me>i.EPSILON?(he[0]=_e[0]/Me,he[1]=_e[1]/Me,he[2]=_e[2]/Me):(he[0]=1,he[1]=0,he[2]=0),Ae},at.getAngle=function(he,_e){var Ae=M(he,_e);return Math.acos(2*Ae*Ae-1)},at.multiply=A,at.rotateX=function(he,_e,Ae){Ae*=.5;var Me=_e[0],Re=_e[1],Be=_e[2],Ge=_e[3],Fe=Math.sin(Ae),tt=Math.cos(Ae);return he[0]=Me*tt+Ge*Fe,he[1]=Re*tt+Be*Fe,he[2]=Be*tt-Re*Fe,he[3]=Ge*tt-Me*Fe,he},at.rotateY=function(he,_e,Ae){Ae*=.5;var Me=_e[0],Re=_e[1],Be=_e[2],Ge=_e[3],Fe=Math.sin(Ae),tt=Math.cos(Ae);return he[0]=Me*tt-Be*Fe,he[1]=Re*tt+Ge*Fe,he[2]=Be*tt+Me*Fe,he[3]=Ge*tt-Re*Fe,he},at.rotateZ=function(he,_e,Ae){Ae*=.5;var Me=_e[0],Re=_e[1],Be=_e[2],Ge=_e[3],Fe=Math.sin(Ae),tt=Math.cos(Ae);return he[0]=Me*tt+Re*Fe,he[1]=Re*tt-Me*Fe,he[2]=Be*tt+Ge*Fe,he[3]=Ge*tt-Be*Fe,he},at.calculateW=function(he,_e){var Ae=_e[0],Me=_e[1],Re=_e[2];return he[0]=Ae,he[1]=Me,he[2]=Re,he[3]=Math.sqrt(Math.abs(1-Ae*Ae-Me*Me-Re*Re)),he},at.exp=y,at.ln=w,at.pow=function(he,_e,Ae){return w(he,_e),O(he,he,Ae),y(he,he),he},at.slerp=P,at.random=function(he){var _e=i.RANDOM(),Ae=i.RANDOM(),Me=i.RANDOM(),Re=Math.sqrt(1-_e),Be=Math.sqrt(_e);return he[0]=Re*Math.sin(2*Math.PI*Ae),he[1]=Re*Math.cos(2*Math.PI*Ae),he[2]=Be*Math.sin(2*Math.PI*Me),he[3]=Be*Math.cos(2*Math.PI*Me),he},at.invert=function(he,_e){var Ae=_e[0],Me=_e[1],Re=_e[2],Be=_e[3],Ge=Ae*Ae+Me*Me+Re*Re+Be*Be,Fe=Ge?1/Ge:0;return he[0]=-Ae*Fe,he[1]=-Me*Fe,he[2]=-Re*Fe,he[3]=Be*Fe,he},at.conjugate=function(he,_e){return he[0]=-_e[0],he[1]=-_e[1],he[2]=-_e[2],he[3]=_e[3],he},at.fromMat3=E,at.fromEuler=function(he,_e,Ae,Me){var Re=.5*Math.PI/180;_e*=Re,Ae*=Re,Me*=Re;var Be=Math.sin(_e),Ge=Math.cos(_e),Fe=Math.sin(Ae),tt=Math.cos(Ae),ut=Math.sin(Me),Xe=Math.cos(Me);return he[0]=Be*tt*Xe-Ge*Fe*ut,he[1]=Ge*Fe*Xe+Be*tt*ut,he[2]=Ge*tt*ut-Be*Fe*Xe,he[3]=Ge*tt*Xe+Be*Fe*ut,he},at.str=function(he){return"quat("+he[0]+", "+he[1]+", "+he[2]+", "+he[3]+")"},at.setAxes=at.sqlerp=at.rotationTo=at.equals=at.exactEquals=at.normalize=at.sqrLen=at.squaredLength=at.len=at.length=at.lerp=at.dot=at.scale=at.mul=at.add=at.set=at.copy=at.fromValues=at.clone=void 0;var i=m(ue()),o=m(ht()),u=m(gr()),p=m(Et());function h(he){if(typeof WeakMap!="function")return null;var _e=new WeakMap,Ae=new WeakMap;return(h=function(Me){return Me?Ae:_e})(he)}function m(he,_e){if(he&&he.__esModule)return he;if(he===null||c(he)!=="object"&&typeof he!="function")return{default:he};var Ae=h(_e);if(Ae&&Ae.has(he))return Ae.get(he);var Me={},Re=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Be in he)if(Be!=="default"&&Object.prototype.hasOwnProperty.call(he,Be)){var Ge=Re?Object.getOwnPropertyDescriptor(he,Be):null;Ge&&(Ge.get||Ge.set)?Object.defineProperty(Me,Be,Ge):Me[Be]=he[Be]}return Me.default=he,Ae&&Ae.set(he,Me),Me}function b(){var he=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(he[0]=0,he[1]=0,he[2]=0),he[3]=1,he}function S(he,_e,Ae){Ae*=.5;var Me=Math.sin(Ae);return he[0]=Me*_e[0],he[1]=Me*_e[1],he[2]=Me*_e[2],he[3]=Math.cos(Ae),he}function A(he,_e,Ae){var Me=_e[0],Re=_e[1],Be=_e[2],Ge=_e[3],Fe=Ae[0],tt=Ae[1],ut=Ae[2],Xe=Ae[3];return he[0]=Me*Xe+Ge*Fe+Re*ut-Be*tt,he[1]=Re*Xe+Ge*tt+Be*Fe-Me*ut,he[2]=Be*Xe+Ge*ut+Me*tt-Re*Fe,he[3]=Ge*Xe-Me*Fe-Re*tt-Be*ut,he}function y(he,_e){var Ae=_e[0],Me=_e[1],Re=_e[2],Be=_e[3],Ge=Math.sqrt(Ae*Ae+Me*Me+Re*Re),Fe=Math.exp(Be),tt=Ge>0?Fe*Math.sin(Ge)/Ge:0;return he[0]=Ae*tt,he[1]=Me*tt,he[2]=Re*tt,he[3]=Fe*Math.cos(Ge),he}function w(he,_e){var Ae=_e[0],Me=_e[1],Re=_e[2],Be=_e[3],Ge=Math.sqrt(Ae*Ae+Me*Me+Re*Re),Fe=Ge>0?Math.atan2(Ge,Be)/Ge:0;return he[0]=Ae*Fe,he[1]=Me*Fe,he[2]=Re*Fe,he[3]=.5*Math.log(Ae*Ae+Me*Me+Re*Re+Be*Be),he}function P(he,_e,Ae,Me){var Re,Be,Ge,Fe,tt,ut=_e[0],Xe=_e[1],Lt=_e[2],Pt=_e[3],bt=Ae[0],mt=Ae[1],Yt=Ae[2],Rt=Ae[3];return(Be=ut*bt+Xe*mt+Lt*Yt+Pt*Rt)<0&&(Be=-Be,bt=-bt,mt=-mt,Yt=-Yt,Rt=-Rt),1-Be>i.EPSILON?(Re=Math.acos(Be),Ge=Math.sin(Re),Fe=Math.sin((1-Me)*Re)/Ge,tt=Math.sin(Me*Re)/Ge):(Fe=1-Me,tt=Me),he[0]=Fe*ut+tt*bt,he[1]=Fe*Xe+tt*mt,he[2]=Fe*Lt+tt*Yt,he[3]=Fe*Pt+tt*Rt,he}function E(he,_e){var Ae,Me=_e[0]+_e[4]+_e[8];if(Me>0)Ae=Math.sqrt(Me+1),he[3]=.5*Ae,he[0]=(_e[5]-_e[7])*(Ae=.5/Ae),he[1]=(_e[6]-_e[2])*Ae,he[2]=(_e[1]-_e[3])*Ae;else{var Re=0;_e[4]>_e[0]&&(Re=1),_e[8]>_e[3*Re+Re]&&(Re=2);var Be=(Re+1)%3,Ge=(Re+2)%3;Ae=Math.sqrt(_e[3*Re+Re]-_e[3*Be+Be]-_e[3*Ge+Ge]+1),he[Re]=.5*Ae,he[3]=(_e[3*Be+Ge]-_e[3*Ge+Be])*(Ae=.5/Ae),he[Be]=(_e[3*Be+Re]+_e[3*Re+Be])*Ae,he[Ge]=(_e[3*Ge+Re]+_e[3*Re+Ge])*Ae}return he}at.clone=p.clone,at.fromValues=p.fromValues,at.copy=p.copy,at.set=p.set,at.add=p.add,at.mul=A;var O=p.scale;at.scale=O;var M=p.dot;at.dot=M,at.lerp=p.lerp;var R=p.length;at.length=R,at.len=R;var z=p.squaredLength;at.squaredLength=z,at.sqrLen=z;var V=p.normalize;at.normalize=V,at.exactEquals=p.exactEquals,at.equals=p.equals;var G,F,q,W=(G=u.create(),F=u.fromValues(1,0,0),q=u.fromValues(0,1,0),function(he,_e,Ae){var Me=u.dot(_e,Ae);return Me<-.999999?(u.cross(G,F,_e),u.len(G)<1e-6&&u.cross(G,q,_e),u.normalize(G,G),S(he,G,Math.PI),he):Me>.999999?(he[0]=0,he[1]=0,he[2]=0,he[3]=1,he):(u.cross(G,_e,Ae),he[0]=G[0],he[1]=G[1],he[2]=G[2],he[3]=1+Me,V(he,he))});at.rotationTo=W;var te,se,le=(te=b(),se=b(),function(he,_e,Ae,Me,Re,Be){return P(te,_e,Re,Be),P(se,Ae,Me,Be),P(he,te,se,2*Be*(1-Be)),he});at.sqlerp=le;var ne,me=(ne=o.create(),function(he,_e,Ae,Me){return ne[0]=Ae[0],ne[3]=Ae[1],ne[6]=Ae[2],ne[1]=Me[0],ne[4]=Me[1],ne[7]=Me[2],ne[2]=-_e[0],ne[5]=-_e[1],ne[8]=-_e[2],V(he,E(he,ne))});return at.setAxes=me,at}var jr,er={};function tn(){if(jr)return er;function c(P){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},c(P)}jr=1,Object.defineProperty(er,"__esModule",{value:!0}),er.create=function(){var P=new i.ARRAY_TYPE(8);return i.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0,P[4]=0,P[5]=0,P[6]=0,P[7]=0),P[3]=1,P},er.clone=function(P){var E=new i.ARRAY_TYPE(8);return E[0]=P[0],E[1]=P[1],E[2]=P[2],E[3]=P[3],E[4]=P[4],E[5]=P[5],E[6]=P[6],E[7]=P[7],E},er.fromValues=function(P,E,O,M,R,z,V,G){var F=new i.ARRAY_TYPE(8);return F[0]=P,F[1]=E,F[2]=O,F[3]=M,F[4]=R,F[5]=z,F[6]=V,F[7]=G,F},er.fromRotationTranslationValues=function(P,E,O,M,R,z,V){var G=new i.ARRAY_TYPE(8);G[0]=P,G[1]=E,G[2]=O,G[3]=M;var F=.5*R,q=.5*z,W=.5*V;return G[4]=F*M+q*O-W*E,G[5]=q*M+W*P-F*O,G[6]=W*M+F*E-q*P,G[7]=-F*P-q*E-W*O,G},er.fromRotationTranslation=m,er.fromTranslation=function(P,E){return P[0]=0,P[1]=0,P[2]=0,P[3]=1,P[4]=.5*E[0],P[5]=.5*E[1],P[6]=.5*E[2],P[7]=0,P},er.fromRotation=function(P,E){return P[0]=E[0],P[1]=E[1],P[2]=E[2],P[3]=E[3],P[4]=0,P[5]=0,P[6]=0,P[7]=0,P},er.fromMat4=function(P,E){var O=o.create();u.getRotation(O,E);var M=new i.ARRAY_TYPE(3);return u.getTranslation(M,E),m(P,O,M),P},er.copy=b,er.identity=function(P){return P[0]=0,P[1]=0,P[2]=0,P[3]=1,P[4]=0,P[5]=0,P[6]=0,P[7]=0,P},er.set=function(P,E,O,M,R,z,V,G,F){return P[0]=E,P[1]=O,P[2]=M,P[3]=R,P[4]=z,P[5]=V,P[6]=G,P[7]=F,P},er.getDual=function(P,E){return P[0]=E[4],P[1]=E[5],P[2]=E[6],P[3]=E[7],P},er.setDual=function(P,E){return P[4]=E[0],P[5]=E[1],P[6]=E[2],P[7]=E[3],P},er.getTranslation=function(P,E){var O=E[4],M=E[5],R=E[6],z=E[7],V=-E[0],G=-E[1],F=-E[2],q=E[3];return P[0]=2*(O*q+z*V+M*F-R*G),P[1]=2*(M*q+z*G+R*V-O*F),P[2]=2*(R*q+z*F+O*G-M*V),P},er.translate=function(P,E,O){var M=E[0],R=E[1],z=E[2],V=E[3],G=.5*O[0],F=.5*O[1],q=.5*O[2],W=E[4],te=E[5],se=E[6],le=E[7];return P[0]=M,P[1]=R,P[2]=z,P[3]=V,P[4]=V*G+R*q-z*F+W,P[5]=V*F+z*G-M*q+te,P[6]=V*q+M*F-R*G+se,P[7]=-M*G-R*F-z*q+le,P},er.rotateX=function(P,E,O){var M=-E[0],R=-E[1],z=-E[2],V=E[3],G=E[4],F=E[5],q=E[6],W=E[7],te=G*V+W*M+F*z-q*R,se=F*V+W*R+q*M-G*z,le=q*V+W*z+G*R-F*M,ne=W*V-G*M-F*R-q*z;return o.rotateX(P,E,O),P[4]=te*(V=P[3])+ne*(M=P[0])+se*(z=P[2])-le*(R=P[1]),P[5]=se*V+ne*R+le*M-te*z,P[6]=le*V+ne*z+te*R-se*M,P[7]=ne*V-te*M-se*R-le*z,P},er.rotateY=function(P,E,O){var M=-E[0],R=-E[1],z=-E[2],V=E[3],G=E[4],F=E[5],q=E[6],W=E[7],te=G*V+W*M+F*z-q*R,se=F*V+W*R+q*M-G*z,le=q*V+W*z+G*R-F*M,ne=W*V-G*M-F*R-q*z;return o.rotateY(P,E,O),P[4]=te*(V=P[3])+ne*(M=P[0])+se*(z=P[2])-le*(R=P[1]),P[5]=se*V+ne*R+le*M-te*z,P[6]=le*V+ne*z+te*R-se*M,P[7]=ne*V-te*M-se*R-le*z,P},er.rotateZ=function(P,E,O){var M=-E[0],R=-E[1],z=-E[2],V=E[3],G=E[4],F=E[5],q=E[6],W=E[7],te=G*V+W*M+F*z-q*R,se=F*V+W*R+q*M-G*z,le=q*V+W*z+G*R-F*M,ne=W*V-G*M-F*R-q*z;return o.rotateZ(P,E,O),P[4]=te*(V=P[3])+ne*(M=P[0])+se*(z=P[2])-le*(R=P[1]),P[5]=se*V+ne*R+le*M-te*z,P[6]=le*V+ne*z+te*R-se*M,P[7]=ne*V-te*M-se*R-le*z,P},er.rotateByQuatAppend=function(P,E,O){var M=O[0],R=O[1],z=O[2],V=O[3],G=E[0],F=E[1],q=E[2],W=E[3];return P[0]=G*V+W*M+F*z-q*R,P[1]=F*V+W*R+q*M-G*z,P[2]=q*V+W*z+G*R-F*M,P[3]=W*V-G*M-F*R-q*z,P[4]=(G=E[4])*V+(W=E[7])*M+(F=E[5])*z-(q=E[6])*R,P[5]=F*V+W*R+q*M-G*z,P[6]=q*V+W*z+G*R-F*M,P[7]=W*V-G*M-F*R-q*z,P},er.rotateByQuatPrepend=function(P,E,O){var M=E[0],R=E[1],z=E[2],V=E[3],G=O[0],F=O[1],q=O[2],W=O[3];return P[0]=M*W+V*G+R*q-z*F,P[1]=R*W+V*F+z*G-M*q,P[2]=z*W+V*q+M*F-R*G,P[3]=V*W-M*G-R*F-z*q,P[4]=M*(W=O[7])+V*(G=O[4])+R*(q=O[6])-z*(F=O[5]),P[5]=R*W+V*F+z*G-M*q,P[6]=z*W+V*q+M*F-R*G,P[7]=V*W-M*G-R*F-z*q,P},er.rotateAroundAxis=function(P,E,O,M){if(Math.abs(M)<i.EPSILON)return b(P,E);var R=Math.hypot(O[0],O[1],O[2]);M*=.5;var z=Math.sin(M),V=z*O[0]/R,G=z*O[1]/R,F=z*O[2]/R,q=Math.cos(M),W=E[0],te=E[1],se=E[2],le=E[3];P[0]=W*q+le*V+te*F-se*G,P[1]=te*q+le*G+se*V-W*F,P[2]=se*q+le*F+W*G-te*V,P[3]=le*q-W*V-te*G-se*F;var ne=E[4],me=E[5],he=E[6],_e=E[7];return P[4]=ne*q+_e*V+me*F-he*G,P[5]=me*q+_e*G+he*V-ne*F,P[6]=he*q+_e*F+ne*G-me*V,P[7]=_e*q-ne*V-me*G-he*F,P},er.add=function(P,E,O){return P[0]=E[0]+O[0],P[1]=E[1]+O[1],P[2]=E[2]+O[2],P[3]=E[3]+O[3],P[4]=E[4]+O[4],P[5]=E[5]+O[5],P[6]=E[6]+O[6],P[7]=E[7]+O[7],P},er.multiply=S,er.scale=function(P,E,O){return P[0]=E[0]*O,P[1]=E[1]*O,P[2]=E[2]*O,P[3]=E[3]*O,P[4]=E[4]*O,P[5]=E[5]*O,P[6]=E[6]*O,P[7]=E[7]*O,P},er.lerp=function(P,E,O,M){var R=1-M;return A(E,O)<0&&(M=-M),P[0]=E[0]*R+O[0]*M,P[1]=E[1]*R+O[1]*M,P[2]=E[2]*R+O[2]*M,P[3]=E[3]*R+O[3]*M,P[4]=E[4]*R+O[4]*M,P[5]=E[5]*R+O[5]*M,P[6]=E[6]*R+O[6]*M,P[7]=E[7]*R+O[7]*M,P},er.invert=function(P,E){var O=w(E);return P[0]=-E[0]/O,P[1]=-E[1]/O,P[2]=-E[2]/O,P[3]=E[3]/O,P[4]=-E[4]/O,P[5]=-E[5]/O,P[6]=-E[6]/O,P[7]=E[7]/O,P},er.conjugate=function(P,E){return P[0]=-E[0],P[1]=-E[1],P[2]=-E[2],P[3]=E[3],P[4]=-E[4],P[5]=-E[5],P[6]=-E[6],P[7]=E[7],P},er.normalize=function(P,E){var O=w(E);if(O>0){O=Math.sqrt(O);var M=E[0]/O,R=E[1]/O,z=E[2]/O,V=E[3]/O,G=E[4],F=E[5],q=E[6],W=E[7],te=M*G+R*F+z*q+V*W;P[0]=M,P[1]=R,P[2]=z,P[3]=V,P[4]=(G-M*te)/O,P[5]=(F-R*te)/O,P[6]=(q-z*te)/O,P[7]=(W-V*te)/O}return P},er.str=function(P){return"quat2("+P[0]+", "+P[1]+", "+P[2]+", "+P[3]+", "+P[4]+", "+P[5]+", "+P[6]+", "+P[7]+")"},er.exactEquals=function(P,E){return P[0]===E[0]&&P[1]===E[1]&&P[2]===E[2]&&P[3]===E[3]&&P[4]===E[4]&&P[5]===E[5]&&P[6]===E[6]&&P[7]===E[7]},er.equals=function(P,E){var O=P[0],M=P[1],R=P[2],z=P[3],V=P[4],G=P[5],F=P[6],q=P[7],W=E[0],te=E[1],se=E[2],le=E[3],ne=E[4],me=E[5],he=E[6],_e=E[7];return Math.abs(O-W)<=i.EPSILON*Math.max(1,Math.abs(O),Math.abs(W))&&Math.abs(M-te)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(te))&&Math.abs(R-se)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(se))&&Math.abs(z-le)<=i.EPSILON*Math.max(1,Math.abs(z),Math.abs(le))&&Math.abs(V-ne)<=i.EPSILON*Math.max(1,Math.abs(V),Math.abs(ne))&&Math.abs(G-me)<=i.EPSILON*Math.max(1,Math.abs(G),Math.abs(me))&&Math.abs(F-he)<=i.EPSILON*Math.max(1,Math.abs(F),Math.abs(he))&&Math.abs(q-_e)<=i.EPSILON*Math.max(1,Math.abs(q),Math.abs(_e))},er.sqrLen=er.squaredLength=er.len=er.length=er.dot=er.mul=er.setReal=er.getReal=void 0;var i=h(ue()),o=h(fr()),u=h(gt());function p(P){if(typeof WeakMap!="function")return null;var E=new WeakMap,O=new WeakMap;return(p=function(M){return M?O:E})(P)}function h(P,E){if(P&&P.__esModule)return P;if(P===null||c(P)!=="object"&&typeof P!="function")return{default:P};var O=p(E);if(O&&O.has(P))return O.get(P);var M={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var z in P)if(z!=="default"&&Object.prototype.hasOwnProperty.call(P,z)){var V=R?Object.getOwnPropertyDescriptor(P,z):null;V&&(V.get||V.set)?Object.defineProperty(M,z,V):M[z]=P[z]}return M.default=P,O&&O.set(P,M),M}function m(P,E,O){var M=.5*O[0],R=.5*O[1],z=.5*O[2],V=E[0],G=E[1],F=E[2],q=E[3];return P[0]=V,P[1]=G,P[2]=F,P[3]=q,P[4]=M*q+R*F-z*G,P[5]=R*q+z*V-M*F,P[6]=z*q+M*G-R*V,P[7]=-M*V-R*G-z*F,P}function b(P,E){return P[0]=E[0],P[1]=E[1],P[2]=E[2],P[3]=E[3],P[4]=E[4],P[5]=E[5],P[6]=E[6],P[7]=E[7],P}function S(P,E,O){var M=E[0],R=E[1],z=E[2],V=E[3],G=O[4],F=O[5],q=O[6],W=O[7],te=E[4],se=E[5],le=E[6],ne=E[7],me=O[0],he=O[1],_e=O[2],Ae=O[3];return P[0]=M*Ae+V*me+R*_e-z*he,P[1]=R*Ae+V*he+z*me-M*_e,P[2]=z*Ae+V*_e+M*he-R*me,P[3]=V*Ae-M*me-R*he-z*_e,P[4]=M*W+V*G+R*q-z*F+te*Ae+ne*me+se*_e-le*he,P[5]=R*W+V*F+z*G-M*q+se*Ae+ne*he+le*me-te*_e,P[6]=z*W+V*q+M*F-R*G+le*Ae+ne*_e+te*he-se*me,P[7]=V*W-M*G-R*F-z*q+ne*Ae-te*me-se*he-le*_e,P}er.getReal=o.copy,er.setReal=o.copy,er.mul=S;var A=o.dot;er.dot=A;var y=o.length;er.length=y,er.len=y;var w=o.squaredLength;return er.squaredLength=w,er.sqrLen=w,er}var ln,Yi,ir={};function us(){if(ln)return ir;function c(E){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},c(E)}ln=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.create=u,ir.clone=function(E){var O=new i.ARRAY_TYPE(2);return O[0]=E[0],O[1]=E[1],O},ir.fromValues=function(E,O){var M=new i.ARRAY_TYPE(2);return M[0]=E,M[1]=O,M},ir.copy=function(E,O){return E[0]=O[0],E[1]=O[1],E},ir.set=function(E,O,M){return E[0]=O,E[1]=M,E},ir.add=function(E,O,M){return E[0]=O[0]+M[0],E[1]=O[1]+M[1],E},ir.subtract=p,ir.multiply=h,ir.divide=m,ir.ceil=function(E,O){return E[0]=Math.ceil(O[0]),E[1]=Math.ceil(O[1]),E},ir.floor=function(E,O){return E[0]=Math.floor(O[0]),E[1]=Math.floor(O[1]),E},ir.min=function(E,O,M){return E[0]=Math.min(O[0],M[0]),E[1]=Math.min(O[1],M[1]),E},ir.max=function(E,O,M){return E[0]=Math.max(O[0],M[0]),E[1]=Math.max(O[1],M[1]),E},ir.round=function(E,O){return E[0]=Math.round(O[0]),E[1]=Math.round(O[1]),E},ir.scale=function(E,O,M){return E[0]=O[0]*M,E[1]=O[1]*M,E},ir.scaleAndAdd=function(E,O,M,R){return E[0]=O[0]+M[0]*R,E[1]=O[1]+M[1]*R,E},ir.distance=b,ir.squaredDistance=S,ir.length=A,ir.squaredLength=y,ir.negate=function(E,O){return E[0]=-O[0],E[1]=-O[1],E},ir.inverse=function(E,O){return E[0]=1/O[0],E[1]=1/O[1],E},ir.normalize=function(E,O){var M=O[0],R=O[1],z=M*M+R*R;return z>0&&(z=1/Math.sqrt(z)),E[0]=O[0]*z,E[1]=O[1]*z,E},ir.dot=function(E,O){return E[0]*O[0]+E[1]*O[1]},ir.cross=function(E,O,M){var R=O[0]*M[1]-O[1]*M[0];return E[0]=E[1]=0,E[2]=R,E},ir.lerp=function(E,O,M,R){var z=O[0],V=O[1];return E[0]=z+R*(M[0]-z),E[1]=V+R*(M[1]-V),E},ir.random=function(E,O){O=O||1;var M=2*i.RANDOM()*Math.PI;return E[0]=Math.cos(M)*O,E[1]=Math.sin(M)*O,E},ir.transformMat2=function(E,O,M){var R=O[0],z=O[1];return E[0]=M[0]*R+M[2]*z,E[1]=M[1]*R+M[3]*z,E},ir.transformMat2d=function(E,O,M){var R=O[0],z=O[1];return E[0]=M[0]*R+M[2]*z+M[4],E[1]=M[1]*R+M[3]*z+M[5],E},ir.transformMat3=function(E,O,M){var R=O[0],z=O[1];return E[0]=M[0]*R+M[3]*z+M[6],E[1]=M[1]*R+M[4]*z+M[7],E},ir.transformMat4=function(E,O,M){var R=O[0],z=O[1];return E[0]=M[0]*R+M[4]*z+M[12],E[1]=M[1]*R+M[5]*z+M[13],E},ir.rotate=function(E,O,M,R){var z=O[0]-M[0],V=O[1]-M[1],G=Math.sin(R),F=Math.cos(R);return E[0]=z*F-V*G+M[0],E[1]=z*G+V*F+M[1],E},ir.angle=function(E,O){var M=E[0],R=E[1],z=O[0],V=O[1],G=Math.sqrt(M*M+R*R)*Math.sqrt(z*z+V*V);return Math.acos(Math.min(Math.max(G&&(M*z+R*V)/G,-1),1))},ir.zero=function(E){return E[0]=0,E[1]=0,E},ir.str=function(E){return"vec2("+E[0]+", "+E[1]+")"},ir.exactEquals=function(E,O){return E[0]===O[0]&&E[1]===O[1]},ir.equals=function(E,O){var M=E[0],R=E[1],z=O[0],V=O[1];return Math.abs(M-z)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(z))&&Math.abs(R-V)<=i.EPSILON*Math.max(1,Math.abs(R),Math.abs(V))},ir.forEach=ir.sqrLen=ir.sqrDist=ir.dist=ir.div=ir.mul=ir.sub=ir.len=void 0;var i=function(E,O){if(E&&E.__esModule)return E;if(E===null||c(E)!=="object"&&typeof E!="function")return{default:E};var M=o(void 0);if(M&&M.has(E))return M.get(E);var R={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in E)if(V!=="default"&&Object.prototype.hasOwnProperty.call(E,V)){var G=z?Object.getOwnPropertyDescriptor(E,V):null;G&&(G.get||G.set)?Object.defineProperty(R,V,G):R[V]=E[V]}return R.default=E,M&&M.set(E,R),R}(ue());function o(E){if(typeof WeakMap!="function")return null;var O=new WeakMap,M=new WeakMap;return(o=function(R){return R?M:O})(E)}function u(){var E=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(E[0]=0,E[1]=0),E}function p(E,O,M){return E[0]=O[0]-M[0],E[1]=O[1]-M[1],E}function h(E,O,M){return E[0]=O[0]*M[0],E[1]=O[1]*M[1],E}function m(E,O,M){return E[0]=O[0]/M[0],E[1]=O[1]/M[1],E}function b(E,O){return Math.hypot(O[0]-E[0],O[1]-E[1])}function S(E,O){var M=O[0]-E[0],R=O[1]-E[1];return M*M+R*R}function A(E){return Math.hypot(E[0],E[1])}function y(E){var O=E[0],M=E[1];return O*O+M*M}ir.len=A,ir.sub=p,ir.mul=h,ir.div=m,ir.dist=b,ir.sqrDist=S,ir.sqrLen=y;var w,P=(w=u(),function(E,O,M,R,z,V){var G,F;for(O||(O=2),M||(M=0),F=R?Math.min(R*O+M,E.length):E.length,G=M;G<F;G+=O)w[0]=E[G],w[1]=E[G+1],z(w,w,V),E[G]=w[0],E[G+1]=w[1];return E});return ir.forEach=P,ir}function rn(){if(Yi)return K;function c(E){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},c(E)}Yi=1,Object.defineProperty(K,"__esModule",{value:!0}),K.vec4=K.vec3=K.vec2=K.quat2=K.quat=K.mat4=K.mat3=K.mat2d=K.mat2=K.glMatrix=void 0;var i=P(ue());K.glMatrix=i;var o=P(Ie());K.mat2=o;var u=P(De());K.mat2d=u;var p=P(ht());K.mat3=p;var h=P(gt());K.mat4=h;var m=P(fr());K.quat=m;var b=P(tn());K.quat2=b;var S=P(us());K.vec2=S;var A=P(gr());K.vec3=A;var y=P(Et());function w(E){if(typeof WeakMap!="function")return null;var O=new WeakMap,M=new WeakMap;return(w=function(R){return R?M:O})(E)}function P(E,O){if(E&&E.__esModule)return E;if(E===null||c(E)!=="object"&&typeof E!="function")return{default:E};var M=w(O);if(M&&M.has(E))return M.get(E);var R={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in E)if(V!=="default"&&Object.prototype.hasOwnProperty.call(E,V)){var G=z?Object.getOwnPropertyDescriptor(E,V):null;G&&(G.get||G.set)?Object.defineProperty(R,V,G):R[V]=E[V]}return R.default=E,M&&M.set(E,R),R}return K.vec4=y,K}var yi,Si,hs,qi,we=rn(),Kn=function(){if(Si)return yi;function c(i,o,u,p){this.cx=3*i,this.bx=3*(u-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(p-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=o,this.p2x=u,this.p2y=p}return Si=1,yi=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,o){if(o===void 0&&(o=1e-6),i<0)return 0;if(i>1)return 1;for(var u=i,p=0;p<8;p++){var h=this.sampleCurveX(u)-i;if(Math.abs(h)<o)return u;var m=this.sampleCurveDerivativeX(u);if(Math.abs(m)<1e-6)break;u-=h/m}var b=0,S=1;for(u=i,p=0;p<20&&(h=this.sampleCurveX(u),!(Math.abs(h-i)<o));p++)i>h?b=u:S=u,u=.5*(S-b)+b;return u},solve:function(i,o){return this.sampleCurveY(this.solveCurveX(i,o))}},yi}(),Ne=N(Kn);function Qe(){if(qi)return hs;function c(i,o){this.x=i,this.y=o}return qi=1,hs=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,o){return this.clone()._rotateAround(i,o)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var o=i.x-this.x,u=i.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,o){return Math.atan2(this.x*o-this.y*i,this.x*i+this.y*o)},_matMult:function(i){var o=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=o,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var o=Math.cos(i),u=Math.sin(i),p=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=p,this},_rotateAround:function(i,o){var u=Math.cos(i),p=Math.sin(i),h=o.y+p*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-p*(this.y-o.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(i){return i instanceof c?i:Array.isArray(i)?new c(i[0],i[1]):i},hs}var ze=N(Qe());function Bt(c,i){if(Array.isArray(c)){if(!Array.isArray(i)||c.length!==i.length)return!1;for(let o=0;o<c.length;o++)if(!Bt(c[o],i[o]))return!1;return!0}if(typeof c=="object"&&c!==null&&i!==null){if(typeof i!="object"||Object.keys(c).length!==Object.keys(i).length)return!1;for(const o in c)if(!Bt(c[o],i[o]))return!1;return!0}return c===i}const At=Math.PI/180,qt=180/Math.PI;function Mt(c){return c*At}function Vt(c){return c*qt}const Gt=[[0,0],[1,0],[1,1],[0,1]];function Nt(c){if(c<=0)return 0;if(c>=1)return 1;const i=c*c,o=i*c;return 4*(c<.5?o:3*(c-i)+o-.75)}function br(c,i,o,u){const p=new Ne(c,i,o,u);return function(h){return p.solve(h)}}const ar=br(.25,.1,.25,1);function Dt(c,i,o){return Math.min(o,Math.max(i,c))}function zr(c,i,o){return(o=Dt((o-c)/(i-c),0,1))*o*(3-2*o)}function Hr(c,i,o){const u=o-i,p=((c-i)%u+u)%u+i;return p===i?o:p}function Oi(c,i,o){if(!c.length)return o(null,[]);let u=c.length;const p=new Array(c.length);let h=null;c.forEach((m,b)=>{i(m,(S,A)=>{S&&(h=S),p[b]=A,--u==0&&o(h,p)})})}function Kr(c,...i){for(const o of i)for(const u in o)c[u]=o[u];return c}let Pi=1;function to(){return Pi++}function ds(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function ka(c,i){c.forEach(o=>{i[o]&&(i[o]=i[o].bind(i))})}function xo(c,i){return c.indexOf(i,c.length-i.length)!==-1}function ha(c,i,o){const u={};for(const p in c)u[p]=i.call(this,c[p],p,c);return u}function Nn(c,i,o){const u={};for(const p in c)i.call(this,c[p],p,c)&&(u[p]=c[p]);return u}function vn(c){return Array.isArray(c)?c.map(vn):typeof c=="object"&&c?ha(c,vn):c}const dl={};function Jr(c){dl[c]||(typeof console<"u"&&console.warn(c),dl[c]=!0)}function da(c,i,o){return(o.y-c.y)*(i.x-c.x)>(i.y-c.y)*(o.x-c.x)}function Jd(c){let i=0;for(let o,u,p=0,h=c.length,m=h-1;p<h;m=p++)o=c[p],u=c[m],i+=(u.x-o.x)*(o.y+u.y);return i}function Wo([c,i,o]){const u=Mt(i+90),p=Mt(o);return{x:c*Math.cos(u)*Math.sin(p),y:c*Math.sin(u)*Math.sin(p),z:c*Math.cos(p),azimuthal:i,polar:o}}function Kl(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function mh(c){const i={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,p,h)=>{const m=p||h;return i[u]=!m||m.toLowerCase(),""}),i["max-age"]){const o=parseInt(i["max-age"],10);isNaN(o)?delete i["max-age"]:i["max-age"]=o}return i}let $c,gh=null;function Yl(c,i){return[c[4*i],c[4*i+1],c[4*i+2],c[4*i+3]]}function qe(c,i,o,u){for(;i<o;){const p=i+o>>1;c[p]<u?i=p+1:o=p}return i}function Q(c,i,o,u){for(;i<o;){const p=i+o>>1;c[p]<=u?i=p+1:o=p}return i}function re(c){return c>0?1/(1.001-c):1+c}function pe(c){return c>0?1-1/(1.001-c):-c}const Se={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if($c==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{$c=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):c}catch{$c=c}}return $c},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Se.API_URL)return null;try{const c=new URL(Se.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function be(c){return Se.API_URL_REGEX.test(c)}function ke(c){return Se.API_SPRITE_REGEX.test(c)}let We,Ve,Ze,it,et,yt;function kt(){return We==null&&(We=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),We}const zt={now:()=>it!==void 0?it:performance.now(),setNow(c){it=c},restoreNow(){it=void 0},frame(c){const i=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(c,i=0){const{width:o,height:u}=c;et||(et=document.createElement("canvas"));const p=et.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(o>et.width||u>et.height)&&(et.width=o,et.height=u),p.clearRect(-i,-i,o+2*i,u+2*i),p.drawImage(c,0,0,o,u),p.getImageData(-i,-i,o+2*i,u+2*i)},resolveURL:c=>(Ve||(Ve=document.createElement("a")),Ve.href=c,Ve.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ze==null&&(Ze=window.matchMedia("(prefers-reduced-motion: reduce)")),Ze.matches)},hasCanvasFingerprintNoise(){if(yt!==void 0)return yt;if(!kt())return yt=!1,!1;const c=new OffscreenCanvas(85,1),i=c.getContext("2d",{willReadFrequently:!0});let o=0;for(let p=0;p<c.width;++p)i.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,i.fillRect(p,0,1,1);const u=i.getImageData(0,0,c.width,c.height);o=0;for(let p=0;p<u.data.length;++p)if(p%4!=3&&o++!==u.data[p])return yt=!0,!0;return yt=!1,!1}};function ur(c,i){const o=c.indexOf("?");if(o<0)return`${c}?${new URLSearchParams(i).toString()}`;const u=new URLSearchParams(c.slice(o));for(const p in i)u.set(p,i[p]);return`${c.slice(0,o)}?${u.toString()}`}function pr(c,i={persistentParams:[]}){const o=c.indexOf("?");if(o<0)return c;const u=new URLSearchParams,p=new URLSearchParams(c.slice(o));for(const m of i.persistentParams){const b=p.get(m);b&&u.set(m,b)}const h=u.toString();return`${c.slice(0,o)}${h.length>0?`?${h}`:""}`}const _r="mapbox-tiles";let mr=500,ai=50;const pi=["language","worldview","jobid"];let Or,di;function Wi(){try{return caches}catch{}}function On(){const c=Wi();c&&Or==null&&(Or=c.open(_r))}let Mn=1/0;const Yn={supported:!1,testSupport:function(c){!Qd&&za&&(_h?ef(c):Fs=c)}};let Fs,za,Qd=!1,_h=!1;const jc=typeof self<"u"?self:{};function ef(c){const i=c.createTexture();c.bindTexture(c.TEXTURE_2D,i);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,za),c.isContextLost())return;Yn.supported=!0}catch{}c.deleteTexture(i),Qd=!0}jc.document&&(za=jc.document.createElement("img"),za.onload=function(){Fs&&ef(Fs),Fs=null,_h=!0},za.onerror=function(){Qd=!0,Fs=null},za.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Vc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Vc);class dm extends Error{constructor(i,o,u){o===401&&be(u)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=o,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const fm=Kl()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,yh=function(c,i){if(!(/^file:/.test(o=c.url)||/^file:/.test(fm())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,p){const h=new AbortController,m=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:fm(),referrerPolicy:u.referrerPolicy,signal:h.signal});let b=!1,S=!1;const A=(y=m.url).indexOf("sku=")>0&&be(y);var y;u.type==="json"&&m.headers.set("Accept","application/json");const w=(E,O,M)=>{if(S)return;if(E&&E.message!=="SecurityError"&&Jr(E.toString()),O&&M)return P(O);const R=Date.now();fetch(m).then(z=>{if(z.ok){const V=A?z.clone():null;return P(z,V,R)}return p(new dm(z.statusText,z.status,u.url))}).catch(z=>{z.name!=="AbortError"&&p(new Error(`${z.message} ${u.url}`))})},P=(E,O,M)=>{(u.type==="arrayBuffer"?E.arrayBuffer():u.type==="json"?E.json():E.text()).then(R=>{S||(O&&M&&function(z,V,G){if(On(),Or==null)return;const F=mh(V.headers.get("Cache-Control")||"");if(F["no-store"])return;const q={status:V.status,statusText:V.statusText,headers:new Headers};V.headers.forEach((se,le)=>q.headers.set(le,se)),F["max-age"]&&q.headers.set("Expires",new Date(G+1e3*F["max-age"]).toUTCString());const W=q.headers.get("Expires");if(!W||new Date(W).getTime()-G<42e4)return;let te=pr(z.url,{persistentParams:pi});if(V.status===206){const se=z.headers.get("Range");if(!se)return;q.status=200,te=ur(te,{range:se})}(function(se,le){if(di===void 0)try{new Response(new ReadableStream),di=!0}catch{di=!1}di?le(se.body):se.blob().then(le)})(V,se=>{const le=new Response((ne=V.status)!==200&&ne!==404&&[101,103,204,205,304].includes(ne)?null:se,q);var ne;On(),Or!=null&&Or.then(me=>me.put(te,le)).catch(me=>Jr(me.message))})}(m,O,M),b=!0,p(null,R,E.headers.get("Cache-Control"),E.headers.get("Expires")))}).catch(R=>{S||p(new Error(R.message))})};return A?function(E,O){if(On(),Or==null)return O(null);Or.then(M=>{let R=pr(E.url,{persistentParams:pi});const z=E.headers.get("Range");z&&(R=ur(R,{range:z})),M.match(R).then(V=>{const G=function(F){if(!F)return!1;const q=new Date(F.headers.get("Expires")||0),W=mh(F.headers.get("Cache-Control")||"");return q>Date.now()&&!W["no-cache"]}(V);M.delete(R),G&&M.put(R,V.clone()),O(null,V,G)}).catch(O)}).catch(O)}(m,w):w(null,null),{cancel:()=>{S=!0,b||h.abort()}}}(c,i);if(Kl()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,i,void 0,!0)}var o;return function(u,p){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const m in u.headers)h.setRequestHeader(m,u.headers[m]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{p(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let m=h.response;if(u.type==="json")try{m=JSON.parse(h.response)}catch(b){return p(b)}p(null,m,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else p(new dm(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(c,i)},Uc=function(c,i){return yh(Kr(c,{type:"arrayBuffer"}),i)};function fs(c){const i=document.createElement("a");return i.href=c,i.protocol===location.protocol&&i.host===location.host}const Ns="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let $s,Lo;$s=[],Lo=0;const fa=function(c,i){if(Yn.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Lo>=Se.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:c,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return $s.push(h),h}Lo++;let o=!1;const u=()=>{if(!o)for(o=!0,Lo--;$s.length&&Lo<Se.MAX_PARALLEL_IMAGE_REQUESTS;){const h=$s.shift(),{requestParameters:m,callback:b,cancelled:S}=h;S||(h.cancel=fa(m,b).cancel)}},p=Uc(c,(h,m,b,S)=>{u(),h?i(h):m&&(self.createImageBitmap?function(A,y){const w=new Blob([new Uint8Array(A)],{type:"image/png"});createImageBitmap(w).then(P=>{y(null,P)}).catch(P=>{y(new Error(`Could not load image because of ${P.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(A,y)=>i(A,y,b,S)):function(A,y){const w=new Image;w.onload=()=>{y(null,w),URL.revokeObjectURL(w.src),w.onload=null,requestAnimationFrame(()=>{w.src=Ns})},w.onerror=()=>y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const P=new Blob([new Uint8Array(A)],{type:"image/png"});w.src=A.byteLength?URL.createObjectURL(P):Ns}(m,(A,y)=>i(A,y,b,S)))});return{cancel:()=>{p.cancel(),u()}}};var vh,pm,mm,pa={exports:{}},tf={exports:{}},zy={exports:{}},F1=function(){if(mm)return pa.exports;mm=1;var c=(vh||(vh=1,tf.exports=function(o,u){var p,h,m,b,S,A,y,w;for(h=o.length-(p=3&o.length),m=u,S=3432918353,A=461845907,w=0;w<h;)y=255&o.charCodeAt(w)|(255&o.charCodeAt(++w))<<8|(255&o.charCodeAt(++w))<<16|(255&o.charCodeAt(++w))<<24,++w,m=27492+(65535&(b=5*(65535&(m=(m^=y=(65535&(y=(y=(65535&y)*S+(((y>>>16)*S&65535)<<16)&4294967295)<<15|y>>>17))*A+(((y>>>16)*A&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(y=0,p){case 3:y^=(255&o.charCodeAt(w+2))<<16;case 2:y^=(255&o.charCodeAt(w+1))<<8;case 1:m^=y=(65535&(y=(y=(65535&(y^=255&o.charCodeAt(w)))*S+(((y>>>16)*S&65535)<<16)&4294967295)<<15|y>>>17))*A+(((y>>>16)*A&65535)<<16)&4294967295}return m^=o.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}),tf.exports),i=(pm||(pm=1,zy.exports=function(o,u){for(var p,h=o.length,m=u^h,b=0;h>=4;)p=1540483477*(65535&(p=255&o.charCodeAt(b)|(255&o.charCodeAt(++b))<<8|(255&o.charCodeAt(++b))<<16|(255&o.charCodeAt(++b))<<24))+((1540483477*(p>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:m^=(255&o.charCodeAt(b+2))<<16;case 2:m^=(255&o.charCodeAt(b+1))<<8;case 1:m=1540483477*(65535&(m^=255&o.charCodeAt(b)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}),zy.exports);return pa.exports=c,pa.exports.murmur3=c,pa.exports.murmur2=i,pa.exports}(),Bo=N(F1);class fl{constructor(i,...o){Kr(this,o[0]||{}),this.type=i}}class bh extends fl{constructor(i,o={}){super("error",Kr({error:i},o))}}function Gc(c,i,o){o[c]&&o[c].indexOf(i)!==-1||(o[c]=o[c]||[],o[c].push(i))}function gm(c,i,o){if(o&&o[c]){const u=o[c].indexOf(i);u!==-1&&o[c].splice(u,1)}}class Hc{on(i,o){return this._listeners=this._listeners||{},Gc(i,o,this._listeners),this}off(i,o){return gm(i,o,this._listeners),gm(i,o,this._oneTimeListeners),this}once(i,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Gc(i,o,this._oneTimeListeners),this):new Promise(u=>this.once(i,u))}fire(i,o){const u=typeof i=="string"?new fl(i,o):i,p=u.type;if(this.listens(p)){u.target=this;const h=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const S of h)S.call(this,u);const m=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const S of m)gm(p,S,this._oneTimeListeners),S.call(this,u);const b=this._eventedParent;b&&(Kr(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(u))}else u instanceof bh&&console.error(u.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,o){return this._eventedParent=i,this._eventedParentData=o,this}}var _m,Qr={},ym=function(){if(_m)return Qr;_m=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(h){return(h=Math.round(h))<0?0:h>255?255:h}function o(h){return i(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(m=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:m>1?1:m;var m}function p(h,m,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?h+(m-h)*b*6:2*b<1?m:3*b<2?h+(m-h)*(2/3-b)*6:h}try{Qr.parseCSSColor=function(h){var m,b=h.replace(/ /g,"").toLowerCase();if(b in c)return c[b].slice();if(b[0]==="#")return b.length===4?(m=parseInt(b.substr(1),16))>=0&&m<=4095?[(3840&m)>>4|(3840&m)>>8,240&m|(240&m)>>4,15&m|(15&m)<<4,1]:null:b.length===7&&(m=parseInt(b.substr(1),16))>=0&&m<=16777215?[(16711680&m)>>16,(65280&m)>>8,255&m,1]:null;var S=b.indexOf("("),A=b.indexOf(")");if(S!==-1&&A+1===b.length){var y=b.substr(0,S),w=b.substr(S+1,A-(S+1)).split(","),P=1;switch(y){case"rgba":if(w.length!==4)return null;P=u(w.pop());case"rgb":return w.length!==3?null:[o(w[0]),o(w[1]),o(w[2]),P];case"hsla":if(w.length!==4)return null;P=u(w.pop());case"hsl":if(w.length!==3)return null;var E=(parseFloat(w[0])%360+360)%360/360,O=u(w[1]),M=u(w[2]),R=M<=.5?M*(O+1):M+O-M*O,z=2*M-R;return[i(255*p(z,R,E+1/3)),i(255*p(z,R,E)),i(255*p(z,R,E-1/3)),P];default:return null}}return null}}catch{}return Qr}();class li{constructor(i,o,u,p=1){this.r=i,this.g=o,this.b=u,this.a=p}static parse(i){if(!i)return;if(i instanceof li)return i;if(typeof i!="string")return;const o=ym.parseCSSColor(i);return o?new li(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[i,o,u,p]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(i)},${Math.round(o)},${Math.round(u)},${p})`}toRenderColor(i){const{r:o,g:u,b:p,a:h}=this;return new N1(i,o,u,p,h)}}class N1{constructor(i,o,u,p,h){if(i){const m=i.image.height,b=m*m;o=h===0?0:o/h*(m-1),u=h===0?0:u/h*(m-1),p=h===0?0:p/h*(m-1);const S=Math.floor(o),A=Math.floor(u),y=Math.floor(p),w=Math.ceil(o),P=Math.ceil(u),E=Math.ceil(p),O=o-S,M=u-A,R=p-y,z=i.image.data,V=4*(S+A*b+y*m),G=4*(S+A*b+E*m),F=4*(S+P*b+y*m),q=4*(S+P*b+E*m),W=4*(w+A*b+y*m),te=4*(w+A*b+E*m),se=4*(w+P*b+y*m),le=4*(w+P*b+E*m);if(V<0||le>=z.length)throw new Error("out of range");this.r=nr(nr(nr(z[V],z[G],R),nr(z[F],z[q],R),M),nr(nr(z[W],z[te],R),nr(z[se],z[le],R),M),O)/255*h,this.g=nr(nr(nr(z[V+1],z[G+1],R),nr(z[F+1],z[q+1],R),M),nr(nr(z[W+1],z[te+1],R),nr(z[se+1],z[le+1],R),M),O)/255*h,this.b=nr(nr(nr(z[V+2],z[G+2],R),nr(z[F+2],z[q+2],R),M),nr(nr(z[W+2],z[te+2],R),nr(z[se+2],z[le+2],R),M),O)/255*h,this.a=h}else this.r=o,this.g=u,this.b=p,this.a=h}toArray(){const{r:i,g:o,b:u,a:p}=this;return p===0?[0,0,0,0]:[255*i/p,255*o/p,255*u/p,p]}toArray01(){const{r:i,g:o,b:u,a:p}=this;return p===0?[0,0,0,0]:[i/p,o/p,u/p,p]}toArray01Scaled(i){const{r:o,g:u,b:p,a:h}=this;return h===0?[0,0,0]:[o/h*i,u/h*i,p/h*i]}toArray01PremultipliedAlpha(){const{r:i,g:o,b:u,a:p}=this;return[i,o,u,p]}toArray01Linear(){const{r:i,g:o,b:u,a:p}=this;return p===0?[0,0,0,0]:[Math.pow(i/p,2.2),Math.pow(o/p,2.2),Math.pow(u/p,2.2),p]}}function nr(c,i,o){return c*(1-o)+i*o}function xh(c,i,o){return c.map((u,p)=>nr(u,i[p],o))}li.black=new li(0,0,0,1),li.white=new li(1,1,1,1),li.transparent=new li(0,0,0,0),li.red=new li(1,0,0,1),li.blue=new li(0,0,1,1);var Jl=Object.freeze({__proto__:null,array:xh,color:function(c,i,o){return new li(nr(c.r,i.r,o),nr(c.g,i.g,o),nr(c.b,i.b,o),nr(c.a,i.a,o))},number:nr});function qc(c,...i){for(const o of i)for(const u in o)c[u]=o[u];return c}class ma extends Error{constructor(i,o){super(o),this.message=o,this.key=i}}class rf{constructor(i,o=[]){this.parent=i,this.bindings={};for(const[u,p]of o)this.bindings[u]=p}concat(i){return new rf(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const js={kind:"null"},Ut={kind:"number"},qr={kind:"string"},Wr={kind:"boolean"},ko={kind:"color"},co={kind:"object"},Yr={kind:"value"},nf={kind:"collator"},Wc={kind:"formatted"},Zc={kind:"resolvedImage"};function wo(c,i){return{kind:"array",itemType:c,N:i}}function cn(c){if(c.kind==="array"){const i=cn(c.itemType);return typeof c.N=="number"?`array<${i}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${i}>`}return c.kind}const Fy=[js,Ut,qr,Wr,ko,Wc,co,wo(Yr),Zc];function Xc(c,i){if(i.kind==="error")return null;if(c.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Xc(c.itemType,i.itemType))&&(typeof c.N!="number"||c.N===i.N))return null}else{if(c.kind===i.kind)return null;if(c.kind==="value"){for(const o of Fy)if(!Xc(o,i))return null}}return`Expected ${cn(c)} but found ${cn(i)} instead.`}function Kc(c,i){return i.some(o=>o.kind===c.kind)}function ga(c,i){return i.some(o=>o==="null"?c===null:o==="array"?Array.isArray(c):o==="object"?c&&!Array.isArray(c)&&typeof c=="object":o===typeof c)}class of{constructor(i,o,u){this.sensitivity=i?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,o){return this.collator.compare(i,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zo{constructor(i,o,u,p,h){this.text=i.normalize?i.normalize():i,this.image=o,this.scale=u,this.fontStack=p,this.textColor=h}}class uo{constructor(i){this.sections=i}static fromString(i){return new uo([new Zo(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||i.image&&i.image.namePrimary.length!==0)}static factory(i){return i instanceof uo?i:uo.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const o of this.sections){if(o.image){i.push(["image",o.image.namePrimary]);continue}i.push(o.text);const u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toRenderColor(null).toArray())),i.push(u)}return i}}class To{constructor(i){this.namePrimary=i.namePrimary,i.nameSecondary&&(this.nameSecondary=i.nameSecondary),this.available=i.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(i,o){return i?new To({namePrimary:i,nameSecondary:o,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Ny(c,i,o,u){return typeof c=="number"&&c>=0&&c<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,i,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,i,o,u]:[c,i,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pl(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof li||c instanceof of||c instanceof uo||c instanceof To)return!0;if(Array.isArray(c)){for(const i of c)if(!pl(i))return!1;return!0}if(typeof c=="object"){for(const i in c)if(!pl(c[i]))return!1;return!0}return!1}function bn(c){if(c===null)return js;if(typeof c=="string")return qr;if(typeof c=="boolean")return Wr;if(typeof c=="number")return Ut;if(c instanceof li)return ko;if(c instanceof of)return nf;if(c instanceof uo)return Wc;if(c instanceof To)return Zc;if(Array.isArray(c)){const i=c.length;let o;for(const u of c){const p=bn(u);if(o){if(o===p)continue;o=Yr;break}o=p}return wo(o||Yr,i)}return co}function Eo(c){const i=typeof c;return c===null?"":i==="string"||i==="number"||i==="boolean"?String(c):c instanceof li||c instanceof uo||c instanceof To?c.toString():JSON.stringify(c)}class Vs{constructor(i,o){this.type=i,this.value=o}static parse(i,o){if(i.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!pl(i[1]))return o.error("invalid value");const u=i[1];let p=bn(u);const h=o.expectedType;return p.kind!=="array"||p.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(p=h),new Vs(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof li?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof uo?this.value.serialize():this.value}}class $n{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const vm={string:qr,number:Ut,boolean:Wr,object:co};class Us{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");let u,p=1;const h=i[0];if(h==="array"){let b,S;if(i.length>2){const A=i[1];if(typeof A!="string"||!(A in vm)||A==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=vm[A],p++}else b=Yr;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=i[2],p++}u=wo(b,S)}else u=vm[h];const m=[];for(;p<i.length;p++){const b=o.parse(i[p],p,Yr);if(!b)return null;m.push(b)}return new Us(u,m)}evaluate(i){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(i);if(!Xc(this.type,bn(u)))return u;if(o===this.args.length-1)throw new $n(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${cn(bn(u))} but was expected to be of type ${cn(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,o=[i.kind];if(i.kind==="array"){const u=i.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);const p=i.N;(typeof p=="number"||this.args.length>1)&&o.push(p)}}return o.concat(this.args.map(u=>u.serialize()))}}class Yc{constructor(i){this.type=Wc,this.sections=i}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const u=i[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const p=[];let h=!1;for(let m=1;m<=i.length-1;++m){const b=i[m];if(h&&typeof b=="object"&&!Array.isArray(b)){h=!1;let S=null;if(b["font-scale"]&&(S=o.parseObjectValue(b["font-scale"],m,"font-scale",Ut),!S))return null;let A=null;if(b["text-font"]&&(A=o.parseObjectValue(b["text-font"],m,"text-font",wo(qr)),!A))return null;let y=null;if(b["text-color"]&&(y=o.parseObjectValue(b["text-color"],m,"text-color",ko),!y))return null;const w=p[p.length-1];w.scale=S,w.font=A,w.textColor=y}else{const S=o.parse(i[m],m,Yr);if(!S)return null;const A=S.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,p.push({content:S,scale:null,font:null,textColor:null})}}return new Yc(p)}evaluate(i){return new uo(this.sections.map(o=>{const u=o.content.evaluate(i);return bn(u)===Zc?new Zo("",u,null,null,null):new Zo(Eo(u),null,o.scale?o.scale.evaluate(i):null,o.font?o.font.evaluate(i).join(","):null,o.textColor?o.textColor.evaluate(i):null)}))}eachChild(i){for(const o of this.sections)i(o.content),o.scale&&i(o.scale),o.font&&i(o.font),o.textColor&&i(o.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const o of this.sections){i.push(o.content.serialize());const u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),i.push(u)}return i}}class Ql{constructor(i,o){this.type=Zc,this.inputPrimary=i,this.inputSecondary=o}static parse(i,o){if(i.length<2)return o.error("Expected two or more arguments.");const u=o.parse(i[1],1,qr);if(!u)return o.error("No image name provided.");if(i.length===2)return new Ql(u);const p=o.parse(i[2],1,qr);return p?new Ql(u,p):o.error("Secondary image variant is not a string.")}evaluate(i){const o=To.fromString(this.inputPrimary.evaluate(i),this.inputSecondary?this.inputSecondary.evaluate(i):void 0);return o&&i.availableImages&&(o.available=i.availableImages.indexOf(o.namePrimary)>-1,o.nameSecondary&&o.available&&i.availableImages&&(o.available=i.availableImages.indexOf(o.nameSecondary)>-1)),o}eachChild(i){i(this.inputPrimary),this.inputSecondary&&i(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ec(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const sf={"to-boolean":Wr,"to-color":ko,"to-number":Ut,"to-string":qr};class Fa{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expected at least one argument.");const u=i[0],p=[];let h=js;if(u==="to-array"){if(!Array.isArray(i[1]))return null;const m=i[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);h=wo(o.expectedType.itemType,m)}else{if(!(m>0&&pl(i[1][0])))return null;h=wo(bn(i[1][0]),m)}for(let b=0;b<m;b++){const S=i[1][b];let A;if(ec(S)==="array")A=o.parse(S,void 0,h.itemType);else{const y=ec(S);if(y!==h.itemType.kind)return o.error(`Expected ${h.itemType.kind} but found ${y}.`);A=o.registry.literal.parse(["literal",S===void 0?null:S],o)}if(!A)return null;p.push(A)}}else{if((u==="to-boolean"||u==="to-string")&&i.length!==2)return o.error("Expected one argument.");h=sf[u];for(let m=1;m<i.length;m++){const b=o.parse(i[m],m,Yr);if(!b)return null;p.push(b)}}return new Fa(h,p)}evaluate(i){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(i));if(this.type.kind==="color"){let o,u;for(const p of this.args){if(o=p.evaluate(i),u=null,o instanceof li)return o;if(typeof o=="string"){const h=i.parseColor(o);if(h)return h}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ny(o[0],o[1],o[2],o[3]),!u))return new li(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new $n(u||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(i),o===null)return 0;const p=Number(o);if(!isNaN(p))return p}throw new $n(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?uo.fromString(Eo(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?To.fromString(Eo(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(o=>o.evaluate(i)):Eo(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Yc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ql(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{i.push(o.serialize())}),i}}const $1=["Unknown","Point","LineString","Polygon"];class $y{constructor(i,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?$1[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:u,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*o-i[0])+this.featureDistanceData.bearing[1]*(p*o-i[1])}return 0}parseColor(i){let o=this._parseColorCache[i];return o||(o=this._parseColorCache[i]=li.parse(i)),o}getConfig(i){return this.options?this.options.get(i):null}}class zo{constructor(i,o,u,p,h){this.name=i,this.type=o,this._evaluate=u,this.args=p,this._overloadIndex=h}evaluate(i){if(!this._evaluate){const o=zo.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,o){const u=i[0],p=zo.definitions[u];if(!p)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(p)?p[0]:p.type,m=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,b=[];let S=null,A=-1;for(const[y,w]of m){if(Array.isArray(y)&&y.length!==i.length-1)continue;b.push(y),A++,S=new Jy(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const P=[];let E=!1;for(let O=1;O<i.length;O++){const M=i[O],R=Array.isArray(y)?y[O-1]:y.type,z=S.parse(M,1+P.length,R);if(!z){E=!0;break}P.push(z)}if(!E)if(Array.isArray(y)&&y.length!==P.length)S.error(`Expected ${y.length} arguments, but found ${P.length} instead.`);else{for(let O=0;O<P.length;O++){const M=Array.isArray(y)?y[O]:y.type,R=P[O];S.concat(O+1).checkSubtype(M,R.type)}if(S.errors.length===0)return new zo(u,h,w,P,A)}}if(b.length===1)o.errors.push(...S.errors);else{const y=(b.length?b:m.map(([P])=>P)).map(j1).join(" | "),w=[];for(let P=1;P<i.length;P++){const E=o.parse(i[P],1+w.length);if(!E)return null;w.push(cn(E.type))}o.error(`Expected arguments of type ${y}, but found (${w.join(", ")}) instead.`)}return null}static register(i,o){zo.definitions=o;for(const u in o)i[u]=zo}}function j1(c){return Array.isArray(c)?`(${c.map(cn).join(", ")})`:`(${cn(c.type)}...)`}class af{constructor(i,o,u){this.type=nf,this.locale=u,this.caseSensitive=i,this.diacriticSensitive=o}static parse(i,o){if(i.length!==2)return o.error("Expected one argument.");const u=i[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const p=u["case-sensitive"]===void 0?o.parse(!1,1,Wr):o.parseObjectValue(u["case-sensitive"],1,"case-sensitive",Wr);if(!p)return null;const h=u["diacritic-sensitive"]===void 0?o.parse(!1,1,Wr):o.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",Wr);if(!h)return null;let m=null;return u.locale&&(m=o.parseObjectValue(u.locale,1,"locale",qr),!m)?null:new af(p,h,m)}evaluate(i){return new of(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function jy(c,i,o=0,u=c.length-1,p=Qc){for(;u>o;){if(u-o>600){const S=u-o+1,A=i-o+1,y=Math.log(S),w=.5*Math.exp(2*y/3),P=.5*Math.sqrt(y*w*(S-w)/S)*(A-S/2<0?-1:1);jy(c,i,Math.max(o,Math.floor(i-A*w/S+P)),Math.min(u,Math.floor(i+(S-A)*w/S+P)),p)}const h=c[i];let m=o,b=u;for(Jc(c,o,i),p(c[u],h)>0&&Jc(c,o,u);m<b;){for(Jc(c,m,b),m++,b--;p(c[m],h)<0;)m++;for(;p(c[b],h)>0;)b--}p(c[o],h)===0?Jc(c,o,b):(b++,Jc(c,b,u)),b<=i&&(o=b+1),i<=b&&(u=b-1)}}function Jc(c,i,o){const u=c[i];c[i]=c[o],c[o]=u}function Qc(c,i){return c<i?-1:c>i?1:0}function V1(c){let i=0;for(let o,u,p=0,h=c.length,m=h-1;p<h;m=p++)o=c[p],u=c[m],i+=(u.x-o.x)*(o.y+u.y);return i}function wh(c,i){c[0]=Math.min(c[0],i[0]),c[1]=Math.min(c[1],i[1]),c[2]=Math.max(c[2],i[0]),c[3]=Math.max(c[3],i[1])}function tc(c,i){return!(c[0]<=i[0]||c[2]>=i[2]||c[1]<=i[1]||c[3]>=i[3])}function U1(c,i,o){const u=c[0]-i[0],p=c[1]-i[1],h=c[0]-o[0],m=c[1]-o[1];return u*m-h*p==0&&u*h<=0&&p*m<=0}function eu(c,i,o=!1){let u=!1;for(let b=0,S=i.length;b<S;b++){const A=i[b];for(let y=0,w=A.length,P=w-1;y<w;P=y++){const E=A[P],O=A[y];if(U1(c,E,O))return o;(h=E)[1]>(p=c)[1]!=(m=O)[1]>p[1]&&p[0]<(m[0]-h[0])*(p[1]-h[1])/(m[1]-h[1])+h[0]&&(u=!u)}}var p,h,m;return u}function Vy(c,i,o,u){const p=u[0]-o[0],h=u[1]-o[1],m=(c[0]-o[0])*h-p*(c[1]-o[1]),b=(i[0]-o[0])*h-p*(i[1]-o[1]);return m>0&&b<0||m<0&&b>0}function lf(c,i,o,u){return(p=[u[0]-o[0],u[1]-o[1]])[0]*(h=[i[0]-c[0],i[1]-c[1]])[1]-p[1]*h[0]!=0&&!(!Vy(c,i,o,u)||!Vy(o,u,c,i));var p,h}const Xo=8192;function kr(c,i){const o=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,p=Math.pow(2,i.z);return[Math.round(o*p*Xo),Math.round(u*p*Xo)]}function Qt(c,i){for(let o=0;o<i.length;o++)if(eu(c,i[o]))return!0;return!1}function bm(c,i,o){for(const u of o)for(let p=0,h=u.length,m=h-1;p<h;m=p++)if(lf(c,i,u[m],u[p]))return!0;return!1}function yr(c,i){for(let o=0;o<c.length;++o)if(!eu(c[o],i))return!1;for(let o=0;o<c.length-1;++o)if(bm(c[o],c[o+1],i))return!1;return!0}function xm(c,i){for(let o=0;o<i.length;o++)if(yr(c,i[o]))return!0;return!1}function Th(c,i,o){const u=[];for(let p=0;p<c.length;p++){const h=[];for(let m=0;m<c[p].length;m++){const b=kr(c[p][m],o);wh(i,b),h.push(b)}u.push(h)}return u}function lr(c,i,o){const u=[];for(let p=0;p<c.length;p++){const h=Th(c[p],i,o);u.push(h)}return u}function wm(c,i,o,u){if(c[0]<o[0]||c[0]>o[2]){const p=.5*u;let h=c[0]-o[0]>p?-u:o[0]-c[0]>p?u:0;h===0&&(h=c[0]-o[2]>p?-u:o[2]-c[0]>p?u:0),c[0]+=h}wh(i,c)}function cf(c,i,o,u){const p=Math.pow(2,u.z)*Xo,h=[u.x*Xo,u.y*Xo],m=[];if(!c)return m;for(const b of c)for(const S of b){const A=[S.x+h[0],S.y+h[1]];wm(A,i,o,p),m.push(A)}return m}function Tm(c,i,o,u){const p=Math.pow(2,u.z)*Xo,h=[u.x*Xo,u.y*Xo],m=[];if(!c)return m;for(const S of c){const A=[];for(const y of S){const w=[y.x+h[0],y.y+h[1]];wh(i,w),A.push(w)}m.push(A)}if(i[2]-i[0]<=p/2){(b=i)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of m)for(const A of S)wm(A,i,o,p)}var b;return m}class ml{constructor(i,o){this.type=Wr,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(pl(i[1])){const u=i[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){const h=u.features[p].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new ml(u,u.features[p].geometry)}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new ml(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new ml(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(o,u){const p=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(u.type==="Polygon"){const b=Th(u.coordinates,h,m),S=cf(o.geometry(),p,h,m);if(!tc(p,h))return!1;for(const A of S)if(!eu(A,b))return!1}if(u.type==="MultiPolygon"){const b=lr(u.coordinates,h,m),S=cf(o.geometry(),p,h,m);if(!tc(p,h))return!1;for(const A of S)if(!Qt(A,b))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(o,u){const p=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(u.type==="Polygon"){const b=Th(u.coordinates,h,m),S=Tm(o.geometry(),p,h,m);if(!tc(p,h))return!1;for(const A of S)if(!yr(A,b))return!1}if(u.type==="MultiPolygon"){const b=lr(u.coordinates,h,m),S=Tm(o.geometry(),p,h,m);if(!tc(p,h))return!1;for(const A of S)if(!xm(A,b))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const rc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},ro=1/298.257223563,uf=ro*(2-ro),tu=Math.PI/180;class ru{static fromTile(i,o,u){const p=Math.PI*(1-2*(i+.5)/Math.pow(2,o)),h=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/tu;return new ru(h,u)}static get units(){return rc}constructor(i,o){if(i===void 0)throw new Error("No latitude given.");if(o&&!rc[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(rc).join(", ")}`);const u=6378.137*tu*(o?rc[o]:1),p=Math.cos(i*tu),h=1/(1-uf*(1-p*p)),m=Math.sqrt(h);this.kx=u*m*p,this.ky=u*m*h*(1-uf)}distance(i,o){const u=Ji(i[0]-o[0])*this.kx,p=(i[1]-o[1])*this.ky;return Math.sqrt(u*u+p*p)}bearing(i,o){const u=Ji(o[0]-i[0])*this.kx;return Math.atan2(u,(o[1]-i[1])*this.ky)/tu}destination(i,o,u){const p=u*tu;return this.offset(i,Math.sin(p)*o,Math.cos(p)*o)}offset(i,o,u){return[i[0]+o/this.kx,i[1]+u/this.ky]}lineDistance(i){let o=0;for(let u=0;u<i.length-1;u++)o+=this.distance(i[u],i[u+1]);return o}area(i){let o=0;for(let u=0;u<i.length;u++){const p=i[u];for(let h=0,m=p.length,b=m-1;h<m;b=h++)o+=Ji(p[h][0]-p[b][0])*(p[h][1]+p[b][1])*(u?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(i,o){let u=0;if(o<=0)return i[0];for(let p=0;p<i.length-1;p++){const h=i[p],m=i[p+1],b=this.distance(h,m);if(u+=b,u>o)return Na(h,m,(o-(u-b))/b)}return i[i.length-1]}pointToSegmentDistance(i,o,u){let[p,h]=o,m=Ji(u[0]-p)*this.kx,b=(u[1]-h)*this.ky;if(m!==0||b!==0){const S=(Ji(i[0]-p)*this.kx*m+(i[1]-h)*this.ky*b)/(m*m+b*b);S>1?(p=u[0],h=u[1]):S>0&&(p+=m/this.kx*S,h+=b/this.ky*S)}return m=Ji(i[0]-p)*this.kx,b=(i[1]-h)*this.ky,Math.sqrt(m*m+b*b)}pointOnLine(i,o){let u=1/0,p=i[0][0],h=i[0][1],m=0,b=0;for(let S=0;S<i.length-1;S++){let A=i[S][0],y=i[S][1],w=Ji(i[S+1][0]-A)*this.kx,P=(i[S+1][1]-y)*this.ky,E=0;w===0&&P===0||(E=(Ji(o[0]-A)*this.kx*w+(o[1]-y)*this.ky*P)/(w*w+P*P),E>1?(A=i[S+1][0],y=i[S+1][1]):E>0&&(A+=w/this.kx*E,y+=P/this.ky*E)),w=Ji(o[0]-A)*this.kx,P=(o[1]-y)*this.ky;const O=w*w+P*P;O<u&&(u=O,p=A,h=y,m=S,b=E)}return{point:[p,h],index:m,t:Math.max(0,Math.min(1,b))}}lineSlice(i,o,u){let p=this.pointOnLine(u,i),h=this.pointOnLine(u,o);if(p.index>h.index||p.index===h.index&&p.t>h.t){const A=p;p=h,h=A}const m=[p.point],b=p.index+1,S=h.index;!hf(u[b],m[0])&&b<=S&&m.push(u[b]);for(let A=b+1;A<=S;A++)m.push(u[A]);return hf(u[S],h.point)||m.push(h.point),m}lineSliceAlong(i,o,u){let p=0;const h=[];for(let m=0;m<u.length-1;m++){const b=u[m],S=u[m+1],A=this.distance(b,S);if(p+=A,p>i&&h.length===0&&h.push(Na(b,S,(i-(p-A))/A)),p>=o)return h.push(Na(b,S,(o-(p-A))/A)),h;p>i&&h.push(S)}return h}bufferPoint(i,o){const u=o/this.ky,p=o/this.kx;return[i[0]-p,i[1]-u,i[0]+p,i[1]+u]}bufferBBox(i,o){const u=o/this.ky,p=o/this.kx;return[i[0]-p,i[1]-u,i[2]+p,i[3]+u]}insideBBox(i,o){return Ji(i[0]-o[0])>=0&&Ji(i[0]-o[2])<=0&&i[1]>=o[1]&&i[1]<=o[3]}}function hf(c,i){return c[0]===i[0]&&c[1]===i[1]}function Na(c,i,o){const u=Ji(i[0]-c[0]);return[c[0]+u*o,c[1]+(i[1]-c[1])*o]}function Ji(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class Em{constructor(i=[],o=(u,p)=>u<p?-1:u>p?1:0){if(this.data=i,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:o,compare:u}=this,p=o[i];for(;i>0;){const h=i-1>>1,m=o[h];if(u(p,m)>=0)break;o[i]=m,i=h}o[i]=p}_down(i){const{data:o,compare:u}=this,p=this.length>>1,h=o[i];for(;i<p;){let m=1+(i<<1);const b=m+1;if(b<this.length&&u(o[b],o[m])<0&&(m=b),u(o[m],h)>=0)break;o[i]=o[m],i=m}o[i]=h}}var It=8192;function Uy(c,i){return i.dist-c.dist}const iu=100,df=50;function ff(c){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==c.length)return!1;for(let o=0;o<i.length;o++)if(i[o]!==c[o])return!1;return!0}function pf(c){return c[1]-c[0]+1}function $a(c,i){const o=c[1]>=c[0]&&c[1]<i;return o||console.warn("Distance Expression: Index is out of range"),o}function Sm(c,i){if(c[0]>c[1])return[null,null];const o=pf(c);if(i){if(o===2)return[c,null];const u=Math.floor(o/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(o===1)return[c,null];const u=Math.floor(o/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function Ko(c,i){const o=[1/0,1/0,-1/0,-1/0];if(!$a(i,c.length))return o;for(let u=i[0];u<=i[1];++u)wh(o,c[u]);return o}function mf(c){const i=[1/0,1/0,-1/0,-1/0];for(let o=0;o<c.length;++o)for(let u=0;u<c[o].length;++u)wh(i,c[o][u]);return i}function nu(c,i,o){if(ff(c)||ff(i))return NaN;let u=0,p=0;return c[2]<i[0]&&(u=i[0]-c[2]),c[0]>i[2]&&(u=c[0]-i[2]),c[1]>i[3]&&(p=c[1]-i[3]),c[3]<i[1]&&(p=i[1]-c[3]),o.distance([0,0],[u,p])}function Gy(c){return 360*c-180}function Hy(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Yo(c,i){const o=Math.pow(2,i.z),u=(c.y/It+i.y)/o;return[Gy((c.x/It+i.x)/o),Hy(u)]}function qy(c,i){const o=[];for(let u=0;u<c.length;++u)o.push(Yo(c[u],i));return o}function Om(c,i,o){const u=o.pointOnLine(i,c).point;return o.distance(c,u)}function Pm(c,i,o,u,p){const h=o.slice(u[0],u[1]+1);let m=1/0;for(let b=i[0];b<=i[1];++b)if((m=Math.min(m,Om(c[b],h,p)))===0)return 0;return m}function gf(c,i,o,u,p){const h=Math.min(p.pointToSegmentDistance(c,o,u),p.pointToSegmentDistance(i,o,u)),m=Math.min(p.pointToSegmentDistance(o,c,i),p.pointToSegmentDistance(u,c,i));return Math.min(h,m)}function Wy(c,i,o,u,p){if(!$a(i,c.length)||!$a(u,o.length))return NaN;let h=1/0;for(let m=i[0];m<i[1];++m)for(let b=u[0];b<u[1];++b){if(lf(c[m],c[m+1],o[b],o[b+1]))return 0;h=Math.min(h,gf(c[m],c[m+1],o[b],o[b+1],p))}return h}function Zy(c,i,o,u,p){if(!$a(i,c.length)||!$a(u,o.length))return NaN;let h=1/0;for(let m=i[0];m<=i[1];++m)for(let b=u[0];b<=u[1];++b)if((h=Math.min(h,p.distance(c[m],o[b])))===0)return h;return h}function Xy(c,i,o){if(eu(c,i,!0))return 0;let u=1/0;for(const p of i){const h=p.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[h-1]&&(u=Math.min(u,o.pointToSegmentDistance(c,p[h-1],p[0])))===0||(u=Math.min(u,Om(c,p,o)))===0)return u}return u}function Ky(c,i,o,u){if(!$a(i,c.length))return NaN;for(let h=i[0];h<=i[1];++h)if(eu(c[h],o,!0))return 0;let p=1/0;for(let h=i[0];h<i[1];++h)for(const m of o)for(let b=0,S=m.length,A=S-1;b<S;A=b++){if(lf(c[h],c[h+1],m[A],m[b]))return 0;p=Math.min(p,gf(c[h],c[h+1],m[A],m[b],u))}return p}function Am(c,i){for(const o of c)for(let u=0;u<=o.length-1;++u)if(eu(o[u],i,!0))return!0;return!1}function Yy(c,i,o,u=1/0){const p=mf(c),h=mf(i);if(u!==1/0&&nu(p,h,o)>=u)return u;if(tc(p,h)){if(Am(c,i))return 0}else if(Am(i,c))return 0;let m=u;for(const b of c)for(let S=0,A=b.length,y=A-1;S<A;y=S++)for(const w of i)for(let P=0,E=w.length,O=E-1;P<E;O=P++){if(lf(b[y],b[S],w[O],w[P]))return 0;m=Math.min(m,gf(b[y],b[S],w[O],w[P],o))}return m}function Eh(c,i,o,u,p,h,m){if(h===null||m===null)return;const b=nu(Ko(u,h),Ko(p,m),o);b<i&&c.push({dist:b,range1:h,range2:m})}function _f(c,i,o,u,p=1/0){let h=Math.min(u.distance(c[0],o[0][0]),p);if(h===0)return h;const m=new Em([{dist:0,range1:[0,c.length-1],range2:[0,0]}],Uy),b=i?df:iu,S=mf(o);for(;m.length;){const A=m.pop();if(A.dist>=h)continue;const y=A.range1;if(pf(y)<=b){if(!$a(y,c.length))return NaN;if(i){const w=Ky(c,y,o,u);if((h=Math.min(h,w))===0)return h}else for(let w=y[0];w<=y[1];++w){const P=Xy(c[w],o,u);if((h=Math.min(h,P))===0)return h}}else{const w=Sm(y,i);if(w[0]!==null){const P=nu(Ko(c,w[0]),S,u);P<h&&m.push({dist:P,range1:w[0],range2:[0,0]})}if(w[1]!==null){const P=nu(Ko(c,w[1]),S,u);P<h&&m.push({dist:P,range1:w[1],range2:[0,0]})}}}return h}function Sh(c,i,o,u,p,h=1/0){let m=Math.min(h,p.distance(c[0],o[0]));if(m===0)return m;const b=new Em([{dist:0,range1:[0,c.length-1],range2:[0,o.length-1]}],Uy),S=i?df:iu,A=u?df:iu;for(;b.length;){const y=b.pop();if(y.dist>=m)continue;const w=y.range1,P=y.range2;if(pf(w)<=S&&pf(P)<=A){if(!$a(w,c.length)||!$a(P,o.length))return NaN;if(i&&u?m=Math.min(m,Wy(c,w,o,P,p)):i||u?i&&!u?m=Math.min(m,Pm(o,P,c,w,p)):!i&&u&&(m=Math.min(m,Pm(c,w,o,P,p))):m=Math.min(m,Zy(c,w,o,P,p)),m===0)return m}else{const E=Sm(w,i),O=Sm(P,u);Eh(b,m,p,c,o,E[0],O[0]),Eh(b,m,p,c,o,E[0],O[1]),Eh(b,m,p,c,o,E[1],O[0]),Eh(b,m,p,c,o,E[1],O[1])}}return m}function ou(c,i,o,u,p=1/0){let h=p;const m=Ko(c,[0,c.length-1]);for(const b of o)if(!(h!==1/0&&nu(m,Ko(b,[0,b.length-1]),u)>=h)&&(h=Math.min(h,Sh(c,i,b,!0,u,h)),h===0))return h;return h}function Oh(c,i,o,u,p=1/0){let h=p;const m=Ko(c,[0,c.length-1]);for(const b of o){if(h!==1/0&&nu(m,mf(b),u)>=h)continue;const S=_f(c,i,b,u,h);if(isNaN(S))return S;if((h=Math.min(h,S))===0)return h}return h}function yf(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class gl{constructor(i,o){this.type=Ut,this.geojson=i,this.geometries=o}static parse(i,o){if(i.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(pl(i[1])){const u=i[1];if(u.type==="FeatureCollection"){for(let p=0;p<u.features.length;++p)if(yf(u.features[p].geometry.type))return new gl(u,u.features[p].geometry)}else if(u.type==="Feature"){if(yf(u.geometry.type))return new gl(u,u.geometry)}else if(yf(u.type))return new gl(u,u)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const o=i.geometry(),u=i.canonicalID();if(o!=null&&u!=null){if(i.geometryType()==="Point")return function(p,h,m){const b=[];for(const A of p)for(const y of A)b.push(Yo(y,h));const S=new ru(b[0][1],"meters");return m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString"?Sh(b,!1,m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",S):m.type==="MultiLineString"?ou(b,!1,m.coordinates,S):m.type==="Polygon"||m.type==="MultiPolygon"?Oh(b,!1,m.type==="Polygon"?[m.coordinates]:m.coordinates,S):null}(o,u,this.geometries);if(i.geometryType()==="LineString")return function(p,h,m){const b=[];for(const A of p){const y=[];for(const w of A)y.push(Yo(w,h));b.push(y)}const S=new ru(b[0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return ou(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",b,S);if(m.type==="MultiLineString"){let A=1/0;for(let y=0;y<m.coordinates.length;y++){const w=ou(m.coordinates[y],!0,b,S,A);if(isNaN(w))return w;if((A=Math.min(A,w))===0)return A}return A}if(m.type==="Polygon"||m.type==="MultiPolygon"){let A=1/0;for(let y=0;y<b.length;y++){const w=Oh(b[y],!0,m.type==="Polygon"?[m.coordinates]:m.coordinates,S,A);if(isNaN(w))return w;if((A=Math.min(A,w))===0)return A}return A}return null}(o,u,this.geometries);if(i.geometryType()==="Polygon")return function(p,h,m){const b=[];for(const A of function(y,w){const P=y.length;if(P<=1)return[y];const E=[];let O,M;for(let R=0;R<P;R++){const z=V1(y[R]);z!==0&&(y[R].area=Math.abs(z),M===void 0&&(M=z<0),M===z<0?(O&&E.push(O),O=[y[R]]):O.push(y[R]))}return O&&E.push(O),E}(p)){const y=[];for(let w=0;w<A.length;++w)y.push(qy(A[w],h));b.push(y)}const S=new ru(b[0][0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return Oh(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",b,S);if(m.type==="MultiLineString"){let A=1/0;for(let y=0;y<m.coordinates.length;y++){const w=Oh(m.coordinates[y],!0,b,S,A);if(isNaN(w))return w;if((A=Math.min(A,w))===0)return A}return A}return m.type==="Polygon"||m.type==="MultiPolygon"?function(A,y,w){let P=1/0;for(const E of A)for(const O of y){const M=Yy(E,O,w,P);if(isNaN(M))return M;if((P=Math.min(P,M))===0)return P}return P}(m.type==="Polygon"?[m.coordinates]:m.coordinates,b,S):null}(o,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function _l(c,i){switch(c){case"string":return Eo(i);case"number":return+i;case"boolean":return!!i;case"color":return li.parse(i);case"formatted":return uo.fromString(Eo(i));case"resolvedImage":return To.fromString(Eo(i))}return i}function Zr(c,i,o,u){return u!==void 0&&(c=u*Math.round(c/u)),i!==void 0&&c<i&&(c=i),o!==void 0&&c>o&&(c=o),c}class su{constructor(i,o,u){this.type=i,this.key=o,this.scope=u}static parse(i,o){let u=o.expectedType;if(u==null&&(u=Yr),i.length<2||i.length>3)return o.error("Invalid number of arguments for 'config' expression.");const p=o.parse(i[1],1);if(!(p instanceof Vs))return o.error("Key name of 'config' expression must be a string literal.");if(i.length>=3){const h=o.parse(i[2],2);return h instanceof Vs?new su(u,Eo(p.value),Eo(h.value)):o.error("Scope of 'config' expression must be a string literal.")}return new su(u,Eo(p.value))}evaluate(i){const o=[this.key,this.scope,i.scope].filter(Boolean).join(""),u=i.getConfig(o);if(!u)return null;const{type:p,value:h,values:m,minValue:b,maxValue:S,stepValue:A}=u,y=u.default.evaluate(i);let w=y;if(h){const P=i.scope;i.scope=(P||"").split("").slice(1).join(""),w=h.evaluate(i),i.scope=P}return p&&(w=_l(p,w)),w===void 0||b===void 0&&S===void 0&&A===void 0||(typeof w=="number"?w=Zr(w,b,S,A):Array.isArray(w)&&(w=w.map(P=>typeof P=="number"?Zr(P,b,S,A):P))),h!==void 0&&w!==void 0&&m&&!m.includes(w)&&(w=y,p&&(w=_l(p,w))),(p&&p!==this.type||w!==void 0&&bn(w)!==this.type)&&(w=_l(this.type.kind,w)),w}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.key),i}}function Ph(c){if(c instanceof zo&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof ml||c instanceof gl)return!1;let i=!0;return c.eachChild(o=>{i&&!Ph(o)&&(i=!1)}),i}function vf(c){if(c instanceof zo&&c.name==="feature-state")return!1;let i=!0;return c.eachChild(o=>{i&&!vf(o)&&(i=!1)}),i}function bf(c){if(c instanceof su)return new Set([c.key]);let i=new Set;return c.eachChild(o=>{i=new Set([...i,...bf(o)])}),i}function Ah(c,i){if(c instanceof zo&&i.indexOf(c.name)>=0)return!1;let o=!0;return c.eachChild(u=>{o&&!Ah(u,i)&&(o=!1)}),o}class xi{constructor(i,o){this.type=o.type,this.name=i,this.boundExpression=o}static parse(i,o){if(i.length!==2||typeof i[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=i[1];return o.scope.has(u)?new xi(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Cm{constructor(i,o=[],u,p=new rf,h=[],m,b){this.registry=i,this.path=o,this.key=o.map(S=>typeof S=="string"?`['${S}']`:`[${S}]`).join(""),this.scope=p,this.errors=h,this.expectedType=u,this._scope=m,this.options=b}parse(i,o,u,p,h={}){return o||u?this.concat(o,null,u,p)._parse(i,h):this._parse(i,h)}parseObjectValue(i,o,u,p,h,m={}){return this.concat(o,u,p,h)._parse(i,m)}_parse(i,o){function u(p,h,m){return m==="assert"?new Us(h,[p]):m==="coerce"?new Fa(h,[p]):p}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(p){let h=p.parse(i,this);if(!h)return null;if(this.expectedType){const m=this.expectedType,b=h.type;if(m.kind!=="string"&&m.kind!=="number"&&m.kind!=="boolean"&&m.kind!=="object"&&m.kind!=="array"||b.kind!=="value")if(m.kind!=="color"&&m.kind!=="formatted"&&m.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(m,b))return null}else h=u(h,m,o.typeAnnotation||"coerce");else h=u(h,m,o.typeAnnotation||"assert")}if(!(h instanceof Vs)&&h.type.kind!=="resolvedImage"&&Mm(h)){const m=new $y(this._scope,this.options);try{h=new Vs(h.type,h.evaluate(m))}catch(b){return this.error(b.message),null}}return h}return Fa.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,o,u,p){let h=typeof i=="number"?this.path.concat(i):this.path;h=typeof o=="string"?h.concat(o):h;const m=p?this.scope.concat(p):this.scope;return new Cm(this.registry,h,u||null,m,this.errors,this._scope,this.options)}error(i,...o){const u=`${this.key}${o.map(p=>`[${p}]`).join("")}`;this.errors.push(new ma(u,i))}checkSubtype(i,o){const u=Xc(i,o);return u&&this.error(u),u}}var Jy=Cm;function Mm(c){if(c instanceof xi)return Mm(c.boundExpression);if(c instanceof zo&&c.name==="error"||c instanceof af||c instanceof ml||c instanceof gl||c instanceof su)return!1;const i=c instanceof Fa||c instanceof Us;let o=!0;return c.eachChild(u=>{o=i?o&&Mm(u):o&&u instanceof Vs}),!!o&&Ph(c)&&Ah(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function xf(c,i){const o=c.length-1;let u,p,h=0,m=o,b=0;for(;h<=m;)if(b=Math.floor((h+m)/2),u=c[b],p=c[b+1],u<=i){if(b===o||i<p)return b;h=b+1}else{if(!(u>i))throw new $n("Input is not a number.");m=b-1}return 0}class Ch{constructor(i,o,u){this.type=i,this.input=o,this.labels=[],this.outputs=[];for(const[p,h]of u)this.labels.push(p),this.outputs.push(h)}static parse(i,o){if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(i[1],1,Ut);if(!u)return null;const p=[];let h=null;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);for(let m=1;m<i.length;m+=2){const b=m===1?-1/0:i[m],S=i[m+1],A=m,y=m+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(p.length&&p[p.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const w=o.parse(S,y,h);if(!w)return null;h=h||w.type,p.push([b,w])}return new Ch(h,u,p)}evaluate(i){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(i);const p=this.input.evaluate(i);if(p<=o[0])return u[0].evaluate(i);const h=o.length;return p>=o[h-1]?u[h-1].evaluate(i):u[xf(o,p)].evaluate(i)}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&i.push(this.labels[o]),i.push(this.outputs[o].serialize());return i}}const Qy=.95047,ev=1.08883,tv=4/29,au=6/29,rv=3*au*au,G1=au*au*au,H1=Math.PI/180,q1=180/Math.PI;function Im(c){return c>G1?Math.pow(c,1/3):c/rv+tv}function Dm(c){return c>au?c*c*c:rv*(c-tv)}function Rm(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Lm(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function iv(c){const i=Lm(c.r),o=Lm(c.g),u=Lm(c.b),p=Im((.4124564*i+.3575761*o+.1804375*u)/Qy),h=Im((.2126729*i+.7151522*o+.072175*u)/1);return{l:116*h-16,a:500*(p-h),b:200*(h-Im((.0193339*i+.119192*o+.9503041*u)/ev)),alpha:c.a}}function nv(c){let i=(c.l+16)/116,o=isNaN(c.a)?i:i+c.a/500,u=isNaN(c.b)?i:i-c.b/200;return i=1*Dm(i),o=Qy*Dm(o),u=ev*Dm(u),new li(Rm(3.2404542*o-1.5371385*i-.4985314*u),Rm(-.969266*o+1.8760108*i+.041556*u),Rm(.0556434*o-.2040259*i+1.0572252*u),c.alpha)}function W1(c,i,o){const u=i-c;return c+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const Mh={forward:iv,reverse:nv,interpolate:function(c,i,o){return{l:nr(c.l,i.l,o),a:nr(c.a,i.a,o),b:nr(c.b,i.b,o),alpha:nr(c.alpha,i.alpha,o)}}},Ih={forward:function(c){const{l:i,a:o,b:u}=iv(c),p=Math.atan2(u,o)*q1;return{h:p<0?p+360:p,c:Math.sqrt(o*o+u*u),l:i,alpha:c.a}},reverse:function(c){const i=c.h*H1,o=c.c;return nv({l:c.l,a:Math.cos(i)*o,b:Math.sin(i)*o,alpha:c.alpha})},interpolate:function(c,i,o){return{h:W1(c.h,i.h,o),c:nr(c.c,i.c,o),l:nr(c.l,i.l,o),alpha:nr(c.alpha,i.alpha,o)}}};var ov=Object.freeze({__proto__:null,hcl:Ih,lab:Mh});class Jo{constructor(i,o,u,p,h){this.type=i,this.operator=o,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[m,b]of h)this.labels.push(m),this.outputs.push(b)}static interpolationFactor(i,o,u,p){let h=0;if(i.name==="exponential")h=Bm(o,i.base,u,p);else if(i.name==="linear")h=Bm(o,1,u,p);else if(i.name==="cubic-bezier"){const m=i.controlPoints;h=new Ne(m[0],m[1],m[2],m[3]).solve(Bm(o,1,u,p))}return h}static parse(i,o){let[u,p,h,...m]=i;if(!Array.isArray(p)||p.length===0)return o.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const A=p[1];if(typeof A!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:A}}else{if(p[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const A=p.slice(1);if(A.length!==4||A.some(y=>typeof y!="number"||y<0||y>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:A}}}if(i.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(h=o.parse(h,2,Ut),!h)return null;const b=[];let S=null;u==="interpolate-hcl"||u==="interpolate-lab"?S=ko:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let A=0;A<m.length;A+=2){const y=m[A],w=m[A+1],P=A+3,E=A+4;if(typeof y!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(b.length&&b[b.length-1][0]>=y)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',P);const O=o.parse(w,E,S);if(!O)return null;S=S||O.type,b.push([y,O])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new Jo(S,u,p,h,b):o.error(`Type ${cn(S)} is not interpolatable.`)}evaluate(i){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(i);const p=this.input.evaluate(i);if(p<=o[0])return u[0].evaluate(i);const h=o.length;if(p>=o[h-1])return u[h-1].evaluate(i);const m=xf(o,p),b=Jo.interpolationFactor(this.interpolation,p,o[m],o[m+1]),S=u[m].evaluate(i),A=u[m+1].evaluate(i);return this.operator==="interpolate"?Jl[this.type.kind.toLowerCase()](S,A,b):this.operator==="interpolate-hcl"?Ih.reverse(Ih.interpolate(Ih.forward(S),Ih.forward(A),b)):Mh.reverse(Mh.interpolate(Mh.forward(S),Mh.forward(A),b))}eachChild(i){i(this.input);for(const o of this.outputs)i(o)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,i,this.input.serialize()];for(let u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o}}function Bm(c,i,o,u){const p=u-o,h=c-o;return p===0?0:i===1?h/p:(Math.pow(i,h)-1)/(Math.pow(i,p)-1)}class wf{constructor(i,o){this.type=i,this.args=o}static parse(i,o){if(i.length<2)return o.error("Expectected at least one argument.");let u=null;const p=o.expectedType;p&&p.kind!=="value"&&(u=p);const h=[];for(const b of i.slice(1)){const S=o.parse(b,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,h.push(S)}const m=p&&h.some(b=>Xc(p,b.type));return new wf(m?Yr:u,h)}evaluate(i){let o,u=null,p=0;for(const h of this.args){if(p++,u=h.evaluate(i),u&&u instanceof To&&!u.available&&(o||(o=u),u=null,p===this.args.length))return o;if(u!==null)break}return u}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(o=>{i.push(o.serialize())}),i}}class Tf{constructor(i,o){this.type=o.type,this.bindings=[].concat(i),this.result=o}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const o of this.bindings)i(o[1]);i(this.result)}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const u=[];for(let h=1;h<i.length-1;h+=2){const m=i[h];if(typeof m!="string")return o.error(`Expected string, but found ${typeof m} instead.`,h);if(/[^a-zA-Z0-9_]/.test(m))return o.error("Variable names must contain only alphanumeric characters or '_'.",h);const b=o.parse(i[h+1],h+1);if(!b)return null;u.push([m,b])}const p=o.parse(i[i.length-1],i.length-1,o.expectedType,u);return p?new Tf(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[o,u]of this.bindings)i.push(o,u.serialize());return i.push(this.result.serialize()),i}}class km{constructor(i,o,u){this.type=i,this.index=o,this.input=u}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,Ut),p=o.parse(i[2],2,wo(o.expectedType||Yr));return u&&p?new km(p.type.itemType,u,p):null}evaluate(i){const o=this.index.evaluate(i),u=this.input.evaluate(i);if(o<0)throw new $n(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new $n(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new $n(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class zm{constructor(i,o){this.type=Wr,this.needle=i,this.haystack=o}static parse(i,o){if(i.length!==3)return o.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,Yr),p=o.parse(i[2],2,Yr);return u&&p?Kc(u.type,[Wr,qr,Ut,js,Yr])?new zm(u,p):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${cn(u.type)} instead`):null}evaluate(i){const o=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(u==null)return!1;if(!ga(o,["boolean","string","number","null"]))throw new $n(`Expected first argument to be of type boolean, string, number or null, but found ${cn(bn(o))} instead.`);if(!ga(u,["string","array"]))throw new $n(`Expected second argument to be of type array or string, but found ${cn(bn(u))} instead.`);return u.indexOf(o)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ef{constructor(i,o,u){this.type=Ut,this.needle=i,this.haystack=o,this.fromIndex=u}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,Yr),p=o.parse(i[2],2,Yr);if(!u||!p)return null;if(!Kc(u.type,[Wr,qr,Ut,js,Yr]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${cn(u.type)} instead`);if(i.length===4){const h=o.parse(i[3],3,Ut);return h?new Ef(u,p,h):null}return new Ef(u,p)}evaluate(i){const o=this.needle.evaluate(i),u=this.haystack.evaluate(i);if(!ga(o,["boolean","string","number","null"]))throw new $n(`Expected first argument to be of type boolean, string, number or null, but found ${cn(bn(o))} instead.`);if(!ga(u,["string","array"]))throw new $n(`Expected second argument to be of type array or string, but found ${cn(bn(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(i);return u.indexOf(o,p)}return u.indexOf(o)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Fm{constructor(i,o,u,p,h,m){this.inputType=i,this.type=o,this.input=u,this.cases=p,this.outputs=h,this.otherwise=m}static parse(i,o){if(i.length<5)return o.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return o.error("Expected an even number of arguments.");let u,p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const h={},m=[];for(let A=2;A<i.length-1;A+=2){let y=i[A];const w=i[A+1];Array.isArray(y)||(y=[y]);const P=o.concat(A);if(y.length===0)return P.error("Expected at least one branch label.");for(const O of y){if(typeof O!="number"&&typeof O!="string")return P.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return P.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return P.error("Numeric branch labels must be integer values.");if(u){if(P.checkSubtype(u,bn(O)))return null}else u=bn(O);if(h[String(O)]!==void 0)return P.error("Branch labels must be unique.");h[String(O)]=m.length}const E=o.parse(w,A,p);if(!E)return null;p=p||E.type,m.push(E)}const b=o.parse(i[1],1,Yr);if(!b)return null;const S=o.parse(i[i.length-1],i.length-1,p);return S?b.type.kind!=="value"&&o.concat(1).checkSubtype(u,b.type)?null:new Fm(u,p,b,h,m,S):null}evaluate(i){const o=this.input.evaluate(i);return(bn(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),u=[],p={};for(const m of o){const b=p[this.cases[m]];b===void 0?(p[this.cases[m]]=u.length,u.push([this.cases[m],[m]])):u[b][1].push(m)}const h=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,b]of u)i.push(b.length===1?h(b[0]):b.map(h)),i.push(this.outputs[m].serialize());return i.push(this.otherwise.serialize()),i}}class Dh{constructor(i,o,u){this.type=i,this.branches=o,this.otherwise=u}static parse(i,o){if(i.length<4)return o.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const p=[];for(let m=1;m<i.length-1;m+=2){const b=o.parse(i[m],m,Wr);if(!b)return null;const S=o.parse(i[m+1],m+1,u);if(!S)return null;p.push([b,S]),u=u||S.type}const h=o.parse(i[i.length-1],i.length-1,u);return h?new Dh(u,p,h):null}evaluate(i){for(const[o,u]of this.branches)if(o.evaluate(i))return u.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[o,u]of this.branches)i(o),i(u);i(this.otherwise)}outputDefined(){return this.branches.every(([i,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(o=>{i.push(o.serialize())}),i}}class Sf{constructor(i,o,u,p){this.type=i,this.input=o,this.beginIndex=u,this.endIndex=p}static parse(i,o){if(i.length<=2||i.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const u=o.parse(i[1],1,Yr),p=o.parse(i[2],2,Ut);if(!u||!p)return null;if(!Kc(u.type,[wo(Yr),qr,Yr]))return o.error(`Expected first argument to be of type array or string, but found ${cn(u.type)} instead`);if(i.length===4){const h=o.parse(i[3],3,Ut);return h?new Sf(u.type,u,p,h):null}return new Sf(u.type,u,p)}evaluate(i){const o=this.input.evaluate(i),u=this.beginIndex.evaluate(i);if(!ga(o,["string","array"]))throw new $n(`Expected first argument to be of type array or string, but found ${cn(bn(o))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(i);return o.slice(u,p)}return o.slice(u)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Nm(c,i){return c==="=="||c==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function sv(c,i,o,u){return u.compare(i,o)===0}function lu(c,i,o){const u=c!=="=="&&c!=="!=";return class Y${constructor(h,m,b){this.type=Wr,this.lhs=h,this.rhs=m,this.collator=b,this.hasUntypedArgument=h.type.kind==="value"||m.type.kind==="value"}static parse(h,m){if(h.length!==3&&h.length!==4)return m.error("Expected two or three arguments.");const b=h[0];let S=m.parse(h[1],1,Yr);if(!S)return null;if(!Nm(b,S.type))return m.concat(1).error(`"${b}" comparisons are not supported for type '${cn(S.type)}'.`);let A=m.parse(h[2],2,Yr);if(!A)return null;if(!Nm(b,A.type))return m.concat(2).error(`"${b}" comparisons are not supported for type '${cn(A.type)}'.`);if(S.type.kind!==A.type.kind&&S.type.kind!=="value"&&A.type.kind!=="value")return m.error(`Cannot compare types '${cn(S.type)}' and '${cn(A.type)}'.`);u&&(S.type.kind==="value"&&A.type.kind!=="value"?S=new Us(A.type,[S]):S.type.kind!=="value"&&A.type.kind==="value"&&(A=new Us(S.type,[A])));let y=null;if(h.length===4){if(S.type.kind!=="string"&&A.type.kind!=="string"&&S.type.kind!=="value"&&A.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(y=m.parse(h[3],3,nf),!y)return null}return new Y$(S,A,y)}evaluate(h){const m=this.lhs.evaluate(h),b=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const S=bn(m),A=bn(b);if(S.kind!==A.kind||S.kind!=="string"&&S.kind!=="number")throw new $n(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${S.kind}, ${A.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const S=bn(m),A=bn(b);if(S.kind!=="string"||A.kind!=="string")return i(h,m,b)}return this.collator?o(h,m,b,this.collator.evaluate(h)):i(h,m,b)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[c];return this.eachChild(m=>{h.push(m.serialize())}),h}}}const Z1=lu("==",function(c,i,o){return i===o},sv),av=lu("!=",function(c,i,o){return i!==o},function(c,i,o,u){return!sv(0,i,o,u)}),lv=lu("<",function(c,i,o){return i<o},function(c,i,o,u){return u.compare(i,o)<0}),cu=lu(">",function(c,i,o){return i>o},function(c,i,o,u){return u.compare(i,o)>0}),cv=lu("<=",function(c,i,o){return i<=o},function(c,i,o,u){return u.compare(i,o)<=0}),uv=lu(">=",function(c,i,o){return i>=o},function(c,i,o,u){return u.compare(i,o)>=0});class $m{constructor(i,o,u,p,h,m){this.type=qr,this.number=i,this.locale=o,this.currency=u,this.unit=p,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(i,o){if(i.length!==3)return o.error("Expected two arguments.");const u=o.parse(i[1],1,Ut);if(!u)return null;const p=i[2];if(typeof p!="object"||Array.isArray(p))return o.error("NumberFormat options argument must be an object.");let h=null;if(p.locale&&(h=o.parseObjectValue(p.locale,2,"locale",qr),!h))return null;let m=null;if(p.currency&&(m=o.parseObjectValue(p.currency,2,"currency",qr),!m))return null;let b=null;if(p.unit&&(b=o.parseObjectValue(p.unit,2,"unit",qr),!b))return null;let S=null;if(p["min-fraction-digits"]&&(S=o.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",Ut),!S))return null;let A=null;return p["max-fraction-digits"]&&(A=o.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",Ut),!A)?null:new $m(u,h,m,b,S,A)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Rh{constructor(i){this.type=Ut,this.input=i}static parse(i,o){if(i.length!==2)return o.error(`Expected 1 argument, but found ${i.length-1} instead.`);const u=o.parse(i[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${cn(u.type)} instead.`):new Rh(u):null}evaluate(i){const o=this.input.evaluate(i);if(typeof o=="string"||Array.isArray(o))return o.length;throw new $n(`Expected value to be of type string or array, but found ${cn(bn(o))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(o=>{i.push(o.serialize())}),i}}function Of(c){return function(){c=1831565813+(c|=0)|0;let i=Math.imul(c^c>>>15,1|c);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const uu={"==":Z1,"!=":av,">":cu,"<":lv,">=":uv,"<=":cv,array:Us,at:km,boolean:Us,case:Dh,coalesce:wf,collator:af,format:Yc,image:Ql,in:zm,"index-of":Ef,interpolate:Jo,"interpolate-hcl":Jo,"interpolate-lab":Jo,length:Rh,let:Tf,literal:Vs,match:Fm,number:Us,"number-format":$m,object:Us,slice:Sf,step:Ch,string:Us,"to-boolean":Fa,"to-color":Fa,"to-number":Fa,"to-string":Fa,var:xi,within:ml,distance:gl,config:su};function hv(c,[i,o,u,p]){i=i.evaluate(c),o=o.evaluate(c),u=u.evaluate(c);const h=p?p.evaluate(c):1,m=Ny(i,o,u,h);if(m)throw new $n(m);return new li(i/255*h,o/255*h,u/255*h,h)}function jm(c,[i,o,u,p]){i=i.evaluate(c),o=o.evaluate(c),u=u.evaluate(c);const h=p?p.evaluate(c):1,m=function(A,y,w,P){return typeof A=="number"&&A>=0&&A<=360?typeof y=="number"&&y>=0&&y<=100&&typeof w=="number"&&w>=0&&w<=100?P===void 0||typeof P=="number"&&P>=0&&P<=1?null:`Invalid hsla value [${[A,y,w,P].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof P=="number"?[A,y,w,P]:[A,y,w]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof P=="number"?[A,y,w,P]:[A,y,w]).join(", ")}]: 'h' must be between 0 and 360.`}(i,o,u,h);if(m)throw new $n(m);const b=`hsla(${i}, ${o}%, ${u}%, ${h})`,S=li.parse(b);if(!S)throw new $n(`Failed to parse HSLA color: ${b}`);return S}function Vm(c,i){return c in i}function Um(c,i){const o=i[c];return o===void 0?null:o}function ic(c){return{type:c}}function dv(c){return{result:"success",value:c}}function yl(c){return{result:"error",value:c}}function Gm(c,i){return!!c&&!!c.parameters&&c.parameters.indexOf(i)>-1}function Pf(c){return c["property-type"]==="data-driven"}function Hm(c){return Gm(c.expression,"measure-light")}function fv(c){return Gm(c.expression,"zoom")}function qm(c){return!!c.expression&&c.expression.interpolated}function Af(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function pv(c){return c}function mv(c,i){const o=i.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",p=u||!(u||c.property!==void 0),h=c.type||(qm(i)?"exponential":"interval");if(o&&((c=qc({},c)).stops&&(c.stops=c.stops.map(A=>[A[0],li.parse(A[1])])),c.default=li.parse(c.default?c.default:i.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!ov[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let m,b,S;if(h==="exponential")m=_v;else if(h==="interval")m=gv;else if(h==="categorical"){m=X1,b=Object.create(null);for(const A of c.stops)b[A[0]]=A[1];S=typeof c.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);m=K1}if(u){const A={},y=[];for(let E=0;E<c.stops.length;E++){const O=c.stops[E],M=O[0].zoom;A[M]===void 0&&(A[M]={zoom:M,type:c.type,property:c.property,default:c.default,stops:[]},y.push(M)),A[M].stops.push([O[0].value,O[1]])}const w=[];for(const E of y)w.push([A[E].zoom,mv(A[E],i)]);const P={name:"linear"};return{kind:"composite",interpolationType:P,interpolationFactor:Jo.interpolationFactor.bind(void 0,P),zoomStops:w.map(E=>E[0]),evaluate:({zoom:E},O)=>_v({stops:w,base:c.base},i,E).evaluate(E,O)}}if(p){const A=h==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Jo.interpolationFactor.bind(void 0,A),zoomStops:c.stops.map(y=>y[0]),evaluate:({zoom:y})=>m(c,i,y,b,S)}}return{kind:"source",evaluate(A,y){const w=y&&y.properties?y.properties[c.property]:void 0;return w===void 0?Lh(c.default,i.default):m(c,i,w,b,S)}}}function Lh(c,i,o){return c!==void 0?c:i!==void 0?i:o!==void 0?o:void 0}function X1(c,i,o,u,p){return Lh(typeof o===p?u[o]:void 0,c.default,i.default)}function gv(c,i,o){if(ec(o)!=="number")return Lh(c.default,i.default);const u=c.stops.length;if(u===1||o<=c.stops[0][0])return c.stops[0][1];if(o>=c.stops[u-1][0])return c.stops[u-1][1];const p=xf(c.stops.map(h=>h[0]),o);return c.stops[p][1]}function _v(c,i,o){const u=c.base!==void 0?c.base:1;if(ec(o)!=="number")return Lh(c.default,i.default);const p=c.stops.length;if(p===1||o<=c.stops[0][0])return c.stops[0][1];if(o>=c.stops[p-1][0])return c.stops[p-1][1];const h=xf(c.stops.map(y=>y[0]),o),m=function(y,w,P,E){const O=E-P,M=y-P;return O===0?0:w===1?M/O:(Math.pow(w,M)-1)/(Math.pow(w,O)-1)}(o,u,c.stops[h][0],c.stops[h+1][0]),b=c.stops[h][1],S=c.stops[h+1][1];let A=Jl[i.type]||pv;if(c.colorSpace&&c.colorSpace!=="rgb"){const y=ov[c.colorSpace];A=(w,P)=>y.reverse(y.interpolate(y.forward(w),y.forward(P),m))}return typeof b.evaluate=="function"?{evaluate(...y){const w=b.evaluate.apply(void 0,y),P=S.evaluate.apply(void 0,y);if(w!==void 0&&P!==void 0)return A(w,P,m)}}:A(b,S,m)}function K1(c,i,o){return i.type==="color"?o=li.parse(o):i.type==="formatted"?o=uo.fromString(o.toString()):i.type==="resolvedImage"?o=To.fromString(o.toString()):ec(o)===i.type||i.type==="enum"&&i.values[o]||(o=void 0),Lh(o,c.default,i.default)}zo.register(uu,{error:[{kind:"error"},[qr],(c,[i])=>{throw new $n(i.evaluate(c))}],typeof:[qr,[Yr],(c,[i])=>cn(bn(i.evaluate(c)))],"to-rgba":[wo(Ut,4),[ko],(c,[i])=>i.evaluate(c).toRenderColor(null).toArray()],rgb:[ko,[Ut,Ut,Ut],hv],rgba:[ko,[Ut,Ut,Ut,Ut],hv],hsl:[ko,[Ut,Ut,Ut],jm],hsla:[ko,[Ut,Ut,Ut,Ut],jm],has:{type:Wr,overloads:[[[qr],(c,[i])=>Vm(i.evaluate(c),c.properties())],[[qr,co],(c,[i,o])=>Vm(i.evaluate(c),o.evaluate(c))]]},get:{type:Yr,overloads:[[[qr],(c,[i])=>Um(i.evaluate(c),c.properties())],[[qr,co],(c,[i,o])=>Um(i.evaluate(c),o.evaluate(c))]]},"feature-state":[Yr,[qr],(c,[i])=>Um(i.evaluate(c),c.featureState||{})],properties:[co,[],c=>c.properties()],"geometry-type":[qr,[],c=>c.geometryType()],id:[Yr,[],c=>c.id()],zoom:[Ut,[],c=>c.globals.zoom],pitch:[Ut,[],c=>c.globals.pitch||0],"distance-from-center":[Ut,[],c=>c.distanceFromCenter()],"measure-light":[Ut,[qr],(c,[i])=>c.measureLight(i.evaluate(c))],"heatmap-density":[Ut,[],c=>c.globals.heatmapDensity||0],"line-progress":[Ut,[],c=>c.globals.lineProgress||0],"raster-value":[Ut,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[Ut,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[Ut,[],c=>c.globals.skyRadialProgress||0],accumulated:[Yr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Ut,ic(Ut),(c,i)=>{let o=0;for(const u of i)o+=u.evaluate(c);return o}],"*":[Ut,ic(Ut),(c,i)=>{let o=1;for(const u of i)o*=u.evaluate(c);return o}],"-":{type:Ut,overloads:[[[Ut,Ut],(c,[i,o])=>i.evaluate(c)-o.evaluate(c)],[[Ut],(c,[i])=>-i.evaluate(c)]]},"/":[Ut,[Ut,Ut],(c,[i,o])=>i.evaluate(c)/o.evaluate(c)],"%":[Ut,[Ut,Ut],(c,[i,o])=>i.evaluate(c)%o.evaluate(c)],ln2:[Ut,[],()=>Math.LN2],pi:[Ut,[],()=>Math.PI],e:[Ut,[],()=>Math.E],"^":[Ut,[Ut,Ut],(c,[i,o])=>Math.pow(i.evaluate(c),o.evaluate(c))],sqrt:[Ut,[Ut],(c,[i])=>Math.sqrt(i.evaluate(c))],log10:[Ut,[Ut],(c,[i])=>Math.log(i.evaluate(c))/Math.LN10],ln:[Ut,[Ut],(c,[i])=>Math.log(i.evaluate(c))],log2:[Ut,[Ut],(c,[i])=>Math.log(i.evaluate(c))/Math.LN2],sin:[Ut,[Ut],(c,[i])=>Math.sin(i.evaluate(c))],cos:[Ut,[Ut],(c,[i])=>Math.cos(i.evaluate(c))],tan:[Ut,[Ut],(c,[i])=>Math.tan(i.evaluate(c))],asin:[Ut,[Ut],(c,[i])=>Math.asin(i.evaluate(c))],acos:[Ut,[Ut],(c,[i])=>Math.acos(i.evaluate(c))],atan:[Ut,[Ut],(c,[i])=>Math.atan(i.evaluate(c))],min:[Ut,ic(Ut),(c,i)=>Math.min(...i.map(o=>o.evaluate(c)))],max:[Ut,ic(Ut),(c,i)=>Math.max(...i.map(o=>o.evaluate(c)))],abs:[Ut,[Ut],(c,[i])=>Math.abs(i.evaluate(c))],round:[Ut,[Ut],(c,[i])=>{const o=i.evaluate(c);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ut,[Ut],(c,[i])=>Math.floor(i.evaluate(c))],ceil:[Ut,[Ut],(c,[i])=>Math.ceil(i.evaluate(c))],"filter-==":[Wr,[qr,Yr],(c,[i,o])=>c.properties()[i.value]===o.value],"filter-id-==":[Wr,[Yr],(c,[i])=>c.id()===i.value],"filter-type-==":[Wr,[qr],(c,[i])=>c.geometryType()===i.value],"filter-<":[Wr,[qr,Yr],(c,[i,o])=>{const u=c.properties()[i.value],p=o.value;return typeof u==typeof p&&u<p}],"filter-id-<":[Wr,[Yr],(c,[i])=>{const o=c.id(),u=i.value;return typeof o==typeof u&&o<u}],"filter->":[Wr,[qr,Yr],(c,[i,o])=>{const u=c.properties()[i.value],p=o.value;return typeof u==typeof p&&u>p}],"filter-id->":[Wr,[Yr],(c,[i])=>{const o=c.id(),u=i.value;return typeof o==typeof u&&o>u}],"filter-<=":[Wr,[qr,Yr],(c,[i,o])=>{const u=c.properties()[i.value],p=o.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[Wr,[Yr],(c,[i])=>{const o=c.id(),u=i.value;return typeof o==typeof u&&o<=u}],"filter->=":[Wr,[qr,Yr],(c,[i,o])=>{const u=c.properties()[i.value],p=o.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[Wr,[Yr],(c,[i])=>{const o=c.id(),u=i.value;return typeof o==typeof u&&o>=u}],"filter-has":[Wr,[Yr],(c,[i])=>i.value in c.properties()],"filter-has-id":[Wr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Wr,[wo(qr)],(c,[i])=>i.value.indexOf(c.geometryType())>=0],"filter-id-in":[Wr,[wo(Yr)],(c,[i])=>i.value.indexOf(c.id())>=0],"filter-in-small":[Wr,[qr,wo(Yr)],(c,[i,o])=>o.value.indexOf(c.properties()[i.value])>=0],"filter-in-large":[Wr,[qr,wo(Yr)],(c,[i,o])=>function(u,p,h,m){for(;h<=m;){const b=h+m>>1;if(p[b]===u)return!0;p[b]>u?m=b-1:h=b+1}return!1}(c.properties()[i.value],o.value,0,o.value.length-1)],all:{type:Wr,overloads:[[[Wr,Wr],(c,[i,o])=>i.evaluate(c)&&o.evaluate(c)],[ic(Wr),(c,i)=>{for(const o of i)if(!o.evaluate(c))return!1;return!0}]]},any:{type:Wr,overloads:[[[Wr,Wr],(c,[i,o])=>i.evaluate(c)||o.evaluate(c)],[ic(Wr),(c,i)=>{for(const o of i)if(o.evaluate(c))return!0;return!1}]]},"!":[Wr,[Wr],(c,[i])=>!i.evaluate(c)],"is-supported-script":[Wr,[qr],(c,[i])=>{const o=c.globals&&c.globals.isSupportedScript;return!o||o(i.evaluate(c))}],upcase:[qr,[qr],(c,[i])=>i.evaluate(c).toUpperCase()],downcase:[qr,[qr],(c,[i])=>i.evaluate(c).toLowerCase()],concat:[qr,ic(Yr),(c,i)=>i.map(o=>Eo(o.evaluate(c))).join("")],"resolved-locale":[qr,[nf],(c,[i])=>i.evaluate(c).resolvedLocale()],random:[Ut,[Ut,Ut,Yr],(c,i)=>{const[o,u,p]=i.map(m=>m.evaluate(c));if(o>u||o===u)return o;let h;if(typeof p=="string")h=function(m){let b=0;if(m.length===0)return b;for(let S=0;S<m.length;S++)b=(b<<5)-b+m.charCodeAt(S),b|=0;return b}(p);else{if(typeof p!="number")throw new $n(`Invalid seed input: ${p}`);h=p}return o+Of(h)()*(u-o)}]});class Cf{constructor(i,o,u,p){this.expression=i,this._warningHistory={},this._evaluator=new $y(u,p),this._defaultValue=o?function(h){return h.type==="color"&&(Af(h.default)||Array.isArray(h.default))?new li(0,0,0,0):h.type==="color"?li.parse(h.default)||null:h.default===void 0?null:h.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(i,o,u,p,h,m,b,S){return this._evaluator.globals=i,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(i,o,u,p,h,m,b,S){this._evaluator.globals=i,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=S||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new $n(`Expected value to be one of ${Object.keys(this._enumValues).map(y=>JSON.stringify(y)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${A.message}`)),this._defaultValue}}}function Mf(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in uu}function Bh(c,i,o,u){const p=new Jy(uu,[],i?function(m){const b={color:ko,string:qr,number:Ut,enum:qr,boolean:Wr,formatted:Wc,resolvedImage:Zc};return m.type==="array"?wo(b[m.value]||Yr,m.length):b[m.type]}(i):void 0,void 0,void 0,o,u),h=p.parse(c,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?dv(new Cf(h,i,o,u)):yl(p.errors)}class Wm{constructor(i,o,u){this.kind=i,this._styleExpression=o,this.isLightConstant=u,this.isStateDependent=i!=="constant"&&!vf(o.expression),this.configDependencies=bf(o.expression)}evaluateWithoutErrorHandling(i,o,u,p,h,m){return this._styleExpression.evaluateWithoutErrorHandling(i,o,u,p,h,m)}evaluate(i,o,u,p,h,m){return this._styleExpression.evaluate(i,o,u,p,h,m)}}class _a{constructor(i,o,u,p,h){this.kind=i,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=i!=="camera"&&!vf(o.expression),this.isLightConstant=h,this.configDependencies=bf(o.expression),this.interpolationType=p}evaluateWithoutErrorHandling(i,o,u,p,h,m){return this._styleExpression.evaluateWithoutErrorHandling(i,o,u,p,h,m)}evaluate(i,o,u,p,h,m){return this._styleExpression.evaluate(i,o,u,p,h,m)}interpolationFactor(i,o,u){return this.interpolationType?Jo.interpolationFactor(this.interpolationType,i,o,u):0}}function yv(c,i,o,u){if((c=Bh(c,i,o,u)).result==="error")return c;const p=c.value.expression,h=Ph(p);if(!h&&!Pf(i))return yl([new ma("","data expressions not supported")]);const m=Ah(p,["zoom","pitch","distance-from-center"]);if(!m&&!fv(i))return yl([new ma("","zoom expressions not supported")]);const b=Ah(p,["measure-light"]);if(!b&&!Hm(i))return yl([new ma("","measure-light expression not supported")]);const S=i.expression&&i.expression.relaxZoomRestriction,A=Df(p);return A||m||S?A instanceof ma?yl([A]):A instanceof Jo&&!qm(i)?yl([new ma("",'"interpolate" expressions cannot be used with this property')]):dv(A?new _a(h?"camera":"composite",c.value,A.labels,A instanceof Jo?A.interpolation:void 0,b):new Wm(h?"constant":"source",c.value,b)):yl([new ma("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class If{constructor(i,o){this._parameters=i,this._specification=o,qc(this,mv(this._parameters,this._specification))}static deserialize(i){return new If(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Df(c){let i=null;if(c instanceof Tf)i=Df(c.result);else if(c instanceof wf){for(const o of c.args)if(i=Df(o),i)break}else(c instanceof Ch||c instanceof Jo)&&c.input instanceof zo&&c.input.name==="zoom"&&(i=c);return i instanceof ma||c.eachChild(o=>{const u=Df(o);u instanceof ma?i=u:i&&u&&i!==u&&(i=new ma("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var Rf,Zm,vv=function(){if(Zm)return Rf;Zm=1,Rf=i;var c=3;function i(o,u,p){var h=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var m=new Int32Array(this.arrayBuffer);o=m[0],this.d=(u=m[1])+2*(p=m[2]);for(var b=0;b<this.d*this.d;b++){var S=m[c+b],A=m[c+b+1];h.push(S===A?null:m.subarray(S,A))}var y=m[c+h.length+1];this.keys=m.subarray(m[c+h.length],y),this.bboxes=m.subarray(y),this.insert=this._insertReadonly}else{this.d=u+2*p;for(var w=0;w<this.d*this.d;w++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=p,this.scale=u/o,this.uid=0;var P=p/u*o;this.min=-P,this.max=o+P}return i.prototype.insert=function(o,u,p,h,m){this._forEachCell(u,p,h,m,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(h),this.bboxes.push(m)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(o,u,p,h,m,b){this.cells[m].push(b)},i.prototype.query=function(o,u,p,h,m){var b=this.min,S=this.max;if(o<=b&&u<=b&&S<=p&&S<=h&&!m)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(o,u,p,h,this._queryCell,A,{},m),A},i.prototype._queryCell=function(o,u,p,h,m,b,S,A){var y=this.cells[m];if(y!==null)for(var w=this.keys,P=this.bboxes,E=0;E<y.length;E++){var O=y[E];if(S[O]===void 0){var M=4*O;(A?A(P[M+0],P[M+1],P[M+2],P[M+3]):o<=P[M+2]&&u<=P[M+3]&&p>=P[M+0]&&h>=P[M+1])?(S[O]=!0,b.push(w[O])):S[O]=!1}}},i.prototype._forEachCell=function(o,u,p,h,m,b,S,A){for(var y=this._convertToCellCoord(o),w=this._convertToCellCoord(u),P=this._convertToCellCoord(p),E=this._convertToCellCoord(h),O=y;O<=P;O++)for(var M=w;M<=E;M++){var R=this.d*M+O;if((!A||A(this._convertFromCellCoord(O),this._convertFromCellCoord(M),this._convertFromCellCoord(O+1),this._convertFromCellCoord(M+1)))&&m.call(this,o,u,p,h,R,b,S,A))return}},i.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},i.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,u=c+this.cells.length+1+1,p=0,h=0;h<this.cells.length;h++)p+=this.cells[h].length;var m=new Int32Array(u+p+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var b=u,S=0;S<o.length;S++){var A=o[S];m[c+S]=b,m.set(A,b),b+=A.length}return m[c+o.length]=b,m.set(this.keys,b),m[c+o.length+1]=b+=this.keys.length,m.set(this.bboxes,b),b+=this.bboxes.length,m.buffer},Rf}(),nc=N(vv);const hu={};function jt(c,i,o={}){Object.defineProperty(c,"_classRegistryKey",{value:i,writable:!1}),hu[i]={klass:c,omit:o.omit||[]}}jt(Object,"Object"),nc.serialize=function(c,i){const o=c.toArrayBuffer();return i&&i.add(o),{buffer:o}},nc.deserialize=function(c){return new nc(c.buffer)},Object.defineProperty(nc,"name",{value:"Grid"}),jt(nc,"Grid"),jt(li,"Color"),jt(Error,"Error"),jt(uo,"Formatted"),jt(Zo,"FormattedSection"),jt(dm,"AJAXError"),jt(To,"ResolvedImage"),jt(If,"StylePropertyFunction"),jt(Cf,"StyleExpression",{omit:["_evaluator"]}),jt(_a,"ZoomDependentExpression"),jt(Wm,"ZoomConstantExpression"),jt(zo,"CompoundExpression",{omit:["_evaluate"]});for(const c in uu)hu[uu[c]._classRegistryKey]||jt(uu[c],`Expression${c}`);function Xm(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function bv(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Fo(c,i){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Xm(c)||bv(c))return i&&i.add(c),c;if(ArrayBuffer.isView(c)){const o=c;return i&&i.add(o.buffer),o}if(c instanceof ImageData)return i&&i.add(c.data.buffer),c;if(Array.isArray(c)){const o=[];for(const u of c)o.push(Fo(u,i));return o}if(c instanceof Map){const o={$name:"Map"};for(const[u,p]of c.entries())o[u]=Fo(p);return o}if(c instanceof Set){const o={$name:"Set"};let u=0;for(const p of c.values())o[++u]=Fo(p);return o}if(typeof c=="object"){const o=c.constructor,u=o._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const p=o.serialize?o.serialize(c,i):{};if(!o.serialize){for(const h in c)c.hasOwnProperty(h)&&(hu[u].omit.indexOf(h)>=0||(p[h]=Fo(c[h],i)));c instanceof Error&&(p.message=c.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof c)}function oc(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Xm(c)||bv(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(oc);if(typeof c=="object"){const i=c.$name||"Object";if(i==="Map"){const p=new Map;for(const h of Object.keys(c))h!=="$name"&&p.set(h,oc(c[h]));return p}if(i==="Set"){const p=new Set;for(const h of Object.keys(c))h!=="$name"&&p.add(oc(c[h]));return p}const{klass:o}=hu[i];if(!o)throw new Error(`can't deserialize unregistered class ${i}`);if(o.deserialize)return o.deserialize(c);const u=Object.create(o.prototype);for(const p of Object.keys(c))p!=="$name"&&(u[p]=oc(c[p]));return u}throw new Error("can't deserialize object of type "+typeof c)}const Wt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function Lf(c){for(const i of c)if(kf(i.charCodeAt(0)))return!0;return!1}function Y1(c){for(const i of c)if(!Bf(i.charCodeAt(0)))return!1;return!0}function Bf(c){return!(Wt.Arabic(c)||Wt["Arabic Supplement"](c)||Wt["Arabic Extended-A"](c)||Wt["Arabic Presentation Forms-A"](c)||Wt["Arabic Presentation Forms-B"](c))}function kf(c){return!(c!==746&&c!==747&&(c<4352||!(Wt["Bopomofo Extended"](c)||Wt.Bopomofo(c)||Wt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Wt["CJK Compatibility Ideographs"](c)||Wt["CJK Compatibility"](c)||Wt["CJK Radicals Supplement"](c)||Wt["CJK Strokes"](c)||!(!Wt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Wt["CJK Unified Ideographs Extension A"](c)||Wt["CJK Unified Ideographs"](c)||Wt["Enclosed CJK Letters and Months"](c)||Wt["Hangul Compatibility Jamo"](c)||Wt["Hangul Jamo Extended-A"](c)||Wt["Hangul Jamo Extended-B"](c)||Wt["Hangul Jamo"](c)||Wt["Hangul Syllables"](c)||Wt.Hiragana(c)||Wt["Ideographic Description Characters"](c)||Wt.Kanbun(c)||Wt["Kangxi Radicals"](c)||Wt["Katakana Phonetic Extensions"](c)||Wt.Katakana(c)&&c!==12540||!(!Wt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Wt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Wt["Unified Canadian Aboriginal Syllabics"](c)||Wt["Unified Canadian Aboriginal Syllabics Extended"](c)||Wt["Vertical Forms"](c)||Wt["Yijing Hexagram Symbols"](c)||Wt["Yi Syllables"](c)||Wt["Yi Radicals"](c))))}function kh(c){return!(kf(c)||function(i){return!!(Wt["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Wt["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Wt["Letterlike Symbols"](i)||Wt["Number Forms"](i)||Wt["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Wt["Control Pictures"](i)&&i!==9251||Wt["Optical Character Recognition"](i)||Wt["Enclosed Alphanumerics"](i)||Wt["Geometric Shapes"](i)||Wt["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Wt["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Wt["CJK Symbols and Punctuation"](i)||Wt.Katakana(i)||Wt["Private Use Area"](i)||Wt["CJK Compatibility Forms"](i)||Wt["Small Form Variants"](i)||Wt["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(c))}function Km(c){return c>=1424&&c<=2303||Wt["Arabic Presentation Forms-A"](c)||Wt["Arabic Presentation Forms-B"](c)}function J1(c,i){return!(!i&&Km(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Wt.Khmer(c))}function Q1(c){for(const i of c)if(Km(i.charCodeAt(0)))return!0;return!1}const zh="deferred",Fh="loading",zf="loaded";let du=null,Vn="unavailable",vl=null;const xv=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Vn="error"),du&&du(c)};function Ym(){Jm.fire(new fl("pluginStateChange",{pluginStatus:Vn,pluginURL:vl}))}const Jm=new Hc,Qm=function(){return Vn},eg=function(){if(Vn!==zh||!vl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Vn=Fh,Ym(),vl&&Uc({url:vl},c=>{c?xv(c):(Vn=zf,Ym())})},No={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Vn===zf||No.applyArabicShaping!=null,isLoading:()=>Vn===Fh,setState(c){Vn=c.pluginStatus,vl=c.pluginURL},isParsed:()=>No.applyArabicShaping!=null&&No.processBidirectionalText!=null&&No.processStyledBidirectionalText!=null,getPluginURL:()=>vl};class nn{constructor(i,o){this.zoom=i,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(o,u){for(const p of o)if(!J1(p.charCodeAt(0),u))return!1;return!0}(i,No.isLoaded())}}class Ff{constructor(i,o,u,p){this.property=i,this.value=o,this.expression=function(h,m,b,S){if(Af(h))return new If(h,m);if(Mf(h)||Array.isArray(h)&&h.length>0){const A=yv(h,m,b,S);if(A.result==="error")throw new Error(A.value.map(y=>`${y.key}: ${y.message}`).join(", "));return A.value}{let A=h;return typeof h=="string"&&m.type==="color"&&(A=li.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>A}}}(o===void 0?i.specification.default:o,i.specification,u,p)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,o,u){return this.property.possiblyEvaluate(this,i,o,u)}}class tg{constructor(i,o,u){this.property=i,this.value=new Ff(i,void 0,o,u)}transitioned(i,o){return new Tv(this.property,this.value,o,Kr({},i.transition,this.transition),i.now)}untransitioned(){return new Tv(this.property,this.value,null,{},0)}}class wv{constructor(i,o,u){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=o,this._options=u,this.configDependencies=new Set}getValue(i){return vn(this._values[i].value.value)}setValue(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new tg(this._values[i].property,this._scope,this._options)),this._values[i].value=new Ff(this._values[i].property,o===null?void 0:vn(o),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,o){o&&(this._options=o);const u=this._properties.properties;if(i)for(const p in i){const h=i[p];if(xo(p,"-transition")){const m=p.slice(0,-11);u[m]&&this.setTransition(m,h)}else u.hasOwnProperty(p)&&this.setValue(p,h)}}getTransition(i){return vn(this._values[i].transition)}setTransition(i,o){this._values.hasOwnProperty(i)||(this._values[i]=new tg(this._values[i].property)),this._values[i].transition=vn(o)||void 0}serialize(){const i={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(i[o]=u);const p=this.getTransition(o);p!==void 0&&(i[`${o}-transition`]=p)}return i}transitioned(i,o){const u=new Ev(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(i,o._values[p]);return u}untransitioned(){const i=new Ev(this._properties);for(const o of Object.keys(this._values))i._values[o]=this._values[o].untransitioned();return i}}class Tv{constructor(i,o,u,p,h){const m=p.delay||0,b=p.duration||0;h=h||0,this.property=i,this.value=o,this.begin=h+m,this.end=this.begin+b,i.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(i,o,u){const p=i.now||0,h=this.value.possiblyEvaluate(i,o,u),m=this.prior;if(m){if(p>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(p<this.begin)return m.possiblyEvaluate(i,o,u);{const b=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(i,o,u),h,Nt(b))}}return h}}class Ev{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,o,u){const p=new pu(this._properties);for(const h of Object.keys(this._values))p._values[h]=this._values[h].possiblyEvaluate(i,o,u);return p}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class ew{constructor(i,o,u){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=o,this._options=u,this.configDependencies=new Set}getValue(i){return vn(this._values[i].value)}setValue(i,o){this._values[i]=new Ff(this._values[i].property,o===null?void 0:vn(o),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(i[o]=u)}return i}possiblyEvaluate(i,o,u){const p=new pu(this._properties);for(const h of Object.keys(this._values))p._values[h]=this._values[h].possiblyEvaluate(i,o,u);return p}}class fu{constructor(i,o,u){this.property=i,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,o,u,p){return this.property.evaluate(this.value,this.parameters,i,o,u,p)}}class pu{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class wt{constructor(i){this.specification=i}possiblyEvaluate(i,o){return i.expression.evaluate(o)}interpolate(i,o,u){const p=Jl[this.specification.type];return p?p(i,o,u):i}}class Xt{constructor(i,o){this.specification=i,this.overrides=o}possiblyEvaluate(i,o,u,p){return new fu(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(o,null,{},u,p)}:i.expression,o)}interpolate(i,o,u){if(i.value.kind!=="constant"||o.value.kind!=="constant")return i;if(i.value.value===void 0||o.value.value===void 0)return new fu(this,{kind:"constant",value:void 0},i.parameters);const p=Jl[this.specification.type];return p?new fu(this,{kind:"constant",value:p(i.value.value,o.value.value,u)},i.parameters):i}evaluate(i,o,u,p,h,m){return i.kind==="constant"?i.value:i.evaluate(o,u,p,h,m)}}class Gs{constructor(i){this.specification=i}possiblyEvaluate(i,o,u,p){return!!i.expression.evaluate(o,null,{},u,p)}interpolate(){return!1}}class Ui{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new nn(0,{});for(const u in i){const p=i[u];p.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new Ff(p,void 0),m=this.defaultTransitionablePropertyValues[u]=new tg(p);this.defaultTransitioningPropertyValues[u]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(o)}}}jt(Xt,"DataDrivenProperty"),jt(wt,"DataConstantProperty"),jt(Gs,"ColorRampProperty");var Ue=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Nh(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Nf(c){if(Array.isArray(c))return c.map(Nf);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const i={};for(const o in c)i[o]=Nf(c[o]);return i}return Nh(c)}function rg(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const i of c.slice(1))if(!rg(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function Hs(c,i="",o=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};rg(c)||(c=$f(c));const p=c;let h=!0;try{h=function(w){if(!mu(w))return w;let P=Nf(w);return sc(P),P=ig(P),P}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}const m=Ue[`filter_${u}`],b=Bh(h,m,i,o);let S=null;if(b.result==="error")throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));S=(w,P,E)=>b.value.evaluate(w,P,{},E);let A=null,y=null;if(h!==p){const w=Bh(p,m,i,o);if(w.result==="error")throw new Error(w.value.map(P=>`${P.key}: ${P.message}`).join(", "));A=(P,E,O,M,R)=>w.value.evaluate(P,E,{},O,void 0,void 0,M,R),y=!Ph(w.value.expression)}return{filter:S,dynamicFilter:A||void 0,needGeometry:Sv(h),needFeature:!!y}}function ig(c){if(!Array.isArray(c))return c;const i=function(o){if(tw.has(o[0])){for(let u=1;u<o.length;u++)if(mu(o[u]))return!0}return o}(c);return i===!0?i:i.map(o=>ig(o))}function sc(c){let i=!1;const o=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)i=i||mu(c[u]),o.push(c[u+1]);o.push(c[c.length-1])}else if(c[0]==="match"){i=i||mu(c[1]);for(let u=2;u<c.length-1;u+=2)o.push(c[u+1]);o.push(c[c.length-1])}else if(c[0]==="step"){i=i||mu(c[1]);for(let u=1;u<c.length-1;u+=2)o.push(c[u+1])}i&&(c.length=0,c.push("any",...o));for(let u=1;u<c.length;u++)sc(c[u])}function mu(c){if(!Array.isArray(c))return!1;if((i=c[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let o=1;o<c.length;o++)if(mu(c[o]))return!0;return!1}const tw=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function rw(c,i){return c<i?-1:c>i?1:0}function Sv(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let i=1;i<c.length;i++)if(Sv(c[i]))return!0;return!1}function $f(c){if(!c)return!0;const i=c[0];return c.length<=1?i!=="any":i==="=="?jf(c[1],c[2],"=="):i==="!="?jh(jf(c[1],c[2],"==")):i==="<"||i===">"||i==="<="||i===">="?jf(c[1],c[2],i):i==="any"?(o=c.slice(1),["any"].concat(o.map($f))):i==="all"?["all"].concat(c.slice(1).map($f)):i==="none"?["all"].concat(c.slice(1).map($f).map(jh)):i==="in"?Vf(c[1],c.slice(2)):i==="!in"?jh(Vf(c[1],c.slice(2))):i==="has"?$h(c[1]):i!=="!has"||jh($h(c[1]));var o}function jf(c,i,o){switch(c){case"$type":return[`filter-type-${o}`,i];case"$id":return[`filter-id-${o}`,i];default:return[`filter-${o}`,c,i]}}function Vf(c,i){if(i.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(o=>typeof o!=typeof i[0])?["filter-in-large",c,["literal",i.sort(rw)]]:["filter-in-small",c,["literal",i]]}}function $h(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function jh(c){return["!",c]}const gu="";function Ov(c,i){return i?`${c}${gu}${i}`:c}const qs="-transition",iw=new Set(["fill","line","background","hillshade","raster"]);class ho extends Hc{constructor(i,o,u,p,h){if(super(),this.id=i.id,this.fqid=Ov(this.id,u),this.type=i.type,this.scope=u,this.lut=p,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),i.slot&&(this.slot=i.slot),o.layout&&(this._unevaluatedLayout=new ew(o.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint)){this._transitionablePaint=new wv(o.paint,this.scope,h);for(const m in i.paint)this.setPaintProperty(m,i.paint[m]);for(const m in i.layout)this.setLayoutProperty(m,i.layout[m]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pu(o.paint)}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D()&&iw.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,o){if(this.type==="custom"&&i==="visibility")return void(this.visibility=o);const u=this._unevaluatedLayout;u._properties.properties[i]&&(u.setValue(i,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(i){return xo(i,qs)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,o){const u=this._transitionablePaint,p=u._properties.properties;if(xo(i,qs)){const w=i.slice(0,-11);return p[w]&&u.setTransition(w,o||void 0),!1}if(!p[i])return!1;const h=u._values[i],m=h.value.isDataDriven(),b=h.value;u.setValue(i,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const S=u._values[i].value,A=S.isDataDriven(),y=xo(i,"pattern")||i==="line-dasharray";return A||m||y||this._handleOverridablePaintPropertyUpdate(i,b,S)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,o,u){return null}_handleOverridablePaintPropertyUpdate(i,o,u){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,o)}serialize(){return Nn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,o)=>!(i===void 0||o==="layout"&&!Object.keys(i).length||o==="paint"&&!Object.keys(i).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const o=this.paint.get(i);if(o instanceof fu&&Pf(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=Hs(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,o,u,p,h,m,b,S,A){}queryIntersectsMatchingFeature(i,o,u,p){}}const nw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Vh{constructor(i,o){this._structArray=i,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $i{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,o){return i._trim(),o&&(i.isTransferred=!0,o.add(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const o=Object.create(this.prototype);return o.arrayBuffer=i.arrayBuffer,o.length=i.length,o.capacity=i.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ti(c,i=1){let o=0,u=0;return{members:c.map(p=>{const h=nw[p.type].BYTES_PER_ELEMENT,m=o=Pv(o,Math.max(i,h)),b=p.components||1;return u=Math.max(u,h),o+=h*b,{name:p.name,type:p.type,components:b,offset:m}}),size:Pv(o,Math.max(u,i)),alignment:i}}function Pv(c,i){return Math.ceil(c/i)*i}class bl extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o){const u=this.length;return this.resize(u+1),this.emplace(u,i,o)}emplace(i,o,u){const p=2*i;return this.int16[p+0]=o,this.int16[p+1]=u,i}}bl.prototype.bytesPerElement=4,jt(bl,"StructArrayLayout2i4");class Uf extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,i,o,u)}emplace(i,o,u,p){const h=3*i;return this.int16[h+0]=o,this.int16[h+1]=u,this.int16[h+2]=p,i}}Uf.prototype.bytesPerElement=6,jt(Uf,"StructArrayLayout3i6");class xl extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,u,p)}emplace(i,o,u,p,h){const m=4*i;return this.int16[m+0]=o,this.int16[m+1]=u,this.int16[m+2]=p,this.int16[m+3]=h,i}}xl.prototype.bytesPerElement=8,jt(xl,"StructArrayLayout4i8");class Gf extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,u,p,h)}emplace(i,o,u,p,h,m){const b=5*i;return this.int16[b+0]=o,this.int16[b+1]=u,this.int16[b+2]=p,this.int16[b+3]=h,this.int16[b+4]=m,i}}Gf.prototype.bytesPerElement=10,jt(Gf,"StructArrayLayout5i10");class ng extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,u,p,h,m,b)}emplace(i,o,u,p,h,m,b,S){const A=6*i,y=12*i,w=3*i;return this.int16[A+0]=o,this.int16[A+1]=u,this.uint8[y+4]=p,this.uint8[y+5]=h,this.uint8[y+6]=m,this.uint8[y+7]=b,this.float32[w+2]=S,i}}ng.prototype.bytesPerElement=12,jt(ng,"StructArrayLayout2i4ub1f12");class ja extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,u,p)}emplace(i,o,u,p,h){const m=4*i;return this.float32[m+0]=o,this.float32[m+1]=u,this.float32[m+2]=p,this.float32[m+3]=h,i}}ja.prototype.bytesPerElement=16,jt(ja,"StructArrayLayout4f16");class wl extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,i,o,u)}emplace(i,o,u,p){const h=3*i;return this.float32[h+0]=o,this.float32[h+1]=u,this.float32[h+2]=p,i}}wl.prototype.bytesPerElement=12,jt(wl,"StructArrayLayout3f12");class Va extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,u,p,h)}emplace(i,o,u,p,h,m){const b=6*i,S=3*i;return this.uint16[b+0]=o,this.uint16[b+1]=u,this.uint16[b+2]=p,this.uint16[b+3]=h,this.float32[S+2]=m,i}}Va.prototype.bytesPerElement=12,jt(Va,"StructArrayLayout4ui1f12");class ac extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,u,p)}emplace(i,o,u,p,h){const m=4*i;return this.uint16[m+0]=o,this.uint16[m+1]=u,this.uint16[m+2]=p,this.uint16[m+3]=h,i}}ac.prototype.bytesPerElement=8,jt(ac,"StructArrayLayout4ui8");class Hf extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,i,o,u,p,h,m)}emplace(i,o,u,p,h,m,b){const S=6*i;return this.int16[S+0]=o,this.int16[S+1]=u,this.int16[S+2]=p,this.int16[S+3]=h,this.int16[S+4]=m,this.int16[S+5]=b,i}}Hf.prototype.bytesPerElement=12,jt(Hf,"StructArrayLayout6i12");class og extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b,S,A,y,w,P){const E=this.length;return this.resize(E+1),this.emplace(E,i,o,u,p,h,m,b,S,A,y,w,P)}emplace(i,o,u,p,h,m,b,S,A,y,w,P,E){const O=12*i;return this.int16[O+0]=o,this.int16[O+1]=u,this.int16[O+2]=p,this.int16[O+3]=h,this.uint16[O+4]=m,this.uint16[O+5]=b,this.uint16[O+6]=S,this.uint16[O+7]=A,this.int16[O+8]=y,this.int16[O+9]=w,this.int16[O+10]=P,this.int16[O+11]=E,i}}og.prototype.bytesPerElement=24,jt(og,"StructArrayLayout4i4ui4i24");class sg extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,i,o,u,p,h,m)}emplace(i,o,u,p,h,m,b){const S=10*i,A=5*i;return this.int16[S+0]=o,this.int16[S+1]=u,this.int16[S+2]=p,this.float32[A+2]=h,this.float32[A+3]=m,this.float32[A+4]=b,i}}sg.prototype.bytesPerElement=20,jt(sg,"StructArrayLayout3i3f20");class ag extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint32[1*i+0]=o,i}}ag.prototype.bytesPerElement=4,jt(ag,"StructArrayLayout1ul4");class Tl extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o){const u=this.length;return this.resize(u+1),this.emplace(u,i,o)}emplace(i,o,u){const p=2*i;return this.uint16[p+0]=o,this.uint16[p+1]=u,i}}Tl.prototype.bytesPerElement=4,jt(Tl,"StructArrayLayout2ui4");class _u extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b,S,A,y,w,P,E){const O=this.length;return this.resize(O+1),this.emplace(O,i,o,u,p,h,m,b,S,A,y,w,P,E)}emplace(i,o,u,p,h,m,b,S,A,y,w,P,E,O){const M=20*i,R=10*i;return this.int16[M+0]=o,this.int16[M+1]=u,this.int16[M+2]=p,this.int16[M+3]=h,this.int16[M+4]=m,this.float32[R+3]=b,this.float32[R+4]=S,this.float32[R+5]=A,this.float32[R+6]=y,this.int16[M+14]=w,this.uint32[R+8]=P,this.uint16[M+18]=E,this.uint16[M+19]=O,i}}_u.prototype.bytesPerElement=40,jt(_u,"StructArrayLayout5i4f1i1ul2ui40");class lc extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,u,p,h,m,b)}emplace(i,o,u,p,h,m,b,S){const A=8*i;return this.int16[A+0]=o,this.int16[A+1]=u,this.int16[A+2]=p,this.int16[A+4]=h,this.int16[A+5]=m,this.int16[A+6]=b,this.int16[A+7]=S,i}}lc.prototype.bytesPerElement=16,jt(lc,"StructArrayLayout3i2i2i16");class So extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,u,p,h)}emplace(i,o,u,p,h,m){const b=4*i,S=8*i;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=p,this.int16[S+6]=h,this.int16[S+7]=m,i}}So.prototype.bytesPerElement=16,jt(So,"StructArrayLayout2f1f2i16");class yu extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,i,o,u,p,h,m)}emplace(i,o,u,p,h,m,b){const S=20*i,A=5*i;return this.uint8[S+0]=o,this.uint8[S+1]=u,this.float32[A+1]=p,this.float32[A+2]=h,this.float32[A+3]=m,this.float32[A+4]=b,i}}yu.prototype.bytesPerElement=20,jt(yu,"StructArrayLayout2ub4f20");class Jn extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u){const p=this.length;return this.resize(p+1),this.emplace(p,i,o,u)}emplace(i,o,u,p){const h=3*i;return this.uint16[h+0]=o,this.uint16[h+1]=u,this.uint16[h+2]=p,i}}Jn.prototype.bytesPerElement=6,jt(Jn,"StructArrayLayout3ui6");class lg extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z,V,G,F,q){const W=this.length;return this.resize(W+1),this.emplace(W,i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z,V,G,F,q)}emplace(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z,V,G,F,q,W){const te=30*i,se=15*i,le=60*i;return this.int16[te+0]=o,this.int16[te+1]=u,this.int16[te+2]=p,this.float32[se+2]=h,this.float32[se+3]=m,this.uint16[te+8]=b,this.uint16[te+9]=S,this.uint32[se+5]=A,this.uint32[se+6]=y,this.uint32[se+7]=w,this.uint16[te+16]=P,this.uint16[te+17]=E,this.uint16[te+18]=O,this.float32[se+10]=M,this.float32[se+11]=R,this.uint8[le+48]=z,this.uint8[le+49]=V,this.uint8[le+50]=G,this.uint32[se+13]=F,this.int16[te+28]=q,this.uint8[le+58]=W,i}}lg.prototype.bytesPerElement=60,jt(lg,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class cg extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z,V,G,F,q,W,te,se,le,ne,me,he,_e,Ae,Me,Re){const Be=this.length;return this.resize(Be+1),this.emplace(Be,i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z,V,G,F,q,W,te,se,le,ne,me,he,_e,Ae,Me,Re)}emplace(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z,V,G,F,q,W,te,se,le,ne,me,he,_e,Ae,Me,Re,Be){const Ge=20*i,Fe=40*i,tt=80*i;return this.float32[Ge+0]=o,this.float32[Ge+1]=u,this.int16[Fe+4]=p,this.int16[Fe+5]=h,this.int16[Fe+6]=m,this.int16[Fe+7]=b,this.int16[Fe+8]=S,this.int16[Fe+9]=A,this.int16[Fe+10]=y,this.int16[Fe+11]=w,this.int16[Fe+12]=P,this.uint16[Fe+13]=E,this.uint16[Fe+14]=O,this.uint16[Fe+15]=M,this.uint16[Fe+16]=R,this.uint16[Fe+17]=z,this.uint16[Fe+18]=V,this.uint16[Fe+19]=G,this.uint16[Fe+20]=F,this.uint16[Fe+21]=q,this.uint16[Fe+22]=W,this.uint16[Fe+23]=te,this.uint16[Fe+24]=se,this.uint16[Fe+25]=le,this.uint16[Fe+26]=ne,this.uint16[Fe+27]=me,this.uint32[Ge+14]=he,this.float32[Ge+15]=_e,this.float32[Ge+16]=Ae,this.float32[Ge+17]=Me,this.float32[Ge+18]=Re,this.uint8[tt+76]=Be,i}}cg.prototype.bytesPerElement=80,jt(cg,"StructArrayLayout2f9i15ui1ul4f1ub80");class vu extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.float32[1*i+0]=o,i}}vu.prototype.bytesPerElement=4,jt(vu,"StructArrayLayout1f4");class Ua extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,o,u,p,h)}emplace(i,o,u,p,h,m){const b=5*i;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=p,this.float32[b+3]=h,this.float32[b+4]=m,i}}Ua.prototype.bytesPerElement=20,jt(Ua,"StructArrayLayout5f20");class ug extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,u,p,h,m,b)}emplace(i,o,u,p,h,m,b,S){const A=7*i;return this.float32[A+0]=o,this.float32[A+1]=u,this.float32[A+2]=p,this.float32[A+3]=h,this.float32[A+4]=m,this.float32[A+5]=b,this.float32[A+6]=S,i}}ug.prototype.bytesPerElement=28,jt(ug,"StructArrayLayout7f28");class Uh extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,o,u,p){const h=this.length;return this.resize(h+1),this.emplace(h,i,o,u,p)}emplace(i,o,u,p,h){const m=6*i;return this.uint32[3*i+0]=o,this.uint16[m+2]=u,this.uint16[m+3]=p,this.uint16[m+4]=h,i}}Uh.prototype.bytesPerElement=12,jt(Uh,"StructArrayLayout1ul3ui12");class hg extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint16[1*i+0]=o,i}}hg.prototype.bytesPerElement=2,jt(hg,"StructArrayLayout1ui2");class Gh extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o){const u=this.length;return this.resize(u+1),this.emplace(u,i,o)}emplace(i,o,u){const p=2*i;return this.float32[p+0]=o,this.float32[p+1]=u,i}}Gh.prototype.bytesPerElement=8,jt(Gh,"StructArrayLayout2f8");class Hh extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R){const z=this.length;return this.resize(z+1),this.emplace(z,i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R)}emplace(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z){const V=16*i;return this.float32[V+0]=o,this.float32[V+1]=u,this.float32[V+2]=p,this.float32[V+3]=h,this.float32[V+4]=m,this.float32[V+5]=b,this.float32[V+6]=S,this.float32[V+7]=A,this.float32[V+8]=y,this.float32[V+9]=w,this.float32[V+10]=P,this.float32[V+11]=E,this.float32[V+12]=O,this.float32[V+13]=M,this.float32[V+14]=R,this.float32[V+15]=z,i}}Hh.prototype.bytesPerElement=64,jt(Hh,"StructArrayLayout16f64");class qf extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,o,u,p,h,m,b){const S=this.length;return this.resize(S+1),this.emplace(S,i,o,u,p,h,m,b)}emplace(i,o,u,p,h,m,b,S){const A=10*i,y=5*i;return this.uint16[A+0]=o,this.uint16[A+1]=u,this.uint16[A+2]=p,this.uint16[A+3]=h,this.float32[y+2]=m,this.float32[y+3]=b,this.float32[y+4]=S,i}}qf.prototype.bytesPerElement=20,jt(qf,"StructArrayLayout4ui3f20");class Wf extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.int16[1*i+0]=o,i}}Wf.prototype.bytesPerElement=2,jt(Wf,"StructArrayLayout1i2");class Zf extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const o=this.length;return this.resize(o+1),this.emplace(o,i)}emplace(i,o){return this.uint8[1*i+0]=o,i}}Zf.prototype.bytesPerElement=1,jt(Zf,"StructArrayLayout1ub1");class Av extends Vh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Av.prototype.size=40;class Xf extends _u{get(i){return new Av(this,i)}}jt(Xf,"CollisionBoxArray");class qh extends Vh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}qh.prototype.size=60;class dg extends lg{get(i){return new qh(this,i)}}jt(dg,"PlacedSymbolArray");class Cv extends Vh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Cv.prototype.size=80;class fg extends cg{get(i){return new Cv(this,i)}}jt(fg,"SymbolInstanceArray");class Mv extends vu{getoffsetX(i){return this.float32[1*i+0]}}jt(Mv,"GlyphOffsetArray");class Kf extends bl{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}jt(Kf,"SymbolLineVertexArray");class Iv extends Vh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Iv.prototype.size=12;class Dv extends Uh{get(i){return new Iv(this,i)}}jt(Dv,"FeatureIndexArray");class Rv extends Tl{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}jt(Rv,"FillExtrusionCentroidArray");class Lv extends Vh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Lv.prototype.size=6;class pg extends Uf{get(i){return new Lv(this,i)}}jt(pg,"FillExtrusionWallArray");const ow=ti([{name:"a_pos",components:2,type:"Int16"}],4),sw=ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class on{constructor(i=[]){this.segments=i}_prepareSegment(i,o,u,p){let h=this.segments[this.segments.length-1];return i>on.MAX_VERTEX_ARRAY_LENGTH&&Jr(`Max vertices per segment is ${on.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!h||h.vertexLength+i>on.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==p)&&(h={vertexOffset:o,primitiveOffset:u,vertexLength:0,primitiveLength:0},p!==void 0&&(h.sortKey=p),this.segments.push(h)),h}prepareSegment(i,o,u,p){return this._prepareSegment(i,o.length,u.length,p)}get(){return this.segments}destroy(){for(const i of this.segments)for(const o in i.vaos)i.vaos[o].destroy()}static simpleSegment(i,o,u,p){return new on([{vertexOffset:i,primitiveOffset:o,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}function Bv(c,i){return 256*(c=Dt(Math.floor(c),0,255))+Dt(Math.floor(i),0,255)}on.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jt(on,"SegmentVector");const aw=ti([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),lw=ti([{name:"a_dash",components:4,type:"Uint16"}]);class Wh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,o,u,p){this.ids.push(kv(i)),this.positions.push(o,u,p)}eachPosition(i,o){const u=kv(i);let p=0,h=this.ids.length-1;for(;p<h;){const m=p+h>>1;this.ids[m]>=u?h=m:p=m+1}for(;this.ids[p]===u;)o(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(i,o){const u=new Float64Array(i.ids),p=new Uint32Array(i.positions);return bu(u,p,0,u.length-1),o&&(o.add(u.buffer),o.add(p.buffer)),{ids:u,positions:p}}static deserialize(i){const o=new Wh;let u;o.ids=i.ids,o.positions=i.positions;for(const p of o.ids)p!==u&&o.uniqueIds.push(p),u=p;return o.indexed=!0,o}}function kv(c){const i=+c;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Bo(String(c))}function bu(c,i,o,u){for(;o<u;){const p=c[o+u>>1];let h=o-1,m=u+1;for(;;){do h++;while(c[h]<p);do m--;while(c[m]>p);if(h>=m)break;Yf(c,h,m),Yf(i,3*h,3*m),Yf(i,3*h+1,3*m+1),Yf(i,3*h+2,3*m+2)}m-o<u-m?(bu(c,i,o,m),o=m+1):(bu(c,i,m+1,u),u=m)}}function Yf(c,i,o){const u=c[i];c[i]=c[o],c[o]=u}jt(Wh,"FeaturePositionMap");class Ga{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,o),this.initialized=!0),!!this.location}set(i,o,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class cc extends Ga{constructor(i){super(i),this.current=0}set(i,o,u){this.fetchUniformLocation(i,o)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class fo extends Ga{constructor(i){super(i),this.current=0}set(i,o,u){this.fetchUniformLocation(i,o)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class ya extends Ga{constructor(i){super(i),this.current=[0,0]}set(i,o,u){this.fetchUniformLocation(i,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class mg extends Ga{constructor(i){super(i),this.current=[0,0,0]}set(i,o,u){this.fetchUniformLocation(i,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Jf extends Ga{constructor(i){super(i),this.current=[0,0,0,0]}set(i,o,u){this.fetchUniformLocation(i,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class gg extends Ga{constructor(i){super(i),this.current=li.transparent.toRenderColor(null)}set(i,o,u){this.fetchUniformLocation(i,o)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const zv=new Float32Array(16);class Zh extends Ga{constructor(i){super(i),this.current=zv}set(i,o,u){if(this.fetchUniformLocation(i,o)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let p=1;p<16;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const cw=new Float32Array(9),uw=new Float32Array(4);class _g extends Ga{constructor(i){super(i),this.current=uw}set(i,o,u){if(this.fetchUniformLocation(i,o)){for(let p=0;p<4;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function yg(c){return[Bv(255*c.r,255*c.g),Bv(255*c.b,255*c.a)]}class Xh{constructor(i,o,u,p){this.value=i,this.uniformNames=o.map(h=>`u_${h}`),this.type=u,this.context=p}setUniform(i,o,u,p,h){const m=p.constantOr(this.value);o.set(i,h,m instanceof li?m.toRenderColor(this.context.lut):m)}getBinding(i,o){return this.type==="color"?new gg(i):new fo(i)}}class xu{constructor(i,o){this.uniformNames=o.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,o,u,p,h){const m=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;m&&o.set(i,h,m)}getBinding(i,o){return o==="u_pattern"||o==="u_dash"?new Jf(i):new fo(i)}}class va{constructor(i,o,u,p){this.expression=i,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(i,o,u,p,h,m,b){const S=this.paintVertexArray.length,A=this.expression.evaluate(new nn(0,{brightness:m}),o,{},h,p,b);this.paintVertexArray.resize(i),this._setPaintValue(S,i,A,this.context)}updatePaintArray(i,o,u,p,h,m,b){const S=this.expression.evaluate({zoom:0,brightness:b},u,p,void 0,h);this._setPaintValue(i,o,S,this.context)}_setPaintValue(i,o,u,p){if(this.type==="color"){const h=yg(u.toRenderColor(p.lut));for(let m=i;m<o;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=i;h<o;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Qo{constructor(i,o,u,p,h,m){this.expression=i,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=u,this.useIntegerZoom=p,this.context=h,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(i,o,u,p,h,m,b){const S=this.expression.evaluate(new nn(this.context.zoom,{brightness:m}),o,{},h,p,b),A=this.expression.evaluate(new nn(this.context.zoom+1,{brightness:m}),o,{},h,p,b),y=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(y,i,S,A,this.context)}updatePaintArray(i,o,u,p,h,m,b){const S=this.expression.evaluate({zoom:this.context.zoom,brightness:b},u,p,void 0,h),A=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b},u,p,void 0,h);this._setPaintValue(i,o,S,A,this.context)}_setPaintValue(i,o,u,p,h){if(this.type==="color"){const m=yg(u.toRenderColor(h.lut)),b=yg(u.toRenderColor(h.lut));for(let S=i;S<o;S++)this.paintVertexArray.emplace(S,m[0],m[1],b[0],b[1])}else{for(let m=i;m<o;m++)this.paintVertexArray.emplace(m,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,o,u,p,h){const m=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,b=Dt(this.expression.interpolationFactor(m,this.context.zoom,this.context.zoom+1),0,1);o.set(i,h,b)}getBinding(i,o){return new fo(i)}}class ba{constructor(i,o,u,p,h){this.expression=i,this.layerId=h,this.paintVertexAttributes=(u==="array"?lw:aw).members;for(let m=0;m<o.length;++m);this.paintVertexArray=new p}populatePaintArray(i,o,u,p){const h=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(h,i,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(i,o,u,p,h,m,b){this._setPaintValues(i,o,u.patterns&&u.patterns[this.layerId],m)}_setPaintValues(i,o,u,p){if(!p||!u)return;const h=p[u];if(!h)return;const{tl:m,br:b,pixelRatio:S}=h;for(let A=i;A<o;A++)this.paintVertexArray.emplace(A,m[0],m[1],b[0],b[1],S)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class uc{constructor(i,o,u=()=>!0){this.binders={},this._buffers=[],this.context=o;const p=[];for(const h in i.paint._values){const m=i.paint.get(h);if(!u(h)||!(m instanceof fu&&Pf(m.property.specification)))continue;const b=dw(h,i.type),S=m.value,A=m.property.specification.type,y=!!m.property.useIntegerZoom,w=h==="line-dasharray"||h.endsWith("pattern"),P=h==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||P)if(S.kind==="source"||P||w){const E=d(h,A,"source");this.binders[h]=w?new ba(S,b,A,E,i.id):new va(S,b,A,E),p.push(`/a_${h}`)}else{const E=d(h,A,"composite");this.binders[h]=new Qo(S,b,A,y,o,E),p.push(`/z_${h}`)}else this.binders[h]=w?new xu(S.value,b):new Xh(S.value,b,A,o),p.push(`/u_${h}`)}this.cacheKey=p.sort().join("")}getMaxValue(i){const o=this.binders[i];return o instanceof va||o instanceof Qo?o.maxValue:0}populatePaintArrays(i,o,u,p,h,m,b){for(const S in this.binders){const A=this.binders[S];A.context=this.context,(A instanceof va||A instanceof Qo||A instanceof ba)&&A.populatePaintArray(i,o,u,p,h,m,b)}}setConstantPatternPositions(i){for(const o in this.binders){const u=this.binders[o];u instanceof xu&&u.setConstantPatternPositions(i)}}updatePaintArrays(i,o,u,p,h,m,b,S){let A=!1;const y=Object.keys(i),w=y.length!==0,P=w?y:o.uniqueIds;this.context.lut=h.lut;for(const E in this.binders){const O=this.binders[E];if(O.context=this.context,(O instanceof va||O instanceof Qo||O instanceof ba)&&(O.expression.isStateDependent===!0||O.expression.isLightConstant===!1)){const M=h.paint.get(E);O.expression=M.value;for(const R of P){const z=i[R.toString()];o.eachPosition(R,(V,G,F)=>{const q=p.feature(V);O.updatePaintArray(G,F,q,z,m,b,S)})}if(!w)for(const R of u.uniqueIds){const z=i[R.toString()];u.eachPosition(R,(V,G,F)=>{const q=p.feature(V);O.updatePaintArray(G,F,q,z,m,b,S)})}A=!0}}return A}defines(){const i=[];for(const o in this.binders){const u=this.binders[o];(u instanceof Xh||u instanceof xu)&&i.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return i}getBinderAttributes(){const i=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof va||u instanceof Qo||u instanceof ba)for(let p=0;p<u.paintVertexAttributes.length;p++)i.push(u.paintVertexAttributes[p].name)}return i}getBinderUniforms(){const i=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Xh||u instanceof xu||u instanceof Qo)for(const p of u.uniformNames)i.push(p)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const o=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Xh||p instanceof xu||p instanceof Qo)for(const h of p.uniformNames)o.push({name:h,property:u,binding:p.getBinding(i,h)})}return o}setUniforms(i,o,u,p,h){for(const{name:m,property:b,binding:S}of u)this.binders[b].setUniform(i,S,h,p.get(b),m)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const o=this.binders[i];(o instanceof va||o instanceof Qo||o instanceof ba)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(i){for(const o in this.binders){const u=this.binders[o];(u instanceof va||u instanceof Qo||u instanceof ba)&&u.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const o=this.binders[i];(o instanceof va||o instanceof Qo||o instanceof ba)&&o.destroy()}}}class El{constructor(i,o,u=()=>!0){this.programConfigurations={};for(const p of i)this.programConfigurations[p.id]=new uc(p,o,u);this.needsUpload=!1,this._featureMap=new Wh,this._featureMapWithoutIds=new Wh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,o,u,p,h,m,b,S){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(i,o,p,h,m,b,S);o.id!==void 0?this._featureMap.add(o.id,u,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,o,u,p,h,m){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,o,b,p,h,m||0)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const hw={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function dw(c,i){return hw[c]||[c.replace(`${i}-`,"").replace(/-/g,"_")]}const fw={"line-pattern":{source:Va,composite:Va},"fill-pattern":{source:Va,composite:Va},"fill-extrusion-pattern":{source:Va,composite:Va},"line-dasharray":{source:ac,composite:ac}},Fv={color:{source:Gh,composite:ja},number:{source:vu,composite:Gh}};function d(c,i,o){const u=fw[c];return u&&u[o]||Fv[i][o]}jt(Xh,"ConstantBinder"),jt(xu,"PatternConstantBinder"),jt(va,"SourceExpressionBinder"),jt(ba,"PatternCompositeBinder"),jt(Qo,"CompositeExpressionBinder"),jt(uc,"ProgramConfiguration",{omit:["_buffers"]}),jt(El,"ProgramConfigurationSet");const n=It/Math.PI/2,l=5,f=6,_=16383,v=64,x=[v,32,16],C=-n,D=n;function L(c,i,o,u=n){return o=Mt(o),[c*Math.sin(o)*u,-i*u,c*Math.cos(o)*u]}function B(c,i,o){return L(Math.cos(Mt(c)),Math.sin(Mt(c)),i,o)}const $=63710088e-1,j=2*Math.PI*$;class U{constructor(i,o){if(isNaN(i)||isNaN(o))throw new Error(`Invalid LngLat object: (${i}, ${o})`);if(this.lng=+i,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new U(Hr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const o=Math.PI/180,u=this.lat*o,p=i.lat*o,h=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((i.lng-this.lng)*o);return $*Math.acos(Math.min(h,1))}toBounds(i=0){const o=360*i/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new Z({lng:this.lng-u,lat:this.lat-o},{lng:this.lng+u,lat:this.lat+o})}toEcef(i){return B(this.lat,this.lng,n+i*n/$)}static convert(i){if(i instanceof U)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new U(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new U(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Z{constructor(i,o){if(i)if(o)this.setSouthWest(i).setNorthEast(o);else if(i.length===4){const u=i;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=i;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(i){return this._ne=i instanceof U?new U(i.lng,i.lat):U.convert(i),this}setSouthWest(i){return this._sw=i instanceof U?new U(i.lng,i.lat):U.convert(i),this}extend(i){const o=this._sw,u=this._ne;let p,h;if(i instanceof U)p=i,h=i;else{if(!(i instanceof Z))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Z.convert(i)):this.extend(U.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(U.convert(i)):this;if(p=i._sw,h=i._ne,!p||!h)return this}return o||u?(o.lng=Math.min(p.lng,o.lng),o.lat=Math.min(p.lat,o.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new U(p.lng,p.lat),this._ne=new U(h.lng,h.lat)),this}getCenter(){return new U((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new U(this.getWest(),this.getNorth())}getSouthEast(){return new U(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:o,lat:u}=U.convert(i);let p=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(i){if(i)return i instanceof Z?i:new Z(i)}}const X=0,Y=25.5;function J(c){return j*Math.cos(c*Math.PI/180)}function ae(c){return(180+c)/360}function ce(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function oe(c,i){return c/J(i)}function fe(c){return 360*c-180}function de(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function ye(c,i){return c*J(de(i))}const ge=85.051129;function ve(c){return Math.cos(Mt(Dt(c,-ge,ge)))}function Ce(c,i){const o=Dt(i,X,Y),u=Math.pow(2,o);return ve(c)*j/(512*u)}function Oe(c){return 1/Math.cos(c*Math.PI/180)}function Te(c,i=0){const o=Math.exp(Math.PI*(1-(c.y+i/It)/(1<<c.z)*2));return 80150034*o/(o*o+1)/It/(1<<c.z)}class $e{constructor(i,o,u=0){this.x=+i,this.y=+o,this.z=+u}static fromLngLat(i,o=0){const u=U.convert(i);return new $e(ae(u.lng),ce(u.lat),oe(o,u.lat))}toLngLat(){return new U(fe(this.x),de(this.y))}toAltitude(){return ye(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/j*Oe(de(this.y))}}function Je(c,i,o,u,p,h,m,b,S){const A=(i+u)/2,y=(o+p)/2,w=new ze(A,y);b(w),function(P,E,O,M,R,z){const V=O-R,G=M-z;return Math.abs((M-E)*V-(O-P)*G)/Math.hypot(V,G)}(w.x,w.y,h.x,h.y,m.x,m.y)>=S?(Je(c,i,o,A,y,h,w,b,S),Je(c,A,y,u,p,w,m,b,S)):c.push(m)}function ct(c,i,o){let u=c[0],p=u.x,h=u.y;i(u);const m=[u];for(let b=1;b<c.length;b++){const S=c[b],{x:A,y}=S;i(S),Je(m,p,h,A,y,u,S,i,o),p=A,h=y,u=S}return m}function Ke(c,i,o,u){if(u(i,o)){const p=i.add(o)._mult(.5);Ke(c,i,p,u),Ke(c,p,o,u)}else c.push(o)}function _t(c,i){let o=c[0];const u=[o];for(let p=1;p<c.length;p++){const h=c[p];Ke(u,o,h,i),o=h}return u}const je=Math.pow(2,14)-1,nt=-je-1;function rt(c,i){const o=Math.round(c.x*i),u=Math.round(c.y*i);return c.x=Dt(o,nt,je),c.y=Dt(u,nt,je),(o<c.x||o>c.x+1||u<c.y||u>c.y+1)&&Jr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function vt(c,i,o){const u=c.loadGeometry(),p=c.extent,h=It/p;if(i&&o&&o.projection.isReprojectedInTileSpace){const m=1<<i.z,{scale:b,x:S,y:A,projection:y}=o,w=P=>{const E=fe((i.x+P.x/p)/m),O=de((i.y+P.y/p)/m),M=y.project(E,O);P.x=(M.x*b-S)*p,P.y=(M.y*b-A)*p};for(let P=0;P<u.length;P++)if(c.type!==1)u[P]=ct(u[P],w,1);else{const E=[];for(const O of u[P])O.x<0||O.x>=p||O.y<0||O.y>=p||(w(O),E.push(O));u[P]=E}}for(const m of u)for(const b of m)rt(b,h);return u}function xt(c,i){return{type:c.type,id:c.id,properties:c.properties,geometry:i?vt(c):[]}}function lt(c,i,o,u,p){c.emplaceBack(2*i+(u+1)/2,2*o+(p+1)/2)}function pt(c,i,o){c.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class Kt{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new bl,this.indexArray=new Jn,this.segments=new on,this.programConfigurations=new El(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}updateFootprints(i,o){}populate(i,o,u,p){const h=this.layers[0],m=[];let b=null;h.type==="circle"&&(b=h.layout.get("circle-sort-key"));for(const{feature:A,id:y,index:w,sourceLayerIndex:P}of i){const E=this.layers[0]._featureFilter.needGeometry,O=xt(A,E);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),O,u))continue;const M=b?b.evaluate(O,{},u):void 0,R={id:y,properties:A.properties,type:A.type,sourceLayerIndex:P,index:w,geometry:E?O.geometry:vt(A,u,p),patterns:{},sortKey:M};m.push(R)}b&&m.sort((A,y)=>A.sortKey-y.sortKey);let S=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Hf,S=p.projection);for(const A of m){const{geometry:y,index:w,sourceLayerIndex:P}=A,E=i[w].feature;this.addFeature(A,y,w,o.availableImages,u,S,o.brightness),o.featureIndex.insert(E,y,w,P,this.index)}}update(i,o,u,p,h){const m=Object.keys(i).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,o,m?this.stateDependentLayers:this.layers,u,p,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,ow.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,sw.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,o,u,p,h,m,b){for(const S of o)for(const A of S){const y=A.x,w=A.y;if(y<0||y>=It||w<0||w>=It)continue;if(m){const O=m.projectTilePoint(y,w,h),M=m.upVector(h,y,w),R=this.globeExtVertexArray;pt(R,O,M),pt(R,O,M),pt(R,O,M),pt(R,O,M)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),E=P.vertexLength;lt(this.layoutVertexArray,y,w,-1,-1),lt(this.layoutVertexArray,y,w,1,-1),lt(this.layoutVertexArray,y,w,1,1),lt(this.layoutVertexArray,y,w,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+2,E+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,{},p,h,b)}}function Ot(c,i){for(let o=0;o<c.length;o++)if(zi(i,c[o]))return!0;for(let o=0;o<i.length;o++)if(zi(c,i[o]))return!0;return!!tr(c,i)}function Ft(c,i,o){return!!zi(c,i)||!!Pr(i,c,o)}function sr(c,i){if(c.length===1)return wi(i,c[0]);for(let o=0;o<i.length;o++){const u=i[o];for(let p=0;p<u.length;p++)if(zi(c,u[p]))return!0}for(let o=0;o<c.length;o++)if(wi(i,c[o]))return!0;for(let o=0;o<i.length;o++)if(tr(c,i[o]))return!0;return!1}function Ht(c,i,o){if(c.length>1){if(tr(c,i))return!0;for(let u=0;u<i.length;u++)if(Pr(i[u],c,o))return!0}for(let u=0;u<c.length;u++)if(Pr(c[u],i,o))return!0;return!1}function tr(c,i){if(c.length===0||i.length===0)return!1;for(let o=0;o<c.length-1;o++){const u=c[o],p=c[o+1];for(let h=0;h<i.length-1;h++)if(Ir(u,p,i[h],i[h+1]))return!0}return!1}function Ir(c,i,o,u){return da(c,o,u)!==da(i,o,u)&&da(c,i,o)!==da(c,i,u)}function Pr(c,i,o){const u=o*o;if(i.length===1)return c.distSqr(i[0])<u;for(let p=1;p<i.length;p++)if(fi(c,i[p-1],i[p])<u)return!0;return!1}function fi(c,i,o){const u=i.distSqr(o);if(u===0)return c.distSqr(i);const p=((c.x-i.x)*(o.x-i.x)+(c.y-i.y)*(o.y-i.y))/u;return c.distSqr(p<0?i:p>1?o:o.sub(i)._mult(p)._add(i))}function wi(c,i){let o,u,p,h=!1;for(let m=0;m<c.length;m++){o=c[m];for(let b=0,S=o.length-1;b<o.length;S=b++)u=o[b],p=o[S],u.y>i.y!=p.y>i.y&&i.x<(p.x-u.x)*(i.y-u.y)/(p.y-u.y)+u.x&&(h=!h)}return h}function zi(c,i){let o=!1;for(let u=0,p=c.length-1;u<c.length;p=u++){const h=c[u],m=c[p];h.y>i.y!=m.y>i.y&&i.x<(m.x-h.x)*(i.y-h.y)/(m.y-h.y)+h.x&&(o=!o)}return o}function ps(c,i,o,u,p){for(const m of c)if(i<=m.x&&o<=m.y&&u>=m.x&&p>=m.y)return!0;const h=[new ze(i,o),new ze(i,p),new ze(u,p),new ze(u,o)];if(c.length>2){for(const m of h)if(zi(c,m))return!0}for(let m=0;m<c.length-1;m++)if(gn(c[m],c[m+1],h))return!0;return!1}function gn(c,i,o){const u=o[0],p=o[2];if(c.x<u.x&&i.x<u.x||c.x>p.x&&i.x>p.x||c.y<u.y&&i.y<u.y||c.y>p.y&&i.y>p.y)return!1;const h=da(c,i,o[0]);return h!==da(c,i,o[1])||h!==da(c,i,o[2])||h!==da(c,i,o[3])}function Fr(c,i,o,u,p,h){let m=i.y-c.y,b=c.x-i.x;if(h=h||0){const S=m*m+b*b;if(S===0)return!0;const A=Math.sqrt(S);m/=A,b/=A}return!((o.x-c.x)*m+(o.y-c.y)*b-h<0||(u.x-c.x)*m+(u.y-c.y)*b-h<0||(p.x-c.x)*m+(p.y-c.y)*b-h<0)}function vi(c,i,o,u,p,h,m){return!(Fr(c,i,u,p,h,m)||Fr(i,o,u,p,h,m)||Fr(o,c,u,p,h,m)||Fr(u,p,c,i,o,m)||Fr(p,h,c,i,o,m)||Fr(h,u,c,i,o,m))}function Gi(c,i,o){const u=i.paint.get(c).value;return u.kind==="constant"?u.value:o.programConfigurations.get(i.id).getMaxValue(c)}function mi(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Ar(c,i,o,u,p){if(!i[0]&&!i[1])return c;const h=ze.convert(i)._mult(p);o==="viewport"&&h._rotate(-u);const m=[];for(let b=0;b<c.length;b++)m.push(c[b].sub(h));return m}function ri(c,i,o,u){const p=ze.convert(c)._mult(u);return i==="viewport"&&p._rotate(-o),p}let ci,sn;jt(Kt,"CircleBucket",{omit:["layers"]});var _n,Xr={exports:{}},In=(_n||(_n=1,function(c,i){(function(o){function u(h,m,b){var S=p(256*h,256*(m=Math.pow(2,b)-m-1),b),A=p(256*(h+1),256*(m+1),b);return S[0]+","+S[1]+","+A[0]+","+A[1]}function p(h,m,b){var S=2*Math.PI*6378137/256/Math.pow(2,b);return[h*S-2*Math.PI*6378137/2,m*S-2*Math.PI*6378137/2]}o.getURL=function(h,m,b,S,A,y){return y=y||{},h+"?"+["bbox="+u(b,S,A),"format="+(y.format||"image/png"),"service="+(y.service||"WMS"),"version="+(y.version||"1.1.1"),"request="+(y.request||"GetMap"),"srs="+(y.srs||"EPSG:3857"),"width="+(y.width||256),"height="+(y.height||256),"layers="+m].join("&")},o.getTileBBox=u,o.getMercCoords=p,Object.defineProperty(o,"__esModule",{value:!0})})(i)}(0,Xr.exports)),Xr.exports);class jn{constructor(i,o,u){this.z=i,this.x=o,this.y=u,this.key=Oo(0,i,i,o,u)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,o){const u=In.getTileBBox(this.x,this.y,this.z),p=function(h,m,b){let S,A="";for(let y=h;y>0;y--)S=1<<y-1,A+=(m&S?1:0)+(b&S?2:0);return A}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dn{constructor(i,o){this.wrap=i,this.canonical=o,this.key=Oo(i,o.z,o.z,o.x,o.y)}}class Ii{constructor(i,o,u,p,h){this.overscaledZ=i,this.wrap=o,this.canonical=new jn(u,+p,+h),this.key=o===0&&i===u?this.canonical.key:Oo(o,i,u,p,h)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const o=this.canonical.z-i;return i>this.canonical.z?new Ii(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ii(i,this.wrap,i,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(i,o=!0){if(this.overscaledZ===i&&o)return this.key;if(i>this.canonical.z)return Oo(this.wrap*+o,i,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-i;return Oo(this.wrap*+o,i,i,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const o=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>o&&i.canonical.y===this.canonical.y>>o}children(i){if(this.overscaledZ>=i)return[new Ii(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new Ii(o,this.wrap,o,u,p),new Ii(o,this.wrap,o,u+1,p),new Ii(o,this.wrap,o,u,p+1),new Ii(o,this.wrap,o,u+1,p+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Ii(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Ii(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dn(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Oo(c,i,o,u,p){const h=1<<Math.min(o,22);let m=h*(p%h)+u%h;return c&&o<22&&(m+=h*h*((c<0?-2*c-1:2*c)%(1<<2*(22-o)))),16*(32*m+o)+(i-o)}const Po=[c=>{let i=c.canonical.x-1,o=c.wrap;return i<0&&(i=(1<<c.canonical.z)-1,o--),new Ii(c.overscaledZ,o,c.canonical.z,i,c.canonical.y)},c=>{let i=c.canonical.x+1,o=c.wrap;return i===1<<c.canonical.z&&(i=0,o++),new Ii(c.overscaledZ,o,c.canonical.z,i,c.canonical.y)},c=>new Ii(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new Ii(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];jt(jn,"CanonicalTileID"),jt(Ii,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ms=ti([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:es}=ms,$o=ti([{name:"a_pos_3",components:3,type:"Int16"}]);var gs=ti([{name:"a_pos",type:"Int16",components:2}]);class Ha{constructor(i,o){this.pos=i,this.dir=o}intersectsPlane(i,o,u){const p=we.vec3.dot(o,this.dir);if(Math.abs(p)<1e-6)return!1;const h=((i[0]-this.pos[0])*o[0]+(i[1]-this.pos[1])*o[1]+(i[2]-this.pos[2])*o[2])/p;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(i,o,u){if(we.vec3.equals(this.pos,i)||o===0)return u[0]=u[1]=u[2]=0,!1;const[p,h,m]=this.dir,b=this.pos[0]-i[0],S=this.pos[1]-i[1],A=this.pos[2]-i[2],y=p*p+h*h+m*m,w=2*(b*p+S*h+A*m),P=w*w-4*y*(b*b+S*S+A*A-o*o);if(P<0){const E=Math.max(-w/2,0),O=b+p*E,M=S+h*E,R=A+m*E,z=Math.hypot(O,M,R);return u[0]=O*o/z,u[1]=M*o/z,u[2]=R*o/z,!1}{const E=(-w-Math.sqrt(P))/(2*y);if(E<0){const O=Math.hypot(b,S,A);return u[0]=b*o/O,u[1]=S*o/O,u[2]=A*o/O,!1}return u[0]=b+p*E,u[1]=S+h*E,u[2]=A+m*E,!0}}}class Sl{constructor(i,o,u,p,h){this.TL=i,this.TR=o,this.BR=u,this.BL=p,this.horizon=h}static fromInvProjectionMatrix(i,o,u){const p=[-1,1,1],h=[1,1,1],m=[1,-1,1],b=[-1,-1,1],S=we.vec3.transformMat4(p,p,i),A=we.vec3.transformMat4(h,h,i),y=we.vec3.transformMat4(m,m,i),w=we.vec3.transformMat4(b,b,i);return new Sl(S,A,y,w,o/u)}}function xa(c,i,o){let u=1/0,p=-1/0;const h=[];for(const m of c){we.vec3.sub(h,m,i);const b=we.vec3.dot(h,o);u=Math.min(u,b),p=Math.max(p,b)}return[u,p]}function wu(c,i){let o=!0;for(let u=0;u<c.planes.length;u++){const p=c.planes[u];let h=0;for(let m=0;m<i.length;m++)h+=we.vec3.dot(p,i[m])+p[3]>=0;if(h===0)return 0;h!==i.length&&(o=!1)}return o?2:1}function Tu(c,i){for(const o of c.projections){const u=xa(i,c.points[0],o.axis);if(o.projection[1]<u[0]||o.projection[0]>u[1])return 0}return 1}function Qf(c,i){let o=0;const u=[0,0,0,0];for(let p=0;p<c.length;p++)u[0]=c[p][0],u[1]=c[p][1],u[2]=c[p][2],u[3]=1,we.vec4.dot(u,i)>=0&&o++;return o}class Eu{constructor(i,o){this.points=i||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=Di.fromPoints(this.points),this.projections=[],this.frustumEdges=[we.vec3.sub([],this.points[2],this.points[3]),we.vec3.sub([],this.points[0],this.points[3]),we.vec3.sub([],this.points[4],this.points[0]),we.vec3.sub([],this.points[5],this.points[1]),we.vec3.sub([],this.points[6],this.points[2]),we.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const p=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:p,projection:xa(this.points,this.points[0],p)}),this.projections.push({axis:h,projection:xa(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(i,o,u,p){const h=Math.pow(2,u),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const y=we.vec4.transformMat4([],A,i),w=1/y[3]/o*h;return we.vec4.mul(y,y,[w,w,p?1/y[3]:w,w])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const y=we.vec3.sub([],m[A[0]],m[A[1]]),w=we.vec3.sub([],m[A[2]],m[A[1]]),P=we.vec3.normalize([],we.vec3.cross([],y,w)),E=-we.vec3.dot(P,m[A[1]]);return P.concat(E)}),S=[];for(let A=0;A<m.length;A++)S.push([m[A][0],m[A][1],m[A][2]]);return new Eu(S,b)}intersectsPrecise(i,o,u){for(let p=0;p<o.length;p++)if(!Qf(i,o[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!Qf(i,this.planes[p]))return 0;for(const p of u)for(const h of this.frustumEdges){const m=we.vec3.cross([],p,h),b=we.vec3.length(m);if(b===0)continue;we.vec3.scale(m,m,1/b);const S=xa(this.points,this.points[0],m),A=xa(i,this.points[0],m);if(S[0]>A[1]||A[0]>S[1])return 0}return 1}containsPoint(i){for(const o of this.planes){const u=o[3];if(we.vec3.dot([o[0],o[1],o[2]],i)+u<0)return!1}return!0}}class Di{static fromPoints(i){const o=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const p of i)we.vec3.min(o,o,p),we.vec3.max(u,u,p);return new Di(o,u)}static fromTileIdAndHeight(i,o,u){const p=1<<i.canonical.z,h=i.canonical.x,m=i.canonical.y;return new Di([h/p,m/p,o],[(h+1)/p,(m+1)/p,u])}static applyTransform(i,o){const u=i.getCorners();for(let p=0;p<u.length;++p)we.vec3.transformMat4(u[p],u[p],o);return Di.fromPoints(u)}static applyTransformFast(i,o){const u=[o[12],o[13],o[14]],p=[...u];for(let h=0;h<3;h++)for(let m=0;m<3;m++){const b=o[4*m+h],S=b*i.min[m],A=b*i.max[m];u[h]+=Math.min(S,A),p[h]+=Math.max(S,A)}return new Di(u,p)}static projectAabbCorners(i,o){const u=i.getCorners();for(let p=0;p<u.length;++p)we.vec3.transformMat4(u[p],u[p],o);return u}constructor(i,o){this.min=i,this.max=o,this.center=we.vec3.scale([],we.vec3.add([],this.min,this.max),.5)}quadrant(i){const o=[i%2==0,i<2],u=we.vec3.clone(this.min),p=we.vec3.clone(this.max);for(let h=0;h<o.length;h++)u[h]=o[h]?this.min[h]:this.center[h],p[h]=o[h]?this.center[h]:this.max[h];return p[2]=this.max[2],new Di(u,p)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,o=this.max;return[[i[0],i[1],i[2]],[o[0],i[1],i[2]],[o[0],o[1],i[2]],[i[0],o[1],i[2]],[i[0],i[1],o[2]],[o[0],i[1],o[2]],[o[0],o[1],o[2]],[i[0],o[1],o[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?wu(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?wu(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,o){return o||this.intersects(i)?Tu(i,this.getCorners()):0}intersectsPreciseFlat(i,o){return o||this.intersectsFlat(i)?Tu(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let o=0;o<3;++o)if(this.min[o]>i.max[o]||i.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],i.min[o]),this.max[o]=Math.max(this.max[o],i.max[o])}encapsulatePoint(i){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],i[o]),this.max[o]=Math.max(this.max[o],i[o])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}function hc(c){return c*n/$}jt(Di,"Aabb");const pw=[new Di([C,C,C],[D,D,D]),new Di([C,C,C],[0,0,D]),new Di([0,C,C],[D,0,D]),new Di([C,0,C],[0,D,D]),new Di([0,0,C],[D,D,D])];function Nv(c,i,o,u=!0){const p=we.vec3.scale([],c._camera.position,c.worldSize),h=[i,o,1,1];we.vec4.transformMat4(h,h,c.pixelMatrixInverse),we.vec4.scale(h,h,1/h[3]);const m=we.vec3.sub([],h,p),b=we.vec3.normalize([],m),S=c.globeMatrix,A=[S[12],S[13],S[14]],y=we.vec3.sub([],A,p),w=we.vec3.length(y),P=we.vec3.normalize([],y),E=c.worldSize/(2*Math.PI),O=we.vec3.dot(P,b),M=Math.asin(E/w);if(M<Math.acos(O)){if(!u)return null;const me=[],he=[];we.vec3.scale(me,b,w/O),we.vec3.normalize(he,we.vec3.sub(he,me,y)),we.vec3.normalize(b,we.vec3.add(b,y,we.vec3.scale(b,he,Math.tan(M)*w)))}const R=[];new Ha(p,b).closestPointOnSphere(A,E,R);const z=we.vec3.normalize([],Yl(S,0)),V=we.vec3.normalize([],Yl(S,1)),G=we.vec3.normalize([],Yl(S,2)),F=we.vec3.dot(z,R),q=we.vec3.dot(V,R),W=we.vec3.dot(G,R),te=Vt(Math.asin(-q/E));let se=Vt(Math.atan2(F,W));se=c.center.lng+function(me,he){const _e=(he-me+180)%360-180;return _e<-180?_e+360:_e}(c.center.lng,se);const le=ae(se),ne=Dt(ce(te),0,1);return new $e(le,ne)}class J${constructor(i,o,u){this.a=we.vec3.sub([],i,u),this.b=we.vec3.sub([],o,u),this.center=u;const p=we.vec3.normalize([],this.a),h=we.vec3.normalize([],this.b);this.angle=Math.acos(we.vec3.dot(p,h))}}function mw(c,i){if(c.angle===0)return null;let o;return o=c.a[i]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[i]/c.a[i]/Math.sin(c.angle)-1/Math.tan(c.angle)),o<0||o>1?null:function(u,p,h,m){const b=Math.sin(h);return u*(Math.sin((1-m)*h)/b)+p*(Math.sin(m*h)/b)}(c.a[i],c.b[i],c.angle,Dt(o,0,1))+c.center[i]}function Ol(c){if(c.z<=1)return pw[c.z+2*c.y+c.x];const i=gw($v(c));return Di.fromPoints(i)}function dc(c,i,o){return we.vec3.scale(c,c,1-o),we.vec3.scaleAndAdd(c,c,i,o)}function UP(c,i,o){for(const u of c)we.vec3.transformMat4(u,u,i),we.vec3.scale(u,u,o)}function GP(c,i,o,u){const p=i/c.worldSize,h=c.globeMatrix;if(o.z<=1){const le=Ol(o).getCorners();return UP(le,h,p),Di.fromPoints(le)}const m=$v(o,u),b=gw(m,n+hc(c._tileCoverLift));UP(b,h,p);const S=Number.MAX_VALUE,A=[-S,-S,-S],y=[S,S,S];if(m.contains(c.center)){for(const me of b)we.vec3.min(y,y,me),we.vec3.max(A,A,me);A[2]=0;const le=c.point,ne=[le.x*p,le.y*p,0];return we.vec3.min(y,y,ne),we.vec3.max(A,A,ne),new Di(y,A)}if(c._tileCoverLift>0){for(const le of b)we.vec3.min(y,y,le),we.vec3.max(A,A,le);return new Di(y,A)}const w=[h[12]*p,h[13]*p,h[14]*p],P=m.getCenter(),E=Dt(c.center.lat,-ge,ge),O=Dt(P.lat,-ge,ge),M=ae(c.center.lng),R=ce(E);let z=M-ae(P.lng);const V=R-ce(O);z>.5?z-=1:z<-.5&&(z+=1);let G=0;if(Math.abs(z)>Math.abs(V))G=z>=0?1:3;else{G=V>=0?0:2;const le=[h[4]*p,h[5]*p,h[6]*p],ne=-Math.sin(Mt(V>=0?m.getSouth():m.getNorth()))*n;we.vec3.scaleAndAdd(w,w,le,ne)}const F=b[G],q=b[(G+1)%4],W=new J$(F,q,w),te=[mw(W,0)||F[0],mw(W,1)||F[1],mw(W,2)||F[2]],se=Su(c.zoom);if(se>0){const le=function({x:me,y:he,z:_e},Ae,Me,Re,Be){const Ge=1/(1<<_e);let Fe=me*Ge,tt=Fe+Ge,ut=he*Ge,Xe=ut+Ge,Lt=0;const Pt=(Fe+tt)/2-Re;return Pt>.5?Lt=-1:Pt<-.5&&(Lt=1),Fe=((Fe+Lt)*Ae-(Re*=Ae))*Me+Re,tt=((tt+Lt)*Ae-Re)*Me+Re,ut=(ut*Ae-(Be*=Ae))*Me+Be,Xe=(Xe*Ae-Be)*Me+Be,[[Fe,Xe,0],[tt,Xe,0],[tt,ut,0],[Fe,ut,0]]}(o,i,c._pixelsPerMercatorPixel,M,R);for(let me=0;me<b.length;me++)dc(b[me],le[me],se);const ne=we.vec3.add([],le[G],le[(G+1)%4]);we.vec3.scale(ne,ne,.5),dc(te,ne,se)}for(const le of b)we.vec3.min(y,y,le),we.vec3.max(A,A,le);return y[2]=Math.min(F[2],q[2]),we.vec3.min(y,y,te),we.vec3.max(A,A,te),new Di(y,A)}function $v({x:c,y:i,z:o},u=!1){const p=1/(1<<o),h=new U(fe(c*p),i===(1<<o)-1&&u?-90:de((i+1)*p)),m=new U(fe((c+1)*p),i===0&&u?90:de(i*p));return new Z(h,m)}function gw(c,i=n){const o=Mt(c.getNorth()),u=Mt(c.getSouth()),p=Math.cos(o),h=Math.cos(u),m=Math.sin(o),b=Math.sin(u),S=c.getWest(),A=c.getEast();return[L(h,b,S,i),L(h,b,A,i),L(p,m,A,i),L(p,m,S,i)]}function vg(c,i,o,u){const p=1<<o.z,h=(c/It+o.x)/p;return B(de((i/It+o.y)/p),fe(h),u)}function jv({min:c,max:i}){return _/Math.max(i[0]-c[0],i[1]-c[1],i[2]-c[2])}const HP=new Float64Array(16);function Vv(c){const i=jv(c),o=we.mat4.fromScaling(HP,[i,i,i]);return we.mat4.translate(o,o,we.vec3.negate([],c.min))}function _w(c){const i=we.mat4.fromTranslation(HP,c.min),o=1/jv(c);return we.mat4.scale(i,i,[o,o,o])}function yw(c){const i=It/(2*Math.PI);return c/(2*Math.PI)/i}function qP(c,i){return It/(512*Math.pow(2,c))*jv(Ol(i))}function WP(c,i,o,u,p){const h=yw(o),m=[c,i,-o/(2*Math.PI)],b=we.mat4.identity(new Float64Array(16));return we.mat4.translate(b,b,m),we.mat4.scale(b,b,[h,h,h]),we.mat4.rotateX(b,b,Mt(-p)),we.mat4.rotateY(b,b,Mt(-u)),b}function Su(c){return zr(l,f,c)}function ZP(c,i){const o=B(i.lat,i.lng),u=function(h){const m=B(h._center.lat,h._center.lng),b=we.vec3.fromValues(0,1,0);let S=we.vec3.cross([],b,m);const A=we.mat4.fromRotation([],-h.angle,m);S=we.vec3.transformMat4(S,S,A),we.mat4.fromRotation(A,-h._pitch,S);const y=we.vec3.normalize([],m);return we.vec3.scale(y,y,hc(h.cameraToCenterDistance/h.pixelsPerMeter)),we.vec3.transformMat4(y,y,A),we.vec3.add([],m,y)}(c),p=we.vec3.subtract([],u,o);return we.vec3.angle(p,o)}function vw(c,i){return ZP(c,i)>Math.PI/2*1.01}const XP=Mt(85),Q$=Math.cos(XP),ej=Math.sin(XP),tj=we.mat4.create(),KP=c=>{const i=[];return c.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function YP(c,i,o,u,p,h,m,b,S){if(h&&c.queryGeometry.isAboveHorizon)return!1;h&&(S*=c.pixelToTileUnitsFactor);const A=c.tileID.canonical,y=o.projection.upVectorScale(A,o.center.lat,o.worldSize).metersToTile;for(const w of i)for(const P of w){const E=P.add(b),O=p&&o.elevation?o.elevation.exaggeration()*p.getElevationAt(E.x,E.y,!0):0,M=o.projection.projectTilePoint(E.x,E.y,A);if(O>0){const G=o.projection.upVector(A,E.x,E.y);M.x+=G[0]*y*O,M.y+=G[1]*y*O,M.z+=G[2]*y*O}const R=h?E:rj(M.x,M.y,M.z,u),z=h?c.tilespaceRays.map(G=>nj(G,O)):c.queryGeometry.screenGeometry,V=we.vec4.transformMat4([],[M.x,M.y,M.z,1],u);if(!m&&h?S*=V[3]/o.cameraToCenterDistance:m&&!h&&(S*=o.cameraToCenterDistance/V[3]),h){const G=de((P.y/It+A.y)/(1<<A.z));S/=o.projection.pixelsPerMeter(G,1)/oe(1,G)}if(Ft(z,R,S))return!0}return!1}function rj(c,i,o,u){const p=we.vec4.transformMat4([],[c,i,o,1],u);return new ze(p[0]/p[3],p[1]/p[3])}const JP=we.vec3.fromValues(0,0,0),ij=we.vec3.fromValues(0,0,1);function nj(c,i){const o=we.vec3.create();return JP[2]=i,c.intersectsPlane(JP,ij,o),new ze(o[0],o[1])}class QP extends Kt{}let e2,t2,r2,i2;function n2(c,{width:i,height:o},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==i*o*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(i*o*u);return c.width=i,c.height=o,c.data=p,c}function o2(c,i,o){const{width:u,height:p}=i;u===c.width&&p===c.height||(bw(c,i,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,p)},o,null),c.width=u,c.height=p,c.data=i.data)}function bw(c,i,o,u,p,h,m,b){if(p.width===0||p.height===0)return i;if(p.width>c.width||p.height>c.height||o.x>c.width-p.width||o.y>c.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>i.width||p.height>i.height||u.x>i.width-p.width||u.y>i.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const S=c.data,A=i.data,y=h===4&&b;for(let w=0;w<p.height;w++){const P=((o.y+w)*c.width+o.x)*h,E=((u.y+w)*i.width+u.x)*h;if(y)for(let O=0;O<p.width;O++){const M=P+O*h+3,R=E+O*h;A[R+0]=255,A[R+1]=255,A[R+2]=255,A[R+3]=S[M]}else if(m)for(let O=0;O<p.width;O++){const M=P+O*h,R=E+O*h,z=S[M+3],V=new li(S[M+0]/255*z,S[M+1]/255*z,S[M+2]/255*z,z).toRenderColor(m).toArray();A[R+0]=V[0],A[R+1]=V[1],A[R+2]=V[2],A[R+3]=V[3]}else for(let O=0;O<p.width*h;O++)A[E+O]=S[P+O]}return i}jt(QP,"HeatmapBucket",{omit:["layers"]});class Ou{constructor(i,o){n2(this,i,1,o)}resize(i){o2(this,new Ou(i),1)}clone(){return new Ou({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,u,p,h){bw(i,o,u,p,h,1,null)}}class Ao{constructor(i,o){n2(this,i,4,o)}resize(i){o2(this,new Ao(i),4)}replace(i,o){o?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ao({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,o,u,p,h,m,b){bw(i,o,u,p,h,4,m,b)}}class s2{constructor(i,o){this.width=i.width,this.height=i.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function bg(c){const i={},o=c.resolution||256,u=c.clips?c.clips.length:1,p=c.image||new Ao({width:o,height:u}),h=(m,b,S)=>{i[c.evaluationKey]=S;const A=c.expression.evaluate(i);A&&(p.data[m+b+0]=Math.floor(255*A.r/A.a),p.data[m+b+1]=Math.floor(255*A.g/A.a),p.data[m+b+2]=Math.floor(255*A.b/A.a),p.data[m+b+3]=Math.floor(255*A.a))};if(c.clips)for(let m=0,b=0;m<u;++m,b+=4*o)for(let S=0,A=0;S<o;S++,A+=4){const y=S/(o-1),{start:w,end:P}=c.clips[m];h(b,A,w*(1-y)+P*y)}else for(let m=0,b=0;m<o;m++,b+=4)h(0,b,m/(o-1));return p}jt(Ou,"AlphaImage"),jt(Ao,"RGBAImage");const oj=ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:sj}=oj;function xg(c,i,o=2){const u=i&&i.length,p=u?i[0]*o:c.length;let h=a2(c,0,p,o,!0);const m=[];if(!h||h.next===h.prev)return m;let b,S,A;if(u&&(h=function(y,w,P,E){const O=[];for(let M=0,R=w.length;M<R;M++){const z=a2(y,w[M]*E,M<R-1?w[M+1]*E:y.length,E,!1);z===z.next&&(z.steiner=!0),O.push(pj(z))}O.sort(hj);for(let M=0;M<O.length;M++)P=dj(O[M],P);return P}(c,i,h,o)),c.length>80*o){b=1/0,S=1/0;let y=-1/0,w=-1/0;for(let P=o;P<p;P+=o){const E=c[P],O=c[P+1];E<b&&(b=E),O<S&&(S=O),E>y&&(y=E),O>w&&(w=O)}A=Math.max(y-b,w-S),A=A!==0?32767/A:0}return wg(h,m,o,b,S,A,0),m}function a2(c,i,o,u,p){let h;if(p===function(m,b,S,A){let y=0;for(let w=b,P=S-A;w<S;w+=A)y+=(m[P]-m[w])*(m[w+1]+m[P+1]),P=w;return y}(c,i,o,u)>0)for(let m=i;m<o;m+=u)h=u2(m/u|0,c[m],c[m+1],h);else for(let m=o-u;m>=i;m-=u)h=u2(m/u|0,c[m],c[m+1],h);return h&&Uv(h,h.next)&&(Eg(h),h=h.next),h}function Kh(c,i){if(!c)return c;i||(i=c);let o,u=c;do if(o=!1,u.steiner||!Uv(u,u.next)&&Rn(u.prev,u,u.next)!==0)u=u.next;else{if(Eg(u),u=i=u.prev,u===u.next)break;o=!0}while(o||u!==i);return i}function wg(c,i,o,u,p,h,m){if(!c)return;!m&&h&&function(S,A,y,w){let P=S;do P.z===0&&(P.z=xw(P.x,P.y,A,y,w)),P.prevZ=P.prev,P.nextZ=P.next,P=P.next;while(P!==S);P.prevZ.nextZ=null,P.prevZ=null,function(E){let O,M=1;do{let R,z=E;E=null;let V=null;for(O=0;z;){O++;let G=z,F=0;for(let W=0;W<M&&(F++,G=G.nextZ,G);W++);let q=M;for(;F>0||q>0&&G;)F!==0&&(q===0||!G||z.z<=G.z)?(R=z,z=z.nextZ,F--):(R=G,G=G.nextZ,q--),V?V.nextZ=R:E=R,R.prevZ=V,V=R;z=G}V.nextZ=null,M*=2}while(O>1)}(P)}(c,u,p,h);let b=c;for(;c.prev!==c.next;){const S=c.prev,A=c.next;if(h?lj(c,u,p,h):aj(c))i.push(S.i,c.i,A.i),Eg(c),c=A.next,b=A.next;else if((c=A)===b){m?m===1?wg(c=cj(Kh(c),i),i,o,u,p,h,2):m===2&&uj(c,i,o,u,p,h):wg(Kh(c),i,o,u,p,h,1);break}}}function aj(c){const i=c.prev,o=c,u=c.next;if(Rn(i,o,u)>=0)return!1;const p=i.x,h=o.x,m=u.x,b=i.y,S=o.y,A=u.y,y=p<h?p<m?p:m:h<m?h:m,w=b<S?b<A?b:A:S<A?S:A,P=p>h?p>m?p:m:h>m?h:m,E=b>S?b>A?b:A:S>A?S:A;let O=u.next;for(;O!==i;){if(O.x>=y&&O.x<=P&&O.y>=w&&O.y<=E&&ep(p,b,h,S,m,A,O.x,O.y)&&Rn(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function lj(c,i,o,u){const p=c.prev,h=c,m=c.next;if(Rn(p,h,m)>=0)return!1;const b=p.x,S=h.x,A=m.x,y=p.y,w=h.y,P=m.y,E=b<S?b<A?b:A:S<A?S:A,O=y<w?y<P?y:P:w<P?w:P,M=b>S?b>A?b:A:S>A?S:A,R=y>w?y>P?y:P:w>P?w:P,z=xw(E,O,i,o,u),V=xw(M,R,i,o,u);let G=c.prevZ,F=c.nextZ;for(;G&&G.z>=z&&F&&F.z<=V;){if(G.x>=E&&G.x<=M&&G.y>=O&&G.y<=R&&G!==p&&G!==m&&ep(b,y,S,w,A,P,G.x,G.y)&&Rn(G.prev,G,G.next)>=0||(G=G.prevZ,F.x>=E&&F.x<=M&&F.y>=O&&F.y<=R&&F!==p&&F!==m&&ep(b,y,S,w,A,P,F.x,F.y)&&Rn(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;G&&G.z>=z;){if(G.x>=E&&G.x<=M&&G.y>=O&&G.y<=R&&G!==p&&G!==m&&ep(b,y,S,w,A,P,G.x,G.y)&&Rn(G.prev,G,G.next)>=0)return!1;G=G.prevZ}for(;F&&F.z<=V;){if(F.x>=E&&F.x<=M&&F.y>=O&&F.y<=R&&F!==p&&F!==m&&ep(b,y,S,w,A,P,F.x,F.y)&&Rn(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function cj(c,i){let o=c;do{const u=o.prev,p=o.next.next;!Uv(u,p)&&l2(u,o,o.next,p)&&Tg(u,p)&&Tg(p,u)&&(i.push(u.i,o.i,p.i),Eg(o),Eg(o.next),o=c=p),o=o.next}while(o!==c);return Kh(o)}function uj(c,i,o,u,p,h){let m=c;do{let b=m.next.next;for(;b!==m.prev;){if(m.i!==b.i&&mj(m,b)){let S=c2(m,b);return m=Kh(m,m.next),S=Kh(S,S.next),wg(m,i,o,u,p,h,0),void wg(S,i,o,u,p,h,0)}b=b.next}m=m.next}while(m!==c)}function hj(c,i){return c.x-i.x}function dj(c,i){const o=function(p,h){let m=h;const b=p.x,S=p.y;let A,y=-1/0;do{if(S<=m.y&&S>=m.next.y&&m.next.y!==m.y){const M=m.x+(S-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(M<=b&&M>y&&(y=M,A=m.x<m.next.x?m:m.next,M===b))return A}m=m.next}while(m!==h);if(!A)return null;const w=A,P=A.x,E=A.y;let O=1/0;m=A;do{if(b>=m.x&&m.x>=P&&b!==m.x&&ep(S<E?b:y,S,P,E,S<E?y:b,S,m.x,m.y)){const M=Math.abs(S-m.y)/(b-m.x);Tg(m,p)&&(M<O||M===O&&(m.x>A.x||m.x===A.x&&fj(A,m)))&&(A=m,O=M)}m=m.next}while(m!==w);return A}(c,i);if(!o)return i;const u=c2(o,c);return Kh(u,u.next),Kh(o,o.next)}function fj(c,i){return Rn(c.prev,c,i.prev)<0&&Rn(i.next,c,c.next)<0}function xw(c,i,o,u,p){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-o)*p|0)|c<<8))|c<<4))|c<<2))|c<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-u)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function pj(c){let i=c,o=c;do(i.x<o.x||i.x===o.x&&i.y<o.y)&&(o=i),i=i.next;while(i!==c);return o}function ep(c,i,o,u,p,h,m,b){return(p-m)*(i-b)>=(c-m)*(h-b)&&(c-m)*(u-b)>=(o-m)*(i-b)&&(o-m)*(h-b)>=(p-m)*(u-b)}function mj(c,i){return c.next.i!==i.i&&c.prev.i!==i.i&&!function(o,u){let p=o;do{if(p.i!==o.i&&p.next.i!==o.i&&p.i!==u.i&&p.next.i!==u.i&&l2(p,p.next,o,u))return!0;p=p.next}while(p!==o);return!1}(c,i)&&(Tg(c,i)&&Tg(i,c)&&function(o,u){let p=o,h=!1;const m=(o.x+u.x)/2,b=(o.y+u.y)/2;do p.y>b!=p.next.y>b&&p.next.y!==p.y&&m<(p.next.x-p.x)*(b-p.y)/(p.next.y-p.y)+p.x&&(h=!h),p=p.next;while(p!==o);return h}(c,i)&&(Rn(c.prev,c,i.prev)||Rn(c,i.prev,i))||Uv(c,i)&&Rn(c.prev,c,c.next)>0&&Rn(i.prev,i,i.next)>0)}function Rn(c,i,o){return(i.y-c.y)*(o.x-i.x)-(i.x-c.x)*(o.y-i.y)}function Uv(c,i){return c.x===i.x&&c.y===i.y}function l2(c,i,o,u){const p=Hv(Rn(c,i,o)),h=Hv(Rn(c,i,u)),m=Hv(Rn(o,u,c)),b=Hv(Rn(o,u,i));return p!==h&&m!==b||!(p!==0||!Gv(c,o,i))||!(h!==0||!Gv(c,u,i))||!(m!==0||!Gv(o,c,u))||!(b!==0||!Gv(o,i,u))}function Gv(c,i,o){return i.x<=Math.max(c.x,o.x)&&i.x>=Math.min(c.x,o.x)&&i.y<=Math.max(c.y,o.y)&&i.y>=Math.min(c.y,o.y)}function Hv(c){return c>0?1:c<0?-1:0}function Tg(c,i){return Rn(c.prev,c,c.next)<0?Rn(c,i,c.next)>=0&&Rn(c,c.prev,i)>=0:Rn(c,i,c.prev)<0||Rn(c,c.next,i)<0}function c2(c,i){const o=ww(c.i,c.x,c.y),u=ww(i.i,i.x,i.y),p=c.next,h=i.prev;return c.next=i,i.prev=c,o.next=p,p.prev=o,u.next=o,o.prev=u,h.next=u,u.prev=h,u}function u2(c,i,o,u){const p=ww(c,i,o);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Eg(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function ww(c,i,o){return{i:c,x:i,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function qv(c,i){const o=c.length;if(o<=1)return[c];const u=[];let p,h;for(let m=0;m<o;m++){const b=Jd(c[m]);b!==0&&(c[m].area=Math.abs(b),h===void 0&&(h=b<0),h===b<0?(p&&u.push(p),p=[c[m]]):p.push(c[m]))}if(p&&u.push(p),i>1)for(let m=0;m<u.length;m++)u[m].length<=i||(jy(u[m],i,1,u[m].length-1,gj),u[m]=u[m].slice(0,i));return u}function gj(c,i){return i.area-c.area}function Tw(c,i,o){const u=o.patternDependencies;let p=!1;for(const h of i){const m=h.paint.get(`${c}-pattern`);m.isConstant()||(p=!0);const b=m.constantOr(null);b&&(p=!0,u[b]=!0)}return p}function Ew(c,i,o,u,p){const h=p.patternDependencies;for(const m of i){const b=m.paint.get(`${c}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:u},o,{},p.availableImages);S=S&&S.name?S.name:S,h[S]=!0,o.patterns[m.id]=S}}return o}class Sw{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bl,this.indexArray=new Jn,this.indexArray2=new Tl,this.programConfigurations=new El(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new on,this.segments2=new on,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=i.projection}updateFootprints(i,o){}populate(i,o,u,p){this.hasPattern=Tw("fill",this.layers,o);const h=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:b,id:S,index:A,sourceLayerIndex:y}of i){const w=this.layers[0]._featureFilter.needGeometry,P=xt(b,w);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),P,u))continue;const E=h?h.evaluate(P,{},u,o.availableImages):void 0,O={id:S,properties:b.properties,type:b.type,sourceLayerIndex:y,index:A,geometry:w?P.geometry:vt(b,u,p),patterns:{},sortKey:E};m.push(O)}h&&m.sort((b,S)=>b.sortKey-S.sortKey);for(const b of m){const{geometry:S,index:A,sourceLayerIndex:y}=b;if(this.hasPattern){const w=Ew("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(w)}else this.addFeature(b,S,A,u,{},o.availableImages,o.brightness);o.featureIndex.insert(i[A].feature,S,A,y,this.index)}}update(i,o,u,p,h){const m=Object.keys(i).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,o,m?this.stateDependentLayers:this.layers,u,p,h)}addFeatures(i,o,u,p,h,m){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,u,p,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,sj),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,o,u,p,h,m=[],b){for(const S of qv(o,500)){let A=0;for(const M of S)A+=M.length;const y=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),w=y.vertexLength,P=[],E=[];for(const M of S){if(M.length===0)continue;M!==S[0]&&E.push(P.length/2);const R=this.segments2.prepareSegment(M.length,this.layoutVertexArray,this.indexArray2),z=R.vertexLength;this.layoutVertexArray.emplaceBack(M[0].x,M[0].y),this.indexArray2.emplaceBack(z+M.length-1,z),P.push(M[0].x),P.push(M[0].y);for(let V=1;V<M.length;V++)this.layoutVertexArray.emplaceBack(M[V].x,M[V].y),this.indexArray2.emplaceBack(z+V-1,z+V),P.push(M[V].x),P.push(M[V].y);R.vertexLength+=M.length,R.primitiveLength+=M.length}const O=xg(P,E);for(let M=0;M<O.length;M+=3)this.indexArray.emplaceBack(w+O[M],w+O[M+1],w+O[M+2]);y.vertexLength+=A,y.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,h,m,p,b)}}let h2,d2,f2,p2;jt(Sw,"FillBucket",{omit:["layers","patternFeatures"]});class Ow{constructor(i,o,u,p){if(this.triangleCount=o.length/3,this.min=new ze(0,0),this.max=new ze(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[h,m]=[i[0].clone(),i[0].clone()];for(let w=1;w<i.length;++w){const P=i[w];h.x=Math.min(h.x,P.x),h.y=Math.min(h.y,P.y),m.x=Math.max(m.x,P.x),m.y=Math.max(m.y,P.y)}if(p){const w=Math.ceil(Math.max(m.x-h.x,m.y-h.y)/p);u=Math.max(u,w)}if(u===0)return;this.min=h,this.max=m;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const S=Math.max(b.x,b.y)/u;this.cellsX=Math.max(1,Math.ceil(b.x/S)),this.cellsY=Math.max(1,Math.ceil(b.y/S)),this.xScale=1/S,this.yScale=1/S;const A=[];for(let w=0;w<this.triangleCount;w++){const P=i[o[3*w+0]].sub(this.min),E=i[o[3*w+1]].sub(this.min),O=i[o[3*w+2]].sub(this.min),M=Pl(Math.floor(Math.min(P.x,E.x,O.x)),this.xScale,this.cellsX),R=Pl(Math.floor(Math.max(P.x,E.x,O.x)),this.xScale,this.cellsX),z=Pl(Math.floor(Math.min(P.y,E.y,O.y)),this.yScale,this.cellsY),V=Pl(Math.floor(Math.max(P.y,E.y,O.y)),this.yScale,this.cellsY),G=new ze(0,0),F=new ze(0,0),q=new ze(0,0),W=new ze(0,0);for(let te=z;te<=V;++te){G.y=F.y=te*S,q.y=W.y=(te+1)*S;for(let se=M;se<=R;++se)G.x=q.x=se*S,F.x=W.x=(se+1)*S,(vi(P,E,O,G,F,W)||vi(P,E,O,G,W,q))&&A.push({cellIdx:te*this.cellsX+se,triIdx:w})}}if(A.length===0)return;A.sort((w,P)=>w.cellIdx-P.cellIdx||w.triIdx-P.triIdx);let y=0;for(;y<A.length;){const w=A[y].cellIdx,P={start:this.payload.length,len:0};for(;y<A.length&&A[y].cellIdx===w;)++P.len,this.payload.push(A[y++].triIdx);this.cells[w]=P}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,o){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const u=Pl(i.x-this.min.x,this.xScale,this.cellsX),p=Pl(i.y-this.min.y,this.yScale,this.cellsY),h=this.cells[p*this.cellsX+u];if(h){this._lazyInitLookup();for(let m=0;m<h.len;m++){const b=this.payload[h.start+m],S=Math.floor(b/8),A=1<<b%8;if(!(this.lookup[S]&A)&&(this.lookup[S]|=A,o.push(b),o.length===this.triangleCount))return}}}query(i,o,u){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>o.x||i.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const p=Pl(i.x-this.min.x,this.xScale,this.cellsX),h=Pl(o.x-this.min.x,this.xScale,this.cellsX),m=Pl(i.y-this.min.y,this.yScale,this.cellsY),b=Pl(o.y-this.min.y,this.yScale,this.cellsY);for(let S=m;S<=b;S++)for(let A=p;A<=h;A++){const y=this.cells[S*this.cellsX+A];if(y)for(let w=0;w<y.len;w++){const P=this.payload[y.start+w],E=Math.floor(P/8),O=1<<P%8;if(!(this.lookup[E]&O)&&(this.lookup[E]|=O,u.push(P),u.length===this.triangleCount))return}}}}function Pl(c,i,o){return Math.max(0,Math.min(o-1,Math.floor(c*i)))}jt(Ow,"TriangleGridIndex");class m2{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[]}updateFootprints(i,o){for(const u of this.footprints)o.push({footprint:u,id:i})}populate(i,o,u,p){const h=[];for(const{feature:m,id:b,index:S,sourceLayerIndex:A}of i){const y=this.layers[0]._featureFilter.needGeometry,w=xt(m,y);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),w,u))continue;const P={id:b,properties:m.properties,type:m.type,sourceLayerIndex:A,index:S,geometry:y?w.geometry:vt(m,u,p),patterns:{}};h.push(P)}for(const m of h){const{geometry:b,index:S,sourceLayerIndex:A}=m;this.addFeature(m,b,S,u,{},o.availableImages,o.brightness),o.featureIndex.insert(i[S].feature,b,S,A,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,o,u,p,h){}destroy(){}addFeature(i,o,u,p,h,m=[],b){for(const S of qv(o,2)){const A=[],y=[],w=[],P=new ze(1/0,1/0),E=new ze(-1/0,-1/0);for(const R of S)if(R.length!==0){R!==S[0]&&w.push(y.length/2);for(let z=0;z<R.length;z++)y.push(R[z].x),y.push(R[z].y),A.push(R[z]),P.x=Math.min(P.x,R[z].x),P.y=Math.min(P.y,R[z].y),E.x=Math.max(E.x,R[z].x),E.y=Math.max(E.y,R[z].y)}const O=xg(y,w),M=new Ow(A,O,8,256);this.footprints.push({vertices:A,indices:O,grid:M,min:P,max:E})}}}jt(m2,"ClipBucket",{omit:["layers"]});const _j=ti([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),yj=ti([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),vj=ti([{name:"a_centroid_pos",components:2,type:"Uint16"}]),bj=ti([{name:"a_join_normal_inside",components:3,type:"Int16"}]),xj=ti([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),wj=ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Tj}=_j;var Pw,g2,Aw,_2,Cw,y2,v2,Wv={};function b2(){if(g2)return Pw;g2=1;var c=Qe();function i(p,h,m,b,S){this.properties={},this.extent=m,this.type=0,this._pbf=p,this._geometry=-1,this._keys=b,this._values=S,p.readFields(o,this,h)}function o(p,h,m){p==1?h.id=m.readVarint():p==2?function(b,S){for(var A=b.readVarint()+b.pos;b.pos<A;){var y=S._keys[b.readVarint()],w=S._values[b.readVarint()];S.properties[y]=w}}(m,h):p==3?h.type=m.readVarint():p==4&&(h._geometry=m.pos)}function u(p){for(var h,m,b=0,S=0,A=p.length,y=A-1;S<A;y=S++)b+=((m=p[y]).x-(h=p[S]).x)*(h.y+m.y);return b}return Pw=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var p=this._pbf;p.pos=this._geometry;for(var h,m=p.readVarint()+p.pos,b=1,S=0,A=0,y=0,w=[];p.pos<m;){if(S<=0){var P=p.readVarint();b=7&P,S=P>>3}if(S--,b===1||b===2)A+=p.readSVarint(),y+=p.readSVarint(),b===1&&(h&&w.push(h),h=[]),h.push(new c(A,y));else{if(b!==7)throw new Error("unknown command "+b);h&&h.push(h[0].clone())}}return h&&w.push(h),w},i.prototype.bbox=function(){var p=this._pbf;p.pos=this._geometry;for(var h=p.readVarint()+p.pos,m=1,b=0,S=0,A=0,y=1/0,w=-1/0,P=1/0,E=-1/0;p.pos<h;){if(b<=0){var O=p.readVarint();m=7&O,b=O>>3}if(b--,m===1||m===2)(S+=p.readSVarint())<y&&(y=S),S>w&&(w=S),(A+=p.readSVarint())<P&&(P=A),A>E&&(E=A);else if(m!==7)throw new Error("unknown command "+m)}return[y,P,w,E]},i.prototype.toGeoJSON=function(p,h,m){var b,S,A=this.extent*Math.pow(2,m),y=this.extent*p,w=this.extent*h,P=this.loadGeometry(),E=i.types[this.type];function O(z){for(var V=0;V<z.length;V++){var G=z[V];z[V]=[360*(G.x+y)/A-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+w)/A)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(b=0;b<P.length;b++)M[b]=P[b][0];O(P=M);break;case 2:for(b=0;b<P.length;b++)O(P[b]);break;case 3:for(P=function(z){var V=z.length;if(V<=1)return[z];for(var G,F,q=[],W=0;W<V;W++){var te=u(z[W]);te!==0&&(F===void 0&&(F=te<0),F===te<0?(G&&q.push(G),G=[z[W]]):G.push(z[W]))}return G&&q.push(G),q}(P),b=0;b<P.length;b++)for(S=0;S<P[b].length;S++)O(P[b][S])}P.length===1?P=P[0]:E="Multi"+E;var R={type:"Feature",geometry:{type:E,coordinates:P},properties:this.properties};return"id"in this&&(R.id=this.id),R},Pw}function x2(){if(_2)return Aw;_2=1;var c=b2();function i(u,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(o,this,p),this.length=this._features.length}function o(u,p,h){u===15?p.version=h.readVarint():u===1?p.name=h.readString():u===5?p.extent=h.readVarint():u===2?p._features.push(h.pos):u===3?p._keys.push(h.readString()):u===4&&p._values.push(function(m){for(var b=null,S=m.readVarint()+m.pos;m.pos<S;){var A=m.readVarint()>>3;b=A===1?m.readString():A===2?m.readFloat():A===3?m.readDouble():A===4?m.readVarint64():A===5?m.readVarint():A===6?m.readSVarint():A===7?m.readBoolean():null}return b}(h))}return Aw=i,i.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var p=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,p,this.extent,this._keys,this._values)},Aw}function w2(){return v2||(v2=1,Wv.VectorTile=function(){if(y2)return Cw;y2=1;var c=x2();function i(o,u,p){if(o===3){var h=new c(p,p.readVarint()+p.pos);h.length&&(u[h.name]=h)}}return Cw=function(o,u){this.layers=o.readFields(i,{},u)},Cw}(),Wv.VectorTileFeature=b2(),Wv.VectorTileLayer=x2()),Wv}var tp=w2();class Yh extends ze{constructor(i,o,u){super(i,o),this.z=u}}class T2 extends Yh{constructor(i,o,u,p){super(i,o,u),this.w=p}}function Zv(c,i,o,u){const p=[],h=u===0?(m,b,S,A,y,w)=>{m.push(new ze(w,S+(w-b)/(A-b)*(y-S)))}:(m,b,S,A,y,w)=>{m.push(new ze(b+(w-S)/(y-S)*(A-b),w))};for(const m of c){const b=[];for(const S of m){if(S.length<=2)continue;const A=[];for(let P=0;P<S.length-1;P++){const E=S[P].x,O=S[P].y,M=S[P+1].x,R=S[P+1].y,z=u===0?E:O,V=u===0?M:R;z<i?V>i&&h(A,E,O,M,R,i):z>o?V<o&&h(A,E,O,M,R,o):A.push(S[P]),V<i&&z>=i&&h(A,E,O,M,R,i),V>o&&z<=o&&h(A,E,O,M,R,o)}let y=S[S.length-1];const w=u===0?y.x:y.y;w>=i&&w<=o&&A.push(y),A.length&&(y=A[A.length-1],A[0].x===y.x&&A[0].y===y.y||A.push(A[0]),b.push(A))}b.length&&p.push(b)}return p}function E2(c,i,o,u){const p=o==="x"?"y":"x",h=(u-c[o])/(i[o]-c[o]);c[p]=c[p]+(i[p]-c[p])*h,c[o]=u,c.hasOwnProperty("z")&&(c.z=nr(c.z,i.z,h)),c.hasOwnProperty("w")&&(c.w=nr(c.w,i.w,h))}function S2(c,i,o,u){const p=o,h=u;for(const m of["x","y"]){let b=c,S=i;b[m]>=S[m]&&(b=i,S=c),b[m]<p&&S[m]>p&&E2(b,S,m,p),b[m]<h&&S[m]>h&&E2(S,b,m,h)}}const Xv=Number.MAX_SAFE_INTEGER;function O2(c,i,o,u){return c.order<i||c.order===Xv||!(c.clipMask&o)||function(p,h){return h.length!==0&&h.find(m=>m===p)===void 0}(u,c.clipScope)}function Kv(c,i){return c.x-i.x||c.y-i.y}function P2(c,i){return Kv(c.min,i.min)===0&&Kv(c.max,i.max)===0}function Mw(c,i){return!(c.min.x>i.max.x||c.max.x<i.min.x||c.min.y>i.max.y||c.max.y<i.min.y)}function Iw(c,i){if(c.length!==i.length)return!1;for(let o=0;o<c.length;o++)if(c[o].sourceId!==i[o].sourceId||!P2(c[o],i[o])||c[o].order!==i[o].order||c[o].clipMask!==i[o].clipMask||!Bt(c[o].clipScope,i[o].clipScope))return!1;return!0}function A2(c,i,o){const u=1/It,p=1/(1<<o.canonical.z),h=(i.x*u+o.canonical.x)*p+o.wrap,m=(i.y*u+o.canonical.y)*p;return{min:new ze((c.x*u+o.canonical.x)*p+o.wrap,(c.y*u+o.canonical.y)*p),max:new ze(h,m)}}function Ej(c,i,o){const u=1<<o.canonical.z,p=((i.x-o.wrap)*u-o.canonical.x)*It,h=(i.y*u-o.canonical.y)*It;return{min:new ze(((c.x-o.wrap)*u-o.canonical.x)*It,(c.y*u-o.canonical.y)*It),max:new ze(p,h)}}function C2(c,i,o,u,p,h,m){const b=c.indices,S=c.vertices,A=[];for(let y=u;y<u+p;y+=3){const w=i[o[y+0]+h],P=i[o[y+1]+h],E=i[o[y+2]+h],O=Math.min(w.x,P.x,E.x),M=Math.max(w.x,P.x,E.x),R=Math.min(w.y,P.y,E.y),z=Math.max(w.y,P.y,E.y);A.length=0,c.grid.query(new ze(O,R),new ze(M,z),A);for(let V=0;V<A.length;V++){const G=A[V];if(vi(S[b[3*G+0]],S[b[3*G+1]],S[b[3*G+2]],w,P,E,m))return!0}}return!1}function M2(c,i,o,u){if(!c||!o)return!1;let p=c.vertices;if(!i.canonical.equals(u.canonical)||i.wrap!==u.wrap){if(o.vertices.length<c.vertices.length)return M2(o,u,c,i);const h=i.canonical,m=u.canonical,b=Math.pow(2,m.z-h.z);p=c.vertices.map(S=>new ze((S.x+h.x*It)*b-m.x*It,(S.y+h.y*It)*b-m.y*It))}return C2(o,p,c.indices,0,c.indices.length,0,0)}function I2(c,i,o,u){const p=Math.pow(2,u.z-o.z);return new ze((c+o.x*It)*p-u.x*It,(i+o.y*It)*p-u.y*It)}function D2(c,i){const o=[];i.grid.queryPoint(c,o);const u=i.indices,p=i.vertices;for(let h=0;h<o.length;h++){const m=o[h];if(zi([p[u[3*m+0]],p[u[3*m+1]],p[u[3*m+2]]],c))return!0}return!1}const Dw=[new ze(0,0),new ze(It,0),new ze(It,It),new ze(0,It)];function R2(c,i){const o=[];let u=[];if(!i||c.length<2)return[c];if(c.length===2)return gn(c[0],c[1],Dw)?[c]:[];for(let p=0;p<c.length+2;p++){const h=c[p%c.length],m=c[(p+1)%c.length],b=gn(p===0?c[c.length-1]:c[(p-1)%c.length],h,Dw),S=gn(h,m,Dw),A=b||S;A&&u.push(h),A&&S||u.length>0&&(u.length>1&&o.push(u),u=[])}return u.length>1&&o.push(u),o}const Rw=tp.VectorTileFeature.types,Sj=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Oj=["fill-extrusion-flood-light-ground-radius"],Pj=Math.pow(2,13),Aj=Math.pow(2,15)-1,L2=new ze(0,1),Pu=2147483648;function Sg(c,i,o,u,p,h,m,b){c.emplaceBack((i<<1)+m,(o<<1)+h,(Math.floor(u*Pj)<<1)+p,Math.round(b))}function Og(c,i,o){c.emplaceBack(i.x*It,i.y*It,o?1:0)}function Yv(c,i,o,u,p,h){c.emplaceBack(i.x,i.y,(o.x<<1)+u,(o.y<<1)+p,h)}function Pg(c,i,o){c.emplaceBack(i.x,i.y,i.z,o[0]*16384,o[1]*16384,o[2]*16384)}class B2{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class k2{constructor(){this.centroidXY=new ze(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new ze(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new ze(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new ze(this.max.x-this.min.x,this.max.y-this.min.y)}}class z2{constructor(){this.acc=new ze(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,o){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=o.x,i.min.y=i.max.y=o.y)}appendEdge(i,o,u){this.accCount++,this.acc._add(o);let p=!!this.borders;o.x<i.min.x?(i.min.x=o.x,p=!0):o.x>i.max.x&&(i.max.x=o.x,p=!0),o.y<i.min.y?(i.min.y=o.y,p=!0):o.y>i.max.y&&(i.max.y=o.y,p=!0),((o.x===0||o.x===It)&&o.x===u.x)!=((o.y===0||o.y===It)&&o.y===u.y)&&this.processBorderOverlap(o,u),p&&this.checkBorderIntersection(o,u)}checkBorderIntersection(i,o){o.x<0!=i.x<0&&this.addBorderIntersection(0,nr(o.y,i.y,(0-o.x)/(i.x-o.x))),o.x>It!=i.x>It&&this.addBorderIntersection(1,nr(o.y,i.y,(It-o.x)/(i.x-o.x))),o.y<0!=i.y<0&&this.addBorderIntersection(2,nr(o.x,i.x,(0-o.y)/(i.y-o.y))),o.y>It!=i.y>It&&this.addBorderIntersection(3,nr(o.x,i.x,(It-o.y)/(i.y-o.y)))}addBorderIntersection(i,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[i];o<u[0]&&(u[0]=o),o>u[1]&&(u[1]=o)}processBorderOverlap(i,o){if(i.x===o.x){if(i.y===o.y)return;const u=i.x===0?0:1;this.addBorderIntersection(u,o.y),this.addBorderIntersection(u,i.y)}else{const u=i.y===0?2:3;this.addBorderIntersection(u,o.x),this.addBorderIntersection(u,i.x)}}centroid(){return this.accCount===0?new ze(0,0):new ze(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,o)=>i+ +(o[0]!==Number.MAX_VALUE),0):0}}function F2(c,i){const o=c.add(i)._unit(),u=Dt(c.x*o.x+c.y*o.y,-1,1);var p,h,m;return m=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(m)))/4*Aj*((p=c).x*(h=i).y-p.y*h.x<0?-1:1)}const Cj=[c=>c.x<0,c=>c.x>It,c=>c.y<0,c=>c.y>It];function Mj(c,i,o,u){const p=[4];if(u===0)return p;o._mult(u);const h=c.sub(o),m=i.sub(o),b=[c,i,h,m];for(let S=0;S<4;S++)for(const A of b)if(Cj[S](A)){p.push(S);break}return p}class N2{constructor(i){this.vertexArray=new Gf,this.indexArray=new Jn,this.programConfigurations=new El(i.layers,{zoom:i.zoom,lut:i.lut},o=>Oj.includes(o)),this._segments=new on,this.hiddenByLandmarkVertexArray=new Zf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new on}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,o,u,p=!1){const h=i.length;if(h>2){let m=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[m].length);let S;m!==this._segments.get().length-1&&(m++,this._segmentToGroundQuads[m]=[],this._segmentToRegionTriCounts[m]=[0,0,0,0,0]);{const A=i[0],y=i[1];S=F2(A.sub(i[h-1])._perp()._unit(),y.sub(A)._perp()._unit())}for(let A=0;A<h;A++){const y=A===h-1?0:A+1,w=i[A],P=i[y],E=i[y===h-1?0:y+1],O=P.sub(w)._perp()._unit(),M=F2(O,E.sub(P)._perp()._unit()),R=S,z=M;if(Lw(w,P,o)||p&&V2(w,o)&&V2(P,o)){S=M;continue}const V=b.vertexLength;Yv(this.vertexArray,w,P,1,1,R),Yv(this.vertexArray,w,P,1,0,R),Yv(this.vertexArray,w,P,0,1,z),Yv(this.vertexArray,w,P,0,0,z),b.vertexLength+=4;const G=Mj(w,P,O,u);for(const F of G)this._segmentToGroundQuads[m].push({id:V,region:F}),this._segmentToRegionTriCounts[m][F]+=2,b.primitiveLength+=2;S=M}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),o=i.length;for(let u=0;u<o;u++)this._segmentToGroundQuads[u].sort((p,h)=>p.region-h.region);for(let u=0;u<o;u++){const p=this._segmentToGroundQuads[u],h=i[u],m=this._segmentToRegionTriCounts[u];m.reduce((S,A)=>S+A,0);let b=0;for(let S=0;S<=4;S++){const A=m[S];if(A!==0){let y=this.regionSegments[S];y||(y=this.regionSegments[S]=new on);const w={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+b,vertexLength:h.vertexLength,primitiveLength:A};y.get().push(w)}b+=A}for(let S=0;S<p.length;S++){const A=p[S].id;this.indexArray.emplaceBack(A,A+1,A+3),this.indexArray.emplaceBack(A,A+3,A+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,o,u,p,h,m){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,o,u,p,h,m)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,yj.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,o,u,p,h,m){this.hasData()&&this.programConfigurations.updatePaintArrays(i,o,u,p,h,m)}updateHiddenByLandmark(i){if(!this.hasData())return;const o=i.groundVertexCount+i.groundVertexArrayOffset;if(i.groundVertexCount===0)return;const u=i.flags&Pu?1:0;for(let p=i.groundVertexArrayOffset;p<o;++p)this.hiddenByLandmarkVertexArray.emplace(p,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,xj.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const o=this.regionSegments[i];o&&o.destroy()}}}}class Jv{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Jn,this.footprintVertices=new bl,this.footprintSegments=[],this.layoutVertexArray=new xl,this.centroidVertexArray=new Rv,this.wallVertexArray=new pg,this.indexArray=new Jn,this.programConfigurations=new El(i.layers,{zoom:i.zoom,lut:i.lut},o=>Sj.includes(o)),this.segments=new on,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new N2(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(i,o){}populate(i,o,u,p){this.features=[],this.hasPattern=Tw("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=Te(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:m,index:b,sourceLayerIndex:S}of i){const A=this.layers[0]._featureFilter.needGeometry,y=xt(h,A);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),y,u))continue;const w={id:m,sourceLayerIndex:S,index:b,geometry:A?y.geometry:vt(h,u,p),properties:h.properties,type:h.type,patterns:{}},P=this.layoutVertexArray.length,E=Rw[w.type]==="Polygon";if(this.hasPattern)this.features.push(Ew("fill-extrusion",this.layers,w,this.zoom,o));else if(this.wallMode)for(const O of w.geometry)for(const M of R2(O,E))this.addFeature(w,[M],b,u,{},o.availableImages,p,o.brightness);else this.addFeature(w,w.geometry,b,u,{},o.availableImages,p,o.brightness);o.featureIndex.insert(h,w.geometry,b,S,this.index,P)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,o,u,p,h,m){for(const b of this.features){const S=Rw[b.type]==="Polygon",{geometry:A}=b;if(this.wallMode)for(const y of A)for(const w of R2(y,S))this.addFeature(b,[w],b.index,o,u,p,h,m);else this.addFeature(b,A,b.index,o,u,p,h,m)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,o,u,p,h){const m=Object.keys(i).length!==0;if(m&&!this.stateDependentLayers.length)return;const b=m?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(i,o,b,u,p,h),this.groundEffect.update(i,o,b,u,p,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Tj),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,bj.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,wj.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,vj.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,o,u,p,h,m,b,S){const A=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,y=[new ze(0,0),new ze(It,It)],w=b.projection,P=w.name==="globe",E=this.wallMode||Rw[i.type]==="Polygon",O=new z2;O.centroidDataIndex=this.centroidData.length;const M=new k2,R=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},p)<=0,z=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},p);let V;if(M.height=z,M.vertexArrayOffset=this.layoutVertexArray.length,M.groundVertexArrayOffset=this.groundEffect.vertexArray.length,P&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Hf),this.wallMode){if(P)return void Jr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;V=function(ne){const me=ne[0].x===ne[ne.length-1].x&&ne[0].y===ne[ne.length-1].y;(function(bt){let mt=0;const Yt=bt.length;for(let Rt=0;Rt<Yt;Rt++)mt+=(bt[(Rt+1)%Yt].x-bt[Rt].x)*(bt[(Rt+1)%Yt].y+bt[Rt].y);return mt>=0})(ne)||(ne=ne.reverse());const _e={geometry:[],joinNormals:[],indices:[]},Ae=[],Me=[],Re=[];let Be=ne.length;if(Be<(me?3:2))return _e;for(;Be>=2&&ne[Be-1].equals(ne[Be-2]);)Be--;let Ge,Fe,tt,ut,Xe,Lt=0;for(;Lt<Be-1&&ne[Lt].equals(ne[Lt+1]);)Lt++;me&&(Ge=ne[Be-2],Xe=ne[Lt].sub(Ge)._unit()._perp());for(let bt=Lt;bt<Be;bt++){if(tt=bt===Be-1?me?ne[Lt+1]:void 0:ne[bt+1],tt&&ne[bt].equals(tt))continue;Xe&&(ut=Xe),Ge&&(Fe=Ge),Ge=ne[bt],Xe=tt?tt.sub(Ge)._unit()._perp():ut,ut=ut||Xe;let mt=ut.add(Xe);mt.x===0&&mt.y===0||mt._unit();const Yt=mt.x*Xe.x+mt.y*Xe.y,Rt=Yt!==0?1/Yt:1/0,$t=ut.x*Xe.y-ut.y*Xe.x>0;let cr="miter";const Cr=2;cr==="miter"&&Rt>Cr&&(cr="bevel"),cr==="bevel"&&(Rt>100&&(cr="flipbevel"),Rt<Cr&&(cr="miter"));const Tr=(Er,Rr,Br,Ti)=>{const ui=new ze(Er.x,Er.y),hr=new ze(Er.x,Er.y);ui.x+=Rr.x*Ti,ui.y+=Rr.y*Ti,hr.x-=Rr.x*Math.max(Br,1),hr.y-=Rr.y*Math.max(Br,1),Re.push(Rr),Ae.push(ui),Me.push(hr)};if(cr==="miter")mt._mult(Rt),Tr(Ge,mt,0,0);else if(cr==="flipbevel")mt=Xe.mult(-1),Tr(Ge,mt,0,0),Tr(Ge,mt.mult(-1),0,0);else{const Er=-Math.sqrt(Rt*Rt-1),Rr=$t?Er:0,Br=$t?0:Er;Fe&&Tr(Ge,ut,Rr,Br),tt&&Tr(Ge,Xe,Rr,Br)}}_e.geometry=[...Ae,...Me.reverse(),Ae[0]],_e.joinNormals=[...Re,...Re.reverse(),Re[Re.length-1]];const Pt=_e.geometry.length-1;for(let bt=0;bt<Pt/2;bt++)if(bt+1<Pt/2){let mt=bt,Yt=bt+1,Rt=Pt-1-bt,$t=Pt-2-bt;mt=mt===0?Pt-1:mt-1,Yt=Yt===0?Pt-1:Yt-1,Rt=Rt===0?Pt-1:Rt-1,$t=$t===0?Pt-1:$t-1,_e.indices.push(Rt),_e.indices.push(Yt),_e.indices.push(mt),_e.indices.push(Rt),_e.indices.push($t),_e.indices.push(Yt)}return _e}(o[0]),o=[V.geometry]}const G=(ne,me)=>ne<(me.length-1)/2||ne===me.length-1,F=this.wallMode?[o]:qv(o,500);for(let ne=F.length-1;ne>=0;ne--){const me=F[ne];(me.length===0||(q=me[0]).every(he=>he.x<=0)||q.every(he=>he.x>=It)||q.every(he=>he.y<=0)||q.every(he=>he.y>=It))&&F.splice(ne,1)}var q;let W;if(P)W=q2(F,y,p);else{W=[];for(const ne of F)W.push({polygon:ne,bounds:y})}const te=E?this.edgeRadius:0,se=te>0&&this.zoom<17,le=(ne,me)=>{if(ne.length===0)return!1;const he=ne[ne.length-1];return me.x===he.x&&me.y===he.y};for(const{polygon:ne,bounds:me}of W){let he=0,_e=0;for(const Be of ne)E&&!Be[0].equals(Be[Be.length-1])&&Be.push(Be[0]),_e+=E?Be.length-1:Be.length;const Ae=this.segments.prepareSegment((E?5:4)*_e,this.layoutVertexArray,this.indexArray);M.footprintSegIdx<0&&(M.footprintSegIdx=this.footprintSegments.length),M.polygonSegIdx<0&&(M.polygonSegIdx=this.polygonSegments.length);const Me={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Re=new B2;if(Re.vertexOffset=this.footprintVertices.length,Re.indexOffset=3*this.footprintIndices.length,Re.ringIndices=[],E){const Be=[],Ge=[];he=Ae.vertexLength;for(let tt=0;tt<ne.length;tt++){const ut=ne[tt];ut.length&&tt!==0&&Ge.push(Be.length/2);const Xe=[];let Lt,Pt;Lt=ut[1].sub(ut[0])._perp()._unit(),Re.ringIndices.push(ut.length-1);for(let bt=1;bt<ut.length;bt++){const mt=ut[bt],Yt=ut[bt===ut.length-1?1:bt+1],Rt=mt.clone();if(te){Pt=Yt.sub(mt)._perp()._unit();const $t=Lt.add(Pt)._unit(),cr=te*Math.min(4,1/(Lt.x*$t.x+Lt.y*$t.y));Rt.x+=cr*$t.x,Rt.y+=cr*$t.y,Rt.x=Math.round(Rt.x),Rt.y=Math.round(Rt.y),Lt=Pt}if(!R||te!==0&&!se||le(Xe,Rt)||Xe.push(Rt),Sg(this.layoutVertexArray,Rt.x,Rt.y,0,0,1,1,0),this.wallMode){const $t=G(bt,ut);Og(this.wallVertexArray,V.joinNormals[bt],!$t)}Ae.vertexLength++,this.footprintVertices.emplaceBack(mt.x,mt.y),Be.push(mt.x,mt.y),P&&Pg(this.layoutVertexExtArray,w.projectTilePoint(Rt.x,Rt.y,p),w.upVector(p,Rt.x,Rt.y))}R&&(te===0||se)&&(Xe.length!==0&&le(Xe,Xe[0])&&Xe.pop(),this.groundEffect.addData(Xe,me,A))}const Fe=this.wallMode?V.indices:xg(Be,Ge);for(let tt=0;tt<Fe.length;tt+=3)this.footprintIndices.emplaceBack(Re.vertexOffset+Fe[tt+0],Re.vertexOffset+Fe[tt+1],Re.vertexOffset+Fe[tt+2]),this.indexArray.emplaceBack(he+Fe[tt],he+Fe[tt+2],he+Fe[tt+1]),Ae.primitiveLength++;Re.indexCount+=Fe.length,Re.vertexCount+=this.footprintVertices.length-Re.vertexOffset}for(let Be=0;Be<ne.length;Be++){const Ge=ne[Be];O.startRing(M,Ge[0]);let Fe=Ge.length>4&&U2(Ge[Ge.length-2],Ge[0],Ge[1]),tt=te?Ij(Ge[Ge.length-2],Ge[0],Ge[1],te):0;const ut=[];let Xe,Lt,Pt;Lt=Ge[1].sub(Ge[0])._perp()._unit();let bt=!0;for(let mt=1,Yt=0;mt<Ge.length;mt++){let Rt=Ge[mt-1],$t=Ge[mt];const cr=Ge[mt===Ge.length-1?1:mt+1];if(O.appendEdge(M,$t,Rt),Lw($t,Rt,me)){te&&(Lt=cr.sub($t)._perp()._unit(),bt=!bt);continue}const Cr=$t.sub(Rt)._perp(),Tr=Cr.x/(Math.abs(Cr.x)+Math.abs(Cr.y)),Er=Cr.y>0?1:0,Rr=Rt.dist($t);if(Yt+Rr>32768&&(Yt=0),te){Pt=cr.sub($t)._perp()._unit();let hr=j2(Rt,$t,cr,$2(Lt,Pt),te);isNaN(hr)&&(hr=0);const ni=$t.sub(Rt)._unit();Rt=Rt.add(ni.mult(tt))._round(),$t=$t.add(ni.mult(-hr))._round(),tt=hr,Lt=Pt,R&&this.zoom>=17&&(le(ut,Rt)||ut.push(Rt),le(ut,$t)||ut.push($t))}const Br=Ae.vertexLength,Ti=Ge.length>4&&U2(Rt,$t,cr);let ui=G2(Yt,Fe,bt);if(Sg(this.layoutVertexArray,Rt.x,Rt.y,Tr,Er,0,0,ui),Sg(this.layoutVertexArray,Rt.x,Rt.y,Tr,Er,0,1,ui),this.wallMode){const hr=G(mt-1,Ge),ni=V.joinNormals[mt-1];Og(this.wallVertexArray,ni,hr),Og(this.wallVertexArray,ni,hr)}if(Yt+=Rr,ui=G2(Yt,Ti,!bt),Fe=Ti,Sg(this.layoutVertexArray,$t.x,$t.y,Tr,Er,0,0,ui),Sg(this.layoutVertexArray,$t.x,$t.y,Tr,Er,0,1,ui),this.wallMode){const hr=G(mt,Ge),ni=V.joinNormals[mt];Og(this.wallVertexArray,ni,hr),Og(this.wallVertexArray,ni,hr)}if(Ae.vertexLength+=4,this.indexArray.emplaceBack(Br+0,Br+1,Br+2),this.indexArray.emplaceBack(Br+1,Br+3,Br+2),Ae.primitiveLength+=2,te){const hr=he+(mt===1?Ge.length-2:mt-2),ni=mt===1?he:hr+1;if(this.indexArray.emplaceBack(Br+1,hr,Br+3),this.indexArray.emplaceBack(hr,ni,Br+3),Ae.primitiveLength+=2,Xe===void 0&&(Xe=Br),!Lw(cr,Ge[mt],me)){const si=mt===Ge.length-1?Xe:Ae.vertexLength;this.indexArray.emplaceBack(Br+2,Br+3,si),this.indexArray.emplaceBack(Br+3,si+1,si),this.indexArray.emplaceBack(Br+3,ni,si+1),Ae.primitiveLength+=3}bt=!bt}if(P){const hr=this.layoutVertexExtArray,ni=w.projectTilePoint(Rt.x,Rt.y,p),si=w.projectTilePoint($t.x,$t.y,p),Fi=w.upVector(p,Rt.x,Rt.y),un=w.upVector(p,$t.x,$t.y);Pg(hr,ni,Fi),Pg(hr,ni,Fi),Pg(hr,si,un),Pg(hr,si,un)}}E&&(he+=Ge.length-1),R&&te&&this.zoom>=17&&(ut.length!==0&&le(ut,ut[0])&&ut.pop(),this.groundEffect.addData(ut,me,A,te>0))}this.footprintSegments.push(Re),Me.triangleCount=this.indexArray.length-Me.triangleArrayOffset,this.polygonSegments.push(Me),++M.footprintSegLen,++M.polygonSegLen}if(M.vertexCount=this.layoutVertexArray.length-M.vertexArrayOffset,M.groundVertexCount=this.groundEffect.vertexArray.length-M.groundVertexArrayOffset,M.vertexCount!==0){if(M.centroidXY=O.borders?L2:this.encodeCentroid(O,M),this.centroidData.push(M),O.borders){this.featuresOnBorder.push(O);const ne=this.featuresOnBorder.length-1;for(let me=0;me<O.borders.length;me++)O.borders[me][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[me].push(ne)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,h,m,p,S),this.groundEffect.addPaintPropertiesData(i,u,h,m,p,S),this.maxHeight=Math.max(this.maxHeight,z)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((o,u)=>this.featuresOnBorder[o].borders[i][0]-this.featuresOnBorder[u].borders[i][0])}splitToSubtiles(){const i=[];for(let b=0;b<this.centroidData.length;b++){const S=this.centroidData[b],A=+(S.min.y+S.max.y>It),y=2*A+(+(S.min.x+S.max.x>It)^A);for(let w=0;w<S.polygonSegLen;w++){const P=S.polygonSegIdx+w;i.push({centroidIdx:b,subtile:y,polygonSegmentIdx:P,triangleSegmentIdx:this.polygonSegments[P].triangleSegIdx})}}const o=new Jn;i.sort((b,S)=>b.triangleSegmentIdx===S.triangleSegmentIdx?b.subtile-S.subtile:b.triangleSegmentIdx-S.triangleSegmentIdx);let u=0,p=0,h=0;for(const b of i){if(b.triangleSegmentIdx!==u)break;h++}const m=i.length;for(;p!==i.length;){u=i[p].triangleSegmentIdx;let b=0,S=p,A=p;for(let y=S;y<h&&i[y].subtile===b;y++)A++;for(;S!==h;){const y=i[S];b=y.subtile;const w=this.centroidData[y.centroidIdx].min.clone(),P=this.centroidData[y.centroidIdx].max.clone(),E={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let O=S;O<A;O++){const M=i[O],R=this.polygonSegments[M.polygonSegmentIdx],z=this.centroidData[M.centroidIdx].min,V=this.centroidData[M.centroidIdx].max,G=this.indexArray.uint16;for(let F=R.triangleArrayOffset;F<R.triangleArrayOffset+R.triangleCount;F++)o.emplaceBack(G[3*F],G[3*F+1],G[3*F+2]);E.primitiveLength+=R.triangleCount,w.x=Math.min(w.x,z.x),w.y=Math.min(w.y,z.y),P.x=Math.max(P.x,V.x),P.y=Math.max(P.y,V.y)}E.primitiveLength>0&&this.triangleSubSegments.push({segment:E,min:w,max:P}),S=A;for(let O=S;O<h&&i[O].subtile===i[S].subtile;O++)A++}p=h;for(let y=p;y<m&&i[y].triangleSegmentIdx===i[p].triangleSegmentIdx;y++)h++}o._trim(),this.indexArray=o}getVisibleSegments(i,o,u){const p=new on;if(this.wallMode){for(const M of this.triangleSubSegments)p.segments.push(M.segment);return p}let h=0,m=0;const b=1<<i.canonical.z;if(o){const M=o.getMinMaxForTile(i);M&&(h=M.min,m=M.max)}m+=this.maxHeight;const S=i.toUnwrapped();let A;const y=[S.canonical.x/b+S.wrap,S.canonical.y/b],w=[(S.canonical.x+1)/b+S.wrap,(S.canonical.y+1)/b],P=(M,R,z)=>[M[0]*(1-z[0])+R[0]*z[0],M[1]*(1-z[1])+R[1]*z[1]],E=[],O=[];for(const M of this.triangleSubSegments){E[0]=M.min.x/It,E[1]=M.min.y/It,O[0]=M.max.x/It,O[1]=M.max.y/It;const R=P(y,w,E),z=P(y,w,O);if(new Di([R[0],R[1],h],[z[0],z[1],m]).intersectsPrecise(u)===0){A&&(p.segments.push(A),A=void 0);continue}const V=M.segment;A&&A.vertexOffset!==V.vertexOffset&&(p.segments.push(A),A=void 0),A?(A.vertexLength+=V.vertexLength,A.primitiveLength+=V.primitiveLength):A={vertexOffset:V.vertexOffset,primitiveLength:V.primitiveLength,vertexLength:V.vertexLength,primitiveOffset:V.primitiveOffset,sortKey:void 0,vaos:{}}}return A&&p.segments.push(A),p}encodeCentroid(i,o){const u=i.centroid(),p=o.span(),h=Math.min(7,Math.round(p.x*this.tileToMeter/10)),m=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new ze(Dt(u.x,1,It-1)<<3|h,Dt(u.y,1,It-1)<<3|m)}encodeBorderCentroid(i){if(!i.borders)return new ze(0,0);const o=i.borders,u=Number.MAX_VALUE;if(o[0][0]!==u||o[1][0]!==u){const p=o[0][0]!==u?0:1;return new ze(6|(o[0][0]!==u?0:65528),(o[p][0]+o[p][1])/2<<3|6)}{const p=o[2][0]!==u?2:3;return new ze((o[p][0]+o[p][1])/2<<3|6,6|(o[2][0]!==u?0:65528))}}showCentroid(i){const o=this.centroidData[i.centroidDataIndex];o.flags&=Pu,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const o=i.vertexArrayOffset,u=i.vertexCount+i.vertexArrayOffset,p=i.flags&Pu?L2:i.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==p.y||h!==p.x){for(let m=o;m<u;++m)this.centroidVertexArray.emplace(m,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const p=o.getReplacementRegionsForTile(i.toUnwrapped());if(Iw(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const m of this.centroidData)m.flags&=2147483647;const h=[];for(const m of this.activeReplacements){if(m.order<u)continue;const b=Math.pow(2,m.footprintTileId.canonical.z-i.canonical.z);for(const S of this.centroidData)if(!(S.flags&Pu||m.min.x>S.max.x||S.min.x>m.max.x||m.min.y>S.max.y||S.min.y>m.max.y))for(let A=0;A<S.footprintSegLen;A++){const y=this.footprintSegments[S.footprintSegIdx+A];if(h.length=0,Dj(this.footprintVertices,y.vertexOffset,y.vertexCount,m.footprintTileId.canonical,i.canonical,h),C2(m.footprint,h,this.footprintIndices.uint16,y.indexOffset,y.indexCount,-y.vertexOffset,-b)){S.flags|=Pu;break}}}for(const m of this.centroidData)this.writeCentroidToBuffer(m);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,o,u){let p=!1;for(let h=0;h<u.footprintSegLen;h++){const m=this.footprintSegments[u.footprintSegIdx+h];let b=0;for(const S of m.ringIndices){for(let A=b,y=S+b-1;A<S+b;y=A++){const w=this.footprintVertices.int16[2*(A+m.vertexOffset)+0],P=this.footprintVertices.int16[2*(A+m.vertexOffset)+1],E=this.footprintVertices.int16[2*(y+m.vertexOffset)+1];P>o!=E>o&&i<(this.footprintVertices.int16[2*(y+m.vertexOffset)+0]-w)*(o-P)/(E-P)+w&&(p=!p)}b=S}}return p}getHeightAtTileCoord(i,o){let u=Number.NEGATIVE_INFINITY,p=!0;const h=4*(i+It)*It+(o+It);if(this.partLookup.hasOwnProperty(h)){const m=this.partLookup[h];return m?{height:m.height,hidden:!!(m.flags&Pu)}:void 0}for(const m of this.centroidData)i>m.max.x||m.min.x>i||o>m.max.y||m.min.y>o||this.footprintContainsPoint(i,o,m)&&m&&m.height>u&&(u=m.height,this.partLookup[h]=m,p=!!(m.flags&Pu));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:p};this.partLookup[h]=void 0}}function $2(c,i){const o=c.add(i)._unit();return c.x*o.x+c.y*o.y}function Ij(c,i,o,u){const p=i.sub(c)._perp()._unit(),h=o.sub(i)._perp()._unit();return j2(c,i,o,$2(p,h),u)}function j2(c,i,o,u,p){const h=Math.sqrt(1-u*u);return Math.min(c.dist(i)/3,i.dist(o)/3,p*h/u)}function Lw(c,i,o){return c.x<o[0].x&&i.x<o[0].x||c.x>o[1].x&&i.x>o[1].x||c.y<o[0].y&&i.y<o[0].y||c.y>o[1].y&&i.y>o[1].y}function V2(c,i){return c.x<i[0].x||c.x>i[1].x||c.y<i[0].y||c.y>i[1].y}function U2(c,i,o){if(c.x<0||c.x>=It||i.x<0||i.x>=It||o.x<0||o.x>=It)return!1;const u=o.sub(i),p=u.perp(),h=c.sub(i);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&p.x*h.x+p.y*h.y<0}function G2(c,i,o){const u=i?2|c:-3&c;return o?1|u:-2&u}function H2(){const c=Math.PI/32,i=Math.tan(c),o=$;return o*Math.sqrt(1+2*i*i)-o}function q2(c,i,o){const u=1<<o.z,p=fe(o.x/u),h=fe((o.x+1)/u),m=de(o.y/u),b=de((o.y+1)/u);return function(S,A,y,w,P=0,E){const O=[];if(!S.length||!y||!w)return O;const M=(W,te)=>{for(const se of W)O.push({polygon:se,bounds:te})},R=Math.ceil(Math.log2(y)),z=Math.ceil(Math.log2(w)),V=R-z,G=[];for(let W=0;W<Math.abs(V);W++)G.push(V>0?0:1);for(let W=0;W<Math.min(R,z);W++)G.push(0),G.push(1);let F=S;if(F=Zv(F,A[0].y-P,A[1].y+P,1),F=Zv(F,A[0].x-P,A[1].x+P,0),!F.length)return O;const q=[];for(G.length?q.push({polygons:F,bounds:A,depth:0}):M(F,A);q.length;){const W=q.pop(),te=W.depth,se=G[te],le=W.bounds[0],ne=W.bounds[1],me=se===0?le.x:le.y,he=se===0?ne.x:ne.y,_e=E?E(se,me,he):.5*(me+he),Ae=Zv(W.polygons,me-P,_e+P,se),Me=Zv(W.polygons,_e-P,he+P,se);if(Ae.length){const Re=[le,new ze(se===0?_e:ne.x,se===1?_e:ne.y)];G.length>te+1?q.push({polygons:Ae,bounds:Re,depth:te+1}):M(Ae,Re)}if(Me.length){const Re=[new ze(se===0?_e:le.x,se===1?_e:le.y),ne];G.length>te+1?q.push({polygons:Me,bounds:Re,depth:te+1}):M(Me,Re)}}return O}(c,i,Math.ceil((h-p)/11.25),Math.ceil((m-b)/11.25),1,(S,A,y)=>{if(S===0)return .5*(A+y);{const w=de((o.y+A/It)/u);return(ce(.5*(de((o.y+y/It)/u)+w))*u-o.y)*It}})}function Dj(c,i,o,u,p,h){const m=Math.pow(2,u.z-p.z);for(let b=0;b<o;b++){let S=c.int16[2*(b+i)+0],A=c.int16[2*(b+i)+1];S=(S+p.x*It)*m-u.x*It,A=(A+p.y*It)*m-u.y*It,h.push(new ze(S,A))}}let W2,Z2;function Ag(c,i){return c.x*i.x+c.y*i.y}function X2(c,i){if(c.length===1){let o=0;const u=i[o++];let p;for(;!p||u.equals(p);)if(p=i[o++],!p)return 1/0;for(;o<i.length;o++){const h=i[o],m=c[0],b=p.sub(u),S=h.sub(u),A=m.sub(u),y=Ag(b,b),w=Ag(b,S),P=Ag(S,S),E=Ag(A,b),O=Ag(A,S),M=y*P-w*w,R=(P*E-w*O)/M,z=(y*O-w*E)/M,V=u.z*(1-R-z)+p.z*R+h.z*z;if(isFinite(V))return V}return 1/0}{let o=1/0;for(const u of i)o=Math.min(o,u.z);return o}}function K2(c,i,o,u,p,h,m,b){const S=m*p.getElevationAt(c,i,!0,!0),A=h[0]!==0,y=A?h[1]===0?m*(h[0]/7-450):m*function(w,P,E){const O=Math.floor(P[0]/8),M=Math.floor(P[1]/8),R=10*(P[0]-8*O),z=10*(P[1]-8*M),V=w.getElevationAt(O,M,!0,!0),G=w.getMeterToDEM(E),F=Math.floor(.5*(R*G-1)),q=Math.floor(.5*(z*G-1)),W=w.tileCoordToPixel(O,M),te=2*F+1,se=2*q+1,le=function(Me,Re,Be,Ge,Fe){return[Me.getElevationAtPixel(Re,Be,!0),Me.getElevationAtPixel(Re+Fe,Be,!0),Me.getElevationAtPixel(Re,Be+Fe,!0),Me.getElevationAtPixel(Re+Ge,Be+Fe,!0)]}(w,W.x-F,W.y-q,te,se),ne=Math.abs(le[0]-le[1]),me=Math.abs(le[2]-le[3]),he=Math.abs(le[0]-le[2])+Math.abs(le[1]-le[3]),_e=Math.min(.25,.5*G*(ne+me)/te),Ae=Math.min(.25,.5*G*he/se);return V+Math.max(_e*R,Ae*z)}(p,h,b):S;return{base:S+(o===0)?-1:o,top:A?Math.max(y+u,S+o+2):S+u}}jt(Jv,"FillExtrusionBucket",{omit:["layers","features"]}),jt(k2,"PartData"),jt(B2,"FootprintSegment"),jt(z2,"BorderCentroidData"),jt(N2,"GroundEffect");const Rj=ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Lj=ti([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:Bj}=Rj,kj=ti([{name:"a_packed",components:4,type:"Float32"}]),{members:zj}=kj,Fj=ti([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Nj}=Fj;class Y2{constructor(i,o){this.width=i,this.height=o,this.nextRow=0,this.image=new Ou({width:i,height:o}),this.positions={},this.uploaded=!1}getDash(i,o){const u=this.getKey(i,o);return this.positions[u]}trim(){const i=this.width,o=this.height=ds(this.nextRow);this.image.resize({width:i,height:o})}getKey(i,o){return i.join(",")+o}getDashRanges(i,o,u){const p=[];let h=i.length%2==1?-i[i.length-1]*u:0,m=i[0]*u,b=!0;p.push({left:h,right:m,isDash:b,zeroLength:i[0]===0});let S=i[0];for(let A=1;A<i.length;A++){b=!b;const y=i[A];h=S*u,S+=y,m=S*u,p.push({left:h,right:m,isDash:b,zeroLength:y===0})}return p}addRoundDash(i,o,u){const p=o/2;for(let h=-u;h<=u;h++){const m=this.width*(this.nextRow+u+h);let b=0,S=i[b];for(let A=0;A<this.width;A++){A/S.right>1&&(S=i[++b]);const y=Math.abs(A-S.left),w=Math.abs(A-S.right),P=Math.min(y,w);let E;const O=h/u*(p+1);if(S.isDash){const M=p-Math.abs(O);E=Math.sqrt(P*P+M*M)}else E=p-Math.sqrt(P*P+O*O);this.image.data[m+A]=Math.max(0,Math.min(255,E+128))}}}addRegularDash(i,o){for(let S=i.length-1;S>=0;--S){const A=i[S],y=i[S+1];A.zeroLength?i.splice(S,1):y&&y.isDash===A.isDash&&(y.left=A.left,i.splice(S,1))}const u=i[0],p=i[i.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const h=this.width*this.nextRow;let m=0,b=i[m];for(let S=0;S<this.width;S++){S/b.right>1&&(b=i[++m]);const A=Math.abs(S-b.left),y=Math.abs(S-b.right),w=Math.min(A,y);this.image.data[h+S]=Math.max(0,Math.min(255,(b.isDash?w:-w)+o+128))}}addDash(i,o){const u=this.getKey(i,o);if(this.positions[u])return this.positions[u];const p=o==="round",h=p?7:0,m=2*h+1;if(this.nextRow+m>this.height)return Jr("LineAtlas out of space"),null;i.length===0&&i.push(1);let b=0;for(let y=0;y<i.length;y++)i[y]<0&&(Jr("Negative value is found in line dasharray, replacing values with 0"),i[y]=0),b+=i[y];if(b!==0){const y=this.width/b,w=this.getDashRanges(i,this.width,y);p?this.addRoundDash(w,y,h):this.addRegularDash(w,o==="square"?.5*y:0)}const S=this.nextRow+h;this.nextRow+=m;const A={tl:[S,h],br:[b,0]};return this.positions[u]=A,A}}jt(Y2,"LineAtlas");const $j=tp.VectorTileFeature.types,jj=Math.cos(Math.PI/180*37.5),Vj=Math.cos(Math.PI/180*5);class Bw{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new ng,this.layoutVertexArray2=new ja,this.patternVertexArray=new wl,this.indexArray=new Jn,this.programConfigurations=new El(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new on,this.maxLineLength=0,this.zOffsetVertexArray=new vu,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:It/64}updateFootprints(i,o){}populate(i,o,u,p){this.hasPattern=Tw("line",this.layers,o);const h=this.layers[0].layout.get("line-sort-key"),m=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!m.isConstant()||!!m.constantOr(0);const b=[];for(const{feature:w,id:P,index:E,sourceLayerIndex:O}of i){const M=this.layers[0]._featureFilter.needGeometry,R=xt(w,M);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),R,u))continue;const z=h?h.evaluate(R,{},u):void 0,V={id:P,properties:w.properties,type:w.type,sourceLayerIndex:O,index:E,geometry:M?R.geometry:vt(w,u,p),patterns:{},sortKey:z};b.push(V)}h&&b.sort((w,P)=>w.sortKey-P.sortKey);const{lineAtlas:S,featureIndex:A}=o,y=this.addConstantDashes(S);for(const w of b){const{geometry:P,index:E,sourceLayerIndex:O}=w;if(y&&this.addFeatureDashes(w,S),this.hasPattern){const M=Ew("line",this.layers,w,this.zoom,o);this.patternFeatures.push(M)}else this.addFeature(w,P,E,u,S.positions,o.availableImages,o.brightness);A.insert(i[E].feature,P,E,O,this.index)}}addConstantDashes(i){let o=!1;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(p.kind!=="constant"||h.kind!=="constant")o=!0;else{const m=h.value,b=p.value;if(!b)continue;i.addDash(b,m)}}return o}addFeatureDashes(i,o){const u=this.zoom;for(const p of this.layers){const h=p.paint.get("line-dasharray").value,m=p.layout.get("line-cap").value;if(h.kind==="constant"&&m.kind==="constant")continue;let b,S;if(h.kind==="constant"){if(b=h.value,!b)continue}else b=h.evaluate({zoom:u},i);S=m.kind==="constant"?m.value:m.evaluate({zoom:u},i),o.addDash(b,S),i.patterns[p.id]=o.getKey(b,S)}}update(i,o,u,p,h){const m=Object.keys(i).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(i,o,m?this.stateDependentLayers:this.layers,u,p,h)}addFeatures(i,o,u,p,h,m){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,u,p,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,zj)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,Nj)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,Lj.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Bj),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,o,u,p,h,m,b){const S=this.layers[0].layout,A=S.get("line-join").evaluate(i,{}),y=S.get("line-cap").evaluate(i,{}),w=S.get("line-miter-limit"),P=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const E of o)this.addLine(E,i,p,A,y,w,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,u,h,m,p,b)}addLine(i,o,u,p,h,m,b){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const S={zoom:this.zoom,lineProgress:void 0},A=this.layers[0].layout,y=p==="none";if(this.patternJoinNone=this.hasPattern&&y,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let W=0;W<i.length-1;W++)this.totalDistance+=i[W].dist(i[W+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w=$j[o.type]==="Polygon";let P=i.length;for(;P>=2&&i[P-1].equals(i[P-2]);)P--;let E=0;for(;E<P-1&&i[E].equals(i[E+1]);)E++;if(P<(w?3:2))return;p==="bevel"&&(m=1.05);const O=this.overscaling<=16?15*It/(512*this.overscaling):0,M=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let R,z,V,G,F,q;this.e1=this.e2=-1,w&&(R=i[P-2],F=i[E].sub(R)._unit()._perp());for(let W=E;W<P;W++){if(V=W===P-1?w?i[E+1]:void 0:i[W+1],V&&i[W].equals(V))continue;if(F&&(G=F),R&&(z=R),R=i[W],this.hasZOffset){const Re=A.get("line-z-offset").value;if(Re.kind==="constant")q=Re.value;else{if(this.lineClips){const Be=this.totalDistance/(this.lineClips.end-this.lineClips.start);S.lineProgress=(Be*this.lineClips.start+this.distance+(z?z.dist(R):0))/Be}else Jr(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),S.lineProgress=0;q=Re.evaluate(S,o)}q=q||0}F=V?V.sub(R)._unit()._perp():G,G=G||F;const te=z&&V;let se=te?p:w||y?"butt":h;const le=G.x*F.x+G.y*F.y;if(y){const Re=function(Be){if(Be.patternJoinNone){const Ge=Be.segmentPoints.length/2,Fe=Be.lineSoFar-Be.segmentStart;for(let tt=0;tt<Ge;++tt){const ut=Be.segmentPoints[2*tt+1],Xe=Math.round(Be.segmentPoints[2*tt])+.5+.25*ut;Be.patternVertexArray.emplaceBack(Xe,Fe,Be.segmentStart),Be.patternVertexArray.emplaceBack(Xe,Fe,Be.segmentStart)}Be.segmentPoints.length=0}Be.e1=Be.e2=-1};if(te&&le<Vj){this.updateDistance(z,R),this.addCurrentVertex(R,G,1,1,M,q),Re(this),this.addCurrentVertex(R,F,-1,-1,M,q);continue}if(z){if(!V){this.updateDistance(z,R),this.addCurrentVertex(R,G,1,1,M,q),Re(this);continue}se="miter"}}let ne=G.add(F);ne.x===0&&ne.y===0||ne._unit();const me=ne.x*F.x+ne.y*F.y,he=me!==0?1/me:1/0,_e=2*Math.sqrt(2-2*me),Ae=me<jj&&z&&V,Me=G.x*F.y-G.y*F.x>0;if(Ae&&W>E){const Re=R.dist(z);if(Re>2*O){const Be=R.sub(R.sub(z)._mult(O/Re)._round());this.updateDistance(z,Be),this.addCurrentVertex(Be,G,0,0,M,q),z=Be}}if(te&&se==="round"&&(he<b?se="miter":he<=2&&(se="fakeround")),se==="miter"&&he>m&&(se="bevel"),se==="bevel"&&(he>2&&(se="flipbevel"),he<m&&(se="miter")),z&&this.updateDistance(z,R),se==="miter")ne._mult(he),this.addCurrentVertex(R,ne,0,0,M,q);else if(se==="flipbevel"){if(he>100)ne=F.mult(-1);else{const Re=he*G.add(F).mag()/G.sub(F).mag();ne._perp()._mult(Re*(Me?-1:1))}this.addCurrentVertex(R,ne,0,0,M,q),this.addCurrentVertex(R,ne.mult(-1),0,0,M,q)}else if(se==="bevel"||se==="fakeround"){const Re=-Math.sqrt(he*he-1),Be=Me?Re:0,Ge=Me?0:Re;if(z&&this.addCurrentVertex(R,G,Be,Ge,M,q),se==="fakeround"){const Fe=Math.round(180*_e/Math.PI/20);for(let tt=1;tt<Fe;tt++){let ut=tt/Fe;if(ut!==.5){const Lt=ut-.5;ut+=ut*Lt*(ut-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*Lt*Lt+(.848013+le*(.215638*le-1.06021)))}const Xe=F.sub(G)._mult(ut)._add(G)._unit()._mult(Me?-1:1);this.addHalfVertex(R,Xe.x,Xe.y,!1,Me,0,M,q)}}V&&this.addCurrentVertex(R,F,-Be,-Ge,M,q)}else se==="butt"?this.addCurrentVertex(R,ne,0,0,M,q):se==="square"?(z||this.addCurrentVertex(R,ne,-1,-1,M,q),this.addCurrentVertex(R,ne,0,0,M,q),z&&this.addCurrentVertex(R,ne,1,1,M,q)):se==="round"&&(z&&(this.addCurrentVertex(R,G,0,0,M,q),this.addCurrentVertex(R,G,1,1,M,q,!0)),V&&(this.addCurrentVertex(R,F,-1,-1,M,q,!0),this.addCurrentVertex(R,F,0,0,M,q)));if(Ae&&W<P-1){const Re=R.dist(V);if(Re>2*O){const Be=R.add(V.sub(R)._mult(O/Re)._round());this.updateDistance(R,Be),this.addCurrentVertex(Be,F,0,0,M,q),R=Be}}}}addVerticesTo(i,o,u,p,h,m,b,S,A,y){const w=(o.w-i.w)/this.tessellationStep|0;if(w>1){this.lineSoFar=i.w;const P=(o.x-i.x)/w,E=(o.y-i.y)/w,O=(o.z-i.z)/w,M=(o.w-i.w)/w;for(let R=1;R<w;++R)i.x+=P,i.y+=E,i.z+=O,this.lineSoFar+=M,this.addHalfVertex(i,u,p,y,!1,b,A,i.z),this.addHalfVertex(i,h,m,y,!0,-S,A,i.z)}this.lineSoFar=o.w,this.addHalfVertex(o,u,p,y,!1,b,A,o.z),this.addHalfVertex(o,h,m,y,!0,-S,A,o.z)}addCurrentVertex(i,o,u,p,h,m,b=!1){const S=o.x+o.y*u,A=o.y-o.x*u,y=o.y*p-o.x,w=-o.y-o.x*p;if(m!=null){const E=It+10,O=m,M=new T2(i.x,i.y,O,this.lineSoFar),R=J2(i,-10,E),z=this.lineSoFar;if(this.currentVertex)if(R){const V=this.currentVertexIsOutside,G=this.currentVertex,F=new T2(i.x,i.y,O,this.lineSoFar);S2(G,F,-10,E),J2(F,-10,E)||(V&&(this.e1=this.e2=-1,this.lineSoFar=G.w,this.addHalfVertex(G,S,A,b,!1,u,h,G.z),this.addHalfVertex(G,y,w,b,!0,-p,h,G.z)),this.addVerticesTo(G,F,S,A,y,w,u,p,h,b))}else{const V=this.currentVertex;this.currentVertexIsOutside&&(S2(V,M,-10,E),this.e1=this.e2=-1,this.lineSoFar=V.w,this.addHalfVertex(V,S,A,b,!1,u,h,V.z),this.addHalfVertex(V,y,w,b,!0,-p,h,V.z)),this.addVerticesTo(V,M,S,A,y,w,u,p,h,b)}else R||(this.addHalfVertex(i,S,A,b,!1,u,h,m),this.addHalfVertex(i,y,w,b,!0,-p,h,m));this.currentVertex=M,this.currentVertexIsOutside=R,this.lineSoFar=z}else this.addHalfVertex(i,S,A,b,!1,u,h,m),this.addHalfVertex(i,y,w,b,!0,-p,h,m)}addHalfVertex({x:i,y:o},u,p,h,m,b,S,A){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),m||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((i<<1)+(h?1:0),(o<<1)+(m?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const y=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,y),S.primitiveLength++),m?this.e2=y:this.e1=y,A!=null&&this.zOffsetVertexArray.emplaceBack(A)}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,o){this.distance+=i.dist(o),this.updateScaledDistance()}}function J2(c,i,o){return c.x<i||c.x>o||c.y<i||c.y>o}let Q2,eA;function tA(c,i,o){return i*(It/(c.tileSize*Math.pow(2,o-c.tileID.overscaledZ)))}function rA(c,i){return 1/tA(c,1,i.tileZoom)}function iA(c,i,o,u){return c.translatePosMatrix(u||i.tileID.projMatrix,i,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}jt(Bw,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const nA=c=>{const i=[];oA(c)&&i.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const o=c.paint.get("line-trim-offset");o[0]===0&&o[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",p=!!c.paint.get("line-pattern").constantOr(1);return u&&p&&i.push("LINE_JOIN_NONE"),i};function oA(c){const i=c.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let kw;const sA=()=>kw||(kw={layout:Q2||(Q2=new Ui({"line-cap":new Xt(Ue.layout_line["line-cap"]),"line-join":new Xt(Ue.layout_line["line-join"]),"line-miter-limit":new wt(Ue.layout_line["line-miter-limit"]),"line-round-limit":new wt(Ue.layout_line["line-round-limit"]),"line-sort-key":new Xt(Ue.layout_line["line-sort-key"]),"line-z-offset":new Xt(Ue.layout_line["line-z-offset"]),visibility:new wt(Ue.layout_line.visibility)})),paint:eA||(eA=new Ui({"line-opacity":new Xt(Ue.paint_line["line-opacity"]),"line-color":new Xt(Ue.paint_line["line-color"]),"line-translate":new wt(Ue.paint_line["line-translate"]),"line-translate-anchor":new wt(Ue.paint_line["line-translate-anchor"]),"line-width":new Xt(Ue.paint_line["line-width"]),"line-gap-width":new Xt(Ue.paint_line["line-gap-width"]),"line-offset":new Xt(Ue.paint_line["line-offset"]),"line-blur":new Xt(Ue.paint_line["line-blur"]),"line-dasharray":new Xt(Ue.paint_line["line-dasharray"]),"line-pattern":new Xt(Ue.paint_line["line-pattern"]),"line-gradient":new Gs(Ue.paint_line["line-gradient"]),"line-trim-offset":new wt(Ue.paint_line["line-trim-offset"]),"line-trim-fade-range":new wt(Ue.paint_line["line-trim-fade-range"]),"line-trim-color":new wt(Ue.paint_line["line-trim-color"]),"line-emissive-strength":new wt(Ue.paint_line["line-emissive-strength"]),"line-border-width":new Xt(Ue.paint_line["line-border-width"]),"line-border-color":new Xt(Ue.paint_line["line-border-color"]),"line-occlusion-opacity":new wt(Ue.paint_line["line-occlusion-opacity"])}))},kw);class Uj extends Xt{possiblyEvaluate(i,o){return o=new nn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(i,o)}evaluate(i,o,u,p){return o=Kr({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(i,o,u,p)}}let Cg;function aA(c,i){return i>0?i+2*c:c}const Gj=ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hj=ti([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),qj=ti([{name:"a_projected_pos",components:4,type:"Float32"}],4);ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Wj=ti([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Zj=ti([{name:"a_texb",components:2,type:"Uint16"}]),Xj=ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Kj=ti([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const lA=ti([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Yj=ti([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ti([{name:"triangle",components:3,type:"Uint16"}]),ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ti([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ti([{type:"Float32",name:"offsetX"}]),ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var io=24;const qa=128;function zw(c,i){const{expression:o}=i;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new nn(c+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=o;let h=0;for(;h<u.length&&u[h]<=c;)h++;h=Math.max(0,h-1);let m=h;for(;m<u.length&&u[m]<c+1;)m++;m=Math.min(u.length-1,m);const b=u[h],S=u[m];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:p}:{kind:"camera",minZoom:b,maxZoom:S,minSize:o.evaluate(new nn(b)),maxSize:o.evaluate(new nn(S)),interpolationType:p}}}function Qv(c,{uSize:i,uSizeT:o},{lowerSize:u,upperSize:p}){return c.kind==="source"?u/qa:c.kind==="composite"?nr(u/qa,p/qa,o):i}function rp(c,i){let o=0,u=0;if(c.kind==="constant")u=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:p,minZoom:h,maxZoom:m}=c,b=p?Dt(Jo.interpolationFactor(p,i,h,m),0,1):0;c.kind==="camera"?u=nr(c.minSize,c.maxSize,b):o=b}return{uSizeT:o,uSize:u}}var Jj=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:qa,evaluateSizeForFeature:Qv,evaluateSizeForZoom:rp,getSizeData:zw});function Qj(c,i,o){return c.sections.forEach(u=>{u.text=function(p,h,m){const b=h.layout.get("text-transform").evaluate(m,{});return b==="uppercase"?p=p.toLocaleUpperCase():b==="lowercase"&&(p=p.toLocaleLowerCase()),No.applyArabicShaping&&(p=No.applyArabicShaping(p)),p}(u.text,i,o)}),c}const Mg={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42","\u2190":"\u2191","\u2192":"\u2193"};function eV(c){return c==="\uFE36"||c==="\uFE48"||c==="\uFE38"||c==="\uFE44"||c==="\uFE42"||c==="\uFE3E"||c==="\uFE3C"||c==="\uFE3A"||c==="\uFE18"||c==="\uFE40"||c==="\uFE10"||c==="\uFE13"||c==="\uFE14"||c==="\uFF40"||c==="\uFFE3"||c==="\uFE11"||c==="\uFE12"}function tV(c){return c==="\uFE35"||c==="\uFE47"||c==="\uFE37"||c==="\uFE43"||c==="\uFE41"||c==="\uFE3D"||c==="\uFE3B"||c==="\uFE39"||c==="\uFE17"||c==="\uFE3F"}var cA,Fw,uA,Nw={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function rV(){return cA||(cA=1,Nw.read=function(c,i,o,u,p){var h,m,b=8*p-u-1,S=(1<<b)-1,A=S>>1,y=-7,w=o?p-1:0,P=o?-1:1,E=c[i+w];for(w+=P,h=E&(1<<-y)-1,E>>=-y,y+=b;y>0;h=256*h+c[i+w],w+=P,y-=8);for(m=h&(1<<-y)-1,h>>=-y,y+=u;y>0;m=256*m+c[i+w],w+=P,y-=8);if(h===0)h=1-A;else{if(h===S)return m?NaN:1/0*(E?-1:1);m+=Math.pow(2,u),h-=A}return(E?-1:1)*m*Math.pow(2,h-u)},Nw.write=function(c,i,o,u,p,h){var m,b,S,A=8*h-p-1,y=(1<<A)-1,w=y>>1,P=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=u?0:h-1,O=u?1:-1,M=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(b=isNaN(i)?1:0,m=y):(m=Math.floor(Math.log(i)/Math.LN2),i*(S=Math.pow(2,-m))<1&&(m--,S*=2),(i+=m+w>=1?P/S:P*Math.pow(2,1-w))*S>=2&&(m++,S/=2),m+w>=y?(b=0,m=y):m+w>=1?(b=(i*S-1)*Math.pow(2,p),m+=w):(b=i*Math.pow(2,w-1)*Math.pow(2,p),m=0));p>=8;c[o+E]=255&b,E+=O,b/=256,p-=8);for(m=m<<p|b,A+=p;A>0;c[o+E]=255&m,E+=O,m/=256,A-=8);c[o+E-O]|=128*M}),Nw}function hA(){if(uA)return Fw;uA=1,Fw=i;var c=rV();function i(F){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(F)?F:new Uint8Array(F||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,u=1/o,p=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(F){return F.type===i.Bytes?F.readVarint()+F.pos:F.pos+1}function m(F,q,W){return W?4294967296*q+(F>>>0):4294967296*(q>>>0)+(F>>>0)}function b(F,q,W){var te=q<=16383?1:q<=2097151?2:q<=268435455?3:Math.floor(Math.log(q)/(7*Math.LN2));W.realloc(te);for(var se=W.pos-1;se>=F;se--)W.buf[se+te]=W.buf[se]}function S(F,q){for(var W=0;W<F.length;W++)q.writeVarint(F[W])}function A(F,q){for(var W=0;W<F.length;W++)q.writeSVarint(F[W])}function y(F,q){for(var W=0;W<F.length;W++)q.writeFloat(F[W])}function w(F,q){for(var W=0;W<F.length;W++)q.writeDouble(F[W])}function P(F,q){for(var W=0;W<F.length;W++)q.writeBoolean(F[W])}function E(F,q){for(var W=0;W<F.length;W++)q.writeFixed32(F[W])}function O(F,q){for(var W=0;W<F.length;W++)q.writeSFixed32(F[W])}function M(F,q){for(var W=0;W<F.length;W++)q.writeFixed64(F[W])}function R(F,q){for(var W=0;W<F.length;W++)q.writeSFixed64(F[W])}function z(F,q){return(F[q]|F[q+1]<<8|F[q+2]<<16)+16777216*F[q+3]}function V(F,q,W){F[W]=q,F[W+1]=q>>>8,F[W+2]=q>>>16,F[W+3]=q>>>24}function G(F,q){return(F[q]|F[q+1]<<8|F[q+2]<<16)+(F[q+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(F,q,W){for(W=W||this.length;this.pos<W;){var te=this.readVarint(),se=te>>3,le=this.pos;this.type=7&te,F(se,q,this),this.pos===le&&this.skip(te)}return q},readMessage:function(F,q){return this.readFields(F,q,this.readVarint()+this.pos)},readFixed32:function(){var F=z(this.buf,this.pos);return this.pos+=4,F},readSFixed32:function(){var F=G(this.buf,this.pos);return this.pos+=4,F},readFixed64:function(){var F=z(this.buf,this.pos)+z(this.buf,this.pos+4)*o;return this.pos+=8,F},readSFixed64:function(){var F=z(this.buf,this.pos)+G(this.buf,this.pos+4)*o;return this.pos+=8,F},readFloat:function(){var F=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,F},readDouble:function(){var F=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,F},readVarint:function(F){var q,W,te=this.buf;return q=127&(W=te[this.pos++]),W<128?q:(q|=(127&(W=te[this.pos++]))<<7,W<128?q:(q|=(127&(W=te[this.pos++]))<<14,W<128?q:(q|=(127&(W=te[this.pos++]))<<21,W<128?q:function(se,le,ne){var me,he,_e=ne.buf;if(me=(112&(he=_e[ne.pos++]))>>4,he<128||(me|=(127&(he=_e[ne.pos++]))<<3,he<128)||(me|=(127&(he=_e[ne.pos++]))<<10,he<128)||(me|=(127&(he=_e[ne.pos++]))<<17,he<128)||(me|=(127&(he=_e[ne.pos++]))<<24,he<128)||(me|=(1&(he=_e[ne.pos++]))<<31,he<128))return m(se,me,le);throw new Error("Expected varint not more than 10 bytes")}(q|=(15&(W=te[this.pos]))<<28,F,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var F=this.readVarint();return F%2==1?(F+1)/-2:F/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var F=this.readVarint()+this.pos,q=this.pos;return this.pos=F,F-q>=12&&p?function(W,te,se){return p.decode(W.subarray(te,se))}(this.buf,q,F):function(W,te,se){for(var le="",ne=te;ne<se;){var me,he,_e,Ae=W[ne],Me=null,Re=Ae>239?4:Ae>223?3:Ae>191?2:1;if(ne+Re>se)break;Re===1?Ae<128&&(Me=Ae):Re===2?(192&(me=W[ne+1]))==128&&(Me=(31&Ae)<<6|63&me)<=127&&(Me=null):Re===3?(he=W[ne+2],(192&(me=W[ne+1]))==128&&(192&he)==128&&((Me=(15&Ae)<<12|(63&me)<<6|63&he)<=2047||Me>=55296&&Me<=57343)&&(Me=null)):Re===4&&(he=W[ne+2],_e=W[ne+3],(192&(me=W[ne+1]))==128&&(192&he)==128&&(192&_e)==128&&((Me=(15&Ae)<<18|(63&me)<<12|(63&he)<<6|63&_e)<=65535||Me>=1114112)&&(Me=null)),Me===null?(Me=65533,Re=1):Me>65535&&(Me-=65536,le+=String.fromCharCode(Me>>>10&1023|55296),Me=56320|1023&Me),le+=String.fromCharCode(Me),ne+=Re}return le}(this.buf,q,F)},readBytes:function(){var F=this.readVarint()+this.pos,q=this.buf.subarray(this.pos,F);return this.pos=F,q},readPackedVarint:function(F,q){if(this.type!==i.Bytes)return F.push(this.readVarint(q));var W=h(this);for(F=F||[];this.pos<W;)F.push(this.readVarint(q));return F},readPackedSVarint:function(F){if(this.type!==i.Bytes)return F.push(this.readSVarint());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readSVarint());return F},readPackedBoolean:function(F){if(this.type!==i.Bytes)return F.push(this.readBoolean());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readBoolean());return F},readPackedFloat:function(F){if(this.type!==i.Bytes)return F.push(this.readFloat());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readFloat());return F},readPackedDouble:function(F){if(this.type!==i.Bytes)return F.push(this.readDouble());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readDouble());return F},readPackedFixed32:function(F){if(this.type!==i.Bytes)return F.push(this.readFixed32());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readFixed32());return F},readPackedSFixed32:function(F){if(this.type!==i.Bytes)return F.push(this.readSFixed32());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readSFixed32());return F},readPackedFixed64:function(F){if(this.type!==i.Bytes)return F.push(this.readFixed64());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readFixed64());return F},readPackedSFixed64:function(F){if(this.type!==i.Bytes)return F.push(this.readSFixed64());var q=h(this);for(F=F||[];this.pos<q;)F.push(this.readSFixed64());return F},skip:function(F){var q=7&F;if(q===i.Varint)for(;this.buf[this.pos++]>127;);else if(q===i.Bytes)this.pos=this.readVarint()+this.pos;else if(q===i.Fixed32)this.pos+=4;else{if(q!==i.Fixed64)throw new Error("Unimplemented type: "+q);this.pos+=8}},writeTag:function(F,q){this.writeVarint(F<<3|q)},realloc:function(F){for(var q=this.length||16;q<this.pos+F;)q*=2;if(q!==this.length){var W=new Uint8Array(q);W.set(this.buf),this.buf=W,this.length=q}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(F){this.realloc(4),V(this.buf,F,this.pos),this.pos+=4},writeSFixed32:function(F){this.realloc(4),V(this.buf,F,this.pos),this.pos+=4},writeFixed64:function(F){this.realloc(8),V(this.buf,-1&F,this.pos),V(this.buf,Math.floor(F*u),this.pos+4),this.pos+=8},writeSFixed64:function(F){this.realloc(8),V(this.buf,-1&F,this.pos),V(this.buf,Math.floor(F*u),this.pos+4),this.pos+=8},writeVarint:function(F){(F=+F||0)>268435455||F<0?function(q,W){var te,se;if(q>=0?(te=q%4294967296|0,se=q/4294967296|0):(se=~(-q/4294967296),4294967295^(te=~(-q%4294967296))?te=te+1|0:(te=0,se=se+1|0)),q>=18446744073709552e3||q<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");W.realloc(10),function(le,ne,me){me.buf[me.pos++]=127&le|128,le>>>=7,me.buf[me.pos++]=127&le|128,le>>>=7,me.buf[me.pos++]=127&le|128,le>>>=7,me.buf[me.pos++]=127&le|128,me.buf[me.pos]=127&(le>>>=7)}(te,0,W),function(le,ne){var me=(7&le)<<4;ne.buf[ne.pos++]|=me|((le>>>=3)?128:0),le&&(ne.buf[ne.pos++]=127&le|((le>>>=7)?128:0),le&&(ne.buf[ne.pos++]=127&le|((le>>>=7)?128:0),le&&(ne.buf[ne.pos++]=127&le|((le>>>=7)?128:0),le&&(ne.buf[ne.pos++]=127&le|((le>>>=7)?128:0),le&&(ne.buf[ne.pos++]=127&le)))))}(se,W)}(F,this):(this.realloc(4),this.buf[this.pos++]=127&F|(F>127?128:0),F<=127||(this.buf[this.pos++]=127&(F>>>=7)|(F>127?128:0),F<=127||(this.buf[this.pos++]=127&(F>>>=7)|(F>127?128:0),F<=127||(this.buf[this.pos++]=F>>>7&127))))},writeSVarint:function(F){this.writeVarint(F<0?2*-F-1:2*F)},writeBoolean:function(F){this.writeVarint(Boolean(F))},writeString:function(F){F=String(F),this.realloc(4*F.length),this.pos++;var q=this.pos;this.pos=function(te,se,le){for(var ne,me,he=0;he<se.length;he++){if((ne=se.charCodeAt(he))>55295&&ne<57344){if(!me){ne>56319||he+1===se.length?(te[le++]=239,te[le++]=191,te[le++]=189):me=ne;continue}if(ne<56320){te[le++]=239,te[le++]=191,te[le++]=189,me=ne;continue}ne=me-55296<<10|ne-56320|65536,me=null}else me&&(te[le++]=239,te[le++]=191,te[le++]=189,me=null);ne<128?te[le++]=ne:(ne<2048?te[le++]=ne>>6|192:(ne<65536?te[le++]=ne>>12|224:(te[le++]=ne>>18|240,te[le++]=ne>>12&63|128),te[le++]=ne>>6&63|128),te[le++]=63&ne|128)}return le}(this.buf,F,this.pos);var W=this.pos-q;W>=128&&b(q,W,this),this.pos=q-1,this.writeVarint(W),this.pos+=W},writeFloat:function(F){this.realloc(4),c.write(this.buf,F,this.pos,!0,23,4),this.pos+=4},writeDouble:function(F){this.realloc(8),c.write(this.buf,F,this.pos,!0,52,8),this.pos+=8},writeBytes:function(F){var q=F.length;this.writeVarint(q),this.realloc(q);for(var W=0;W<q;W++)this.buf[this.pos++]=F[W]},writeRawMessage:function(F,q){this.pos++;var W=this.pos;F(q,this);var te=this.pos-W;te>=128&&b(W,te,this),this.pos=W-1,this.writeVarint(te),this.pos+=te},writeMessage:function(F,q,W){this.writeTag(F,i.Bytes),this.writeRawMessage(q,W)},writePackedVarint:function(F,q){q.length&&this.writeMessage(F,S,q)},writePackedSVarint:function(F,q){q.length&&this.writeMessage(F,A,q)},writePackedBoolean:function(F,q){q.length&&this.writeMessage(F,P,q)},writePackedFloat:function(F,q){q.length&&this.writeMessage(F,y,q)},writePackedDouble:function(F,q){q.length&&this.writeMessage(F,w,q)},writePackedFixed32:function(F,q){q.length&&this.writeMessage(F,E,q)},writePackedSFixed32:function(F,q){q.length&&this.writeMessage(F,O,q)},writePackedFixed64:function(F,q){q.length&&this.writeMessage(F,M,q)},writePackedSFixed64:function(F,q){q.length&&this.writeMessage(F,R,q)},writeBytesField:function(F,q){this.writeTag(F,i.Bytes),this.writeBytes(q)},writeFixed32Field:function(F,q){this.writeTag(F,i.Fixed32),this.writeFixed32(q)},writeSFixed32Field:function(F,q){this.writeTag(F,i.Fixed32),this.writeSFixed32(q)},writeFixed64Field:function(F,q){this.writeTag(F,i.Fixed64),this.writeFixed64(q)},writeSFixed64Field:function(F,q){this.writeTag(F,i.Fixed64),this.writeSFixed64(q)},writeVarintField:function(F,q){this.writeTag(F,i.Varint),this.writeVarint(q)},writeSVarintField:function(F,q){this.writeTag(F,i.Varint),this.writeSVarint(q)},writeStringField:function(F,q){this.writeTag(F,i.Bytes),this.writeString(q)},writeFloatField:function(F,q){this.writeTag(F,i.Fixed32),this.writeFloat(q)},writeDoubleField:function(F,q){this.writeTag(F,i.Fixed64),this.writeDouble(q)},writeBooleanField:function(F,q){this.writeVarintField(F,Boolean(q))}},Fw}var eb=N(hA());const $w=3;function iV(c,i,o){i.glyphs=[],c===1&&o.readMessage(nV,i)}function nV(c,i,o){if(c===3){const{id:u,bitmap:p,width:h,height:m,left:b,top:S,advance:A}=o.readMessage(oV,{});i.glyphs.push({id:u,bitmap:new Ou({width:h+2*$w,height:m+2*$w},p),metrics:{width:h,height:m,left:b,top:S,advance:A}})}else c===4?i.ascender=o.readSVarint():c===5&&(i.descender=o.readSVarint())}function oV(c,i,o){c===1?i.id=o.readVarint():c===2?i.bitmap=o.readBytes():c===3?i.width=o.readVarint():c===4?i.height=o.readVarint():c===5?i.left=o.readSVarint():c===6?i.top=o.readSVarint():c===7&&(i.advance=o.readVarint())}const dA=$w,Ws={horizontal:1,vertical:2,horizontalOnly:3};class Ig{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,o){const u=new Ig;return u.scale=i||1,u.fontStack=o,u}static forImage(i){const o=new Ig;return o.imageName=i,o}}class ip{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,o){const u=new ip;for(let p=0;p<i.sections.length;p++){const h=i.sections[p];h.image?u.addImageSection(h):u.addTextSection(h,o)}return u}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(o,u){let p="";for(let h=0;h<o.length;h++){const m=o.charCodeAt(h+1)||null,b=o.charCodeAt(h-1)||null;p+=!u&&(m&&kh(m)&&!Mg[o[h+1]]||b&&kh(b)&&!Mg[o[h-1]])||!Mg[o[h]]?o[h]:Mg[o[h]]}return p}(this.text,i)}trim(){let i=0;for(let u=0;u<this.text.length&&tb[this.text.charCodeAt(u)];u++)i++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=i&&tb[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(i,o),this.sectionIndex=this.sectionIndex.slice(i,o)}substring(i,o){const u=new ip;return u.text=this.text.substring(i,o),u.sectionIndex=this.sectionIndex.slice(i,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,o)=>Math.max(i,this.sections[o].scale),0)}addTextSection(i,o){this.text+=i.text,this.sections.push(Ig.forText(i.scale,i.fontStack||o));const u=this.sections.length-1;for(let p=0;p<i.text.length;++p)this.sectionIndex.push(u)}addImageSection(i){const o=i.image?i.image.namePrimary:"";if(o.length===0)return void Jr("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(Ig.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Jr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function jw(c,i,o,u,p,h,m,b,S,A,y,w,P,E,O){const M=ip.fromFeature(c,p);w===Ws.vertical&&M.verticalizePunctuation(P);let R=[];const z=function(W,te,se,le,ne,me){if(!W)return[];const he=[],_e=function(Be,Ge,Fe,tt,ut,Xe){let Lt=0;for(let Pt=0;Pt<Be.length();Pt++){const bt=Be.getSection(Pt);Lt+=fA(Be.getCodePoint(Pt),bt,tt,ut,Ge,Xe)}return Lt/Math.max(1,Math.ceil(Lt/Fe))}(W,te,se,le,ne,me),Ae=W.text.indexOf("\u200B")>=0;let Me=0;for(let Be=0;Be<W.length();Be++){const Ge=W.getSection(Be),Fe=W.getCodePoint(Be);if(tb[Fe]||(Me+=fA(Fe,Ge,le,ne,te,me)),Be<W.length()-1){const tt=!((Re=Fe)<11904||!(Wt["Bopomofo Extended"](Re)||Wt.Bopomofo(Re)||Wt["CJK Compatibility Forms"](Re)||Wt["CJK Compatibility Ideographs"](Re)||Wt["CJK Compatibility"](Re)||Wt["CJK Radicals Supplement"](Re)||Wt["CJK Strokes"](Re)||Wt["CJK Symbols and Punctuation"](Re)||Wt["CJK Unified Ideographs Extension A"](Re)||Wt["CJK Unified Ideographs"](Re)||Wt["Enclosed CJK Letters and Months"](Re)||Wt["Halfwidth and Fullwidth Forms"](Re)||Wt.Hiragana(Re)||Wt["Ideographic Description Characters"](Re)||Wt["Kangxi Radicals"](Re)||Wt["Katakana Phonetic Extensions"](Re)||Wt.Katakana(Re)||Wt["Vertical Forms"](Re)||Wt["Yi Radicals"](Re)||Wt["Yi Syllables"](Re)));(sV[Fe]||tt||Ge.imageName)&&he.push(mA(Be+1,Me,_e,he,aV(Fe,W.getCodePoint(Be+1),tt&&Ae),!1))}}var Re;return gA(mA(W.length(),Me,_e,he,0,!0))}(M,A,h,i,u,E),{processBidirectionalText:V,processStyledBidirectionalText:G}=No;if(V&&M.sections.length===1){const W=V(M.toString(),z);for(const te of W){const se=new ip;se.text=te,se.sections=M.sections;for(let le=0;le<te.length;le++)se.sectionIndex.push(0);R.push(se)}}else if(G){const W=G(M.text,M.sectionIndex,z);for(const te of W){const se=new ip;se.text=te[0],se.sectionIndex=te[1],se.sections=M.sections,R.push(se)}}else R=function(W,te){const se=[],le=W.text;let ne=0;for(const me of te)se.push(W.substring(ne,me)),ne=me;return ne<le.length&&se.push(W.substring(ne,le.length)),se}(M,z);const F=[],q={positionedLines:F,text:M.toString(),top:y[1],bottom:y[1],left:y[0],right:y[0],writingMode:w,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(W,te,se,le,ne,me,he,_e,Ae,Me,Re,Be){let Ge=0,Fe=0,tt=0;const ut=_e==="right"?1:_e==="left"?0:.5;let Xe=!1;for(const Rt of ne){const $t=Rt.getSections();for(const cr of $t){if(cr.imageName)continue;const Cr=te[cr.fontStack];if(Cr&&(Xe=Cr.ascender!==void 0&&Cr.descender!==void 0,!Xe))break}if(!Xe)break}let Lt=0;for(const Rt of ne){Rt.trim();const $t=Rt.getMaxScale(),cr=($t-1)*io,Cr={positionedGlyphs:[],lineOffset:0};W.positionedLines[Lt]=Cr;const Tr=Cr.positionedGlyphs;let Er=0;if(!Rt.length()){Fe+=me,++Lt;continue}let Rr=0,Br=0;for(let ui=0;ui<Rt.length();ui++){const hr=Rt.getSection(ui),ni=Rt.getSectionIndex(ui),si=Rt.getCodePoint(ui);let Fi=hr.scale,un=null,wn=null,hn=null,Qi=io,Un=0;const Pn=!(Ae===Ws.horizontal||!Re&&!kf(si)||Re&&(tb[si]||(Pt=si,Wt.Arabic(Pt)||Wt["Arabic Supplement"](Pt)||Wt["Arabic Extended-A"](Pt)||Wt["Arabic Presentation Forms-A"](Pt)||Wt["Arabic Presentation Forms-B"](Pt))));if(hr.imageName){const no=le[hr.imageName];if(!no)continue;hn=hr.imageName,W.iconsInText=W.iconsInText||!0,wn=no.paddedRect;const Ri=no.displaySize;Fi=Fi*io/Be,un={width:Ri[0],height:Ri[1],left:0,top:-dA,advance:Pn?Ri[1]:Ri[0],localGlyph:!1},Un=Xe?-un.height*Fi:$t*io-17-Ri[1]*Fi,Qi=un.advance;const ts=(Pn?Ri[0]:Ri[1])*Fi-io*$t;ts>0&&ts>Er&&(Er=ts)}else{const no=se[hr.fontStack];if(!no)continue;no[si]&&(wn=no[si]);const Ri=te[hr.fontStack];if(!Ri)continue;const ts=Ri.glyphs[si];if(!ts)continue;if(un=ts.metrics,Qi=si!==8203?io:0,Xe){const Ya=Ri.ascender!==void 0?Math.abs(Ri.ascender):0,Ta=Ri.descender!==void 0?Math.abs(Ri.descender):0,Ea=(Ya+Ta)*Fi;Rr<Ea&&(Rr=Ea,Br=(Ya-Ta)/2*Fi),Un=-Ya*Fi}else Un=($t-Fi)*io-17}Pn?(W.verticalizable=!0,Tr.push({glyph:si,imageName:hn,x:Ge,y:Fe+Un,vertical:Pn,scale:Fi,localGlyph:un.localGlyph,fontStack:hr.fontStack,sectionIndex:ni,metrics:un,rect:wn}),Ge+=Qi*Fi+Me):(Tr.push({glyph:si,imageName:hn,x:Ge,y:Fe+Un,vertical:Pn,scale:Fi,localGlyph:un.localGlyph,fontStack:hr.fontStack,sectionIndex:ni,metrics:un,rect:wn}),Ge+=un.advance*Fi+Me)}Tr.length!==0&&(tt=Math.max(Ge-Me,tt),Xe?_A(Tr,ut,Er,Br,me*$t/2):_A(Tr,ut,Er,0,me/2)),Ge=0;const Ti=me*$t+Er;Cr.lineOffset=Math.max(Er,cr),Fe+=Ti,++Lt}var Pt;const bt=Fe,{horizontalAlign:mt,verticalAlign:Yt}=Vw(he);(function(Rt,$t,cr,Cr,Tr,Er){const Rr=($t-cr)*Tr,Br=-Er*Cr;for(const Ti of Rt)for(const ui of Ti.positionedGlyphs)ui.x+=Rr,ui.y+=Br})(W.positionedLines,ut,mt,Yt,tt,bt),W.top+=-Yt*bt,W.bottom=W.top+bt,W.left+=-mt*tt,W.right=W.left+tt,W.hasBaseline=Xe}(q,i,o,u,R,m,b,S,w,A,P,O),!function(W){for(const te of W)if(te.positionedGlyphs.length!==0)return!1;return!0}(F)&&q}const tb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},sV={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function fA(c,i,o,u,p,h){if(i.imageName){const m=u[i.imageName];return m?m.displaySize[0]*i.scale*io/h+p:0}{const m=o[i.fontStack],b=m&&m.glyphs[c];return b?b.metrics.advance*i.scale+p:0}}function pA(c,i,o,u){const p=Math.pow(c-i,2);return u?c<i?p/2:2*p:p+Math.abs(o)*o}function aV(c,i,o){let u=0;return c===10&&(u-=1e4),o&&(u+=150),c!==40&&c!==65288||(u+=50),i!==41&&i!==65289||(u+=50),u}function mA(c,i,o,u,p,h){let m=null,b=pA(i,o,p,h);for(const S of u){const A=pA(i-S.x,o,p,h)+S.badness;A<=b&&(m=S,b=A)}return{index:c,x:i,priorBreak:m,badness:b}}function gA(c){return c?gA(c.priorBreak).concat(c.index):[]}function Vw(c){let i=.5,o=.5;switch(c){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:i,verticalAlign:o}}function _A(c,i,o,u,p){if(!(i||o||u||p))return;const h=c.length-1,m=c[h],b=(m.x+m.metrics.advance*m.scale)*i;for(let S=0;S<=h;S++)c[S].x-=b,c[S].y+=o+u+p}function lV(c,i,o,u){const{horizontalAlign:p,verticalAlign:h}=Vw(u),m=o[0]-c.displaySize[0]*p,b=o[1]-c.displaySize[1]*h;return{imagePrimary:c,imageSecondary:i,top:b,bottom:b+c.displaySize[1],left:m,right:m+c.displaySize[0]}}function yA(c,i,o,u,p,h){const m=c.imagePrimary;let b;if(m.content){const R=m.content,z=m.pixelRatio||1;b=[R[0]/z,R[1]/z,m.displaySize[0]-R[2]/z,m.displaySize[1]-R[3]/z]}const S=i.left*h,A=i.right*h;let y,w,P,E;o==="width"||o==="both"?(E=p[0]+S-u[3],w=p[0]+A+u[1]):(E=p[0]+(S+A-m.displaySize[0])/2,w=E+m.displaySize[0]);const O=i.top*h,M=i.bottom*h;return o==="height"||o==="both"?(y=p[1]+O-u[0],P=p[1]+M+u[2]):(y=p[1]+(O+M-m.displaySize[1])/2,P=y+m.displaySize[1]),{imagePrimary:m,imageSecondary:void 0,top:y,right:w,bottom:P,left:E,collisionPadding:b}}class fc extends ze{constructor(i,o,u,p,h){super(i,o),this.angle=p,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new fc(this.x,this.y,this.z,this.angle,this.segment)}}function vA(c,i,o,u,p){if(i.segment===void 0)return!0;let h=i,m=i.segment+1,b=0;for(;b>-o/2;){if(m--,m<0)return!1;b-=c[m].dist(h),h=c[m]}b+=c[m].dist(c[m+1]),m++;const S=[];let A=0;for(;b<o/2;){const y=c[m],w=c[m+1];if(!w)return!1;let P=c[m-1].angleTo(y)-y.angleTo(w);for(P=Math.abs((P+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:P}),A+=P;b-S[0].distance>u;)A-=S.shift().angleDelta;if(A>p)return!1;m++,b+=y.dist(w)}return!0}function bA(c){let i=0;for(let o=0;o<c.length-1;o++)i+=c[o].dist(c[o+1]);return i}function xA(c,i,o){return c?.6*i*o:0}function wA(c,i){return Math.max(c?c.right-c.left:0,i?i.right-i.left:0)}function cV(c,i,o,u,p,h){const m=xA(o,p,h),b=wA(o,u)*h;let S=0;const A=bA(c)/2;for(let y=0;y<c.length-1;y++){const w=c[y],P=c[y+1],E=w.dist(P);if(S+E>A){const O=(A-S)/E,M=nr(w.x,P.x,O),R=nr(w.y,P.y,O),z=new fc(M,R,0,P.angleTo(w),y);return!m||vA(c,z,b,m,i)?z:void 0}S+=E}}function uV(c,i,o,u,p,h,m,b,S){const A=xA(u,h,m),y=wA(u,p),w=y*m,P=c[0].x===0||c[0].x===S||c[0].y===0||c[0].y===S;return i-w<i/4&&(i=w+i/4),TA(c,P?i/2*b%i:(y/2+2*h)*m*b%i,i,A,o,w,P,!1,S)}function TA(c,i,o,u,p,h,m,b,S){const A=h/2,y=bA(c);let w=0,P=i-o,E=[];for(let O=0;O<c.length-1;O++){const M=c[O],R=c[O+1],z=M.dist(R),V=R.angleTo(M);for(;P+o<w+z;){P+=o;const G=(P-w)/z,F=nr(M.x,R.x,G),q=nr(M.y,R.y,G);if(F>=0&&F<S&&q>=0&&q<S&&P-A>=0&&P+A<=y){const W=new fc(F,q,0,V,O);u&&!vA(c,W,h,u,p)||E.push(W)}}w+=z}return b||E.length||m||(E=TA(c,w/2,o,u,p,h,m,!0,S)),E}function EA(c,i,o,u,p){const h=[];for(let m=0;m<c.length;m++){const b=c[m];let S;for(let A=0;A<b.length-1;A++){let y=b[A],w=b[A+1];y.x<i&&w.x<i||(y.x<i?y=new ze(i,y.y+(i-y.x)/(w.x-y.x)*(w.y-y.y))._round():w.x<i&&(w=new ze(i,y.y+(i-y.x)/(w.x-y.x)*(w.y-y.y))._round()),y.y<o&&w.y<o||(y.y<o?y=new ze(y.x+(o-y.y)/(w.y-y.y)*(w.x-y.x),o)._round():w.y<o&&(w=new ze(y.x+(o-y.y)/(w.y-y.y)*(w.x-y.x),o)._round()),y.x>=u&&w.x>=u||(y.x>=u?y=new ze(u,y.y+(u-y.x)/(w.x-y.x)*(w.y-y.y))._round():w.x>=u&&(w=new ze(u,y.y+(u-y.x)/(w.x-y.x)*(w.y-y.y))._round()),y.y>=p&&w.y>=p||(y.y>=p?y=new ze(y.x+(p-y.y)/(w.y-y.y)*(w.x-y.x),p)._round():w.y>=p&&(w=new ze(y.x+(p-y.y)/(w.y-y.y)*(w.x-y.x),p)._round()),S&&y.equals(S[S.length-1])||(S=[y],h.push(S)),S.push(w)))))}}return h}function SA(c){let i=0,o=0;for(const m of c)i+=m.w*m.h,o=Math.max(o,m.w);c.sort((m,b)=>b.h-m.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),o),h:1/0}];let p=0,h=0;for(const m of c)for(let b=u.length-1;b>=0;b--){const S=u[b];if(!(m.w>S.w||m.h>S.h)){if(m.x=S.x,m.y=S.y,h=Math.max(h,m.y+m.h),p=Math.max(p,m.x+m.w),m.w===S.w&&m.h===S.h){const A=u.pop();b<u.length&&(u[b]=A)}else m.h===S.h?(S.x+=m.w,S.w-=m.w):m.w===S.w?(S.y+=m.h,S.h-=m.h):(u.push({x:S.x+m.w,y:S.y,w:S.w-m.w,h:m.h}),S.y+=m.h,S.h-=m.h);break}}return{w:p,h,fill:i/(p*h)||0}}jt(fc,"Anchor");const Dg=1;class Uw{constructor(i,{pixelRatio:o,version:u,stretchX:p,stretchY:h,content:m},b){this.paddedRect=i,this.pixelRatio=o,this.stretchX=p,this.stretchY=h,this.content=m,this.version=u,this.padding=b}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class OA{constructor(i,o,u){const p={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(i,p,Dg,m),this.addImages(o,h,2,m);const{w:b,h:S}=SA(m),A=new Ao({width:b||1,height:S||1});for(const y in i){const w=i[y],P=p[y].paddedRect;Ao.copy(w.data,A,{x:0,y:0},{x:P.x+Dg,y:P.y+Dg},w.data,u,w.sdf)}for(const y in o){const w=o[y],P=h[y].paddedRect;let E=h[y].padding;const O=P.x+E,M=P.y+E,R=w.data.width,z=w.data.height;E=E>1?E-1:E,Ao.copy(w.data,A,{x:0,y:0},{x:O,y:M},w.data,u),Ao.copy(w.data,A,{x:0,y:z-E},{x:O,y:M-E},{width:R,height:E},u),Ao.copy(w.data,A,{x:0,y:0},{x:O,y:M+z},{width:R,height:E},u),Ao.copy(w.data,A,{x:R-E,y:0},{x:O-E,y:M},{width:E,height:z},u),Ao.copy(w.data,A,{x:0,y:0},{x:O+R,y:M},{width:E,height:z},u),Ao.copy(w.data,A,{x:R-E,y:z-E},{x:O-E,y:M-E},{width:E,height:E},u),Ao.copy(w.data,A,{x:0,y:z-E},{x:O+R,y:M-E},{width:E,height:E},u),Ao.copy(w.data,A,{x:0,y:0},{x:O+R,y:M+z},{width:E,height:E},u),Ao.copy(w.data,A,{x:R-E,y:0},{x:O-E,y:M+z},{width:E,height:E},u)}this.image=A,this.iconPositions=p,this.patternPositions=h}addImages(i,o,u,p){for(const h in i){const m=i[h],b={x:0,y:0,w:m.data.width+2*u,h:m.data.height+2*u};p.push(b),o[h]=new Uw(b,m,u),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(i,o,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>i.hasImage(p,u)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const p in i.getUpdatedImages(u))this.patchUpdatedImage(this.iconPositions[p],i.getImage(p,u),o),this.patchUpdatedImage(this.patternPositions[p],i.getImage(p,u),o)}patchUpdatedImage(i,o,u){if(!i||!o||i.version===o.version)return;i.version=o.version;const[p,h]=i.tl;u.update(o.data,{position:{x:p,y:h}})}}jt(Uw,"ImagePosition"),jt(OA,"ImageAtlas");const Rg=1e20;function PA(c,i,o,u,p,h,m,b,S){for(let A=i;A<i+u;A++)AA(c,o*h+A,h,p,m,b,S);for(let A=o;A<o+p;A++)AA(c,A*h+i,1,u,m,b,S)}function AA(c,i,o,u,p,h,m){h[0]=0,m[0]=-Rg,m[1]=Rg,p[0]=c[i];for(let b=1,S=0,A=0;b<u;b++){p[b]=c[i+b*o];const y=b*b;do{const w=h[S];A=(p[b]-p[w]+y-w*w)/(b-w)/2}while(A<=m[S]&&--S>-1);S++,h[S]=b,m[S]=A,m[S+1]=Rg}for(let b=0,S=0;b<u;b++){for(;m[S+1]<b;)S++;const A=h[S],y=b-A;c[i+b*o]=p[A]+y*y}}const Wa=2,Gw={none:0,ideographs:1,all:2};class np{constructor(i,o,u){this.requestManager=i,this.localGlyphMode=o,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,o){this.urls[o]=i}getGlyphs(i,o,u){const p=[],h=this.urls[o]||Se.GLYPHS_URL;for(const m in i)for(const b of i[m])p.push({stack:m,id:b});Oi(p,({stack:m,id:b},S)=>{let A=this.entries[m];A||(A=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let y=A.glyphs[b];if(y!==void 0)return void S(null,{stack:m,id:b,glyph:y});if(y=this._tinySDF(A,m,b),y)return A.glyphs[b]=y,void S(null,{stack:m,id:b,glyph:y});const w=Math.floor(b/256);if(256*w>65535)return void S(new Error("glyphs > 65535 not supported"));if(A.ranges[w])return void S(null,{stack:m,id:b,glyph:y});let P=A.requests[w];P||(P=A.requests[w]=[],np.loadGlyphRange(m,w,h,this.requestManager,(E,O)=>{if(O){A.ascender=O.ascender,A.descender=O.descender;for(const M in O.glyphs)this._doesCharSupportLocalGlyph(+M)||(A.glyphs[+M]=O.glyphs[+M]);A.ranges[w]=!0}for(const M of P)M(E,O);delete A.requests[w]})),P.push((E,O)=>{E?S(E):O&&S(null,{stack:m,id:b,glyph:O.glyphs[b]||null})})},(m,b)=>{if(m)u(m);else if(b){const S={};for(const{stack:A,id:y,glyph:w}of b)S[A]===void 0&&(S[A]={}),S[A].glyphs===void 0&&(S[A].glyphs={}),S[A].glyphs[y]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics},S[A].ascender=this.entries[A].ascender,S[A].descender=this.entries[A].descender;u(null,S)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==Gw.none&&(this.localGlyphMode===Gw.all?!!this.localFontFamily:!!this.localFontFamily&&(Wt["CJK Unified Ideographs"](i)||Wt["Hangul Syllables"](i)||Wt.Hiragana(i)||Wt.Katakana(i)||Wt["CJK Symbols and Punctuation"](i)||Wt["CJK Unified Ideographs Extension A"](i)||Wt["CJK Unified Ideographs Extension B"](i)))}_tinySDF(i,o,u){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let h=i.tinySDF;if(!h){let M="400";/bold/i.test(o)?M="900":/medium/i.test(o)?M="500":/light/i.test(o)&&(M="200"),h=i.tinySDF=new np.TinySDF({fontFamily:p,fontWeight:M,fontSize:24*Wa,buffer:3*Wa,radius:8*Wa}),h.fontWeight=M}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const m=String.fromCodePoint(u),{data:b,width:S,height:A,glyphWidth:y,glyphHeight:w,glyphLeft:P,glyphTop:E,glyphAdvance:O}=h.draw(m);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new Ou({width:S,height:A},b),metrics:{width:y/Wa,height:w/Wa,left:P/Wa,top:E/Wa-27,advance:O/Wa,localGlyph:!0}}}}np.loadGlyphRange=function(c,i,o,u,p){const h=256*i,m=h+255,b=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",c).replace("{range}",`${h}-${m}`),Vc.Glyphs);Uc(b,(S,A)=>{if(S)p(S);else if(A){const y={},w=function(P){return new eb(P).readFields(iV,{})}(A);for(const P of w.glyphs)y[P.id]=P;p(null,{glyphs:y,ascender:w.ascender,descender:w.descender})}})},np.TinySDF=class{constructor({fontSize:c=24,buffer:i=3,radius:o=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:h="normal",fontStyle:m="normal"}={}){this.buffer=i,this.cutoff=u,this.radius=o;const b=this.size=c+4*i,S=this._createCanvas(b),A=this.ctx=S.getContext("2d",{willReadFrequently:!0});A.font=`${m} ${h} ${c}px ${p}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(c){const i=document.createElement("canvas");return i.width=i.height=c,i}draw(c){const{width:i,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:h}=this.ctx.measureText(c),m=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-p))),S=Math.min(this.size-this.buffer,m+Math.ceil(u)),A=b+2*this.buffer,y=S+2*this.buffer,w=Math.max(A*y,0),P=new Uint8ClampedArray(w),E={data:P,width:A,height:y,glyphWidth:b,glyphHeight:S,glyphTop:m,glyphLeft:0,glyphAdvance:i};if(b===0||S===0)return E;const{ctx:O,buffer:M,gridInner:R,gridOuter:z}=this;O.clearRect(M,M,b,S),O.fillText(c,M,M+m);const V=O.getImageData(M,M,b,S);z.fill(Rg,0,w),R.fill(0,0,w);for(let G=0;G<S;G++)for(let F=0;F<b;F++){const q=V.data[4*(G*b+F)+3]/255;if(q===0)continue;const W=(G+M)*A+F+M;if(q===1)z[W]=0,R[W]=Rg;else{const te=.5-q;z[W]=te>0?te*te:0,R[W]=te<0?te*te:0}}PA(z,0,0,A,y,A,this.f,this.v,this.z),PA(R,M,M,b,S,A,this.f,this.v,this.z);for(let G=0;G<w;G++){const F=Math.sqrt(z[G])-Math.sqrt(R[G]);P[G]=Math.round(255-255*(F/this.radius+this.cutoff))}return E}};const Au=Dg;function CA(c,i,o,u){const p=[],h=c.imagePrimary,m=h.pixelRatio,b=h.paddedRect.w-2*Au,S=h.paddedRect.h-2*Au,A=c.right-c.left,y=c.bottom-c.top,w=h.stretchX||[[0,b]],P=h.stretchY||[[0,S]],E=(me,he)=>me+he[1]-he[0],O=w.reduce(E,0),M=P.reduce(E,0),R=b-O,z=S-M;let V=0,G=O,F=0,q=M,W=0,te=R,se=0,le=z;if(h.content&&u){const me=h.content;V=rb(w,0,me[0]),F=rb(P,0,me[1]),G=rb(w,me[0],me[2]),q=rb(P,me[1],me[3]),W=me[0]-V,se=me[1]-F,te=me[2]-me[0]-G,le=me[3]-me[1]-q}const ne=(me,he,_e,Ae)=>{const Me=ib(me.stretch-V,G,A,c.left),Re=nb(me.fixed-W,te,me.stretch,O),Be=ib(he.stretch-F,q,y,c.top),Ge=nb(he.fixed-se,le,he.stretch,M),Fe=ib(_e.stretch-V,G,A,c.left),tt=nb(_e.fixed-W,te,_e.stretch,O),ut=ib(Ae.stretch-F,q,y,c.top),Xe=nb(Ae.fixed-se,le,Ae.stretch,M),Lt=new ze(Me,Be),Pt=new ze(Fe,Be),bt=new ze(Fe,ut),mt=new ze(Me,ut),Yt=new ze(Re/m,Ge/m),Rt=new ze(tt/m,Xe/m),$t=i*Math.PI/180;if($t){const Br=Math.sin($t),Ti=Math.cos($t),ui=[Ti,-Br,Br,Ti];Lt._matMult(ui),Pt._matMult(ui),mt._matMult(ui),bt._matMult(ui)}const cr=me.stretch+me.fixed,Cr=_e.stretch+_e.fixed,Tr=he.stretch+he.fixed,Er=Ae.stretch+Ae.fixed,Rr=c.imageSecondary;return{tl:Lt,tr:Pt,bl:mt,br:bt,texPrimary:{x:h.paddedRect.x+Au+cr,y:h.paddedRect.y+Au+Tr,w:Cr-cr,h:Er-Tr},texSecondary:Rr?{x:Rr.paddedRect.x+Au+cr,y:Rr.paddedRect.y+Au+Tr,w:Cr-cr,h:Er-Tr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yt,pixelOffsetBR:Rt,minFontScaleX:te/m/A,minFontScaleY:le/m/y,isSDF:o}};if(u&&(h.stretchX||h.stretchY)){const me=MA(w,R,O),he=MA(P,z,M);for(let _e=0;_e<me.length-1;_e++){const Ae=me[_e],Me=me[_e+1];for(let Re=0;Re<he.length-1;Re++)p.push(ne(Ae,he[Re],Me,he[Re+1]))}}else p.push(ne({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return p}function rb(c,i,o){let u=0;for(const p of c)u+=Math.max(i,Math.min(o,p[1]))-Math.max(i,Math.min(o,p[0]));return u}function MA(c,i,o){const u=[{fixed:-Au,stretch:0}];for(const[p,h]of c){const m=u[u.length-1];u.push({fixed:p-m.stretch,stretch:m.stretch}),u.push({fixed:p-m.stretch,stretch:m.stretch+(h-p)})}return u.push({fixed:i+Au,stretch:o}),u}function ib(c,i,o,u){return c/i*o+u}function nb(c,i,o,u){return c-i*o/u}function hV(c,i,o,u){const p=i+c.positionedLines[u].lineOffset;return u===0?o+p/2:o+(p+(i+c.positionedLines[u-1].lineOffset))/2}function dV(c,i=1,o=!1){let u=1/0,p=1/0,h=-1/0,m=-1/0;const b=c[0];for(let E=0;E<b.length;E++){const O=b[E];(!E||O.x<u)&&(u=O.x),(!E||O.y<p)&&(p=O.y),(!E||O.x>h)&&(h=O.x),(!E||O.y>m)&&(m=O.y)}const S=Math.min(h-u,m-p);let A=S/2;const y=new Em([],fV);if(S===0)return new ze(u,p);for(let E=u;E<h;E+=S)for(let O=p;O<m;O+=S)y.push(new op(E+A,O+A,A,c));let w=function(E){let O=0,M=0,R=0;const z=E[0];for(let V=0,G=z.length,F=G-1;V<G;F=V++){const q=z[V],W=z[F],te=q.x*W.y-W.x*q.y;M+=(q.x+W.x)*te,R+=(q.y+W.y)*te,O+=3*te}return new op(M/O,R/O,0,E)}(c),P=y.length;for(;y.length;){const E=y.pop();(E.d>w.d||!w.d)&&(w=E,o&&console.log("found best %d after %d probes",Math.round(1e4*E.d)/1e4,P)),E.max-w.d<=i||(A=E.h/2,y.push(new op(E.p.x-A,E.p.y-A,A,c)),y.push(new op(E.p.x+A,E.p.y-A,A,c)),y.push(new op(E.p.x-A,E.p.y+A,A,c)),y.push(new op(E.p.x+A,E.p.y+A,A,c)),P+=4)}return o&&(console.log(`num probes: ${P}`),console.log(`best distance: ${w.d}`)),w.p}function fV(c,i){return i.max-c.max}class op{constructor(i,o,u,p){this.p=new ze(i,o),this.h=u,this.d=function(h,m){let b=!1,S=1/0;for(let A=0;A<m.length;A++){const y=m[A];for(let w=0,P=y.length,E=P-1;w<P;E=w++){const O=y[w],M=y[E];O.y>h.y!=M.y>h.y&&h.x<(M.x-O.x)*(h.y-O.y)/(M.y-O.y)+O.x&&(b=!b),S=Math.min(S,fi(h,O,M))}}return(b?1:-1)*Math.sqrt(S)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Hw=Number.POSITIVE_INFINITY,pV=Math.sqrt(2);function IA(c,[i,o]){let u=0,p=0;if(o===Hw){i<0&&(i=0);const h=i/pV;switch(c){case"top-right":case"top-left":p=h-7;break;case"bottom-right":case"bottom-left":p=7-h;break;case"bottom":p=7-i;break;case"top":p=i-7}switch(c){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=i;break;case"right":u=-i}}else{switch(i=Math.abs(i),o=Math.abs(o),c){case"top-right":case"top-left":case"top":p=o-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-o}switch(c){case"top-right":case"bottom-right":case"right":u=-i;break;case"top-left":case"bottom-left":case"left":u=i}}return[u,p]}function qw(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function mV(c,i,o,u,p,h,m,b,S,A,y,w,P,E,O){let M=h.textMaxSize.evaluate(i,{},w);M===void 0&&(M=m);const R=c.layers[0].layout,z=R.get("icon-offset").evaluate(i,{},w),V=RA(o.horizontal)||o.vertical,G=P.name==="globe",F=io,q=m/F,W=c.tilePixelRatio*M/F,te=(Me=c.overscaling,c.zoom>18&&Me>2&&(Me>>=1),Math.max(It/(512*Me),1)*R.get("symbol-spacing")),se=R.get("text-padding")*c.tilePixelRatio,le=R.get("icon-padding")*c.tilePixelRatio,ne=Mt(R.get("text-max-angle")),me=R.get("text-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",he=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",_e=R.get("symbol-placement"),Ae=te/2;var Me;const Re=R.get("icon-text-fit").evaluate(i,{},w),Be=R.get("icon-text-fit-padding").evaluate(i,{},w),Ge=Re!=="none";let Fe;c.hasAnyIconTextFit===!1&&Ge&&(c.hasAnyIconTextFit=!0),u&&Ge&&(c.allowVerticalPlacement&&o.vertical&&(Fe=yA(u,o.vertical,Re,Be,z,q)),V&&(u=yA(u,V,Re,Be,z,q)));const tt=(ut,Xe,Lt)=>{if(Xe.x<0||Xe.x>=It||Xe.y<0||Xe.y>=It)return;let Pt=null;if(G){const{x:bt,y:mt,z:Yt}=P.projectTilePoint(Xe.x,Xe.y,Lt);Pt={anchor:new fc(bt,mt,Yt,0,void 0),up:P.upVector(Lt,Xe.x,Xe.y)}}(function(bt,mt,Yt,Rt,$t,cr,Cr,Tr,Er,Rr,Br,Ti,ui,hr,ni,si,Fi,un,wn,hn,Qi,Un,Pn,no,Ri,ts,Ya){const Ta=bt.addToLineVertexArray(mt,Rt);let Ea,td,Ru,rd,Yg,eM,tM,rM=0,iM=0,nM=0,oM=0,xT=-1,wT=-1;const Al={};let sM=Bo("");const id=Yt?Yt.anchor:mt,TT=Er.layout.get("icon-text-fit").evaluate(Qi,{},Ri)!=="none";let ET=0,ST=0;if(Er._unevaluatedLayout.getValue("text-radial-offset")===void 0?[ET,ST]=Er.layout.get("text-offset").evaluate(Qi,{},Ri).map(_s=>_s*io):(ET=Er.layout.get("text-radial-offset").evaluate(Qi,{},Ri)*io,ST=Hw),bt.allowVerticalPlacement&&$t.vertical){const _s=$t.vertical;if(ni)eM=Ww(_s),Tr&&(tM=Ww(Tr));else{const ys=Er.layout.get("text-rotate").evaluate(Qi,{},Ri)+90;Ru=ob(Rr,id,mt,Br,Ti,ui,_s,hr,ys,si),Tr&&(rd=ob(Rr,id,mt,Br,Ti,ui,Tr,un,ys))}}if(cr){const _s=Er.layout.get("icon-rotate").evaluate(Qi,{},Ri),ys=CA(cr,_s,Pn,TT),fp=Tr?CA(Tr,_s,Pn,TT):void 0;td=ob(Rr,id,mt,Br,Ti,ui,cr,un,_s),rM=4*ys.length;const aM=bt.iconSizeData;let nd=null;aM.kind==="source"?(nd=[qa*Er.layout.get("icon-size").evaluate(Qi,{},Ri)],nd[0]>Cu&&Jr(`${bt.layerIds[0]}: Value for "icon-size" is >= ${Lg}. Reduce your "icon-size".`)):aM.kind==="composite"&&(nd=[qa*Un.compositeIconSizes[0].evaluate(Qi,{},Ri),qa*Un.compositeIconSizes[1].evaluate(Qi,{},Ri)],(nd[0]>Cu||nd[1]>Cu)&&Jr(`${bt.layerIds[0]}: Value for "icon-size" is >= ${Lg}. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,ys,nd,hn,wn,Qi,!1,Yt,mt,Ta.lineStartIndex,Ta.lineLength,-1,no,Ri,ts,Ya),xT=bt.icon.placedSymbolArray.length-1,fp&&(iM=4*fp.length,bt.addSymbols(bt.icon,fp,nd,hn,wn,Qi,Ws.vertical,Yt,mt,Ta.lineStartIndex,Ta.lineLength,-1,no,Ri,ts,Ya),wT=bt.icon.placedSymbolArray.length-1)}for(const _s in $t.horizontal){const ys=$t.horizontal[_s];Ea||(sM=Bo(ys.text),ni?Yg=Ww(ys):Ea=ob(Rr,id,mt,Br,Ti,ui,ys,hr,Er.layout.get("text-rotate").evaluate(Qi,{},Ri),si));const fp=ys.positionedLines.length===1;if(nM+=DA(bt,Yt,mt,ys,Cr,Er,ni,Qi,si,Ta,$t.vertical?Ws.horizontal:Ws.horizontalOnly,fp?Object.keys($t.horizontal):[_s],Al,xT,Un,no,Ri,ts),fp)break}$t.vertical&&(oM+=DA(bt,Yt,mt,$t.vertical,Cr,Er,ni,Qi,si,Ta,Ws.vertical,["vertical"],Al,wT,Un,no,Ri,ts));let Lu=-1;const OT=(_s,ys)=>_s?Math.max(_s,ys):ys;Lu=OT(Yg,Lu),Lu=OT(eM,Lu),Lu=OT(tM,Lu);const M6=Lu>-1?1:0;bt.glyphOffsetArray.length>=65535&&Jr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Qi.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,Qi.sortKey),bt.symbolInstances.emplaceBack(mt.x,mt.y,id.x,id.y,id.z,Al.right>=0?Al.right:-1,Al.center>=0?Al.center:-1,Al.left>=0?Al.left:-1,Al.vertical>=0?Al.vertical:-1,xT,wT,sM,Ea!==void 0?Ea:bt.collisionBoxArray.length,Ea!==void 0?Ea+1:bt.collisionBoxArray.length,Ru!==void 0?Ru:bt.collisionBoxArray.length,Ru!==void 0?Ru+1:bt.collisionBoxArray.length,td!==void 0?td:bt.collisionBoxArray.length,td!==void 0?td+1:bt.collisionBoxArray.length,rd||bt.collisionBoxArray.length,rd?rd+1:bt.collisionBoxArray.length,Br,nM,oM,rM,iM,M6,0,ET,ST,Lu,0,TT?1:0)})(c,Xe,Pt,ut,o,u,p,Fe,c.layers[0],c.collisionBoxArray,i.index,i.sourceLayerIndex,c.index,se,me,S,0,le,he,z,i,h,A,y,w,E,O)};if(_e==="line")for(const ut of EA(i.geometry,0,0,It,It)){const Xe=uV(ut,te,ne,o.vertical||V,u,F,W,c.overscaling,It);for(const Lt of Xe)V&&gV(c,V.text,Ae,Lt)||tt(ut,Lt,w)}else if(_e==="line-center"){for(const ut of i.geometry)if(ut.length>1){const Xe=cV(ut,ne,o.vertical||V,u,F,W);Xe&&tt(ut,Xe,w)}}else if(i.type==="Polygon")for(const ut of qv(i.geometry,0)){const Xe=dV(ut,16);tt(ut[0],new fc(Xe.x,Xe.y,0,0,void 0),w)}else if(i.type==="LineString")for(const ut of i.geometry)tt(ut,new fc(ut[0].x,ut[0].y,0,0,void 0),w);else if(i.type==="Point")for(const ut of i.geometry)for(const Xe of ut)tt([Xe],new fc(Xe.x,Xe.y,0,0,void 0),w)}const Lg=255,Cu=Lg*qa;function DA(c,i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R,z){const V=function(q,W,te,se,le,ne,me,he){const _e=[];if(W.positionedLines.length===0)return _e;const Ae=se.layout.get("text-rotate").evaluate(ne,{})*Math.PI/180,Me=function(tt){const ut=tt[0],Xe=tt[1],Lt=ut*Xe;return Lt>0?[ut,-Xe]:Lt<0?[-ut,Xe]:ut===0?[Xe,ut]:[Xe,-ut]}(te);let Re=Math.abs(W.top-W.bottom);for(const tt of W.positionedLines)Re-=tt.lineOffset;const Be=W.positionedLines.length,Ge=Re/Be;let Fe=W.top-te[1];for(let tt=0;tt<Be;++tt){const ut=W.positionedLines[tt];Fe=hV(W,Ge,Fe,tt);for(const Xe of ut.positionedGlyphs){if(!Xe.rect)continue;const Lt=Xe.rect||{};let Pt=dA+1,bt=!0,mt=1,Yt=0;if(Xe.imageName){const hn=me[Xe.imageName];if(!hn)continue;if(hn.sdf){Jr("SDF images are not supported in formatted text and will be ignored.");continue}bt=!1,mt=hn.pixelRatio,Pt=Dg/mt}const Rt=(le||he)&&Xe.vertical,$t=Xe.metrics.advance*Xe.scale/2,cr=Xe.metrics,Cr=Xe.rect;if(Cr===null)continue;he&&W.verticalizable&&(Yt=Xe.imageName?$t-Xe.metrics.width*Xe.scale/2:0);const Tr=le?[Xe.x+$t,Xe.y]:[0,0];let Er=[0,0],Rr=[0,0],Br=!1;le||(Rt?(Rr=[Xe.x+$t+Me[0],Xe.y+Me[1]-Yt],Br=!0):Er=[Xe.x+$t+te[0],Xe.y+te[1]-Yt]);const Ti=Cr.w*Xe.scale/(mt*(Xe.localGlyph?Wa:1)),ui=Cr.h*Xe.scale/(mt*(Xe.localGlyph?Wa:1));let hr,ni,si,Fi;if(Rt){const hn=Xe.y-Fe,Qi=new ze(-$t,$t-hn),Un=-Math.PI/2,Pn=new ze(...Rr);hr=new ze(-$t+Er[0],Er[1]),hr._rotateAround(Un,Qi)._add(Pn),hr.x+=-hn+$t,hr.y-=(cr.left-Pt)*Xe.scale;const no=Xe.imageName?cr.advance*Xe.scale:io*Xe.scale,Ri=String.fromCodePoint(Xe.glyph);eV(Ri)?hr.x+=(1-Pt)*Xe.scale:tV(Ri)?hr.x+=no-cr.height*Xe.scale+(-Pt-1)*Xe.scale:hr.x+=Xe.imageName||cr.width+2*Pt===Cr.w&&cr.height+2*Pt===Cr.h?(no-ui)/2:(no-(cr.height+2*Pt)*Xe.scale)/2,ni=new ze(hr.x,hr.y-Ti),si=new ze(hr.x+ui,hr.y),Fi=new ze(hr.x+ui,hr.y-Ti)}else{const hn=(cr.left-Pt)*Xe.scale-$t+Er[0],Qi=(-cr.top-Pt)*Xe.scale+Er[1],Un=hn+Ti,Pn=Qi+ui;hr=new ze(hn,Qi),ni=new ze(Un,Qi),si=new ze(hn,Pn),Fi=new ze(Un,Pn)}if(Ae){let hn;hn=le?new ze(0,0):Br?new ze(Me[0],Me[1]):new ze(te[0],te[1]),hr._rotateAround(Ae,hn),ni._rotateAround(Ae,hn),si._rotateAround(Ae,hn),Fi._rotateAround(Ae,hn)}const un=new ze(0,0),wn=new ze(0,0);_e.push({tl:hr,tr:ni,bl:si,br:Fi,texPrimary:Lt,texSecondary:void 0,writingMode:W.writingMode,glyphOffset:Tr,sectionIndex:Xe.sectionIndex,isSDF:bt,pixelOffsetTL:un,pixelOffsetBR:wn,minFontScaleX:0,minFontScaleY:0})}}return _e}(0,u,S,h,m,b,p,c.allowVerticalPlacement),G=c.textSizeData;let F=null;G.kind==="source"?(F=[qa*h.layout.get("text-size").evaluate(b,{},R)],F[0]>Cu&&Jr(`${c.layerIds[0]}: Value for "text-size" is >= ${Lg}. Reduce your "text-size".`)):G.kind==="composite"&&(F=[qa*O.compositeTextSizes[0].evaluate(b,{},R),qa*O.compositeTextSizes[1].evaluate(b,{},R)],(F[0]>Cu||F[1]>Cu)&&Jr(`${c.layerIds[0]}: Value for "text-size" is >= ${Lg}. Reduce your "text-size".`)),c.addSymbols(c.text,V,F,S,m,b,y,i,o,A.lineStartIndex,A.lineLength,E,M,R,z,!1);for(const q of w)P[q]=c.text.placedSymbolArray.length-1;return 4*V.length}function RA(c){for(const i in c)return c[i];return null}function ob(c,i,o,u,p,h,m,b,S,A){let y=m.top,w=m.bottom,P=m.left,E=m.right;const O=m.collisionPadding;if(O&&(P-=O[0],y-=O[1],E+=O[2],w+=O[3]),S){const M=new ze(P,y),R=new ze(E,y),z=new ze(P,w),V=new ze(E,w),G=Mt(S);let F=new ze(0,0);A&&(F=new ze(A[0],A[1])),M._rotateAround(G,F),R._rotateAround(G,F),z._rotateAround(G,F),V._rotateAround(G,F),P=Math.min(M.x,R.x,z.x,V.x),E=Math.max(M.x,R.x,z.x,V.x),y=Math.min(M.y,R.y,z.y,V.y),w=Math.max(M.y,R.y,z.y,V.y)}return c.emplaceBack(i.x,i.y,i.z,o.x,o.y,P,y,E,w,b,u,p,h),c.length-1}function Ww(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const i=c.bottom-c.top;return i>0?Math.max(10,i):null}function gV(c,i,o,u){const p=c.compareText;if(i in p){const h=p[i];for(let m=h.length-1;m>=0;m--)if(u.dist(h[m])<o)return!0}else p[i]=[];return p[i].push(u),!1}function LA(c,i){const o=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*i:0,p=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),h=Math.sin(o)*p/Math.sin(Math.max(Math.PI/2-c._pitch-o,.01));let m=Math.sin(c._pitch)*h+p;const b=p*(1/c._horizonShift);return c.elevation&&c.elevation.exaggeration()!==0||(m*=1+Math.max(c.zoom-17,0)),Math.min(1.01*m,b)}function Bg(c,i){if(!i.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:i};const o=Math.pow(2,-c.z),u=c.x*o,p=(c.x+1)*o,h=c.y*o,m=(c.y+1)*o,b=fe(u),S=fe(p),A=de(h),y=de(m),w=i.project(b,A),P=i.project(S,A),E=i.project(S,y),O=i.project(b,y);let M=Math.min(w.x,P.x,E.x,O.x),R=Math.min(w.y,P.y,E.y,O.y),z=Math.max(w.x,P.x,E.x,O.x),V=Math.max(w.y,P.y,E.y,O.y);const G=o/16;function F(W,te,se,le,ne,me){const he=(se+ne)/2,_e=(le+me)/2,Ae=i.project(fe(he),de(_e)),Me=Math.max(0,M-Ae.x,R-Ae.y,Ae.x-z,Ae.y-V);M=Math.min(M,Ae.x),z=Math.max(z,Ae.x),R=Math.min(R,Ae.y),V=Math.max(V,Ae.y),Me>G&&(F(W,Ae,se,le,he,_e),F(Ae,te,he,_e,ne,me))}F(w,P,u,h,p,h),F(P,E,p,h,p,m),F(E,O,p,m,u,m),F(O,w,u,m,u,h),M-=G,R-=G,z+=G,V+=G;const q=1/Math.max(z-M,V-R);return{scale:q,x:M*q,y:R*q,x2:z*q,y2:V*q,projection:i}}function BA(c,{x:i,y:o},u=0){return new ze(((i-u)*c.scale-c.x)*It,(o*c.scale-c.y)*It)}const _V=we.mat4.identity(new Float32Array(16));class Mu{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,o){return{x:0,y:0,z:0}}unproject(i,o){return new U(0,0)}projectTilePoint(i,o,u){return{x:i,y:o,z:0}}locationPoint(i,o,u=!0){return i._coordinatePoint(i.locationCoordinate(o),u)}pixelsPerMeter(i,o){return oe(1,i)*o}pixelSpaceConversion(i,o,u){return 1}farthestPixelDistance(i){return LA(i,i.pixelsPerMeter)}pointCoordinate(i,o,u,p){const h=i.horizonLineFromTop(!1),m=new ze(o,Math.max(h,u));return i.rayIntersectionCoordinate(i.pointRayIntersection(m,p))}pointCoordinate3D(i,o,u){const p=new ze(o,u);if(i.elevation)return i.elevation.pointCoordinate(p);{const h=this.pointCoordinate(i,p.x,p.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(i,o){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,o.x,o.y);const u=i.horizonLineFromTop();return o.y<u}createInversionMatrix(i,o){return _V}createTileMatrix(i,o,u){let p,h,m;const b=u.canonical,S=we.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const A=Bg(b,this);p=1,h=A.x+u.wrap*A.scale,m=A.y,we.mat4.scale(S,S,[p/A.scale,p/A.scale,i.pixelsPerMeter/o])}else p=o/i.zoomScale(b.z),h=(b.x+Math.pow(2,b.z)*u.wrap)*p,m=b.y*p;return we.mat4.translate(S,S,[h,m,0]),we.mat4.scale(S,S,[p/It,p/It,1]),S}upVector(i,o,u){return[0,0,1]}upVectorScale(i,o,u){return{metersToTile:1}}}class yV extends Mu{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[o,u]=this.parallels=i.parallels||[29.5,45.5],p=Math.sin(Mt(o));this.n=(p+Math.sin(Mt(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(i,o){const{n:u,c:p,r0:h}=this,m=Mt(i-this.center[0]),b=Mt(o),S=Math.sqrt(p-2*u*Math.sin(b))/u;return{x:S*Math.sin(m*u),y:S*Math.cos(m*u)-h,z:0}}unproject(i,o){const{n:u,c:p,r0:h}=this,m=h+o;let b=Math.atan2(i,Math.abs(m))*Math.sign(m);m*u<0&&(b-=Math.PI*Math.sign(i)*Math.sign(m));const S=Mt(this.center[0])*u;b=Hr(b,-Math.PI-S,Math.PI-S);const A=Dt(Vt(b/u)+this.center[0],-180,180),y=Math.asin(Dt((p-(i*i+m*m)*u*u)/(2*u),-1,1)),w=Dt(Vt(y),-ge,ge);return new U(A,w)}}const kg=1.340264,zg=-.081106,Fg=893e-6,Ng=.003796,sb=Math.sqrt(3)/2;class vV extends Mu{project(i,o){o=o/180*Math.PI,i=i/180*Math.PI;const u=Math.asin(sb*Math.sin(o)),p=u*u,h=p*p*p;return{x:.5*(i*Math.cos(u)/(sb*(kg+3*zg*p+h*(7*Fg+9*Ng*p)))/Math.PI+.5),y:1-.5*(u*(kg+zg*p+h*(Fg+Ng*p))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,p=u*u,h=p*p*p;for(let y,w,P,E=0;E<12&&(w=u*(kg+zg*p+h*(Fg+Ng*p))-o,P=kg+3*zg*p+h*(7*Fg+9*Ng*p),y=w/P,u=Dt(u-y,-Math.PI/3,Math.PI/3),p=u*u,h=p*p*p,!(Math.abs(y)<1e-12));++E);const m=sb*i*(kg+3*zg*p+h*(7*Fg+9*Ng*p))/Math.cos(u),b=Math.asin(Math.sin(u)/sb),S=Dt(180*m/Math.PI,-180,180),A=Dt(180*b/Math.PI,-ge,ge);return new U(S,A)}}class bV extends Mu{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){return{x:.5+i/360,y:.5-o/360,z:0}}unproject(i,o){const u=360*(i-.5),p=Dt(360*(.5-o),-ge,ge);return new U(u,p)}}const sp=Math.PI/2;function ab(c){return Math.tan((sp+c)/2)}class xV extends Mu{constructor(i){super(i),this.center=i.center||[0,30];const[o,u]=this.parallels=i.parallels||[30,30];let p=Mt(o),h=Mt(u);this.southernCenter=p+h<0,this.southernCenter&&(p=-p,h=-h);const m=Math.cos(p),b=ab(p);this.n=p===h?Math.sin(p):Math.log(m/Math.cos(h))/Math.log(ab(h)/b),this.f=m*Math.pow(ab(p),this.n)/this.n}project(i,o){o=Mt(o),this.southernCenter&&(o=-o),i=Mt(i-this.center[0]);const u=1e-6,{n:p,f:h}=this;h>0?o<-sp+u&&(o=-sp+u):o>sp-u&&(o=sp-u);const m=h/Math.pow(ab(o),p);let b=m*Math.sin(p*i),S=h-m*Math.cos(p*i);return b=.5*(b/Math.PI+.5),S=.5*(S/Math.PI+.5),{x:b,y:this.southernCenter?S:1-S,z:0}}unproject(i,o){i=(2*i-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:u,f:p}=this,h=p-o,m=Math.sign(h),b=Math.sign(u)*Math.sqrt(i*i+h*h);let S=Math.atan2(i,Math.abs(h))*m;h*u<0&&(S-=Math.PI*Math.sign(i)*m);const A=Dt(Vt(S/u)+this.center[0],-180,180),y=Dt(Vt(2*Math.atan(Math.pow(p/b,1/u))-sp),-ge,ge);return new U(A,this.southernCenter?-y:y)}}class kA extends Mu{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,o){return{x:ae(i),y:ce(o),z:0}}unproject(i,o){const u=fe(i),p=de(o);return new U(u,p)}}const zA=Mt(ge);class wV extends Mu{project(i,o){const u=(o=Mt(o))*o,p=u*u;return{x:.5*((i=Mt(i))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(i,o){i=(2*i-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,p=25,h=0,m=u*u;do{m=u*u;const A=m*m;h=(u*(1.007226+m*(.015085+A*(.028874*m-.044475-.005916*A)))-o)/(1.007226+m*(.045255+A*(.259866*m-.311325-.005916*11*A))),u=Dt(u-h,-zA,zA)}while(Math.abs(h)>1e-6&&--p>0);m=u*u;const b=Dt(Vt(i/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),S=Vt(u);return new U(b,S)}}const FA=Mt(ge);class TV extends Mu{project(i,o){o=Mt(o),i=Mt(i);const u=Math.cos(o),p=2/Math.PI,h=Math.acos(u*Math.cos(i/2)),m=Math.sin(h)/h,b=.5*(i*p+2*u*Math.sin(i/2)/m)||0,S=.5*(o+Math.sin(o)/m)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(S/Math.PI+1),z:0}}unproject(i,o){let u=i=(2*i-.5)*Math.PI,p=o=(2*(1-o)-1)*Math.PI,h=25;const m=1e-6;let b=0,S=0;do{const A=Math.cos(p),y=Math.sin(p),w=2*y*A,P=y*y,E=A*A,O=Math.cos(u/2),M=Math.sin(u/2),R=2*O*M,z=M*M,V=1-E*O*O,G=V?1/V:0,F=V?Math.acos(A*O)*Math.sqrt(1/V):0,q=.5*(2*F*A*M+2*u/Math.PI)-i,W=.5*(F*y+p)-o,te=.5*G*(E*z+F*A*O*P)+1/Math.PI,se=G*(R*w/4-F*y*M),le=.125*G*(w*M-F*y*E*R),ne=.5*G*(P*O+F*z*A)+.5,me=se*le-ne*te;b=(W*se-q*ne)/me,S=(q*le-W*te)/me,u=Dt(u-b,-Math.PI,Math.PI),p=Dt(p-S,-FA,FA)}while((Math.abs(b)>m||Math.abs(S)>m)&&--h>0);return new U(Vt(u),Vt(p))}}class NA extends Mu{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Mt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,o){const{scale:u,cosPhi:p}=this;return{x:Mt(i)*p*u+.5,y:-Math.sin(Mt(o))/p*u+.5,z:0}}unproject(i,o){const{scale:u,cosPhi:p}=this,h=-(o-.5)/u,m=Dt(Vt((i-.5)/u)/p,-180,180),b=Math.asin(Dt(h*p,-1,1)),S=Dt(Vt(b),-ge,ge);return new U(m,S)}}class EV extends kA{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,o,u){const p=vg(i,o,u),h=Vv(Ol(u));return we.vec3.transformMat4(p,p,h),{x:p[0],y:p[1],z:p[2]}}locationPoint(i,o){const u=B(o.lat,o.lng),p=we.vec3.normalize([],u),h=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(o),i._centerAltitude):i._centerAltitude,m=oe(1,0)*It*h;we.vec3.scaleAndAdd(u,u,p,m);const b=we.mat4.identity(new Float64Array(16));return we.mat4.multiply(b,i.pixelMatrix,i.globeMatrix),we.vec3.transformMat4(u,u,b),new ze(u[0],u[1])}pixelsPerMeter(i,o){return oe(1,0)*o}pixelSpaceConversion(i,o,u){const p=oe(1,i)*o,h=nr(oe(1,45)*o,p,u);return this.pixelsPerMeter(i,o)/h}createTileMatrix(i,o,u){const p=_w(Ol(u.canonical));return we.mat4.multiply(new Float64Array(16),i.globeMatrix,p)}createInversionMatrix(i,o){const{center:u}=i,p=Vv(Ol(o));return we.mat4.rotateY(p,p,Mt(u.lng)),we.mat4.rotateX(p,p,Mt(u.lat)),we.mat4.scale(p,p,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(i,o,u,p){return Nv(i,o,u,!0)||new $e(0,0)}pointCoordinate3D(i,o,u){const p=this.pointCoordinate(i,o,u,0);return[p.x,p.y,p.z]}isPointAboveHorizon(i,o){return!Nv(i,o.x,o.y,!1)}farthestPixelDistance(i){const o=function(p,h){const m=p.cameraToCenterDistance,b=p._centerAltitude*h,S=p._camera,A=p._camera.forward(),y=we.vec3.add([],we.vec3.scale([],A,-m),[0,0,b]),w=p.worldSize/(2*Math.PI),P=[0,0,-w],E=p.width/p.height,O=Math.tan(p.fovAboveCenter),M=we.vec3.scale([],S.up(),O),R=we.vec3.scale([],S.right(),O*E),z=we.vec3.normalize([],we.vec3.add([],we.vec3.add([],A,M),R)),V=[];let G;if(new Ha(y,z).closestPointOnSphere(P,w,V)){const F=we.vec3.add([],V,P),q=we.vec3.sub([],F,y);G=Math.cos(p.fovAboveCenter)*we.vec3.length(q)}else{const F=we.vec3.sub([],y,P),q=we.vec3.sub([],P,y);we.vec3.normalize(q,q);const W=we.vec3.length(F)-w;G=Math.sqrt(W*(W+2*w));const te=Math.acos(G/(w+W))-Math.acos(we.vec3.dot(A,q));G*=Math.cos(te)}return 1.01*G}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),u=Su(i.zoom);if(u>0){const p=LA(i,oe(1,i.center.lat)*i.worldSize),h=i.worldSize/(2*Math.PI),m=Math.max(i.width,i.height)/i.worldSize*Math.PI;return nr(o,p+h*(1-Math.cos(m)),Math.pow(u,10))}return o}upVector(i,o,u){return vg(o,u,i,1)}upVectorScale(i){return{metersToTile:hc(jv(Ol(i)))}}}function $A(c){const i=c.parallels,o=!!i&&Math.abs(i[0]+i[1])<.01;switch(c.name){case"mercator":return new kA(c);case"equirectangular":return new bV(c);case"naturalEarth":return new wV(c);case"equalEarth":return new vV(c);case"winkelTripel":return new TV(c);case"albers":return o?new NA(c):new yV(c);case"lambertConformalConic":return o?new NA(c):new xV(c);case"globe":return new EV(c)}throw new Error(`Invalid projection name: ${c.name}`)}const SV=tp.VectorTileFeature.types,OV=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lb(c,i,o,u,p,h,m,b,S,A,y,w,P){const E=b?Math.min(Cu,Math.round(b[0])):0,O=b?Math.min(Cu,Math.round(b[1])):0;c.emplaceBack(i,o,Math.round(32*u),Math.round(32*p),h,m,(E<<1)+(S?1:0),O,16*A,16*y,256*w,256*P)}function cb(c,i,o){c.emplaceBack(i,o)}function ub(c,i,o,u,p,h,m){c.emplaceBack(i,o,u,p,h,m)}function hb(c,i,o,u,p){c.emplaceBack(i,o,u,p),c.emplaceBack(i,o,u,p),c.emplaceBack(i,o,u,p),c.emplaceBack(i,o,u,p)}function PV(c){for(const i of c.sections)if(Q1(i.text))return!0;return!1}class Zw{constructor(i){this.layoutVertexArray=new og,this.indexArray=new Jn,this.programConfigurations=i,this.segments=new on,this.dynamicLayoutVertexArray=new ja,this.opacityVertexArray=new ag,this.placedSymbolArray=new dg,this.iconTransitioningVertexArray=new Tl,this.globeExtVertexArray=new sg,this.zOffsetVertexArray=new vu}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,o,u,p,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Gj.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,qj.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,OV,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,Zj.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Hj.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,Wj.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}jt(Zw,"SymbolBuffers");class Xw{constructor(i,o,u){this.layoutVertexArray=new i,this.layoutAttributes=o,this.indexArray=new u,this.segments=new on,this.collisionVertexArray=new yu,this.collisionVertexArrayExt=new ja}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Xj.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,Kj.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}jt(Xw,"CollisionBuffers");class db{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(m=>m.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=we.mat4.identity([]),this.placementViewportMatrix=we.mat4.identity([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zw(this.zoom,o["text-size"]),this.iconSizeData=zw(this.zoom,o["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(m=>Ws[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Zw(new El(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new Zw(new El(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new Mv,this.lineVertexArray=new Kf,this.symbolInstances=new fg}calculateGlyphDependencies(i,o,u,p,h){for(let m=0;m<i.length;m++){const b=i.codePointAt(m);if(b===void 0)break;if(o[b]=!0,p&&h&&b<=65535){const S=Mg[i.charAt(m)];S&&(o[S.charCodeAt(0)]=!0)}}}updateFootprints(i,o){}updateReplacement(i,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!Iw(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(i,o,u,p){const h=this.layers[0],m=h.layout,b=this.projection.name==="globe",S=m.get("text-font"),A=m.get("text-field"),y=m.get("icon-image"),w=(A.value.kind!=="constant"||A.value.value instanceof uo&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),P=y.value.kind!=="constant"||!!y.value.value||Object.keys(y.parameters).length>0,E=m.get("symbol-sort-key");if(this.features=[],!w&&!P)return;const O=o.iconDependencies,M=o.glyphDependencies,R=o.availableImages,z=new nn(this.zoom);for(const{feature:V,id:G,index:F,sourceLayerIndex:q}of i){const W=h._featureFilter.needGeometry,te=xt(V,W);if(!h._featureFilter.filter(z,te,u))continue;if(W||(te.geometry=vt(V,u,p)),b&&V.type!==1&&u.z<=5){const me=te.geometry,he=.98078528056,_e=(Ae,Me)=>{const Re=vg(Ae.x,Ae.y,u,1),Be=vg(Me.x,Me.y,u,1);return we.vec3.dot(Re,Be)<he};for(let Ae=0;Ae<me.length;Ae++)me[Ae]=_t(me[Ae],_e)}let se,le;if(w){const me=h.getValueAndResolveTokens("text-field",te,u,R),he=uo.factory(me);PV(he)&&(this.hasRTLText=!0),(!this.hasRTLText||Qm()==="unavailable"||this.hasRTLText&&No.isParsed())&&(se=Qj(he,h,te))}if(P){const me=h.getValueAndResolveTokens("icon-image",te,u,R);le=me instanceof To?me:To.fromString(me)}if(!se&&!le)continue;const ne=this.sortFeaturesByKey?E.evaluate(te,{},u):void 0;if(this.features.push({id:G,text:se,icon:le,index:F,sourceLayerIndex:q,geometry:te.geometry,properties:V.properties,type:SV[V.type],sortKey:ne}),le&&(O[le.namePrimary]=!0,le.nameSecondary&&(O[le.nameSecondary]=!0)),se){const me=S.evaluate(te,{},u).join(","),he=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ws.vertical)>=0;for(const _e of se.sections)if(_e.image)O[_e.image.namePrimary]=!0;else{const Ae=Lf(se.toString()),Me=_e.fontStack||me,Re=M[Me]=M[Me]||{};this.calculateGlyphDependencies(_e.text,Re,he,this.allowVerticalPlacement,Ae)}}}m.get("symbol-placement")==="line"&&(this.features=function(V){const G={},F={},q=[];let W=0;function te(me){q.push(V[me]),W++}function se(me,he,_e){const Ae=F[me];return delete F[me],F[he]=Ae,q[Ae].geometry[0].pop(),q[Ae].geometry[0]=q[Ae].geometry[0].concat(_e[0]),Ae}function le(me,he,_e){const Ae=G[he];return delete G[he],G[me]=Ae,q[Ae].geometry[0].shift(),q[Ae].geometry[0]=_e[0].concat(q[Ae].geometry[0]),Ae}function ne(me,he,_e){const Ae=_e?he[0][he[0].length-1]:he[0][0];return`${me}:${Ae.x}:${Ae.y}`}for(let me=0;me<V.length;me++){const he=V[me],_e=he.geometry,Ae=he.text?he.text.toString():null;if(!Ae){te(me);continue}const Me=ne(Ae,_e),Re=ne(Ae,_e,!0);if(Me in F&&Re in G&&F[Me]!==G[Re]){const Be=le(Me,Re,_e),Ge=se(Me,Re,q[Be].geometry);delete G[Me],delete F[Re],F[ne(Ae,q[Ge].geometry,!0)]=Ge,q[Be].geometry=null}else Me in F?se(Me,Re,_e):Re in G?le(Me,Re,_e):(te(me),G[Me]=W-1,F[Re]=W-1)}return q.filter(me=>me.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((V,G)=>V.sortKey-G.sortKey)}update(i,o,u,p,h){const m=Object.keys(i).length!==0;if(m&&!this.stateDependentLayers.length)return;const b=m?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(i,o,b,u,p,h),this.icon.programConfigurations.updatePaintArrays(i,o,b,u,p,h)}updateZOffset(){const i=(h,m,b)=>{u+=m,u>h.length&&h.resize(u);for(let S=-m;S<0;S++)h.emplace(S+u,b)},o=(h,m,b)=>{p+=m,p>h.length&&h.resize(p);for(let S=-m;S<0;S++)h.emplace(S+p,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,p=0;for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:S,numIconVertices:A}=m,y=m.zOffset,w=A>0;if((b>0||S>0)&&(i(this.text.zOffsetVertexArray,b,y),i(this.text.zOffsetVertexArray,S,y)),w){const{placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:E}=m;P>=0&&o(this.icon.zOffsetVertexArray,A,y),E>=0&&o(this.icon.zOffsetVertexArray,m.numVerticalIconVertices,y)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=$A(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,o){const u=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:p,y:h}of o)this.lineVertexArray.emplaceBack(p,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(i,o,u,p,h,m,b,S,A,y,w,P,E,O,M,R){const z=i.indexArray,V=i.layoutVertexArray,G=i.globeExtVertexArray,F=i.segments.prepareSegment(4*o.length,V,z,this.canOverlap?m.sortKey:void 0),q=this.glyphOffsetArray.length,W=F.vertexLength,te=this.allowVerticalPlacement&&b===Ws.vertical?Math.PI/2:0,se=m.text&&m.text.sections;for(let ne=0;ne<o.length;ne++){const{tl:me,tr:he,bl:_e,br:Ae,texPrimary:Me,texSecondary:Re,pixelOffsetTL:Be,pixelOffsetBR:Ge,minFontScaleX:Fe,minFontScaleY:tt,glyphOffset:ut,isSDF:Xe,sectionIndex:Lt}=o[ne],Pt=F.vertexLength,bt=ut[1];if(lb(V,A.x,A.y,me.x,bt+me.y,Me.x,Me.y,u,Xe,Be.x,Be.y,Fe,tt),lb(V,A.x,A.y,he.x,bt+he.y,Me.x+Me.w,Me.y,u,Xe,Ge.x,Be.y,Fe,tt),lb(V,A.x,A.y,_e.x,bt+_e.y,Me.x,Me.y+Me.h,u,Xe,Be.x,Ge.y,Fe,tt),lb(V,A.x,A.y,Ae.x,bt+Ae.y,Me.x+Me.w,Me.y+Me.h,u,Xe,Ge.x,Ge.y,Fe,tt),S){const{x:mt,y:Yt,z:Rt}=S.anchor,[$t,cr,Cr]=S.up;ub(G,mt,Yt,Rt,$t,cr,Cr),ub(G,mt,Yt,Rt,$t,cr,Cr),ub(G,mt,Yt,Rt,$t,cr,Cr),ub(G,mt,Yt,Rt,$t,cr,Cr),hb(i.dynamicLayoutVertexArray,mt,Yt,Rt,te)}else hb(i.dynamicLayoutVertexArray,A.x,A.y,A.z,te);if(R){const mt=Re||Me;cb(i.iconTransitioningVertexArray,mt.x,mt.y),cb(i.iconTransitioningVertexArray,mt.x+mt.w,mt.y),cb(i.iconTransitioningVertexArray,mt.x,mt.y+mt.h),cb(i.iconTransitioningVertexArray,mt.x+mt.w,mt.y+mt.h)}z.emplaceBack(Pt,Pt+1,Pt+2),z.emplaceBack(Pt+1,Pt+2,Pt+3),F.vertexLength+=4,F.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ut[0]),ne!==o.length-1&&Lt===o[ne+1].sectionIndex||i.programConfigurations.populatePaintArrays(V.length,m,m.index,{},E,O,M,se&&se[Lt])}const le=S?S.anchor:A;i.placedSymbolArray.emplaceBack(le.x,le.y,le.z,A.x,A.y,q,this.glyphOffsetArray.length-q,W,y,w,A.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],b,0,!1,0,P,0)}_commitLayoutVertex(i,o,u,p,h,m,b){i.emplaceBack(o,u,p,h,m,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(i,o,u,p,h,m,b){const S=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),A=S.vertexLength,y=b.tileAnchorX,w=b.tileAnchorY;for(let E=0;E<4;E++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,o,i.padding,b.zOffset),this._commitLayoutVertex(u.layoutVertexArray,p,h,m,y,w,new ze(i.x1,i.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,h,m,y,w,new ze(i.x2,i.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,h,m,y,w,new ze(i.x2,i.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,h,m,y,w,new ze(i.x1,i.y2)),S.vertexLength+=4;const P=u.indexArray;P.emplaceBack(A,A+1),P.emplaceBack(A+1,A+2),P.emplaceBack(A+2,A+3),P.emplaceBack(A+3,A),S.primitiveLength+=4}_addTextDebugCollisionBoxes(i,o,u,p,h,m){for(let b=p;b<h;b++){const S=u.get(b),A=this.getSymbolInstanceTextSize(i,m,o,b);this._addCollisionDebugVertices(S,A,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(i,o,u,p,h,m){for(let b=p;b<h;b++){const S=u.get(b),A=this.getSymbolInstanceIconSize(i,o,m.placedIconSymbolIndex);this._addCollisionDebugVertices(S,A,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,m)}}generateCollisionDebugBuffers(i,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xw(lc,lA.members,Tl),this.iconCollisionBox=new Xw(lc,lA.members,Tl);const u=rp(this.iconSizeData,i),p=rp(this.textSizeData,i);for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(p,i,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(p,i,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(u,i,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(u,i,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(i,o,u,p){const h=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:p),m=Qv(this.textSizeData,i,h)/io;return this.tilePixelRatio*m}getSymbolInstanceIconSize(i,o,u){const p=this.icon.placedSymbolArray.get(u),h=Qv(this.iconSizeData,i,p);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(i,o,u,p){i.emplaceBack(o,-u,-u,p),i.emplaceBack(o,u,-u,p),i.emplaceBack(o,u,u,p),i.emplaceBack(o,-u,u,p)}_updateTextDebugCollisionBoxes(i,o,u,p,h,m){for(let b=p;b<h;b++){const S=u.get(b),A=this.getSymbolInstanceTextSize(i,m,o,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,S.padding,m.zOffset)}}_updateIconDebugCollisionBoxes(i,o,u,p,h,m){for(let b=p;b<h;b++){const S=u.get(b),A=this.getSymbolInstanceIconSize(i,o,m.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,S.padding,m.zOffset)}}updateCollisionDebugBuffers(i,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=rp(this.iconSizeData,i),p=rp(this.textSizeData,i);for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(p,i,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(p,i,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(u,i,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._updateIconDebugCollisionBoxes(u,i,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,o,u,p,h,m,b,S,A){const y={};if(o<u){const{x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F,featureIndex:q}=i.get(o);y.textBox={x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F},y.textFeatureIndex=q}if(p<h){const{x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F,featureIndex:q}=i.get(p);y.verticalTextBox={x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F},y.verticalTextFeatureIndex=q}if(m<b){const{x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F,featureIndex:q}=i.get(m);y.iconBox={x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F},y.iconFeatureIndex=q}if(S<A){const{x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F,featureIndex:q}=i.get(S);y.verticalIconBox={x1:w,y1:P,x2:E,y2:O,padding:M,projectedAnchorX:R,projectedAnchorY:z,projectedAnchorZ:V,tileAnchorX:G,tileAnchorY:F},y.verticalIconFeatureIndex=q}return y}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,o){const u=i.placedSymbolArray.get(o),p=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<p;h+=4)i.indexArray.emplaceBack(h,h+1,h+2),i.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(i),u=Math.cos(i),p=[],h=[],m=[];for(let b=0;b<this.symbolInstances.length;++b){m.push(b);const S=this.symbolInstances.get(b);p.push(0|Math.round(o*S.tileAnchorX+u*S.tileAnchorY)),h.push(S.featureIndex)}return m.sort((b,S)=>p[b]-p[S]||h[S]-h[b]),m}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:S,verticalPlacedIconSymbolIndex:A}=u;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),h>=0&&h!==p&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&m!==p&&this.addIndicesForPlacedSymbol(this.text,m),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),S>=0&&this.addIndicesForPlacedSymbol(this.icon,S),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let jA,VA,Kw;jt(db,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),db.addDynamicAttributes=hb;class UA{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:js,this.defaultValue=i}evaluate(i){if(i.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(i.formattedSection))return o.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}jt(UA,"FormatSectionOverride",{omit:["defaultValue"]});const Yw=()=>Kw||(Kw={layout:jA||(jA=new Ui({"symbol-placement":new wt(Ue.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(Ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(Ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(Ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(Ue.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new wt(Ue.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new wt(Ue.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new wt(Ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(Ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(Ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(Ue.layout_symbol["icon-size"]),"icon-text-fit":new Xt(Ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xt(Ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(Ue.layout_symbol["icon-image"]),"icon-rotate":new Xt(Ue.layout_symbol["icon-rotate"]),"icon-padding":new wt(Ue.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(Ue.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(Ue.layout_symbol["icon-offset"]),"icon-anchor":new Xt(Ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(Ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(Ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(Ue.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(Ue.layout_symbol["text-field"]),"text-font":new Xt(Ue.layout_symbol["text-font"]),"text-size":new Xt(Ue.layout_symbol["text-size"]),"text-max-width":new Xt(Ue.layout_symbol["text-max-width"]),"text-line-height":new Xt(Ue.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(Ue.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(Ue.layout_symbol["text-justify"]),"text-radial-offset":new Xt(Ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(Ue.layout_symbol["text-variable-anchor"]),"text-anchor":new Xt(Ue.layout_symbol["text-anchor"]),"text-max-angle":new wt(Ue.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(Ue.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(Ue.layout_symbol["text-rotate"]),"text-padding":new wt(Ue.layout_symbol["text-padding"]),"text-keep-upright":new wt(Ue.layout_symbol["text-keep-upright"]),"text-transform":new Xt(Ue.layout_symbol["text-transform"]),"text-offset":new Xt(Ue.layout_symbol["text-offset"]),"text-allow-overlap":new wt(Ue.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new wt(Ue.layout_symbol["text-ignore-placement"]),"text-optional":new wt(Ue.layout_symbol["text-optional"]),visibility:new wt(Ue.layout_symbol.visibility)})),paint:VA||(VA=new Ui({"icon-opacity":new Xt(Ue.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Xt(Ue.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Xt(Ue.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Xt(Ue.paint_symbol["text-emissive-strength"]),"icon-color":new Xt(Ue.paint_symbol["icon-color"]),"icon-halo-color":new Xt(Ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(Ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(Ue.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(Ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(Ue.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Xt(Ue.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Xt(Ue.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Xt(Ue.paint_symbol["text-occlusion-opacity"]),"text-color":new Xt(Ue.paint_symbol["text-color"],{runtimeType:ko,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Xt(Ue.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(Ue.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(Ue.paint_symbol["text-halo-blur"]),"text-translate":new wt(Ue.paint_symbol["text-translate"]),"text-translate-anchor":new wt(Ue.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new wt(Ue.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new wt(Ue.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new wt(Ue.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new wt(Ue.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Xt(Ue.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new wt(Ue.paint_symbol["symbol-elevation-reference"])}))},Kw);class fb extends ho{constructor(i,o,u,p){super(i,Yw(),o,u,p),this._colorAdjustmentMatrix=we.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,o){super.recalculate(i,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const h of u)p.indexOf(h)<0&&p.push(h);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,o,u,p){return this._saturation===i&&this._contrast===o&&this._brightnessMin===u&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(h,m,b,S){h=pe(h),m=re(m);const A=we.mat4.create(),y=h/3,w=1-2*y,P=[w,y,y,0,y,w,y,0,y,y,w,0,0,0,0,1],E=.5-.5*m,O=S-b;return we.mat4.multiply(A,[O,0,0,0,0,O,0,0,0,0,O,0,b,b,b,1],[m,0,0,0,0,m,0,0,0,0,m,0,E,E,E,1]),we.mat4.multiply(A,A,P),A}(i,o,u,p),this._saturation=i,this._contrast=o,this._brightnessMin=u,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,o,u,p){const h=this.layout.get(i).evaluate(o,{},u,p),m=this._unevaluatedLayout._values[i];return m.isDataDriven()||Mf(m.value)||!h?h:function(b,S){return S.replace(/{([^{}]+)}/g,(A,y)=>y in b?String(b[y]):"")}(o.properties,h)}createBucket(i){return new db(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of Yw().paint.overridableProperties){if(!fb.hasPaintOverride(this.layout,i))continue;const o=this.paint.get(i),u=new UA(o),p=new Cf(u,o.property.specification,this.scope,this.options);let h=null;h=o.value.kind==="constant"||o.value.kind==="source"?new Wm("source",p):new _a("composite",p,o.value.zoomStops,o.value._interpolationType),this.paint._values[i]=new fu(o.property,h,o.parameters)}}_handleOverridablePaintPropertyUpdate(i,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&fb.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,o){const u=i.get("text-field"),p=Yw().paint.properties[o];let h=!1;const m=b=>{for(const S of b)if(p.overrides&&p.overrides.hasOverride(S))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof uo)m(u.value.value.sections);else if(u.value.kind==="source"){const b=A=>{h||(A instanceof Vs&&bn(A.value)===Wc?m(A.value.sections):A instanceof Yc?m(A.sections):A.eachChild(b))},S=u.value;S._styleExpression&&b(S._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,o,u){return{config:new uc(this,{zoom:o,lut:u}),overrideFog:!1}}}let GA,HA,qA,WA;var Jw=ti([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Qw(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function eT(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class tT{constructor(i,o,u,p){this.context=i,this.format=u,this.useMipmap=p&&p.useMipmap,this.texture=i.gl.createTexture(),this.update(o,{premultiply:p&&p.premultiply})}update(i,o){const u=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,p=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:h}=this,{gl:m}=h,{x:b,y:S}=o&&o.position?o.position:{x:0,y:0},A=Math.max(b+u,this.size?this.size[0]:0),y=Math.max(S+p,this.size?this.size[1]:0);!this.size||this.size[0]===A&&this.size[1]===y||(m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(this.texture),this.texture=m.createTexture(),this.size=null),m.bindTexture(m.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===m.RGBA8&&(!o||o.premultiply!==!1));const w=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&A>0&&y>0){const P=this.useMipmap?Math.floor(Math.log2(Math.max(A,y)))+1:1;m.texStorage2D(m.TEXTURE_2D,P,this.format,A,y),this.size=[A,y]}if(this.size)if(w)m.texSubImage2D(m.TEXTURE_2D,0,b,S,Qw(this.format),eT(this.format),i);else{const P=i.data;P&&m.texSubImage2D(m.TEXTURE_2D,0,b,S,u,p,Qw(this.format),eT(this.format),P)}this.useMipmap&&m.generateMipmap(m.TEXTURE_2D)}bind(i,o,u=!1){const{context:p}=this,{gl:h}=p;h.bindTexture(h.TEXTURE_2D,this.texture),i!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?i===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),o!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(i,o,u,p){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.magFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),this.magFilter=o),i!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?i===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),u!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,u),this.wrapS=u),p!==this.wrapT&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,p),this.wrapT=p)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class pb{constructor(i,o){this.context=i,this.texture=o}bind(i,o){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),i!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,i),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,i),this.minFilter=i),o!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,o),this.wrapS=o)}}function mb(c,i,o,u,p,h,m,b){const S=[c,i,1,o,u,1,p,h,1],A=[m,b,1],y=we.mat3.adjoint([],S),[w,P,E]=we.vec3.transformMat3(A,A,y);return we.mat3.multiply(S,S,[w,0,0,0,P,0,0,0,E])}function ZA(c,i,o,u,p,h,m,b){const S=function(A,y,w,P,E,O,M,R){const z=mb(0,0,1,0,1,1,0,1),V=mb(A,y,w,P,E,O,M,R),G=we.mat3.adjoint([],z);return we.mat3.multiply(V,V,G)}(c,i,o,u,p,h,m,b);return[S[2]/S[8]/It,S[5]/S[8]/It]}function gb(c){return[c[0],Math.min(Math.max(c[1],-ge),ge)]}class XA extends Hc{constructor(i,o,u,p){super(),this.id=i,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=o,this._dirty=!1}load(i,o){if(this._loaded=o||!1,this.fire(new fl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=fa(this.map._requestManager.transformRequest(this.url,Vc.Image),(u,p)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new bh(u)):p&&(this.image=p instanceof HTMLImageElement?zt.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new pb(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new fl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof pb||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=i[0][1],u=i[0][1];for(const h of i)h[1]>u&&(u=h[1]),h[1]<o&&(o=h[1]);const p=(u+o)/2;if(p>ge?this.onNorthPole=!0:p<-ge&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=i.map($e.fromLngLat);this.tileID=function(m){let b=1/0,S=1/0,A=-1/0,y=-1/0;for(const M of m)b=Math.min(b,M.x),S=Math.min(S,M.y),A=Math.max(A,M.x),y=Math.max(y,M.y);const w=Math.max(A-b,y-S),P=Math.max(0,Math.floor(-Math.log(w)/Math.LN2)),E=Math.pow(2,P);let O=Math.floor((b+A)/2*E);return O>1&&(O-=1),new jn(P,O,Math.floor((S+y)/2*E))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new fl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const z in this.tiles){const V=this.tiles[z];V.state!=="loaded"&&(V.state="loaded",V.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Bg(new jn(0,0,0),this.map.transform.projection),u=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(z){const V=z[1].x-z[0].x,G=z[1].y-z[0].y,F=z[2].x-z[1].x,q=z[2].y-z[1].y,W=z[3].x-z[2].x,te=z[3].y-z[2].y,se=z[0].x-z[3].x,le=z[0].y-z[3].y,ne=V*q-F*G,me=F*te-W*q,he=W*le-se*te,_e=se*G-V*le;return ne>0&&me>0&&he>0&&_e>0||ne<0&&me<0&&he<0&&_e<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=Bg(this.tileID,this.map.transform.projection),[h,m,b,S]=this.coordinates.map(z=>{const V=p.projection.project(z[0],z[1]);return BA(p,V)._round()});this.perspectiveTransform=ZA(h.x,h.y,m.x,m.y,b.x,b.y,S.x,S.y);const A=this._boundsArray=new xl;A.emplaceBack(h.x,h.y,0,0),A.emplaceBack(m.x,m.y,It,0),A.emplaceBack(S.x,S.y,0,It),A.emplaceBack(b.x,b.y,It,It),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(A,Jw.members),this.boundsSegments=on.simpleSegment(0,0,4,2);const y=[],w=[gb((P=this.coordinates)[0]),gb(P[1]),gb(P[2]),gb(P[3])];var P;const[E,O,M,R]=function(z){let V=z[0][0],G=V,F=z[0][1],q=F;for(let W=1;W<z.length;W++)z[W][0]<V?V=z[W][0]:z[W][0]>G&&(G=z[W][0]),z[W][1]<F?F=z[W][1]:z[W][1]>q&&(q=z[W][1]);return[V,F,G-V,q-F]}(w);{const z=new xl,[V,G,F,q]=function(Be){let Ge=Be[0].x,Fe=Ge,tt=Be[0].y,ut=tt;for(let Xe=1;Xe<Be.length;Xe++)Be[Xe].x<Ge?Ge=Be[Xe].x:Be[Xe].x>Fe&&(Fe=Be[Xe].x),Be[Xe].y<tt?tt=Be[Xe].y:Be[Xe].y>ut&&(ut=Be[Xe].y);return[Ge,tt,Fe-Ge,ut-tt]}(u),W=Be=>[(Be.x-V)/F,(Be.y-G)/q],[te,se,le,ne]=u.map(W),me=function(Be,Ge,Fe,tt,ut,Xe,Lt,Pt){const bt=mb(0,0,1,0,1,1,0,1),mt=mb(Be,Ge,Fe,tt,ut,Xe,Lt,Pt),Yt=we.mat3.adjoint([],mt);return we.mat3.multiply(bt,bt,Yt)}(te[0],te[1],se[0],se[1],le[0],le[1],ne[0],ne[1]);this.elevatedGlobePerspectiveTransform=ZA(te[0],te[1],se[0],se[1],le[0],le[1],ne[0],ne[1]);const he=(Be,Ge)=>{y.push(Be.lng);const Fe=Math.round((Be.lng-E)/M*It),tt=Math.round((Be.lat-O)/R*It),ut=W(Ge),Xe=we.vec3.transformMat3([],[ut[0],ut[1],1],me),Lt=Math.round(Xe[0]/Xe[2]*It),Pt=Math.round(Xe[1]/Xe[2]*It);z.emplaceBack(Fe,tt,Lt,Pt)},_e=u[3].x-u[0].x,Ae=u[3].y-u[0].y,Me=u[2].x-u[1].x,Re=u[2].y-u[1].y;for(let Be=0;Be<65;Be++){const Ge=Be/64,Fe=[u[0].x+Ge*_e,u[0].y+Ge*Ae],tt=[u[1].x+Ge*Me,u[1].y+Ge*Re],ut=tt[0]-Fe[0],Xe=tt[1]-Fe[1];for(let Lt=0;Lt<65;Lt++){const Pt=Lt/64,bt={x:Fe[0]+ut*Pt,y:Fe[1]+Xe*Pt,z:0};he(o.projection.unproject(bt.x,bt.y),bt)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(z,Jw.members)}{this.maxLongitudeTriangleSize=0;let z=[],V=new Jn;const G=(F,q,W)=>{V.emplaceBack(F,q,W);const te=y[F],se=y[q],le=y[W],ne=Math.min(Math.min(te,se),le),me=Math.max(Math.max(te,se),le)-ne;me>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=me),z.push(ne+me/2)};for(let F=0;F<64;F++)for(let q=0;q<64;q++){const W=65*F+q,te=W+1,se=W+65,le=se+1;G(W,se,te),G(te,se,le)}[z,V]=function(F,q){const W=Array.from({length:F.length},(le,ne)=>ne);W.sort((le,ne)=>F[le]-F[ne]);const te=[],se=new Jn;for(let le=0;le<W.length;le++){const ne=W[le];te.push(F[ne]);const me=3*ne,he=me+1;se.emplaceBack(q.uint16[me],q.uint16[he],q.uint16[he+1])}return[te,se]}(z,V),this.elevatedGlobeTrianglesCenterLongitudes=z,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(V)}this.elevatedGlobeSegments=on.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,M/It,0,R/It,0,0,O,E,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const o=this.map.painter.context,u=o.gl;!this._dirty||this.texture instanceof pb||(this.texture?this.texture.update(this.image):(this.texture=new tT(o,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(o)}loadTile(i,o){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},o(null)):(i.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let p=(h=i+180)+360*Math.round((u[0]-h)/360);var h;const m=new on,b=(w,P)=>{m.segments.push({vertexOffset:0,primitiveOffset:w,vertexLength:o.segments[0].vertexLength,primitiveLength:P,sortKey:void 0,vaos:{}})},S=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-p)<=S){const w=Q(u,0,u.length,p+S);return w===u.length||b(w,qe(u,w+1,u.length,p+360-S)-w),m}p<u[0]&&(p+=360);const A=qe(u,0,u.length,p-S);if(A===u.length)return b(0,u.length),m;b(0,A-0);const y=Q(u,A+1,u.length,p+S);return y!==u.length&&b(y,u.length-y),m}}const AV=(Math.pow(256,2)-1)/16907520;class KA extends ho{constructor(i,o,u,p){super(i,{layout:qA||(qA=new Ui({visibility:new wt(Ue.layout_raster.visibility)})),paint:WA||(WA=new Ui({"raster-opacity":new wt(Ue.paint_raster["raster-opacity"]),"raster-color":new Gs(Ue.paint_raster["raster-color"]),"raster-color-mix":new wt(Ue.paint_raster["raster-color-mix"]),"raster-color-range":new wt(Ue.paint_raster["raster-color-range"]),"raster-hue-rotate":new wt(Ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(Ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(Ue.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(Ue.paint_raster["raster-saturation"]),"raster-contrast":new wt(Ue.paint_raster["raster-contrast"]),"raster-resampling":new wt(Ue.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(Ue.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new wt(Ue.paint_raster["raster-emissive-strength"]),"raster-array-band":new wt(Ue.paint_raster["raster-array-band"]),"raster-elevation":new wt(Ue.paint_raster["raster-elevation"])}))},o,u,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof XA&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[u,p]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(p)||u===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=bg({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,p])}}let YA,JA,QA,eC,tC;class rC extends ho{constructor(i,o,u,p){super(i,{layout:YA||(YA=new Ui({visibility:new wt(Ue["layout_raster-particle"].visibility)})),paint:JA||(JA=new Ui({"raster-particle-array-band":new wt(Ue["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new wt(Ue["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Gs(Ue["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new wt(Ue["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new wt(Ue["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new wt(Ue["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new wt(Ue["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new wt(Ue["paint_raster-particle"]["raster-particle-elevation"])}))},o,u,p),this._updateColorRamp(),this.lastInvalidatedAt=zt.now()}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=bg({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=zt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class CV extends ho{constructor(i,o){super(i,{},o,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function rT(c,i,o){const u=[0,0,1],p=we.quat.identity([]);return we.quat.rotateY(p,p,o?-Mt(c)+Math.PI:Mt(c)),we.quat.rotateX(p,p,-Mt(i)),we.vec3.transformQuat(u,u,p),we.vec3.normalize(u,u)}function iC(c,i){const o=_b(c.projection,c.zoom,c.width,c.height),u=function(h,m,b,S,A){const y=new U(b.lng-180*Iu,b.lat),w=new U(b.lng+180*Iu,b.lat),P=h.project(y.lng,y.lat),E=h.project(w.lng,w.lat),O=-Math.atan2(E.y-P.y,E.x-P.x),M=$e.fromLngLat(b);M.y=Dt(M.y,-1+Iu,1-Iu);const R=M.toLngLat(),z=h.project(R.lng,R.lat),V=$e.fromLngLat(R);V.x+=Iu;const G=V.toLngLat(),F=h.project(G.lng,G.lat),q=oC(F.x-z.x,F.y-z.y,O),W=$e.fromLngLat(R);W.y+=Iu;const te=W.toLngLat(),se=h.project(te.lng,te.lat),le=oC(se.x-z.x,se.y-z.y,O),ne=Math.abs(q.x)/Math.abs(le.y),me=we.mat4.identity([]);we.mat4.rotateZ(me,me,-O*(1-(A?0:S)));const he=we.mat4.identity([]);return we.mat4.scale(he,he,[1,1-(1-ne)*S,1]),he[4]=-le.x/le.y*S,we.mat4.rotateZ(he,he,O),we.mat4.multiply(he,me,he),he}(c.projection,0,c.center,o,i),p=nC(c);return we.mat4.scale(u,u,[p,p,1]),u}function nC(c){const i=c.projection,o=_b(c.projection,c.zoom,c.width,c.height),u=iT(i,c.center),p=iT(i,U.convert(i.center));return Math.pow(2,u*o+(1-o)*p)}function _b(c,i,o,u,p=1/0){const h=c.range;if(!h)return 0;const m=Math.min(p,Math.max(o,u)),b=Math.log(m/1024)/Math.LN2;return zr(h[0]+b,h[1]+b,i)}const Iu=1/4e4;function iT(c,i){const o=Dt(i.lat,-ge,ge),u=new U(i.lng-180*Iu,o),p=new U(i.lng+180*Iu,o),h=c.project(u.lng,o),m=c.project(p.lng,o),b=$e.fromLngLat(u),S=$e.fromLngLat(p),A=m.x-h.x,y=m.y-h.y,w=S.x-b.x,P=S.y-b.y,E=Math.sqrt((w*w+P*P)/(A*A+y*y));return Math.log(E)/Math.LN2}function oC(c,i,o){const u=Math.cos(o),p=Math.sin(o);return{x:c*u-i*p,y:c*p+i*u}}function sC(c,i,o){we.mat4.identity(c),we.mat4.rotateZ(c,c,Mt(i[2])),we.mat4.rotateX(c,c,Mt(i[0])),we.mat4.rotateY(c,c,Mt(i[1])),we.mat4.scale(c,c,o),we.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function yb(c,i,o,u,p,h,m,b){const S=[o[0]-i[0],o[1]-i[1],0],A=[u[0]-i[0],u[1]-i[1],0];if(we.vec3.length(S)<1e-12||we.vec3.length(A)<1e-12)return we.quat.identity(c);const y=we.vec3.cross([],S,A);we.vec3.normalize(y,y),we.vec3.subtract(A,u,i),S[2]=(h-p)*b,A[2]=(m-p)*b;const w=S;return we.vec3.cross(w,S,A),we.vec3.normalize(w,w),we.quat.rotationTo(c,y,w)}function nT(c,i,o=!1){const u=Su(i.zoom),p=function(h,m,b){const S=m.worldSize,A=[h[12],h[13],h[14]],y=de(A[1]/S),w=fe(A[0]/S),P=we.mat4.identity([]),E=oe(1,y)*S,O=oe(1,0)*S*Ce(y,m.zoom),M=1/yw(S);let R=O*M;if(b){const F=_b(m.projection,m.zoom,m.width,m.height,1024);R=M*m.projection.pixelSpaceConversion(m.center.lat,S,F)}const z=B(y,w);we.vec3.add(z,z,we.vec3.scale([],we.vec3.normalize([],z),E*R*A[2]));const V=function(F){const q=[F[0],F[1],F[2]];let W=[0,1,0];const te=we.vec3.cross([],W,q);return we.vec3.cross(W,q,te),we.vec3.squaredLength(W)===0&&(W=[0,1,0],we.vec3.cross(te,q,W)),we.vec3.normalize(te,te),we.vec3.normalize(W,W),we.vec3.normalize(q,q),[te[0],te[1],te[2],0,W[0],W[1],W[2],0,q[0],q[1],q[2],0,F[0],F[1],F[2],1]}(z);we.mat4.scale(P,P,[R,R,R*E]),we.mat4.translate(P,P,[-A[0],-A[1],-A[2]]);const G=we.mat4.multiply([],m.globeMatrix,V);return we.mat4.multiply(G,G,P),we.mat4.multiply(G,G,h),G}(c,i,o);if(u>0){const h=function(m,b){const S=b.worldSize,A=oe(1,0)*S*Ce(b.center.lat,b.zoom)/yw(S),y=oe(1,b.center.lat)*S,w=we.mat4.identity([]);return we.mat4.rotateY(w,w,Mt(b.center.lng)),we.mat4.rotateX(w,w,Mt(b.center.lat)),we.mat4.translate(w,w,[0,0,n]),we.mat4.scale(w,w,[A,A,A*y]),we.mat4.translate(w,w,[b.point.x-.5*S,b.point.y-.5*S,0]),we.mat4.multiply(w,w,m),we.mat4.multiply(w,b.globeMatrix,w)}(c,i);return function(m,b,S){const A=(O,M,R)=>{const z=we.vec3.length(O),V=we.vec3.length(M),G=dc(O,M,R);return we.vec3.scale(G,G,1/we.vec3.length(G)*nr(z,V,R))},y=A([m[0],m[1],m[2]],[b[0],b[1],b[2]],S),w=A([m[4],m[5],m[6]],[b[4],b[5],b[6]],S),P=A([m[8],m[9],m[10]],[b[8],b[9],b[10]],S),E=dc([m[12],m[13],m[14]],[b[12],b[13],b[14]],S);return[y[0],y[1],y[2],0,w[0],w[1],w[2],0,P[0],P[1],P[2],0,E[0],E[1],E[2],1]}(p,h,u)}return p}function aC(c,i,o,u){const p=Di.projectAabbCorners(u,o);let h=Number.MAX_VALUE,m=-1;for(let A=0;A<p.length;++A){const y=p[A];y[0]=(.5*y[0]+.5)*i.width,y[1]=(.5-.5*y[1])*i.height,y[2]<h&&(m=A,h=y[2])}const b=A=>new ze(p[A][0],p[A][1]);let S;switch(m){case 0:case 6:S=[b(1),b(5),b(4),b(7),b(3),b(2),b(1)];break;case 1:case 7:S=[b(0),b(4),b(5),b(6),b(2),b(3),b(0)];break;case 3:case 5:S=[b(1),b(0),b(4),b(7),b(6),b(2),b(1)];break;default:S=[b(1),b(5),b(6),b(7),b(3),b(0),b(1)]}if(Ot(c,S))return h}const MV=ti([{name:"a_pos_3f",components:3,type:"Float32"}]),IV=ti([{name:"a_color_3f",components:3,type:"Float32"}]),DV=ti([{name:"a_color_4f",components:4,type:"Float32"}]),RV=ti([{name:"a_uv_2f",components:2,type:"Float32"}]),LV=ti([{name:"a_normal_3f",components:3,type:"Float32"}]),BV=ti([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),kV=ti([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),lC={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class vb{constructor(i,o,u,p){this.message=(i?`${i}: `:"")+u,p&&(this.identifier=p),o!=null&&o.__line__&&(this.line=o.__line__)}}function cC(c,i){const o=c.indexOf("://")===-1;try{return new URL(c,o&&i?"http://example.com":void 0),!0}catch{return!1}}class uC{constructor(i,o){this.feature=i,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class hC{constructor(){this.instancedDataArray=new Hh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class oT{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=i.projection,this.index=i.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(i,o){}populate(i,o,u,p){this.tileToMeter=Te(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:m,id:b,index:S,sourceLayerIndex:A}of i){const y=b!=null?b:m.properties&&m.properties.hasOwnProperty("id")?m.properties.id:void 0,w=xt(m,h);if(!this.layers[0]._featureFilter.filter(new nn(this.zoom),w,u))continue;const P={id:y,sourceLayerIndex:A,index:S,geometry:h?w.geometry:vt(m,u,p),properties:m.properties,type:m.type,patterns:{}},E=this.addFeature(P,P.geometry,w);E&&o.featureIndex.insert(m,P.geometry,S,A,this.index,this.instancesPerModel[E].instancedDataArray.length,It/32)}this.lookup=null}update(i,o,u,p){for(const h in this.instancesPerModel){const m=this.instancesPerModel[h];for(const b in i)m.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(m.features[m.idToFeaturesIndex[b]],i[b],m,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];for(const p of u.features){const h=this.layers[0],m=p.feature,b=this.canonical,S=h.paint.get("model-rotation").evaluate(m,{},b),A=h.paint.get("model-scale").evaluate(m,{},b),y=h.paint.get("model-translation").evaluate(m,{},b);we.vec3.exactEquals(p.rotation,S)&&we.vec3.exactEquals(p.scale,A)&&we.vec3.exactEquals(p.translation,y)||(this.evaluate(p,p.featureStates,u,!0),i=!0)}}return i}updateReplacement(i,o,u,p){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(Iw(this.activeReplacements,h))return!1;this.activeReplacements=h;let m=!1;for(const b in this.instancesPerModel){const S=this.instancesPerModel[b],A=S.instancedDataArray;for(const y of S.features){const w=y.instancedDataOffset,P=y.instancedDataCount;for(let E=0;E<P;E++){const O=16*(E+w);let M=A.float32[O+0];const R=M>It;M=R?M-It:M;const z=Math.floor(M),V=A.float32[O+1];let G=!1;for(const F of this.activeReplacements)if(!O2(F,u,lC.Model,p)&&!(F.min.x>z||z>F.max.x||F.min.y>V||V>F.max.y)&&(G=D2(I2(z,V,i.canonical,F.footprintTileId.canonical),F.footprint),G))break;A.float32[O]=G?M+It:M,m=m||G!==R}}}return m}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=i.createVertexBuffer(u.instancedDataArray,BV.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris)for(const o of this.modelUris)i.removeModel(o,"")}addFeature(i,o,u){const p=this.layers[0],h=p.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return Jr(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),h;cC(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new hC);const m=this.instancesPerModel[h],b=m.instancedDataArray,S=new uC(u,b.length);for(const A of o)for(const y of A){if(y.x<0||y.x>=It||y.y<0||y.y>=It)continue;const w=(this.lookupDim-1)/It,P=this.lookupDim*(y.y*w|0)+y.x*w|0;if(this.lookup){if(this.lookup[P]!==0)continue;this.lookup[P]=1}this.instanceCount++;const E=b.length;b.resize(E+1),m.instancesEvaluatedElevation.push(0),b.float32[16*E]=y.x,b.float32[16*E+1]=y.y}return S.instancedDataCount=m.instancedDataArray.length-S.instancedDataOffset,S.instancedDataCount>0&&(i.id&&(m.idToFeaturesIndex[i.id]=m.features.length),m.features.push(S),this.evaluate(S,{},m,!1)),h}getModelUris(){return this.modelUris}evaluate(i,o,u,p){const h=this.layers[0],m=i.feature,b=this.canonical,S=i.rotation=h.paint.get("model-rotation").evaluate(m,o,b),A=i.scale=h.paint.get("model-scale").evaluate(m,o,b),y=i.translation=h.paint.get("model-translation").evaluate(m,o,b),w=h.paint.get("model-color").evaluate(m,o,b);w.a=h.paint.get("model-color-mix-intensity").evaluate(m,o,b);const P=[];this.maxVerticalOffset<y[2]&&(this.maxVerticalOffset=y[2]),this.maxScale=Math.max(Math.max(this.maxScale,A[0]),Math.max(A[1],A[2])),sC(P,S,A);const E=Math.round(100*w.a)+w.b/1.05;for(let O=0;O<i.instancedDataCount;++O){const M=i.instancedDataOffset+O,R=16*M,z=u.instancedDataArray.float32;let V=0;p&&(V=z[R+6]-u.instancesEvaluatedElevation[M]);const G=0|z[R+1];z[R]=(0|z[R])+w.r/1.05,z[R+1]=G+w.g/1.05,z[R+2]=E,z[R+3]=1/(b.z>10?this.tileToMeter:Te(b,G)),z[R+4]=y[0],z[R+5]=y[1],z[R+6]=y[2]+V,z[R+7]=P[0],z[R+8]=P[1],z[R+9]=P[2],z[R+10]=P[4],z[R+11]=P[5],z[R+12]=P[6],z[R+13]=P[8],z[R+14]=P[9],z[R+15]=P[10],u.instancesEvaluatedElevation[M]=y[2]}}}let dC,fC;jt(oT,"ModelBucket",{omit:["layers"]}),jt(hC,"PerModelAttributes"),jt(uC,"ModelFeature");const Jh=64,ap={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function pC(c,i,o,u,p,h,m,b,S,A=!1){const y=o.zoom,w=o.project(u),P=Ce(u.lat,y),E=1/P;we.mat4.identity(c),we.mat4.translate(c,c,[w.x+m[0]*E,w.y+m[1]*E,m[2]]);let O=1,M=1;const R=o.worldSize;if(A){if(o.projection.name==="mercator"){let F=0;o.elevation&&(F=o.elevation.getAtPointOrZero(new $e(w.x/R,w.y/R),0));const q=we.vec4.transformMat4([],[w.x,w.y,F,1],o.projMatrix)[3]/o.cameraToCenterDistance;O=q,M=q*Ce(o.center.lat,y)}else if(o.projection.name==="globe"){const F=nT(c,o),q=we.mat4.multiply([],o.projMatrix,F),W=[0,0,0,1];we.vec4.transformMat4(W,W,q);const te=W[3]/o.cameraToCenterDistance,se=Su(y),le=o.projection.pixelsPerMeter(u.lat,R)*Ce(u.lat,y),ne=o.projection.pixelsPerMeter(o.center.lat,R)*Ce(o.center.lat,y);O=te/nr(le,ve(o.center.lat),se),M=te*P/le,O*=ne,M*=ne}}else O=E;we.mat4.scale(c,c,[O,O,M]);const z=[...c],V=i.orientation,G=[];if(sC(G,[V[0]+p[0],V[1]+p[1],V[2]+p[2]],h),we.mat4.multiply(c,z,G),b&&o.elevation){let F=0;const q=[];if(S&&o.elevation){F=function(se,le,ne,me,he){const _e=le.elevation;if(!_e)return 0;const Ae=Di.projectAabbCorners(ne,me),Me=oe(1,he.lat)*le.worldSize,Re=function(Yt,Rt){const $t=[0,0,1],cr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Cr of cr){const Tr=Yt[Cr.corners[0]],Er=Yt[Cr.corners[1]],Rr=Yt[Cr.corners[2]],Br=[Er[0]-Tr[0],Er[1]-Tr[1],Rt*(Er[2]-Tr[2])],Ti=we.vec3.cross(Br,Br,[Rr[0]-Tr[0],Rr[1]-Tr[1],Rt*(Rr[2]-Tr[2])]);we.vec3.normalize(Ti,Ti),Cr.dotProductWithUp=we.vec3.dot(Ti,$t)}return cr.sort((Cr,Tr)=>Cr.dotProductWithUp-Tr.dotProductWithUp),cr[0].corners}(Ae,Me),Be=Ae[Re[0]],Ge=Ae[Re[1]],Fe=Ae[Re[2]],tt=Ae[Re[3]],ut=_e.getAtPointOrZero(new $e(Be[0]/le.worldSize,Be[1]/le.worldSize),0),Xe=_e.getAtPointOrZero(new $e(Ge[0]/le.worldSize,Ge[1]/le.worldSize),0),Lt=_e.getAtPointOrZero(new $e(Fe[0]/le.worldSize,Fe[1]/le.worldSize),0),Pt=_e.getAtPointOrZero(new $e(tt[0]/le.worldSize,tt[1]/le.worldSize),0),bt=(ut+Pt)/2,mt=(Xe+Lt)/2;return bt>mt?Xe<Lt?yb(se,Ge,tt,Be,Xe,Pt,ut,Me):yb(se,Fe,Be,tt,Lt,ut,Pt,Me):ut<Pt?yb(se,Be,Ge,Fe,ut,Xe,Lt,Me):yb(se,tt,Fe,Ge,Pt,Lt,Xe,Me),Math.max(bt,mt)}(q,o,i.aabb,c,u);const W=we.mat4.fromQuat([],q),te=we.mat4.multiply([],W,G);we.mat4.multiply(c,z,te)}else F=o.elevation.getAtPointOrZero(new $e(w.x/R,w.y/R),0);F!==0&&(c[14]+=F)}}function $g(c,i,o=!1){c.uploaded||(c.gfxTexture=new tT(i,c.image,o?i.gl.R8:i.gl.RGBA8,{useMipmap:c.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function zV(c,i,o){c.indexBuffer=i.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=i.createVertexBuffer(c.vertexArray,MV.members,!1,!0),c.normalArray&&(c.normalBuffer=i.createVertexBuffer(c.normalArray,LV.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=i.createVertexBuffer(c.texcoordArray,RV.members,!1,!0)),c.colorArray&&(c.colorBuffer=i.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?IV:DV).members,!1,!0)),c.featureArray&&(c.pbrBuffer=i.createVertexBuffer(c.featureArray,kV.members,!0)),c.segments=on.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&$g(u.pbrMetallicRoughness.baseColorTexture,i),u.pbrMetallicRoughness.metallicRoughnessTexture&&$g(u.pbrMetallicRoughness.metallicRoughnessTexture,i),u.normalTexture&&$g(u.normalTexture,i),u.occlusionTexture&&$g(u.occlusionTexture,i,o),u.emissionTexture&&$g(u.emissionTexture,i)}function sT(c,i,o){if(c.meshes)for(const u of c.meshes)zV(u,i,o);if(c.children)for(const u of c.children)sT(u,i,o)}function bb(c){if(c.meshes)for(const i of c.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(c.children)for(const i of c.children)bb(i)}function aT(c){if(c.meshes)for(const o of c.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((i=o.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(c.children)for(const o of c.children)aT(o)}class lp{constructor(i,o,u){this._demTile=i,this._dem=this._demTile.dem,this._scale=o,this._offset=u}static create(i,o,u){const p=u||i.findDEMTileFor(o);if(!p||!p.dem)return;const h=p.dem,m=p.tileID,b=1<<o.canonical.z-m.canonical.z;return new lp(p,h.dim/It/b,[(o.canonical.x/b-m.canonical.x)*h.dim,(o.canonical.y/b-m.canonical.y)*h.dim])}tileCoordToPixel(i,o){const u=o*this._scale+this._offset[1],p=Math.floor(i*this._scale+this._offset[0]),h=Math.floor(u);return new ze(p,h)}getElevationAt(i,o,u,p){const h=i*this._scale+this._offset[0],m=o*this._scale+this._offset[1],b=Math.floor(h),S=Math.floor(m),A=this._dem;return p=!!p,u?nr(nr(A.get(b,S,p),A.get(b,S+1,p),m-S),nr(A.get(b+1,S,p),A.get(b+1,S+1,p),m-S),h-b):A.get(b,S,p)}getElevationAtPixel(i,o,u){return this._dem.get(i,o,!!u)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*oe(1,i)*this._dem.stride}}const lT=new Float32Array(262144),Qh=new Uint8Array(262144);function mC(c){let i=0;if(c.meshes)for(const o of c.meshes)i=Math.max(i,o.aabb.max[2]);if(c.children)for(const o of c.children)i=Math.max(i,mC(o));return i}function gC(c,i,o){if(c.meshes)for(const u of c.meshes)u.aabb.min[0]!==1/0&&o.insert(i,u.aabb.min[0],u.aabb.min[1],u.aabb.max[0],u.aabb.max[1]);if(c.children)for(const u of c.children)gC(u,i,o)}const _C=["","wall","door","roof","window","lamp","logo"];class yC{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:mC(i)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const o=new Di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==i&&(u.transformedAabb=Di.applyTransformFast(u.aabb,this.node.matrix),o.encapsulate(u.transformedAabb)),i++;this.aabb=o}return this.aabb}}class xb{constructor(i,o,u,p,h,m){this.id=o,this.modelTraits|=ap.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,u&&(this.modelTraits|=ap.HasMapboxMeshFeatures),p&&(this.modelTraits|=ap.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=h,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const b of i)this.nodesInfo.push(new yC(b)),gC(b,m.featureIndexArray.length,m.grid),m.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,m.bucketLayerIDs.length-1,0)}updateFootprints(i,o){for(const u of this.getNodesInfo()){const p=u.node;p.footprint&&o.push({footprint:p.footprint,id:i})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const u of o){const p=u.node;this.uploaded?this.updatePbrBuffer(p):sT(p,i,!0)}for(const u of o)bb(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let o=!1;if(!i.meshes)return o;for(const u of i.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),o=!0);return o}needsReEvaluation(i,o,u){const p=i.transform.projectionOptions,h=i.style.getBrightness(),m=this.brightness!==h;return!!(!this.uploaded||this.dirty||p.name!==this.projection.name||jg(u.paint.get("model-color").value,m)||jg(u.paint.get("model-color-mix-intensity").value,m)||jg(u.paint.get("model-roughness").value,m)||jg(u.paint.get("model-emissive-strength").value,m)||jg(u.paint.get("model-height-based-emissive-strength-multiplier").value,m))&&(this.projection=p,this.brightness=h,!0)}evaluateScale(i,o){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const u=this.getNodesInfo(),p=this.id.canonical;for(const h of u){const m=h.feature;h.evaluatedScale=o.paint.get("model-scale").evaluate(m,{},p)}}evaluate(i){const o=this.getNodesInfo();for(const u of o){if(!u.node.meshes)continue;const p=u.feature,h=u.node.meshes&&u.node.meshes[0].featureData,m=u.evaluatedColor[2],b=u.evaluatedRMEA[2],S=this.id.canonical;if(u.hasTranslucentParts=!1,h){for(let A=0;A<_C.length;A++){const y=_C[A];y.length&&(p.properties.part=y);const w=i.paint.get("model-color").evaluate(p,{},S).toRenderColor(null),P=i.paint.get("model-color-mix-intensity").evaluate(p,{},S);u.evaluatedColor[A]=[w.r,w.g,w.b,P],u.evaluatedRMEA[A][0]=i.paint.get("model-roughness").evaluate(p,{},S),u.evaluatedRMEA[A][2]=i.paint.get("model-emissive-strength").evaluate(p,{},S),u.evaluatedRMEA[A][3]=w.a,u.emissionHeightBasedParams[A]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(p,{},S),!u.hasTranslucentParts&&w.a<1&&(u.hasTranslucentParts=!0)}delete p.properties.part,NV(u,m!==u.evaluatedColor[2]||b!==u.evaluatedRMEA[2],this.modelTraits)}else u.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(p,{},S);u.evaluatedScale=i.paint.get("model-scale").evaluate(p,{},S),this.updatePbrBuffer(u.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,o,u,p){const h=i.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const m=lp.create(i,u,h);if(!m)return;this.modelTraits&ap.HasMapboxMeshFeatures&&this.updateDEM(i,m,u,p);for(const b of this.getNodesInfo()){const S=b.node;if(!S.footprint||!S.footprint.vertices||!S.footprint.vertices.length)continue;const A=S.footprint.vertices;let y=m.getElevationAt(A[0].x,A[0].y,!0,!0);for(let w=1;w<A.length;w++)y=Math.min(y,m.getElevationAt(A[w].x,A[w].y,!0,!0));S.elevation=y}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=o}}updateDEM(i,o,u,p){let h=o._dem._modifiedForSources[p];if(h===void 0&&(o._dem._modifiedForSources[p]=[],h=o._dem._modifiedForSources[p]),h.includes(u.canonical))return;const m=o._dem.dim;h.push(u.canonical);let b=!1;for(const S of this.getNodesInfo()){const A=S.node;if(!A.footprint||!A.footprint.grid)continue;const y=A.footprint.grid,w=o.tileCoordToPixel(y.min.x,y.min.y),P=o.tileCoordToPixel(y.max.x,y.max.y),E=Math.min(Math.min(m-P.y,w.x),Math.min(w.y,m-P.x));if(E<0)continue;const O=Dt(E,2,5);let M=Math.max(0,w.x-O),R=Math.max(0,w.y-O),z=Math.min(P.x+O,m-1),V=Math.min(P.y+O,m-1);for(let W=R;W<=V;++W)for(let te=M;te<=z;++te)Qh[W*m+te]=255;let G=0,F=0;for(let W=0;W<y.cellsY;++W)for(let te=0;te<y.cellsX;++te){if(!y.cells[W*y.cellsX+te])continue;const se=o.tileCoordToPixel(y.min.x+te/y.xScale,y.min.y+W/y.yScale),le=o.tileCoordToPixel(y.min.x+(te+1)/y.xScale,y.min.y+(W+1)/y.yScale);for(let ne=se.y;ne<=Math.min(le.y+1,m-1);++ne)for(let me=se.x;me<=Math.min(le.x+1,m-1);++me)Qh[ne*m+me]===255&&(Qh[ne*m+me]=0,G+=o.getElevationAtPixel(me,ne),F++)}const q=G/F;M=Math.max(1,w.x-O),R=Math.max(1,w.y-O),z=Math.min(P.x+O,m-2),V=Math.min(P.y+O,m-2),b=!0;for(let W=R;W<=V;++W)for(let te=M;te<=z;++te)Qh[W*m+te]===0&&(lT[W*m+te]=o._dem.set(te,W,q));for(let W=1;W<O;++W){M=Math.max(1,w.x-W),R=Math.max(1,w.y-W),z=Math.min(P.x+W,m-2),V=Math.min(P.y+W,m-2);for(let te=R;te<=V;++te)for(let se=M;se<=z;++se){const le=te*m+se;if(Qh[le]===255){let ne=0,me=0,he=-1,_e=-1;for(let Ae=-1;Ae<=1;++Ae)for(let Me=-1;Me<=1;++Me){const Re=(te+Ae)*m+se+Me;if(Qh[Re]>=W)continue;const Be=lT[Re],Ge=Math.abs(Be);Ge>me&&(ne=Be,me=Ge,he=Me,_e=Ae)}if(me>.1){const Ae=1-(W+.5*Math.abs(he*_e))/O;let Me=o._dem.get(se,te)+ne*Ae;const Re=o._dem.get(se+he,te+_e),Be=o._dem.get(se-he,te-_e,!0);(Me-Re)*(Me-Be)>0&&(Me=(Re+Be)/2),lT[le]=o._dem.set(se,te,Me),Qh[le]=W}}}}}b&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=zt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const o of i)bb(o.node),aT(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(i.toUnwrapped()),p=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const m=p[h].node;p[h].hiddenByReplacement=!!m.footprint&&!u.find(b=>b.footprint===m.footprint)}}getHeightAtTileCoord(i,o){const u=this.getNodesInfo(),p=[],h=[0,0,0],m=we.mat4.identity([]);for(let b=0;b<this.nodesInfo.length;b++){const S=u[b],A=S.node.meshes[0],y=A.transformedAabb;if(i<y.min[0]||o<y.min[1]||i>y.max[0]||o>y.max[1])continue;if(S.node.hidden===!0)return{height:1/0,maxHeight:S.feature.properties.height,hidden:!1,verticalScale:S.evaluatedScale[2]};we.mat4.invert(m,S.node.matrix),h[0]=i,h[1]=o,we.vec3.transformMat4(h,h,m);const w=(h[0]-A.aabb.min[0])/(A.aabb.max[0]-A.aabb.min[0])*Jh|0,P=Math.min(63,(h[1]-A.aabb.min[1])/(A.aabb.max[1]-A.aabb.min[1])*Jh|0)*Jh+Math.min(63,w),E=A.heightmap[P];if(!(E<0&&S.node.footprint))return S.hiddenByReplacement?void 0:{height:E,maxHeight:S.feature.properties.height,hidden:!1,verticalScale:S.evaluatedScale[2]};if(S.node.footprint.grid.query(new ze(i,o),new ze(i,o),p),p.length>0)return{height:void 0,maxHeight:S.feature.properties.height,hidden:S.hiddenByReplacement,verticalScale:S.evaluatedScale[2]}}}}function jg(c,i){return!c.isLightConstant&&i}function FV(c,i,o,u,p,h,m,b){let S=(61440&i|(61440&i)>>4)>>8,A=(3840&i|(3840&i)>>4)>>4,y=240&i|(240&i)>>4;o[3]>0&&(S=nr(S,255*o[0],o[3]),A=nr(A,255*o[1],o[3]),y=nr(y,255*o[2],o[3]));const w=S<<8|A,P=y<<8|Math.floor(255*u[3]),E=function(W){const te=Dt(W,0,2);return Math.min(Math.round(.5*te*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],O=Dt(p[0],0,1),M=Dt(p[1],0,1),R=Dt(p[2],0,1),z=Dt(p[3],0,1);let V,G,F,q;if(O!==M&&m!==h&&M!==O){const W=m-h;G=1/(W*(M-O)),F=-(h+W*O)/(W*(M-O));const te=Dt(p[4],-1,1);q=Math.pow(10,te),V=255*R<<8|255*z}else V=65535,G=0,F=1,q=1;if(c.emplaceBack(w,P,E,V,G,F,q),b){const W=b.length;b.clear();for(let te=0;te<W;te++)b.emplaceBack(w,P,E,V,G,F,q)}}function NV(c,i,o){const u=c.node;let p=0;const h=o&ap.HasMeshoptCompression;for(const m of u.meshes){if(u.lights&&u.lightMeshIndex===p||!m.featureData)continue;m.featureArray=new qf,m.featureArray.reserve(m.featureData.length);let b=i;for(const S of m.featureData){const A=h?65535&S:S>>16&65535,y=h?S>>16&65535:65535&S,w=(15&y)<8?15&y:0,P=c.evaluatedRMEA[w],E=c.evaluatedColor[w],O=c.emissionHeightBasedParams[w];let M;if(b&&w===2&&u.lights&&(M=new qf,M.resize(10*u.lights.length)),FV(m.featureArray,A,E,P,O,m.aabb.min[2],m.aabb.max[2],M),M&&b){b=!1;const R=u.meshes[u.lightMeshIndex];R.featureArray=M,R.featureArray._trim()}}m.featureArray._trim(),p++}}function vC(c,i,o,u){const p=1<<c.z;i.lat=de((u/It+c.y)/p),i.lng=fe((o/It+c.x)/p)}jt(xb,"Tiled3dModelBucket",{omit:["layers"]}),jt(yC,"Tiled3dModelFeature");const $V={circle:class extends ho{constructor(c,i,o,u){super(c,{layout:ci||(ci=new Ui({"circle-sort-key":new Xt(Ue.layout_circle["circle-sort-key"]),visibility:new wt(Ue.layout_circle.visibility)})),paint:sn||(sn=new Ui({"circle-radius":new Xt(Ue.paint_circle["circle-radius"]),"circle-color":new Xt(Ue.paint_circle["circle-color"]),"circle-blur":new Xt(Ue.paint_circle["circle-blur"]),"circle-opacity":new Xt(Ue.paint_circle["circle-opacity"]),"circle-translate":new wt(Ue.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(Ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(Ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(Ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(Ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(Ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(Ue.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new wt(Ue.paint_circle["circle-emissive-strength"])}))},i,o,u)}createBucket(c){return new Kt(c)}queryRadius(c){const i=c;return Gi("circle-radius",this,i)+Gi("circle-stroke-width",this,i)+mi(this.paint.get("circle-translate"))}queryIntersectsFeature(c,i,o,u,p,h,m,b){const S=ri(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o);return YP(c,u,h,m,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,A)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,i,o){const u=KP(this);return{config:new uc(this,{zoom:i,lut:o}),defines:u,overrideFog:!1}}},heatmap:class extends ho{createBucket(c){return new QP(c)}constructor(c,i,o,u){super(c,{layout:e2||(e2=new Ui({visibility:new wt(Ue.layout_heatmap.visibility)})),paint:t2||(t2=new Ui({"heatmap-radius":new Xt(Ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(Ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(Ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Gs(Ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(Ue.paint_heatmap["heatmap-opacity"])}))},i,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=bg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Gi("heatmap-radius",this,c)}queryIntersectsFeature(c,i,o,u,p,h,m,b){const S=this.paint.get("heatmap-radius").evaluate(i,o);return YP(c,u,h,m,b,!0,!0,new ze(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,i,o){return c==="heatmap"?{config:new uc(this,{zoom:i,lut:o}),overrideFog:!1}:{}}},hillshade:class extends ho{constructor(c,i,o,u){super(c,{layout:r2||(r2=new Ui({visibility:new wt(Ue.layout_hillshade.visibility)})),paint:i2||(i2=new Ui({"hillshade-illumination-direction":new wt(Ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(Ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(Ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(Ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(Ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(Ue.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new wt(Ue.paint_hillshade["hillshade-emissive-strength"])}))},i,o,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,i,o){return{overrideFog:!1}}},fill:class extends ho{constructor(c,i,o,u){super(c,{layout:h2||(h2=new Ui({"fill-sort-key":new Xt(Ue.layout_fill["fill-sort-key"]),visibility:new wt(Ue.layout_fill.visibility)})),paint:d2||(d2=new Ui({"fill-antialias":new wt(Ue.paint_fill["fill-antialias"]),"fill-opacity":new Xt(Ue.paint_fill["fill-opacity"]),"fill-color":new Xt(Ue.paint_fill["fill-color"]),"fill-outline-color":new Xt(Ue.paint_fill["fill-outline-color"]),"fill-translate":new wt(Ue.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(Ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xt(Ue.paint_fill["fill-pattern"]),"fill-emissive-strength":new wt(Ue.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Xt(Ue.paint_fill["fill-z-offset"])}))},i,o,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),i=c&&c.constantOr(1),o=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(c,i,o){return{config:new uc(this,{zoom:i,lut:o}),overrideFog:!1}}recalculate(c,i){super.recalculate(c,i);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new Sw(c)}queryRadius(){return mi(this.paint.get("fill-translate"))}queryIntersectsFeature(c,i,o,u,p,h){return!c.queryGeometry.isAboveHorizon&&sr(Ar(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends ho{constructor(c,i,o,u){super(c,{layout:W2||(W2=new Ui({visibility:new wt(Ue["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new wt(Ue["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:Z2||(Z2=new Ui({"fill-extrusion-opacity":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Xt(Ue["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new wt(Ue["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},i,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new Jv(c)}queryRadius(){return mi(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,i,o,u,p,h,m,b,S){const A=ri(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),y=this.paint.get("fill-extrusion-height").evaluate(i,o),w=this.paint.get("fill-extrusion-base").evaluate(i,o),P=[0,0],E=b&&h.elevation,O=h.elevation?h.elevation.exaggeration():1,M=c.tile.getBucket(this);if(E&&M instanceof Jv){const F=M.centroidVertexArray,q=S+1;q<F.length&&(P[0]=F.geta_centroid_pos0(q),P[1]=F.geta_centroid_pos1(q))}if(P[0]===0&&P[1]===1)return!1;h.projection.name==="globe"&&(u=q2([u],[new ze(0,0),new ze(It,It)],c.tileID.canonical).map(F=>F.polygon).flat());const R=E?b:null,[z,V]=function(F,q,W,te,se,le,ne,me,he,_e,Ae){return F.projection.name==="globe"?function(Me,Re,Be,Ge,Fe,tt,ut,Xe,Lt,Pt,bt){const mt=[],Yt=[],Rt=Me.projection.upVectorScale(bt,Me.center.lat,Me.worldSize).metersToTile,$t=[0,0,0,1],cr=[0,0,0,1],Cr=(Er,Rr,Br,Ti)=>{Er[0]=Rr,Er[1]=Br,Er[2]=Ti,Er[3]=1},Tr=H2();Be>0&&(Be+=Tr),Ge+=Tr;for(const Er of Re){const Rr=[],Br=[];for(const Ti of Er){const ui=Ti.x+Fe.x,hr=Ti.y+Fe.y,ni=Me.projection.projectTilePoint(ui,hr,bt),si=Me.projection.upVector(bt,Ti.x,Ti.y);let Fi=Be,un=Ge;if(ut){const wn=K2(ui,hr,Be,Ge,ut,Xe,Lt,Pt);Fi+=wn.base,un+=wn.top}Be!==0?Cr($t,ni.x+si[0]*Rt*Fi,ni.y+si[1]*Rt*Fi,ni.z+si[2]*Rt*Fi):Cr($t,ni.x,ni.y,ni.z),Cr(cr,ni.x+si[0]*Rt*un,ni.y+si[1]*Rt*un,ni.z+si[2]*Rt*un),we.vec3.transformMat4($t,$t,tt),we.vec3.transformMat4(cr,cr,tt),Rr.push(new Yh($t[0],$t[1],$t[2])),Br.push(new Yh(cr[0],cr[1],cr[2]))}mt.push(Rr),Yt.push(Br)}return[mt,Yt]}(F,q,W,te,se,le,ne,me,he,_e,Ae):ne?function(Me,Re,Be,Ge,Fe,tt,ut,Xe,Lt){const Pt=[],bt=[],mt=[0,0,0,1];for(const Yt of Me){const Rt=[],$t=[];for(const cr of Yt){const Cr=cr.x+Ge.x,Tr=cr.y+Ge.y,Er=K2(Cr,Tr,Re,Be,tt,ut,Xe,Lt);mt[0]=Cr,mt[1]=Tr,mt[2]=Er.base,mt[3]=1,we.vec4.transformMat4(mt,mt,Fe),mt[3]=Math.max(mt[3],1e-5);const Rr=new Yh(mt[0]/mt[3],mt[1]/mt[3],mt[2]/mt[3]);mt[0]=Cr,mt[1]=Tr,mt[2]=Er.top,mt[3]=1,we.vec4.transformMat4(mt,mt,Fe),mt[3]=Math.max(mt[3],1e-5);const Br=new Yh(mt[0]/mt[3],mt[1]/mt[3],mt[2]/mt[3]);Rt.push(Rr),$t.push(Br)}Pt.push(Rt),bt.push($t)}return[Pt,bt]}(q,W,te,se,le,ne,me,he,_e):function(Me,Re,Be,Ge,Fe){const tt=[],ut=[],Xe=Fe[8]*Re,Lt=Fe[9]*Re,Pt=Fe[10]*Re,bt=Fe[11]*Re,mt=Fe[8]*Be,Yt=Fe[9]*Be,Rt=Fe[10]*Be,$t=Fe[11]*Be;for(const cr of Me){const Cr=[],Tr=[];for(const Er of cr){const Rr=Er.x+Ge.x,Br=Er.y+Ge.y,Ti=Fe[0]*Rr+Fe[4]*Br+Fe[12],ui=Fe[1]*Rr+Fe[5]*Br+Fe[13],hr=Fe[2]*Rr+Fe[6]*Br+Fe[14],ni=Fe[3]*Rr+Fe[7]*Br+Fe[15],si=Ti+Xe,Fi=ui+Lt,un=hr+Pt,wn=Math.max(ni+bt,1e-5),hn=Ti+mt,Qi=ui+Yt,Un=hr+Rt,Pn=Math.max(ni+$t,1e-5);Cr.push(new Yh(si/wn,Fi/wn,un/wn)),Tr.push(new Yh(hn/Pn,Qi/Pn,Un/Pn))}tt.push(Cr),ut.push(Tr)}return[tt,ut]}(q,W,te,se,le)}(h,u,w,y,A,m,R,P,O,h.center.lat,c.tileID.canonical),G=c.queryGeometry;return function(F,q,W){let te=1/0;sr(W,q)&&(te=X2(W,q[0]));for(let se=0;se<q.length;se++){const le=q[se],ne=F[se];for(let me=0;me<le.length-1;me++){const he=le[me],_e=[he,le[me+1],ne[me+1],ne[me],he];Ot(W,_e)&&(te=Math.min(te,X2(W,_e)))}}return te!==1/0&&te}(z,V,G.isPointQuery()?G.screenBounds:G.screenGeometry)}},line:class extends ho{constructor(c,i,o,u){const p=sA();super(c,p,i,o,u),p.layout&&(this.layout=new pu(p.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof Ch,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,i){super.recalculate(c,i),this.paint._values["line-floorwidth"]=(()=>{if(Cg)return Cg;const o=sA();return Cg=new Uj(o.paint.properties["line-width"].specification),Cg.useIntegerZoom=!0,Cg})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Bw(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,i,o){const u=nA(this);return{config:new uc(this,{zoom:i,lut:o}),defines:u,overrideFog:!1}}queryRadius(c){const i=c,o=aA(Gi("line-width",this,i),Gi("line-gap-width",this,i)),u=Gi("line-offset",this,i);return o/2+Math.abs(u)+mi(this.paint.get("line-translate"))}queryIntersectsFeature(c,i,o,u,p,h){if(c.queryGeometry.isAboveHorizon)return!1;const m=Ar(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),b=c.pixelToTileUnitsFactor/2*aA(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),S=this.paint.get("line-offset").evaluate(i,o);return S&&(u=function(A,y){const w=[],P=new ze(0,0);for(let E=0;E<A.length;E++){const O=A[E],M=[];for(let R=0;R<O.length;R++){const z=O[R],V=O[R+1],G=R===0?P:z.sub(O[R-1])._unit()._perp(),F=R===O.length-1?P:V.sub(z)._unit()._perp(),q=G._add(F)._unit();q._mult(1/(q.x*F.x+q.y*F.y)),M.push(q._mult(y)._add(z))}w.push(M)}return w}(u,S*c.pixelToTileUnitsFactor)),function(A,y,w){for(let P=0;P<y.length;P++){const E=y[P];if(A.length>=3){for(let O=0;O<E.length;O++)if(zi(A,E[O]))return!0}if(Ht(A,E,w))return!0}return!1}(m,u,b)}isTileClipped(){return!0}isDraped(c){const i=this.layout.get("line-z-offset");return i.isConstant()&&!i.constantOr(0)}},symbol:fb,background:class extends ho{constructor(c,i,o,u){super(c,{layout:GA||(GA=new Ui({visibility:new wt(Ue.layout_background.visibility)})),paint:HA||(HA=new Ui({"background-pitch-alignment":new wt(Ue.paint_background["background-pitch-alignment"]),"background-color":new wt(Ue.paint_background["background-color"]),"background-pattern":new wt(Ue.paint_background["background-pattern"]),"background-opacity":new wt(Ue.paint_background["background-opacity"]),"background-emissive-strength":new wt(Ue.paint_background["background-emissive-strength"])}))},i,o,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,i,o){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:KA,"raster-particle":rC,sky:class extends ho{constructor(c,i,o,u){super(c,{layout:QA||(QA=new Ui({visibility:new wt(Ue.layout_sky.visibility)})),paint:eC||(eC=new Ui({"sky-type":new wt(Ue.paint_sky["sky-type"]),"sky-atmosphere-sun":new wt(Ue.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new wt(Ue.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new wt(Ue.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new wt(Ue.paint_sky["sky-gradient-radius"]),"sky-gradient":new Gs(Ue.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new wt(Ue.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new wt(Ue.paint_sky["sky-atmosphere-color"]),"sky-opacity":new wt(Ue.paint_sky["sky-opacity"])}))},i,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=bg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(c,i){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),p=!u,h=c.style.light,m=h.properties.get("position");return p&&h.properties.get("anchor")==="viewport"&&Jr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?rT(m.azimuthal,90-m.polar,i):rT(u[0],90-u[1],i)}const o=this.paint.get("sky-gradient-center");return rT(o[0],90-o[1],i)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends ho{constructor(c,i,o,u){super(c,{paint:tC||(tC=new Ui({}))},i,null)}},model:class extends ho{constructor(c,i,o,u){super(c,{layout:dC||(dC=new Ui({visibility:new wt(Ue.layout_model.visibility),"model-id":new Xt(Ue.layout_model["model-id"])})),paint:fC||(fC=new Ui({"model-opacity":new wt(Ue.paint_model["model-opacity"]),"model-rotation":new Xt(Ue.paint_model["model-rotation"]),"model-scale":new Xt(Ue.paint_model["model-scale"]),"model-translation":new Xt(Ue.paint_model["model-translation"]),"model-color":new Xt(Ue.paint_model["model-color"]),"model-color-mix-intensity":new Xt(Ue.paint_model["model-color-mix-intensity"]),"model-type":new wt(Ue.paint_model["model-type"]),"model-cast-shadows":new wt(Ue.paint_model["model-cast-shadows"]),"model-receive-shadows":new wt(Ue.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new wt(Ue.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Xt(Ue.paint_model["model-emissive-strength"]),"model-roughness":new Xt(Ue.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Xt(Ue.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new wt(Ue.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new wt(Ue.paint_model["model-front-cutoff"])}))},i,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new oT(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof xb?It-1:0}queryIntersectsFeature(c,i,o,u,p,h){if(!this.modelManager)return!1;const m=this.modelManager,b=c.tile.getBucket(this);if(!(b&&b instanceof oT))return!1;const S=b;for(const A in S.instancesPerModel){const y=S.instancesPerModel[A],w=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(y.idToFeaturesIndex.hasOwnProperty(w)){const P=y.features[y.idToFeaturesIndex[w]],E=m.getModel(A,this.scope);if(!E)return!1;let O=we.mat4.create();const M=new U(0,0),R=S.canonical;let z=Number.MAX_VALUE;for(let V=0;V<P.instancedDataCount;++V){const G=16*(P.instancedDataOffset+V),F=y.instancedDataArray.float32,q=[F[G+4],F[G+5],F[G+6]];vC(R,M,F[G],0|F[G+1]),pC(O,E,h,M,P.rotation,P.scale,q,!1,!1,!1),h.projection.name==="globe"&&(O=nT(O,h));const W=we.mat4.multiply([],h.projMatrix,O),te=c.queryGeometry,se=aC(te.isPointQuery()?te.screenBounds:te.screenGeometry,h,W,E.aabb);se!=null&&(z=Math.min(se,z))}return z!==Number.MAX_VALUE&&z}}return!1}_handleOverridablePaintPropertyUpdate(c,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const i=this._transitionablePaint._values[c];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof _a}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(c,i,o,u){const p=c.tile,h=p.getBucket(this);let m=null,b=Number.MAX_VALUE;if(!(h&&h instanceof xb))return{queryFeature:m,intersectionZ:b};const S=h.getNodesInfo()[i];if(S.hiddenByReplacement||!S.node.meshes||!o.filter(new nn(p.tileID.overscaledZ),S.feature,p.tileID.canonical))return{queryFeature:m,intersectionZ:b};const A=S.node,y=u.calculatePosMatrix(p.tileID.toUnwrapped(),u.worldSize),w=S.evaluatedScale;let P=0;u.elevation&&A.elevation&&(P=A.elevation*u.elevation.exaggeration()),we.mat4.translate(y,y,[(A.anchor?A.anchor[0]:0)*(w[0]-1),(A.anchor?A.anchor[1]:0)*(w[1]-1),P]),we.mat4.scale(y,y,w),we.mat4.multiply(y,y,A.matrix);const E=c.queryGeometry,O=E.isPointQuery()?E.screenBounds:E.screenGeometry,M=function(z){const V=we.mat4.multiply([],y,z.matrix),G=we.mat4.multiply(V,u.expandedFarZProjMatrix,V);for(let F=0;F<z.meshes.length;++F){const q=z.meshes[F];if(F===z.lightMeshIndex)continue;const W=aC(O,u,G,q.aabb);W!=null&&(b=Math.min(W,b))}if(z.children)for(const F of z.children)M(F)};if(M(A),b===Number.MAX_VALUE)return{queryFeature:m,intersectionZ:b};const R=new U(0,0);return vC(p.tileID.canonical,R,S.node.anchor[0],S.node.anchor[1]),m={type:"Feature",geometry:{type:"Point",coordinates:[R.lng,R.lat]},properties:S.feature.properties,id:S.feature.id,state:{},layer:this.serialize()},{queryFeature:m,intersectionZ:b}}},clip:class extends ho{constructor(c,i,o,u){super(c,{layout:f2||(f2=new Ui({"clip-layer-types":new wt(Ue.layout_clip["clip-layer-types"]),"clip-layer-scope":new wt(Ue.layout_clip["clip-layer-scope"])})),paint:p2||(p2=new Ui({}))},i,o,u)}recalculate(c,i){super.recalculate(c,i)}createBucket(c){return new m2(c)}isTileClipped(){return!0}is3D(){return!0}}};class jV{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class VV{constructor(){this.tasks={},this.taskQueue=[],ka(["process"],this),this.invoker=new jV(this.process),this.nextId=0}add(i,o){const u=this.nextId++,p=function({type:h,isSymbolTile:m,zoom:b}){return b=b||0,h==="message"?0:h!=="maybePrepare"||m?h!=="parseTile"||m?h==="parseTile"&&m?300-b:h==="maybePrepare"&&m?400-b:500:200-b:100-b}(o);if(p===0){try{i()}finally{}return null}return this.tasks[u]={fn:i,metadata:o,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const o=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let i=null,o=1/0;for(let p=0;p<this.taskQueue.length;p++){const h=this.tasks[this.taskQueue[p]];h.priority<o&&(o=h.priority,i=p)}if(i===null)return null;const u=this.taskQueue[i];return this.taskQueue.splice(i,1),u}remove(){this.invoker.remove()}}class bC{constructor(i,o,u){this.target=i,this.parent=o,this.mapId=u,this.callbacks={},this.cancelCallbacks={},ka(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new VV}send(i,o,u,p,h=!1,m){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=m,this.callbacks[b]=u);const S=new Set;return this.target.postMessage({id:b,type:i,hasCallback:!!u,targetMapId:p,mustQueue:h,sourceMapId:this.mapId,data:Fo(o,S)},S),{cancel:()=>{u&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(i){const o=i.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const p=this.cancelCallbacks[u];delete this.cancelCallbacks[u],p&&p.cancel()}else if(o.mustQueue||Kl()){const p=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,o),p&&p.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,o)}processTask(i,o){if(delete this.cancelCallbacks[i],o.type==="<response>"){const u=this.callbacks[i];delete this.callbacks[i],u&&(o.error?u(oc(o.error)):u(null,oc(o.data)))}else{const u=new Set,p=o.hasCallback?(m,b)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:m?Fo(m):null,data:Fo(b,u)},u)}:m=>{},h=oc(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,h,p);else if(this.parent.getWorkerSource){const m=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,m[0],h.source,h.scope)[m[1]](h,p)}else p(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class cp{constructor(i,o){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=to();const u=this.workerPool.acquire(this.id);for(let p=0;p<u.length;p++){const h=new cp.Actor(u[p],o,this.id);h.name=`Worker ${p}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,o,u){Oi(this.actors,(p,h)=>{p.send(i,o,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}cp.Actor=bC;class xC{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,o){const u=this.toIdx(i,o);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(i,o){return this.leaves[this.toIdx(i,o)]}toIdx(i,o){return o*this.size+i}}function wC(c,i,o,u){let p=0,h=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(u[m])<1e-15){if(o[m]<c[m]||o[m]>i[m])return null}else{const b=1/u[m];let S=(c[m]-o[m])*b,A=(i[m]-o[m])*b;if(S>A){const y=S;S=A,A=y}if(S>p&&(p=S),A<h&&(h=A),p>h)return null}return p}function TC(c,i,o,u,p,h,m,b,S,A,y){const w=u-c,P=p-i,E=h-o,O=m-c,M=b-i,R=S-o,z=y[1]*R-y[2]*M,V=y[2]*O-y[0]*R,G=y[0]*M-y[1]*O,F=w*z+P*V+E*G;if(Math.abs(F)<1e-15)return null;const q=1/F,W=A[0]-c,te=A[1]-i,se=A[2]-o,le=(W*z+te*V+se*G)*q;if(le<0||le>1)return null;const ne=te*E-se*P,me=se*w-W*E,he=W*P-te*w,_e=(y[0]*ne+y[1]*me+y[2]*he)*q;return _e<0||le+_e>1?null:(O*ne+M*me+R*he)*q}function EC(c,i,o){return(c-i)/(o-i)}function SC(c,i,o,u,p,h,m,b,S){const A=1<<o,y=h-u,w=m-p,P=(c+1)/A*y+u,E=(i+0)/A*w+p,O=(i+1)/A*w+p;b[0]=(c+0)/A*y+u,b[1]=E,S[0]=P,S[1]=O}class OC{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(h){const m=Math.ceil(Math.log2(h.dim/8)),b=[];let S=Math.ceil(Math.pow(2,m));const A=1/S,y=(E,O,M,R,z)=>{const V=R?1:0,G=(E+1)*M-V,F=O*M,q=(O+1)*M-V;z[0]=E*M,z[1]=F,z[2]=G,z[3]=q};let w=new xC(S);const P=[];for(let E=0;E<S*S;E++){y(E%S,Math.floor(E/S),A,!1,P);const O=Du(P[0],P[1],h),M=Du(P[2],P[1],h),R=Du(P[2],P[3],h),z=Du(P[0],P[3],h);w.minimums.push(Math.min(O,M,R,z)),w.maximums.push(Math.max(O,M,R,z)),w.leaves.push(1)}for(b.push(w),S/=2;S>=1;S/=2){const E=b[b.length-1];w=new xC(S);for(let O=0;O<S*S;O++){y(O%S,Math.floor(O/S),2,!0,P);const M=E.getElevation(P[0],P[1]),R=E.getElevation(P[2],P[1]),z=E.getElevation(P[2],P[3]),V=E.getElevation(P[0],P[3]),G=E.isLeaf(P[0],P[1]),F=E.isLeaf(P[2],P[1]),q=E.isLeaf(P[2],P[3]),W=E.isLeaf(P[0],P[3]),te=Math.min(M.min,R.min,z.min,V.min),se=Math.max(M.max,R.max,z.max,V.max),le=G&&F&&q&&W;w.maximums.push(se),w.minimums.push(te),w.leaves.push(se-te<=5&&le?1:0)}b.push(w)}return b}(this.dem),u=o.length-1,p=o[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(o,0,0,u,0)}raycastRoot(i,o,u,p,h,m,b=1){return wC([i,o,-100],[u,p,this.maximums[0]*b],h,m)}raycast(i,o,u,p,h,m,b=1){if(!this.nodeCount)return null;const S=this.raycastRoot(i,o,u,p,h,m,b);if(S==null)return null;const A=[],y=[],w=[],P=[],E=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;E.length>0;){const{idx:O,t:M,nodex:R,nodey:z,depth:V}=E.pop();if(this.leaves[O]){SC(R,z,V,i,o,u,p,w,P);const F=1<<V,q=(R+0)/F,W=(R+1)/F,te=(z+0)/F,se=(z+1)/F,le=Du(q,te,this.dem)*b,ne=Du(W,te,this.dem)*b,me=Du(W,se,this.dem)*b,he=Du(q,se,this.dem)*b,_e=TC(w[0],w[1],le,P[0],w[1],ne,P[0],P[1],me,h,m),Ae=TC(P[0],P[1],me,w[0],P[1],he,w[0],w[1],le,h,m),Me=Math.min(_e!==null?_e:Number.MAX_VALUE,Ae!==null?Ae:Number.MAX_VALUE);if(Me!==Number.MAX_VALUE)return Me;{const Re=we.vec3.scaleAndAdd([],h,m,M);if(PC(le,ne,he,me,EC(Re[0],w[0],P[0]),EC(Re[1],w[1],P[1]))>=Re[2])return M}continue}let G=0;for(let F=0;F<this._siblingOffset.length;F++){SC((R<<1)+this._siblingOffset[F][0],(z<<1)+this._siblingOffset[F][1],V+1,i,o,u,p,w,P),w[2]=-100,P[2]=this.maximums[this.childOffsets[O]+F]*b;const q=wC(w,P,h,m);if(q!=null){const W=q;A[F]=W;let te=!1;for(let se=0;se<G&&!te;se++)W>=A[y[se]]&&(y.splice(se,0,F),te=!0);te||(y[G]=F),G++}}for(let F=0;F<G;F++){const q=y[F];E.push({idx:this.childOffsets[O]+q,t:A[q],nodex:(R<<1)+this._siblingOffset[q][0],nodey:(z<<1)+this._siblingOffset[q][1],depth:V+1})}}return null}_addNode(i,o,u){return this.minimums.push(i),this.maximums.push(o),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(i,o,u,p,h){if(i[p].isLeaf(o,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const m=p-1,b=i[m];let S=0,A=0;for(let y=0;y<this._siblingOffset.length;y++){const w=2*o+this._siblingOffset[y][0],P=2*u+this._siblingOffset[y][1],E=b.getElevation(w,P),O=b.isLeaf(w,P),M=this._addNode(E.min,E.max,O);O&&(S|=1<<y),A||(A=M)}for(let y=0;y<this._siblingOffset.length;y++)S&1<<y||this._construct(i,2*o+this._siblingOffset[y][0],2*u+this._siblingOffset[y][1],m,A+y)}}function PC(c,i,o,u,p,h){return nr(nr(c,o,h),nr(i,u,h),p)}function Du(c,i,o){const u=o.dim,p=Dt(c*u-.5,0,u-1),h=Dt(i*u-.5,0,u-1),m=Math.floor(p),b=Math.floor(h),S=Math.min(m+1,u-1),A=Math.min(b+1,u-1);return PC(o.get(m,b),o.get(S,b),o.get(m,A),o.get(S,A),p-m,h-b)}const UV={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function GV(c,i,o){return(256*c*256+256*i+o)/10-1e4}function HV(c,i,o){return 256*c+i+o/256-32768}class wb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,o,u,p=!1){if(this.uid=i,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Jr(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const h=this.dim=o.height-2,m=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let S=0;S<h;S++)m[this._idx(-1,S)]=m[this._idx(0,S)],m[this._idx(h,S)]=m[this._idx(h-1,S)],m[this._idx(S,-1)]=m[this._idx(S,0)],m[this._idx(S,h)]=m[this._idx(S,h-1)];m[this._idx(-1,-1)]=m[this._idx(0,0)],m[this._idx(h,-1)]=m[this._idx(h-1,0)],m[this._idx(-1,h)]=m[this._idx(0,h-1)],m[this._idx(h,h)]=m[this._idx(h-1,h-1)]}const b=u==="terrarium"?HV:GV;for(let S=0;S<m.length;++S){const A=4*S;this.floatView[S]=b(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}this._timestamp=zt.now()}_buildQuadTree(){this._tree=new OC(this)}get(i,o,u=!1){u&&(i=Dt(i,-1,this.dim),o=Dt(o,-1,this.dim));const p=this._idx(i,o);return this.floatView[p]}set(i,o,u){const p=this._idx(i,o),h=this.floatView[p];return this.floatView[p]=u,u-h}static getUnpackVector(i){return UV[i]}_idx(i,o){if(i<-1||i>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(i+1)}static pack(i,o){const u=[0,0,0,0],p=wb.getUnpackVector(o);let h=Math.floor((i+p[3])/p[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new s2({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,o,u){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let p=o*this.dim,h=o*this.dim+this.dim,m=u*this.dim,b=u*this.dim+this.dim;switch(o){case-1:p=h-1;break;case 1:h=p+1}switch(u){case-1:m=b-1;break;case 1:b=m+1}const S=-o*this.dim,A=-u*this.dim;for(let y=m;y<b;y++)for(let w=p;w<h;w++){const P=4*this._idx(w,y),E=4*this._idx(w+S,y+A);this.pixels[P+0]=i.pixels[E+0],this.pixels[P+1]=i.pixels[E+1],this.pixels[P+2]=i.pixels[E+2],this.pixels[P+3]=i.pixels[E+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function qV(c,i,o){c===1?i.header_length=o.readFixed32():c===2?i.x=o.readVarint():c===3?i.y=o.readVarint():c===4?i.z=o.readVarint():c===5&&i.layers.push(function(u,p){return u.readFields(YV,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},p)}(o,o.readVarint()+o.pos))}function WV(c,i,o){c===1?(i.delta_filter=function(u,p){return u.readFields(ZV,{block_size:0},p)}(o,o.readVarint()+o.pos),i.filter="delta_filter"):c===2?(o.readVarint(),i.filter="zigzag_filter"):c===3?(o.readVarint(),i.filter="bitshuffle_filter"):c===4&&(o.readVarint(),i.filter="byteshuffle_filter")}function ZV(c,i,o){c===1&&(i.block_size=o.readVarint())}function XV(c,i,o){c===1?(o.readVarint(),i.codec="gzip_data"):c===2?(o.readVarint(),i.codec="jpeg_image"):c===3?(o.readVarint(),i.codec="webp_image"):c===4&&(o.readVarint(),i.codec="png_image")}function KV(c,i,o){c===1?i.first_byte=o.readFixed64():c===2?i.last_byte=o.readFixed64():c===3?i.filters.push(function(u,p){return u.readFields(WV,{},p)}(o,o.readVarint()+o.pos)):c===4?i.codec=function(u,p){return u.readFields(XV,{},p)}(o,o.readVarint()+o.pos):c===5?i.deprecated_offset=o.readFloat():c===6?i.deprecated_scale=o.readFloat():c===7?i.bands.push(o.readString()):c===8?i.offset=o.readDouble():c===9&&(i.scale=o.readDouble())}function YV(c,i,o){c===1?i.version=o.readVarint():c===2?i.name=o.readString():c===3?i.units=o.readString():c===4?i.tilesize=o.readVarint():c===5?i.buffer=o.readVarint():c===6?i.pixel_format=o.readVarint():c===7&&i.data_index.push(function(u,p){return u.readFields(KV,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},p)}(o,o.readVarint()+o.pos))}function JV(c,i,o){if(c===2)(function(u,p,h){u.readFields(QV,h,p)})(o,o.readVarint()+o.pos,i);else if(c===3)throw new Error("Not implemented")}function QV(c,i,o){if(c===1){let u=0;const p=o.readVarint()+o.pos;for(;o.pos<p;)i[u++]=o.readVarint()}}jt(wb,"DEMData"),jt(OC,"DemMinMaxQuadTree",{omit:["dem"]});class e6{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const o=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,o),o}put(i,o){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,o)}}function t6(c,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let o=i[3];for(let u=2;u>=1;u--){const p=u===1?1:0,h=u===2?1:0;for(let m=0;m<i[0];m++){const b=i[1]*m;for(let S=p;S<i[1];S++){const A=i[2]*(S+b);for(let y=h;y<i[2];y++){const w=i[3]*(y+A);for(let P=0;P<i[3];P++){const E=w+P;c[E]+=c[E-o]}}}}o*=i[u]}return c}function r6(c){for(let i=0,o=c.length;i<o;i++)c[i]=c[i]>>>1^-(1&c[i]);return c}function i6(c,i){switch(i){case"uint32":return c;case"uint16":for(let o=0;o<c.length;o+=2){const u=c[o],p=c[o+1];c[o]=(240&u)>>4|(61440&u)>>8|(240&p)<<4|61440&p,c[o+1]=15&u|(3840&u)>>4|(15&p)<<8|(3840&p)<<4}return c;case"uint8":for(let o=0;o<c.length;o+=4){const u=c[o],p=c[o+1],h=c[o+2],m=c[o+3];c[o+0]=(192&u)>>6|(192&p)>>4|(192&h)>>2|192&m,c[o+1]=(48&u)>>4|(48&p)>>2|48&h|(48&m)<<2,c[o+2]=(12&u)>>2|12&p|(12&h)<<2|(12&m)<<4,c[o+3]=3&u|(3&p)<<2|(3&h)<<4|(3&m)<<6}return c;default:throw new Error(`Invalid pixel format, "${i}"`)}}var Zs=Uint8Array,Vg=Uint16Array,n6=Int32Array,AC=new Zs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),CC=new Zs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o6=new Zs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),MC=function(c,i){for(var o=new Vg(31),u=0;u<31;++u)o[u]=i+=1<<c[u-1];var p=new n6(o[30]);for(u=1;u<30;++u)for(var h=o[u];h<o[u+1];++h)p[h]=h-o[u]<<5|u;return{b:o,r:p}},IC=MC(AC,2),DC=IC.b,s6=IC.r;DC[28]=258,s6[258]=28;for(var a6=MC(CC,0).b,RC=new Vg(32768),xn=0;xn<32768;++xn){var up=(43690&xn)>>1|(21845&xn)<<1;RC[xn]=((65280&(up=(61680&(up=(52428&up)>>2|(13107&up)<<2))>>4|(3855&up)<<4))>>8|(255&up)<<8)>>1}var Ug=function(c,i,o){for(var u=c.length,p=0,h=new Vg(i);p<u;++p)c[p]&&++h[c[p]-1];var m,b=new Vg(i);for(p=1;p<i;++p)b[p]=b[p-1]+h[p-1]<<1;m=new Vg(1<<i);var S=15-i;for(p=0;p<u;++p)if(c[p])for(var A=p<<4|c[p],y=i-c[p],w=b[c[p]-1]++<<y,P=w|(1<<y)-1;w<=P;++w)m[RC[w]>>S]=A;return m},Gg=new Zs(288);for(xn=0;xn<144;++xn)Gg[xn]=8;for(xn=144;xn<256;++xn)Gg[xn]=9;for(xn=256;xn<280;++xn)Gg[xn]=7;for(xn=280;xn<288;++xn)Gg[xn]=8;var LC=new Zs(32);for(xn=0;xn<32;++xn)LC[xn]=5;var l6=Ug(Gg,9),c6=Ug(LC,5),cT=function(c){for(var i=c[0],o=1;o<c.length;++o)c[o]>i&&(i=c[o]);return i},Za=function(c,i,o){var u=i/8|0;return(c[u]|c[u+1]<<8)>>(7&i)&o},uT=function(c,i){var o=i/8|0;return(c[o]|c[o+1]<<8|c[o+2]<<16)>>(7&i)},u6=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Xa=function(c,i,o){var u=new Error(i||u6[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,Xa),!o)throw u;return u},h6=new Zs(0),d6=typeof TextDecoder<"u"&&new TextDecoder;try{d6.decode(h6,{stream:!0})}catch{}const f6={gzip_data:"gzip"};class wa extends Error{constructor(i){super(i),this.name="MRTError"}}const p6={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},BC={uint32:1,uint16:2,uint8:4},m6={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let hT;class dT{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const o=this.layers[i];if(!o)throw new wa(`Layer '${i}' not found`);return o}getHeaderLength(i){const o=new Uint8Array(i),u=new DataView(i);if(o[0]!==13)throw new wa("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(i){const o=new Uint8Array(i),u=this.getHeaderLength(i);if(o.length<u)throw new wa(`Expected header with length >= ${u} but got buffer of length ${o.length}`);const p=function(h,m){return h.readFields(qV,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new hT(o.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new wa(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const h of p.layers)this.layers[h.name]=new g6(h,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const o=[],u=this.getLayer(i.layerName);for(let p of i.blockIndices){const h=u.dataIndex[p],m=h.first_byte-i.firstByte,b=h.last_byte-i.firstByte;if(u._blocksInProgress.has(p))continue;const S={layerName:u.name,firstByte:m,lastByte:b,pixelFormat:u.pixelFormat,blockIndex:p,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(A=>A.filter)};u._blocksInProgress.add(p),o.push(S)}return new kC(o,()=>{o.forEach(p=>u._blocksInProgress.delete(p.blockIndex))},(p,h)=>{if(o.forEach(m=>u._blocksInProgress.delete(m.blockIndex)),p)throw p;h.forEach(m=>{this.getLayer(m.layerName).processDecodedData(m)})})}}class g6{constructor({version:i,name:o,units:u,tilesize:p,pixel_format:h,buffer:m,data_index:b},S){if(this.version=i,this.version!==1)throw new wa(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=o,this.units=u,this.tileSize=p,this.buffer=m,this.pixelFormat=p6[h],this.dataIndex=b,this.bandShape=[p+2*m,p+2*m,BC[this.pixelFormat]],this._decodedBlocks=new e6(S?S.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return BC[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const o=i.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,i.data)}getBlockForBand(i){let o=0;switch(typeof i){case"string":for(const[u,p]of this.dataIndex.entries()){for(const[h,m]of p.bands.entries())if(m===i)return{bandIndex:o+h,blockIndex:u,blockBandIndex:h};o+=p.bands.length}break;case"number":for(const[u,p]of this.dataIndex.entries()){if(i>=o&&i<o+p.bands.length)return{bandIndex:i,blockIndex:u,blockBandIndex:i-o};o+=p.bands.length}break;default:throw new wa(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}throw new wa(`Band not found: ${JSON.stringify(i)}`)}getDataRange(i){let o=1/0,u=-1/0;const p=[],h=new Set;for(const m of i){const{blockIndex:b}=this.getBlockForBand(m);if(b<0)throw new wa(`Invalid band: ${JSON.stringify(m)}`);const S=this.dataIndex[b];p.includes(b)||p.push(b),h.add(b),o=Math.min(o,S.first_byte),u=Math.max(u,S.last_byte)}if(h.size>this.cacheSize)throw new wa(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:u,blockIndices:p}}hasBand(i){const{blockIndex:o}=this.getBlockForBand(i);return o>=0}hasDataForBand(i){const{blockIndex:o}=this.getBlockForBand(i);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(i){const{blockIndex:o,blockBandIndex:u}=this.getBlockForBand(i),p=this._decodedBlocks.get(o.toString());if(!p)throw new wa(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[o],m=this.bandShape.reduce((A,y)=>A*y,1),b=u*m,S=p.subarray(b,b+m);return{data:S,bytes:new Uint8Array(S.buffer).subarray(S.byteOffset,S.byteOffset+S.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset!==0?h.offset:h.deprecated_offset,scale:h.scale!==0?h.scale:h.deprecated_scale}}}dT.setPbf=function(c){hT=c};class kC{constructor(i,o,u){this.tasks=i,this._onCancel=o,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,o){this._finalized||(this._onComplete(i,o),this._finalized=!0)}}dT.performDecoding=function(c,i){const o=new Uint8Array(c);return Promise.all(i.tasks.map(u=>{const{layerName:p,firstByte:h,lastByte:m,pixelFormat:b,blockShape:S,blockIndex:A,filters:y,codec:w}=u,P=o.subarray(h,m+1),E=new Uint32Array(S[0]*S[1]*S[2]);let O;if(w!=="gzip_data")throw new wa(`Unhandled codec: ${w}`);return O=function(M,R){if(!globalThis.DecompressionStream&&R==="gzip_data")return Promise.resolve(((F=function(te){te[0]==31&&te[1]==139&&te[2]==8||Xa(6,"invalid gzip data");var se=te[3],le=10;4&se&&(le+=2+(te[10]|te[11]<<8));for(var ne=(se>>3&1)+(se>>4&1);ne>0;ne-=!te[le++]);return le+(2&se)}(G=M))+8>G.length&&Xa(6,"invalid gzip data"),function(te,se,le,ne){var me=te.length;if(!me||se.f&&!se.l)return le||new Zs(0);var he=!le,_e=he||se.i!=2,Ae=se.i;he&&(le=new Zs(3*me));var Me,Re,Be=function(Ru){var rd=le.length;if(Ru>rd){var Yg=new Zs(Math.max(2*rd,Ru));Yg.set(le),le=Yg}},Ge=se.f||0,Fe=se.p||0,tt=se.b||0,ut=se.l,Xe=se.d,Lt=se.m,Pt=se.n,bt=8*me;do{if(!ut){Ge=Za(te,Fe,1);var mt=Za(te,Fe+1,3);if(Fe+=3,!mt){var Yt=te[(hr=4+((Fe+7)/8|0))-4]|te[hr-3]<<8,Rt=hr+Yt;if(Rt>me){Ae&&Xa(0);break}_e&&Be(tt+Yt),le.set(te.subarray(hr,Rt),tt),se.b=tt+=Yt,se.p=Fe=8*Rt,se.f=Ge;continue}if(mt==1)ut=l6,Xe=c6,Lt=9,Pt=5;else if(mt==2){var $t=Za(te,Fe,31)+257,cr=Za(te,Fe+10,15)+4,Cr=$t+Za(te,Fe+5,31)+1;Fe+=14;for(var Tr=new Zs(Cr),Er=new Zs(19),Rr=0;Rr<cr;++Rr)Er[o6[Rr]]=Za(te,Fe+3*Rr,7);Fe+=3*cr;var Br=cT(Er),Ti=(1<<Br)-1,ui=Ug(Er,Br);for(Rr=0;Rr<Cr;){var hr,ni=ui[Za(te,Fe,Ti)];if(Fe+=15&ni,(hr=ni>>4)<16)Tr[Rr++]=hr;else{var si=0,Fi=0;for(hr==16?(Fi=3+Za(te,Fe,3),Fe+=2,si=Tr[Rr-1]):hr==17?(Fi=3+Za(te,Fe,7),Fe+=3):hr==18&&(Fi=11+Za(te,Fe,127),Fe+=7);Fi--;)Tr[Rr++]=si}}var un=Tr.subarray(0,$t),wn=Tr.subarray($t);Lt=cT(un),Pt=cT(wn),ut=Ug(un,Lt),Xe=Ug(wn,Pt)}else Xa(1);if(Fe>bt){Ae&&Xa(0);break}}_e&&Be(tt+131072);for(var hn=(1<<Lt)-1,Qi=(1<<Pt)-1,Un=Fe;;Un=Fe){var Pn=(si=ut[uT(te,Fe)&hn])>>4;if((Fe+=15&si)>bt){Ae&&Xa(0);break}if(si||Xa(2),Pn<256)le[tt++]=Pn;else{if(Pn==256){Un=Fe,ut=null;break}var no=Pn-254;Pn>264&&(no=Za(te,Fe,(1<<(Ya=AC[Rr=Pn-257]))-1)+DC[Rr],Fe+=Ya);var Ri=Xe[uT(te,Fe)&Qi],ts=Ri>>4;if(Ri||Xa(3),Fe+=15&Ri,wn=a6[ts],ts>3){var Ya=CC[ts];wn+=uT(te,Fe)&(1<<Ya)-1,Fe+=Ya}if(Fe>bt){Ae&&Xa(0);break}_e&&Be(tt+131072);var Ta=tt+no;if(tt<wn){var Ea=0-wn,td=Math.min(wn,Ta);for(Ea+tt<0&&Xa(3);tt<td;++tt)le[tt]=(void 0)[Ea+tt]}for(;tt<Ta;++tt)le[tt]=le[tt-wn]}}se.l=ut,se.p=Un,se.b=tt,se.f=Ge,ut&&(Ge=1,se.m=Lt,se.d=Xe,se.n=Pt)}while(!Ge);return tt!=le.length&&he?(Me=le,((Re=tt)==null||Re>Me.length)&&(Re=Me.length),new Zs(Me.subarray(0,Re))):le.subarray(0,tt)}(G.subarray(F,-8),{i:2},new Zs(((z=G)[(V=z.length)-4]|z[V-3]<<8|z[V-2]<<16|z[V-1]<<24)>>>0))));var z,V,G,F;const q=f6[R];if(!q)throw new Error(`Unhandled codec: ${R}`);const W=new globalThis.DecompressionStream(q);return new Response(new Blob([M]).stream().pipeThrough(W)).arrayBuffer().then(te=>new Uint8Array(te))}(P,w).then(M=>(function(R,z){R.readFields(JV,z)}(new hT(M),E),new m6[b](E.buffer))),O.then(M=>{for(let R=y.length-1;R>=0;R--)switch(y[R]){case"delta_filter":t6(M,S);break;case"zigzag_filter":r6(M);break;case"bitshuffle_filter":i6(M,b);break;default:throw new wa(`Unhandled filter "${y[R]}"`)}return{layerName:p,blockIndex:A,data:M}}).catch(M=>{throw M})}))},jt(kC,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var Hg={workerUrl:"",workerClass:null,workerParams:void 0};const fT="mapboxgl_preloaded_worker_pool";class qg{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<qg.workerCount;)this.workers.push(Hg.workerClass!=null?new Hg.workerClass:new self.Worker(Hg.workerUrl,Hg.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[fT]}numActive(){return Object.keys(this.active).length}}let Wg;function Tb(){return Wg||(Wg=new qg),Wg}qg.workerCount=2;let Zg,pT,Ka,hp,mT,dp=null;function zC(){return Kl()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:pT||Se.DRACO_URL}function FC(){if(Kl()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(hp)return hp;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return hp=WebAssembly.validate(c)?Se.MESHOPT_SIMD_URL:Se.MESHOPT_URL,hp}const Eb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},_6={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Xg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function NC(c,i,o){const u=o.json.bufferViews.length,p=o.buffers.length;i.bufferView=u,o.json.bufferViews[u]={buffer:p,byteLength:c.byteLength},o.buffers[p]=c}const gT="KHR_draco_mesh_compression";function y6(c,i){const o=c.extensions&&c.extensions[gT];if(!o)return;const u=new Ka.Decoder,p=UC(i,o.bufferView),h=new Ka.Mesh;if(!u.DecodeArrayToMesh(p,p.byteLength,h))throw new Error("Failed to decode Draco mesh");const m=i.json.accessors[c.indices],b=Eb[m.componentType],S=m.count*b.BYTES_PER_ELEMENT,A=Ka._malloc(S);b===Uint16Array?u.GetTrianglesUInt16Array(h,S,A):u.GetTrianglesUInt32Array(h,S,A),NC(Ka.memory.buffer.slice(A,A+S),m,i),Ka._free(A);for(const y of Object.keys(o.attributes)){const w=u.GetAttributeByUniqueId(h,o.attributes[y]),P=i.json.accessors[c.attributes[y]],E=_6[P.componentType],O=P.count*Xg[P.type]*Eb[P.componentType].BYTES_PER_ELEMENT,M=Ka._malloc(O);u.GetAttributeDataArrayForAllPoints(h,w,Ka[E],O,M),NC(Ka.memory.buffer.slice(M,M+O),P,i),Ka._free(M)}u.destroy(),h.destroy(),delete c.extensions[gT]}const Sb="EXT_meshopt_compression";function v6(c,i){if(!c.extensions||!c.extensions[Sb])return;const o=c.extensions[Sb],u=new Uint8Array(i.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),p=new Uint8Array(o.count*o.byteStride);mT.decodeGltfBuffer(p,o.count,o.byteStride,u,o.mode,o.filter),c.buffer=i.buffers.length,c.byteOffset=0,i.buffers[c.buffer]=p.buffer,delete c.extensions[Sb]}const $C=1179937895,jC=new TextDecoder("utf8");function VC(c,i){return new URL(c,i).href}function b6(c,i,o,u){return fetch(VC(c.uri,u)).then(p=>p.arrayBuffer()).then(p=>{i.buffers[o]=p})}function UC(c,i){const o=c.json.bufferViews[i];return new Uint8Array(c.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function x6(c,i,o,u){if(c.uri){const p=VC(c.uri,u);return fetch(p).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{i.images[o]=h})}if(c.bufferView!==void 0){const p=UC(i,c.bufferView),h=new Blob([p],{type:c.mimeType});return createImageBitmap(h).then(m=>{i.images[o]=m})}}function GC(c,i=0,o){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,i,1)[0]===$C){const y=new Uint32Array(c,i);let w=2;const P=(y[w++]>>2)-3,E=y[w++]>>2;if(w++,u.json=JSON.parse(jC.decode(y.subarray(w,w+E))),w+=E,w<P){const O=y[w++];w++;const M=i+(w<<2);u.buffers[0]=c.slice(M,M+O)}}else u.json=JSON.parse(jC.decode(new Uint8Array(c,i)));const{buffers:p,images:h,meshes:m,extensionsUsed:b,bufferViews:S}=u.json;let A=Promise.resolve();if(p){const y=[];for(let w=0;w<p.length;w++){const P=p[w];P.uri?y.push(b6(P,u,w,o)):u.buffers[w]||(u.buffers[w]=null)}A=Promise.all(y)}return A.then(()=>{const y=[],w=b&&b.includes(gT),P=b&&b.includes(Sb);if(w&&y.push(function(){if(!Ka)return Zg!=null?Zg:(Zg=function(E){let O,M=null;function R(){O=new Uint8Array(M.buffer)}function z(){throw new Error("Unexpected Draco error.")}const V={a:{a:z,d:function(G,F,q){return O.copyWithin(G,F,F+q)},c:function(G){const F=O.length,q=Math.max(G>>>0,Math.ceil(1.2*F)),W=Math.ceil((q-F)/65536);try{return M.grow(W),R(),!0}catch{return!1}},b:z}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(E,V):E.then(G=>G.arrayBuffer()).then(G=>WebAssembly.instantiate(G,V))).then(G=>{const{Rb:F,Qb:q,P:W,T:te,X:se,Ja:le,La:ne,Qa:me,Va:he,Wa:_e,eb:Ae,jb:Me,f:Re,e:Be,yb:Ge,zb:Fe,Ab:tt,Bb:ut,Db:Xe,Gb:Lt}=G.instance.exports;M=Be;const Pt=(()=>{let bt=0,mt=0,Yt=0,Rt=0;return $t=>{Yt&&(F(Rt),F(bt),mt+=Yt,Yt=bt=0),bt||(mt+=128,bt=q(mt));const cr=$t.length+7&-8;let Cr=bt;cr>=mt&&(Yt=cr,Cr=Rt=q(cr));for(let Tr=0;Tr<$t.length;Tr++)O[Cr+Tr]=$t[Tr];return Cr}})();return R(),Re(),{memory:Be,_free:F,_malloc:q,Mesh:class{constructor(){this.ptr=W()}destroy(){te(this.ptr)}},Decoder:class{constructor(){this.ptr=le()}destroy(){Me(this.ptr)}DecodeArrayToMesh(bt,mt,Yt){const Rt=Pt(bt),$t=ne(this.ptr,Rt,mt,Yt.ptr);return!!se($t)}GetAttributeByUniqueId(bt,mt){return{ptr:me(this.ptr,bt.ptr,mt)}}GetTrianglesUInt16Array(bt,mt,Yt){he(this.ptr,bt.ptr,mt,Yt)}GetTrianglesUInt32Array(bt,mt,Yt){_e(this.ptr,bt.ptr,mt,Yt)}GetAttributeDataArrayForAllPoints(bt,mt,Yt,Rt,$t){Ae(this.ptr,bt.ptr,mt.ptr,Yt,Rt,$t)}},DT_INT8:Ge(),DT_UINT8:Fe(),DT_INT16:tt(),DT_UINT16:ut(),DT_UINT32:Xe(),DT_FLOAT32:Lt()}})}(fetch(zC())),Zg.then(E=>{Ka=E,Zg=void 0}))}()),P&&y.push(function(){if(mT)return;const E=function(O){let M;const R=WebAssembly.instantiateStreaming(O,{}).then(G=>{M=G.instance,M.exports.__wasm_call_ctors()}),z={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},V={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:R,supported:!0,decodeGltfBuffer(G,F,q,W,te,se){(function(le,ne,me,he,_e,Ae,Me){const Re=le.exports.sbrk,Be=he+3&-4,Ge=Re(Be*_e),Fe=Re(Ae.length),tt=new Uint8Array(le.exports.memory.buffer);tt.set(Ae,Fe);const ut=ne(Ge,he,_e,Fe,Ae.length);if(ut===0&&Me&&Me(Ge,Be,_e),me.set(tt.subarray(Ge,Ge+he*_e)),Re(Ge-Re(0)),ut!==0)throw new Error(`Malformed buffer data: ${ut}`)})(M,M.exports[V[te]],G,F,q,W,M.exports[z[se]])}}}(fetch(FC()));return E.ready.then(()=>{mT=E})}()),h)for(let E=0;E<h.length;E++)y.push(x6(h[E],u,E,o));return(y.length?Promise.all(y):Promise.resolve()).then(()=>{if(w&&m)for(const{primitives:E}of m)for(const O of E)y6(O,u);if(P&&m&&S)for(const E of S)v6(E,u);return u})})}function ed(c,i){const o=c.json.bufferViews[i.bufferView],u=Eb[i.componentType];return new u(c.buffers[o.buffer],(i.byteOffset||0)+(o.byteOffset||0),i.count*(o.byteStride&&o.byteStride!==Xg[i.type]*u.BYTES_PER_ELEMENT?o.byteStride/u.BYTES_PER_ELEMENT:Xg[i.type]))}function _T(c,i,o,u){const p=Eb[i.componentType],h=function(y){switch(y){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),m=c.json.bufferViews[i.bufferView],b=m.byteStride?m.byteStride/p.BYTES_PER_ELEMENT:Xg[i.type],S=o.float32,A=S.length/o.capacity;for(let y=0,w=0;y<i.count*b;y+=b,w+=A)for(let P=0;P<A;P++)S[w+P]=u[y+P]*h;o._trim()}function w6(c,i,o){const u=c.indices,p=c.attributes,h={};h.indexArray=new Jn;const m=i.json.accessors[u],b=m.count/3;h.indexArray.reserve(b);const S=ed(i,m);for(let P=0;P<b;P++)h.indexArray.emplaceBack(S[3*P],S[3*P+1],S[3*P+2]);h.indexArray._trim(),h.vertexArray=new wl;const A=i.json.accessors[p.POSITION];h.vertexArray.reserve(A.count);const y=ed(i,A);for(let P=0;P<A.count;P++)h.vertexArray.emplaceBack(y[3*P],y[3*P+1],y[3*P+2]);if(h.vertexArray._trim(),h.aabb=new Di(A.min,A.max),h.centroid=function(P,E){const O=[0,0,0],M=P.length;if(M>0){for(let R=0;R<M;R++){const z=3*P[R];O[0]+=E[z],O[1]+=E[z+1],O[2]+=E[z+2]}O[0]/=M,O[1]/=M,O[2]/=M}return O}(S,y),p.COLOR_0!==void 0){const P=i.json.accessors[p.COLOR_0],E=Xg[P.type],O=ed(i,P);h.colorArray=E===3?new wl:new ja,h.colorArray.resize(P.count),_T(i,P,h.colorArray,O)}if(p.NORMAL!==void 0){h.normalArray=new wl;const P=i.json.accessors[p.NORMAL];h.normalArray.resize(P.count);const E=ed(i,P);_T(i,P,h.normalArray,E)}if(p.TEXCOORD_0!==void 0&&o.length>0){h.texcoordArray=new Gh;const P=i.json.accessors[p.TEXCOORD_0];h.texcoordArray.resize(P.count);const E=ed(i,P);_T(i,P,h.texcoordArray,E)}if(p._FEATURE_ID_RGBA4444!==void 0){const P=i.json.accessors[p._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=ed(i,P))}p._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(ed(i,i.json.accessors[p._FEATURE_RGBA4444]).buffer));const w=c.material;return h.material=function(P,E){const{emissiveFactor:O=[0,0,0],alphaMode:M="OPAQUE",alphaCutoff:R=.5,normalTexture:z,occlusionTexture:V,emissiveTexture:G,doubleSided:F}=P,{baseColorFactor:q=[1,1,1,1],metallicFactor:W=1,roughnessFactor:te=1,baseColorTexture:se,metallicRoughnessTexture:le}=P.pbrMetallicRoughness||{},ne=V?E[V.index]:void 0;if(V&&V.extensions&&V.extensions.KHR_texture_transform&&ne){const me=V.extensions.KHR_texture_transform;ne.offsetScale=[me.offset[0],me.offset[1],me.scale[0],me.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new li(...q),metallicFactor:W,roughnessFactor:te,baseColorTexture:se?E[se.index]:void 0,metallicRoughnessTexture:le?E[le.index]:void 0},doubleSided:F,emissiveFactor:O,alphaMode:M,alphaCutoff:R,normalTexture:z?E[z.index]:void 0,occlusionTexture:ne,emissionTexture:G?E[G.index]:void 0,defined:P.defined===void 0}}(w!==void 0?i.json.materials[w]:{defined:!1},o),h}function HC(c,i,o){const{matrix:u,rotation:p,translation:h,scale:m,mesh:b,extras:S,children:A}=c,y={};if(y.matrix=u||we.mat4.fromRotationTranslationScale([],p||[0,0,0,1],h||[0,0,0],m||[1,1,1]),b!==void 0){y.meshes=o[b];const w=y.anchor=[0,0];for(const P of y.meshes){const{min:E,max:O}=P.aabb;w[0]+=E[0]+O[0],w[1]+=E[1]+O[1]}w[0]=Math.floor(w[0]/y.meshes.length/2),w[1]=Math.floor(w[1]/y.meshes.length/2)}if(S&&(S.id&&(y.id=S.id),S.lights&&(y.lights=function(w){if(!w.length)return[];const P=function(z){const V=atob(z),G=new Uint8Array(V.length);for(let F=0;F<V.length;F++)G[F]=V.codePointAt(F);return G}(w),E=[],O=P.length/24,M=new Uint16Array(P.buffer),R=new Float32Array(P.buffer);for(let z=0;z<O;z++){const V=M[2*z*6]/30,G=M[2*z*6+1]/30,F=M[2*z*6+10]/100,q=R[6*z+1],W=R[6*z+2],te=R[6*z+3],se=R[6*z+4],le=te-q,ne=se-W,me=Math.hypot(le,ne);E.push({pos:[q+.5*le,W+.5*ne,G],normal:[ne/me,-le/me,0],width:me,height:V,depth:F,points:[q,W,te,se]})}return E}(S.lights))),A){const w=[];for(const P of A)w.push(HC(i.json.nodes[P],i,o));y.children=w}return y}function T6(c){if(c.vertices.length===0||c.indices.length===0)return null;const i=new Ow(c.vertices,c.indices,8,256),[o,u]=[i.min.clone(),i.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:i,min:o,max:u}}function E6(c){if(!c.extras||!c.extras.ground)return null;const i=c.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const o=i[0];if(!o||!Array.isArray(o)||o.length===0)return null;const u=[];for(const m of o){if(!Array.isArray(m)||m.length!==2)continue;const b=m[0],S=m[1];typeof b=="number"&&typeof S=="number"&&u.push(new ze(b,S))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let p=0;for(let m=0;m<u.length;m++){const b=u[m],S=u[(m+1)%u.length],A=u[(m+2)%u.length];p+=(b.x-S.x)*(A.y-S.y)-(A.x-S.x)*(b.y-S.y)}p>0&&u.reverse();const h=xg(u.flatMap(m=>[m.x,m.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function S6(c,i){const o=[],u=[];let p=0;const h=[];for(const m of c){p=o.length;const b=m.vertexArray.float32,S=m.indexArray.uint16;for(let A=0;A<m.vertexArray.length;A++)h[0]=b[3*A+0],h[1]=b[3*A+1],h[2]=b[3*A+2],we.vec3.transformMat4(h,h,i),o.push(new ze(h[0],h[1]));for(let A=0;A<3*m.indexArray.length;A++)u.push(S[A]+p)}if(u.length%3!=0)return null;for(let m=0;m<u.length;m+=3){const b=o[u[m+0]],S=o[u[m+1]],A=o[u[m+2]];(b.x-S.x)*(A.y-S.y)-(A.x-S.x)*(b.y-S.y)>0&&([u[m+1],u[m+2]]=[u[m+2],u[m+1]])}return{vertices:o,indices:u}}function qC(c){const i=function(S,A){const y=[],w=WebGL2RenderingContext;if(S.json.textures)for(const P of S.json.textures){const E={magFilter:w.LINEAR,minFilter:w.NEAREST,wrapS:w.REPEAT,wrapT:w.REPEAT};P.sampler!==void 0&&Object.assign(E,S.json.samplers[P.sampler]),y.push({image:A[P.source],sampler:E,uploaded:!1})}return y}(c,c.images),o=function(S,A){const y=[];for(const w of S.json.meshes){const P=[];for(const E of w.primitives)P.push(w6(E,S,A));y.push(P)}return y}(c,i),{scenes:u,scene:p,nodes:h}=c.json,m=u?u[p||0].nodes:h,b=[];for(const S of m)b.push(HC(h[S],c,o));return function(S,A,y){const w={},P=new Set;for(let E=0;E<S.length;E++){const O=y[A[E]];if(!O.extras)continue;const M=O.extras["mapbox:footprint:version"],R=O.extras["mapbox:footprint:id"];(M||R)&&P.add(E),M==="1.0.0"&&R&&(w[R]=E)}for(let E=0;E<S.length;E++){if(P.has(E))continue;const O=S[E],M=y[A[E]];if(!M.extras)continue;let R=null;O.id in w&&(R=S6(S[w[O.id]].meshes,O.matrix)),R||(R=E6(M)),R&&(O.footprint=T6(R))}if(P.size>0){const E=Array.from(P.values()).sort((O,M)=>O-M);for(let O=E.length-1;O>=0;O--)S.splice(E[O],1)}}(b,m,c.json.nodes),b}function O6(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const i=c.vertexArray.float32,o=c.aabb.min[0]-1,u=c.aabb.min[1]-1,p=Jh/(c.aabb.max[0]-o+2),h=Jh/(c.aabb.max[1]-u+2);for(let m=0;m<i.length;m+=3){const b=i[m+2],S=(i[m+0]-o)*p|0,A=(i[m+1]-u)*h|0;b>c.heightmap[A*Jh+S]&&(c.heightmap[A*Jh+S]=b)}}function P6(c,i){const o={};o.indexArray=new Jn,o.indexArray.reserve(4*c.length),o.vertexArray=new wl,o.vertexArray.reserve(10*c.length),o.colorArray=new ja,o.vertexArray.reserve(10*c.length);let u=0;for(const m of c){const b=Math.min(10,Math.max(4,1.3*m.height))*i,S=[-m.normal[1],m.normal[0],0],A=Math.min(.29,.1*m.width/m.depth),y=m.width-2*m.depth*i*(A+.01),w=we.vec3.scaleAndAdd([],m.pos,S,y/2),P=we.vec3.scaleAndAdd([],m.pos,S,-y/2),E=[w[0],w[1],w[2]+m.height],O=[P[0],P[1],P[2]+m.height],M=we.vec3.scaleAndAdd([],m.normal,S,A);we.vec3.scale(M,M,b);const R=we.vec3.scaleAndAdd([],m.normal,S,-A);we.vec3.scale(R,R,b),we.vec3.add(M,w,M),we.vec3.add(R,P,R),w[2]+=.1,P[2]+=.1,o.vertexArray.emplaceBack(M[0],M[1],M[2]),o.vertexArray.emplaceBack(R[0],R[1],R[2]),o.vertexArray.emplaceBack(w[0],w[1],w[2]),o.vertexArray.emplaceBack(P[0],P[1],P[2]),o.vertexArray.emplaceBack(E[0],E[1],E[2]),o.vertexArray.emplaceBack(O[0],O[1],O[2]),o.vertexArray.emplaceBack(w[0],w[1],w[2]),o.vertexArray.emplaceBack(P[0],P[1],P[2]),o.vertexArray.emplaceBack(M[0],M[1],M[2]),o.vertexArray.emplaceBack(R[0],R[1],R[2]);const z=y/b/2;o.colorArray.emplaceBack(-z-A,-1,z,.8),o.colorArray.emplaceBack(z+A,-1,z,.8),o.colorArray.emplaceBack(-z,0,z,1.3),o.colorArray.emplaceBack(z,0,z,1.3),o.colorArray.emplaceBack(z+A,-.8,z,.7),o.colorArray.emplaceBack(z+A,-.8,z,.7),o.colorArray.emplaceBack(0,0,z,1.3),o.colorArray.emplaceBack(0,0,z,1.3),o.colorArray.emplaceBack(z+A,-1.2,z,.8),o.colorArray.emplaceBack(z+A,-1.2,z,.8),o.indexArray.emplaceBack(6+u,4+u,8+u),o.indexArray.emplaceBack(7+u,9+u,5+u),o.indexArray.emplaceBack(0+u,1+u,2+u),o.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const p={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=li.white,p.pbrMetallicRoughness=h,o.material=p,o.aabb=new Di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}class WC{constructor(i){this._stringToNumber={},this._numberToString=[];for(let o=0;o<i.length;o++){const u=i[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const A6=["id","tile","layer","source","sourceLayer","state"];class ZC{constructor(i,o,u,p,h){this.type="Feature",this._vectorTileFeature=i,this._z=o,this._x=u,this._y=p,this.properties=i.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of A6)this[o]!==void 0&&(i[o]=this[o]);return i}}class XC{constructor(i,o){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new nc(It,16,0),this.featureIndexArray=new Dv,this.promoteId=o,this.is3DTile=!1}insert(i,o,u,p,h,m=0,b=0){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,h,m);const A=this.grid;for(let y=0;y<o.length;y++){const w=o[y],P=[1/0,1/0,-1/0,-1/0];for(let E=0;E<w.length;E++){const O=w[E];P[0]=Math.min(P[0],O.x),P[1]=Math.min(P[1],O.y),P[2]=Math.max(P[2],O.x),P[3]=Math.max(P[3],O.y)}b!==0&&(P[0]-=b,P[1]-=b,P[2]+=b,P[3]+=b),P[0]<It&&P[1]<It&&P[2]>=0&&P[3]>=0&&A.insert(S,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new tp.VectorTile(new eb(this.rawTileData)).layers,this.sourceLayerCoder=new WC(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,o,u,p){this.loadVTLayers();const h=i.params||{},m=Hs(h.filter),b=i.tileResult,S=i.transform,A=b.bufferedTilespaceBounds,y=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(O,M,R,z)=>ps(b.bufferedTilespaceGeometry,O,M,R,z));y.sort(C6);let w=null;S.elevation&&y.length>0&&(w=lp.create(S.elevation,this.tileID));const P={};let E;for(let O=0;O<y.length;O++){const M=y[O];if(M===E)continue;E=M;const R=this.featureIndexArray.get(M);let z=null;if(this.is3DTile){const V=this.bucketLayerIDs[0][0],G=o[V];if(G.type!=="model")continue;const{queryFeature:F,intersectionZ:q}=G.queryIntersectsMatchingFeature(b,R.featureIndex,m,S);F&&this.appendToResult(P,V,R.featureIndex,F,q)}else this.loadMatchingFeature(P,R,m,h.layers,h.availableImages,o,u,p,(V,G,F,q=0)=>(z||(z=vt(V,this.tileID.canonical,i.tileTransform)),G.queryIntersectsFeature(b,V,F,z,this.z,i.transform,i.pixelPosMatrix,w,q)))}return P}loadMatchingFeature(i,o,u,p,h,m,b,S,A){const{featureIndex:y,bucketIndex:w,sourceLayerIndex:P,layoutVertexArrayOffset:E}=o,O=this.bucketLayerIDs[w];if(p&&!function(V,G){for(let F=0;F<V.length;F++)if(G.indexOf(V[F])>=0)return!0;return!1}(p,O))return;const M=this.sourceLayerCoder.decode(P),R=this.vtLayers[M].feature(y);if(u.needGeometry){const V=xt(R,!0);if(!u.filter(new nn(this.tileID.overscaledZ),V,this.tileID.canonical))return}else if(!u.filter(new nn(this.tileID.overscaledZ),R))return;const z=this.getId(R,M);for(let V=0;V<O.length;V++){const G=O[V];if(p&&p.indexOf(G)<0)continue;const F=m[G];if(!F)continue;let q={};z!==void 0&&S&&(q=S.getState(F.sourceLayer||"_geojsonTileLayer",z));const W=!A||A(R,F,q,E);if(!W)continue;const te=new ZC(R,this.z,this.x,this.y,z),se=Kr({},b[G]);se.paint=KC(se.paint,F.paint,R,q,h),se.layout=KC(se.layout,F.layout,R,q,h),te.layer=se,this.appendToResult(i,G,y,te,W)}}appendToResult(i,o,u,p,h){let m=i[o];m===void 0&&(m=i[o]=[]),m.push({featureIndex:u,feature:p,intersectionZ:h})}lookupSymbolFeatures(i,o,u,p,h,m,b,S){const A={};this.loadVTLayers();const y=Hs(h);for(const w of i)this.loadMatchingFeature(A,{bucketIndex:u,sourceLayerIndex:p,featureIndex:w,layoutVertexArrayOffset:0},y,m,b,S,o);return A}loadFeature(i){const{featureIndex:o,sourceLayerIndex:u}=i;this.loadVTLayers();const p=this.sourceLayerCoder.decode(u),h=this.vtFeatures[p];if(h[o])return h[o];const m=this.vtLayers[p].feature(o);return h[o]=m,m}hasLayer(i){for(const o of this.bucketLayerIDs)for(const u of o)if(i===u)return!0;return!1}getId(i,o){let u=i.id;if(this.promoteId){const p=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];p!=null&&(u=i.properties[p]),typeof u=="boolean"&&(u=Number(u))}return u}}function KC(c,i,o,u,p){return ha(c,(h,m)=>{const b=i instanceof pu?i.get(m):null;return b&&b.evaluate?b.evaluate(o,u,p):b})}function C6(c,i){return i-c}jt(XC,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const YC=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class yT{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(i,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const h=YC[15&u];if(!h)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(i,2,1),[b]=new Uint32Array(i,4,1);return new yT(b,m,h,i)}constructor(i,o=64,u=Float64Array,p){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const h=YC.indexOf(this.ArrayType),m=2*i*this.ArrayType.BYTES_PER_ELEMENT,b=i*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+b+S,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+m+b+S),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+b+S,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=i)}add(i,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=i,this.coords[this._pos++]=o,u}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return vT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,o,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:b}=this,S=[0,h.length-1,0],A=[];for(;S.length;){const y=S.pop()||0,w=S.pop()||0,P=S.pop()||0;if(w-P<=b){for(let R=P;R<=w;R++){const z=m[2*R],V=m[2*R+1];z>=i&&z<=u&&V>=o&&V<=p&&A.push(h[R])}continue}const E=P+w>>1,O=m[2*E],M=m[2*E+1];O>=i&&O<=u&&M>=o&&M<=p&&A.push(h[E]),(y===0?i<=O:o<=M)&&(S.push(P),S.push(E-1),S.push(1-y)),(y===0?u>=O:p>=M)&&(S.push(E+1),S.push(w),S.push(1-y))}return A}within(i,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:h,nodeSize:m}=this,b=[0,p.length-1,0],S=[],A=u*u;for(;b.length;){const y=b.pop()||0,w=b.pop()||0,P=b.pop()||0;if(w-P<=m){for(let R=P;R<=w;R++)QC(h[2*R],h[2*R+1],i,o)<=A&&S.push(p[R]);continue}const E=P+w>>1,O=h[2*E],M=h[2*E+1];QC(O,M,i,o)<=A&&S.push(p[E]),(y===0?i-u<=O:o-u<=M)&&(b.push(P),b.push(E-1),b.push(1-y)),(y===0?i+u>=O:o+u>=M)&&(b.push(E+1),b.push(w),b.push(1-y))}return S}}function vT(c,i,o,u,p,h){if(p-u<=o)return;const m=u+p>>1;JC(c,i,m,u,p,h),vT(c,i,o,u,m-1,1-h),vT(c,i,o,m+1,p,1-h)}function JC(c,i,o,u,p,h){for(;p>u;){if(p-u>600){const A=p-u+1,y=o-u+1,w=Math.log(A),P=.5*Math.exp(2*w/3),E=.5*Math.sqrt(w*P*(A-P)/A)*(y-A/2<0?-1:1);JC(c,i,o,Math.max(u,Math.floor(o-y*P/A+E)),Math.min(p,Math.floor(o+(A-y)*P/A+E)),h)}const m=i[2*o+h];let b=u,S=p;for(Kg(c,i,u,o),i[2*p+h]>m&&Kg(c,i,u,p);b<S;){for(Kg(c,i,b,S),b++,S--;i[2*b+h]<m;)b++;for(;i[2*S+h]>m;)S--}i[2*u+h]===m?Kg(c,i,u,S):(S++,Kg(c,i,S,p)),S<=o&&(u=S+1),o<=S&&(p=S-1)}}function Kg(c,i,o,u){bT(c,o,u),bT(i,2*o,2*u),bT(i,2*o+1,2*u+1)}function bT(c,i,o){const u=c[i];c[i]=c[o],c[o]=u}function QC(c,i,o,u){const p=c-o,h=i-u;return p*p+h*h}a.$=wv,a.A=class extends vb{},a.B=ec,a.C=qc,a.D=Nh,a.E=Hc,a.F=qm,a.G=Pf,a.H=fv,a.I=Uw,a.J=Mf,a.K=Nf,a.L=yv,a.M=Bh,a.N=vf,a.O=Ah,a.P=ze,a.Q=Ph,a.R=Vc,a.S=zo,a.T=tT,a.U=ym,a.V=vb,a.W=rg,a.X=Af,a.Y=Hm,a.Z=function(c){const i=c.value;let o=[];if(!i)return o;const u=ec(i);return u!=="string"?(o=o.concat([new vb(c.key,i,`string expected, "${u}" found`)]),o):(cC(i,!0)||(o=o.concat([new vb(c.key,i,`invalid url "${i}"`)])),o)},a._=Ue,a.a=function(c){return Se.API_CDN_URL_REGEX.test(c)},a.a$=hg,a.a0=Ui,a.a1=wt,a.a2=class{constructor(c){this.specification=c}possiblyEvaluate(c,i){return Wo(c.expression.evaluate(i))}interpolate(c,i,o){return{x:nr(c.x,i.x,o),y:nr(c.y,i.y,o),z:nr(c.z,i.z,o),azimuthal:nr(c.azimuthal,i.azimuthal,o),polar:nr(c.polar,i.polar,o)}}},a.a3=nn,a.a4=_a,a.a5=$e,a.a6=we,a.a7=zr,a.a8=pu,a.a9=Su,a.aA=Ii,a.aB=KA,a.aC=rC,a.aD=XA,a.aE=function(c,i){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){i(null,o)};for(let u=0;u<c.length;u++){const p=document.createElement("source");fs(c[u])||(o.crossOrigin="Anonymous"),p.src=c[u],o.appendChild(p)}return{cancel:()=>{}}},a.aF=pb,a.aG=function(c){return fetch(c).then(i=>i.arrayBuffer()).then(i=>GC(i,0,c))},a.aH=qC,a.aI=class{constructor(c,i,o,u){this.id=c,this.position=i!=null?new U(i[0],i[1]):new U(0,0),this.orientation=o!=null?o:[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new Di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,i){if(we.mat4.multiply(c.matrix,i,c.matrix),c.meshes)for(const o of c.meshes){const u=Di.applyTransformFast(o.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const o of c.children)this._applyTransformations(o,c.matrix)}computeBoundsAndApplyParent(){const c=we.mat4.identity([]);for(const i of this.nodes)this._applyTransformations(i,c)}computeModelMatrix(c,i,o,u,p,h,m=!1){pC(this.matrix,this,c.transform,this.position,i,o,u,p,h,m)}upload(c){if(!this.uploaded){for(const i of this.nodes)sT(i,c);for(const i of this.nodes)bb(i);this.uploaded=!0}}destroy(){for(const c of this.nodes)aT(c)}},a.aJ=ka,a.aK=Bg,a.aL=fe,a.aM=de,a.aN=xl,a.aO=Jn,a.aP=to,a.aQ=Xf,a.aR=db,a.aS=function(){No.isLoading()||No.isLoaded()||Qm()!=="deferred"||eg()},a.aT=Hs,a.aU=xt,a.aV=ZC,a.aW=mh,a.aX=Bw,a.aY=Sw,a.aZ=vt,a.a_=bl,a.aa=nr,a.ab=It,a.ac=xh,a.ad=class{constructor(c){this.specification=c}possiblyEvaluate(c,i){return function([o,u]){const p=Wo([1,o,u]);return{x:p.x,y:p.y,z:p.z}}(c.expression.evaluate(i))}interpolate(c,i,o){return{x:nr(c.x,i.x,o),y:nr(c.y,i.y,o),z:nr(c.z,i.z,o)}}},a.ae=function(c,i,o=0,u=!0){const p=new ze(o,o),h=c.sub(p),m=i.add(p),b=[h,new ze(m.x,h.y),m,new ze(h.x,m.y)];return u&&b.push(h.clone()),b},a.af=function(c,i){const o=[];for(let u=0;u<c.length;u++){const p=Hr(u-1,-1,c.length-1),h=Hr(u+1,-1,c.length-1),m=c[u],b=c[h],S=c[p].sub(m).unit(),A=b.sub(m).unit(),y=A.angleWithSep(S.x,S.y),w=S.add(A).unit().mult(-1*i/Math.sin(y/2));o.push(m.add(w))}return o},a.ag=BA,a.ah=ps,a.ai=function(c,i,o=0){return we.vec3.fromValues(((i.x-o)*c.scale-c.x)*It,(i.y*c.scale-c.y)*It,ye(i.z,i.y))},a.aj=Ha,a.ak=tA,a.al=function(c){let i=1/0,o=1/0,u=-1/0,p=-1/0;for(const h of c)i=Math.min(i,h.x),o=Math.min(o,h.y),u=Math.max(u,h.x),p=Math.max(p,h.y);return{min:new ze(i,o),max:new ze(u,p)}},a.am=ae,a.an=zi,a.ao=ct,a.ap=Dt,a.aq=n,a.ar=function(c,i){const o={};for(let u=0;u<i.length;u++){const p=i[u];p in c&&(o[p]=c[p])}return o},a.as=Z,a.at=ce,a.au=class{constructor(c){this.entries={},this.scheduler=c}request(c,i,o,u){const p=this.entries[c]=this.entries[c]||{callbacks:[]};if(p.result){const[h,m]=p.result;return this.scheduler?this.scheduler.add(()=>{u(h,m)},i):u(h,m),()=>{}}return p.callbacks.push(u),p.cancel||(p.cancel=o((h,m)=>{p.result=[h,m];for(const b of p.callbacks)this.scheduler?this.scheduler.add(()=>{b(h,m)},i):b(h,m);setTimeout(()=>delete this.entries[c],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(h=>h!==u),p.callbacks.length||(p.cancel(),delete this.entries[c]))}}},a.av=Ov,a.aw=function(c,i,o){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},p=>{const h=Uc(c.request,(m,b,S,A)=>{m?p(m):b&&p(null,{vectorTile:o?void 0:new tp.VectorTile(new eb(b)),rawData:b,cacheControl:S,expires:A})});return()=>{h.cancel(),p()}},i)},a.ax=function(c){Mn++,Mn>ai&&(c.getActor().send("enforceCacheSizeLimit",mr),Mn=0)},a.ay=kt,a.az=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},a.b=function(c){return Se.API_FONTS_REGEX.test(c)},a.b$=function(c){const{x:i,y:o}=c.point,{lng:u,lat:p}=c._center;return WP(i,o,c.worldSize,u,p)},a.b0=gs,a.b1=on,a.b2=xg,a.b3=Jw,a.b4=function(c,i){const o=Su(i.zoom);if(o===0)return Ol(c);const u=$v(c),p=gw(u),h=ae(u.getWest())*i.worldSize,m=ae(u.getEast())*i.worldSize,b=ce(u.getNorth())*i.worldSize,S=ce(u.getSouth())*i.worldSize,A=[h,b,0],y=[m,b,0],w=[h,S,0],P=[m,S,0],E=we.mat4.invert([],i.globeMatrix);return we.vec3.transformMat4(A,A,E),we.vec3.transformMat4(y,y,E),we.vec3.transformMat4(w,w,E),we.vec3.transformMat4(P,P,E),p[0]=dc(p[0],w,o),p[1]=dc(p[1],P,o),p[2]=dc(p[2],y,o),p[3]=dc(p[3],A,o),Di.fromPoints(p)},a.b5=Vv,a.b6=vg,a.b7=dc,a.b8=Uf,a.b9=$o,a.bA=Hr,a.bB=Mt,a.bC=Yl,a.bD=oe,a.bE=function(c,i,o){c[4*i+0]=o[0],c[4*i+1]=o[1],c[4*i+2]=o[2],c[4*i+3]=o[3]},a.bF=Zh,a.bG=ya,a.bH=mg,a.bI=fo,a.bJ=cc,a.bK=U,a.bL=$A,a.bM=Dn,a.bN=Eu,a.bO=nC,a.bP=jn,a.bQ=GP,a.bR=function(c,i,o,u,p,h,m,b,S){if(S.name==="globe")return GP(c,i,new jn(o,u,p),!1);const A=Bg({z:o,x:u,y:p},S);return new Di([(h+A.x/A.scale)*i,i*(A.y/A.scale),m],[(h+A.x2/A.scale)*i,i*(A.y2/A.scale),b])},a.bS=function(c,i,o){let u=0;for(let p=0;p<2;++p)c[p]>0&&(u+=(c[p]-0)*(c[p]-0)),i[p]<0&&(u+=(0-i[p])*(0-i[p]));return u},a.bT=ge,a.bU=f,a.bV=function(c){const i=we.mat4.identity(new Float64Array(16));we.mat4.multiply(i,c.pixelMatrix,c.globeMatrix);const o=[0,C,0],u=[0,D,0];return we.vec3.transformMat4(o,o,i),we.vec3.transformMat4(u,u,i),[o[0]>0&&o[0]<=c.width&&o[1]>0&&o[1]<=c.height&&!vw(c,new U(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!vw(c,new U(c.center.lat,-90))]},a.bW=function(c,i){const{scale:o}=c.tileTransform,u=o*It/(c.tileSize*Math.pow(2,i.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return we.mat2.scale(new Float32Array(4),i.inverseAdjustmentMatrix,[u,u])},a.bX=_b,a.bY=iC,a.bZ=function(c){const i=iC(c,!0);return we.mat2.invert([],[i[0],i[1],i[4],i[5]])},a.b_=Sl,a.ba=dT,a.bb=eb,a.bc=Uc,a.bd=function(c){const i=[];for(const o in c)i.push(c[o]);return i},a.be=function(c,i){const o=[];for(const u in c)u in i||o.push(u);return o},a.bf=Oi,a.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.bh=Bt,a.bi=function(c,i){const{x:o,y:u}=c.point,p=WP(o,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return we.mat4.multiply(p,p,_w(Ol(i)))},a.bj=rp,a.bk=Ws,a.bl=Qv,a.bm=function(c,i,o,u,p){const h=5*i+2;c.float32[h+0]=o,c.float32[h+1]=u,c.float32[h+2]=p},a.bn=hb,a.bo=EA,a.bp=Ot,a.bq=io,a.br=O2,a.bs=lC,a.bt=I2,a.bu=D2,a.bv=qw,a.bw=IA,a.bx=Vw,a.by=yT,a.bz=li,a.c=ke,a.c$=Po,a.c0=Vt,a.c1=Oo,a.c2=l,a.c3=function(c){const i=Math.round((c+45+360)%360/90)%4;return Gt[i]},a.c4=45,a.c5=J,a.c6=Jf,a.c7=function(c,i,o){const u=Math.sqrt(c*c+i*i+o*o),p=u>0?Math.acos(o/u)*qt:0;let h=c!==0||i!==0?Math.atan2(-i,-c)*qt+90:0;return h<0&&(h+=360),[u,h,p]},a.c8=Te,a.c9=Di,a.cA=function(c){const i=ge-5;c=Dt(c,-i,i)/i*90;const o=Math.pow(Math.abs(Math.sin(Mt(c))),3);return Math.round(o*(x.length-1))},a.cB=function(c,i,o,u){const p=i.getNorth(),h=i.getSouth(),m=i.getWest(),b=i.getEast(),S=1<<c.z,A=b-m,y=p-h,w=A/v,P=-y/x[o],E=[0,w,0,P,0,0,p,m,0];if(c.z>0){const O=180/u;we.mat3.multiply(E,E,[O/A+1,0,0,0,O/y+1,0,-.5*O/w,.5*O/P,1])}return E[2]=S,E[5]=c.x,E[8]=c.y,E},a.cC=Ol,a.cD=function(c,i,o){const u=we.mat4.identity(new Float64Array(16)),p=(i/(1<<c)-.5)*Math.PI*2;return we.mat4.rotateY(u,o.globeMatrix,p),Float32Array.from(u)},a.cE=class{isDataAvailableAtPoint(c){const i=this._source();if(this.isUsingMockSource()||!i||c.y<0||c.y>1)return!1;const o=i.getSource().maxzoom,u=1<<o,p=Math.floor(c.x),h=Math.floor((c.x-p)*u),m=Math.floor(c.y*u),b=this.findDEMTileFor(new Ii(o,p,o,h,m));return!(!b||!b.dem)}getAtPointOrZero(c,i=0){return this.getAtPoint(c,i)||0}getAtPoint(c,i,o=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const u=this._source();if(!u||c.y<0||c.y>1)return i;const p=u.getSource().maxzoom,h=1<<p,m=Math.floor(c.x),b=c.x-m,S=new Ii(p,m,p,Math.floor(b*h),Math.floor(c.y*h)),A=this.findDEMTileFor(S);if(!A||!A.dem)return i;const y=A.dem,w=1<<A.tileID.canonical.z,P=(b*w-A.tileID.canonical.x)*y.dim,E=(c.y*w-A.tileID.canonical.y)*y.dim,O=Math.floor(P),M=Math.floor(E);return(o?this.exaggeration():1)*nr(nr(y.get(O,M),y.get(O,M+1),E-M),nr(y.get(O+1,M),y.get(O+1,M+1),E-M),P-O)}getAtTileOffset(c,i,o){const u=1<<c.canonical.z;return this.getAtPointOrZero(new $e(c.wrap+(c.canonical.x+i/It)/u,(c.canonical.y+o/It)/u))}getAtTileOffsetFunc(c,i,o,u){return p=>{const h=this.getAtTileOffset(c,p.x,p.y),m=u.upVector(c.canonical,p.x,p.y),b=u.upVectorScale(c.canonical,i,o).metersToTile;return we.vec3.scale(m,m,h*b),m}}getForTilePoints(c,i,o,u){if(this.isUsingMockSource())return!1;const p=lp.create(this,c,u);return!!p&&(i.forEach(h=>{h[2]=this.exaggeration()*p.getElevationAt(h[0],h[1],o)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(c);if(!i||!i.dem)return null;const o=i.dem.tree,u=i.tileID,p=1<<c.canonical.z-u.canonical.z;let h=c.canonical.x/p-u.canonical.x,m=c.canonical.y/p-u.canonical.y,b=0;for(let S=0;S<c.canonical.z-u.canonical.z&&!o.leaves[b];S++){h*=2,m*=2;const A=2*Math.floor(m)+Math.floor(h);b=o.childOffsets[b]+A,h%=1,m%=1}return{min:this.exaggeration()*o.minimums[b],max:this.exaggeration()*o.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,i,o){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let i=!1,o=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const p of c){const h=this.getMinMaxForTile(p.tileID);h&&(o=Math.min(o,h.min),u=Math.max(u,h.max),i=!0)}return i?{min:o,max:u}:null}},a.cF=s2,a.cG=hc,a.cH=function(c,i){return[Math.pow(c[0],2.2)*i,Math.pow(c[1],2.2)*i,Math.pow(c[2],2.2)*i]},a.cI=qP,a.cJ=pe,a.cK=re,a.cL=256,a.cM=function(c,i){const o=[0,0,0],u=Vv(Ol(i.canonical));return we.vec3.transformMat4(o,o,u),we.vec3.transformMat4(o,o,c),o},a.cN=c=>({u_camera_to_center_distance:new fo(c),u_extrude_scale:new _g(c),u_device_pixel_ratio:new fo(c),u_matrix:new Zh(c),u_inv_rot_matrix:new Zh(c),u_merc_center:new ya(c),u_tile_id:new mg(c),u_zoom_transition:new fo(c),u_up_dir:new mg(c),u_emissive_strength:new fo(c)}),a.cO=c=>({u_matrix:new Zh(c),u_pixels_to_tile_units:new _g(c),u_device_pixel_ratio:new fo(c),u_units_to_pixels:new ya(c),u_dash_image:new cc(c),u_gradient_image:new cc(c),u_image_height:new fo(c),u_texsize:new ya(c),u_tile_units_to_pixels:new fo(c),u_alpha_discard_threshold:new fo(c),u_trim_offset:new ya(c),u_trim_fade_range:new ya(c),u_trim_color:new Jf(c),u_emissive_strength:new fo(c)}),a.cP=c=>({u_matrix:new Zh(c),u_texsize:new ya(c),u_pixels_to_tile_units:new _g(c),u_device_pixel_ratio:new fo(c),u_image:new cc(c),u_units_to_pixels:new ya(c),u_tile_units_to_pixels:new fo(c),u_alpha_discard_threshold:new fo(c),u_trim_offset:new ya(c)}),a.cQ=So,a.cR=Yj,a.cS=Jj,a.cT=KP,a.cU=(c,i,o,u,p,h)=>{const m=c.transform,b=m.projection.name==="globe";let S;if(h.paint.get("circle-pitch-alignment")==="map")if(b){const y=qP(m.zoom,i.canonical)*m._pixelsPerMercatorPixel;S=Float32Array.from([y,0,0,y])}else S=m.calculatePixelsToTileUnitsMatrix(o);else S=new Float32Array([m.pixelsToGLUnits[0],0,0,m.pixelsToGLUnits[1]]);const A={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(m.projection),u_matrix:c.translatePosMatrix(i.projMatrix,o,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:zt.devicePixelRatio,u_extrude_scale:S,u_inv_rot_matrix:tj,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(b){A.u_inv_rot_matrix=u,A.u_merc_center=p,A.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],A.u_zoom_transition=Su(m.zoom);const y=p[0]*It,w=p[1]*It;A.u_up_dir=m.projection.upVector(new jn(0,0,0),y,w)}return A},a.cV=nA,a.cW=(c,i,o,u,p,h)=>{const m=c.transform;return{u_matrix:iA(c,i,o,u),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:m.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:p,u_image:0,u_tile_units_to_pixels:rA(i,m),u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:h}},a.cX=(c,i,o,u,p,h,m)=>{const b=c.transform,S=b.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:iA(c,i,o,u),u_pixels_to_tile_units:S,u_device_pixel_ratio:h,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:oA(o)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:rA(i,c.transform),u_alpha_discard_threshold:0,u_trim_offset:m,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength")}},a.cY=ds,a.cZ=bg,a.c_=H2,a.ca=Wo,a.cb=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},a.cc=function(c){return c({pluginStatus:Vn,pluginURL:vl}),Jm.on("pluginStateChange",c),c},a.cd=cp,a.ce=Tb,a.cf=np,a.cg=Gw,a.ch=fm,a.ci=xv,a.cj=pr,a.ck=Bo,a.cl=vn,a.cm=function(c){const i=c.indexOf(gu);return i>=0?c.slice(0,i):c},a.cn=function(c){return c.indexOf(gu)>=0},a.co=function(c){const i=c.indexOf(gu);return i>=0?c.slice(i+1):""},a.cp=function(c){const i=[],o=c.id;return o===void 0&&i.push({message:`layers.${o}: missing required property "id"`}),c.render===void 0&&i.push({message:`layers.${o}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&i.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),i},a.cq=function(c,i,o,u){return c.type==="custom"?new CV(c,i):new $V[c.type](c,i,o,u)},a.cr=Nn,a.cs=Jm,a.ct=yh,a.cu=gg,a.cv=class extends Ga{constructor(c){super(c),this.current=cw}set(c,i,o){if(this.fetchUniformLocation(c,i)){for(let u=0;u<9;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},a.cw=Nt,a.cx=function(c,i,o){const u=Su(o.zoom),p=c.style.map._antialias,h=i.options.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return u===0&&!p&&!h},a.cy=function(c){const i=c.pixelsPerMeter,o=i/oe(1,c.center.lat),u=we.mat4.identity(new Float64Array(16));return we.mat4.translate(u,u,[c.point.x,c.point.y,0]),we.mat4.scale(u,u,[o,o,i]),Float32Array.from(u)},a.cz=$v,a.d=function(c){return Se.API_TILEJSON_REGEX.test(c)},a.d$=N,a.d0=Jv,a.d1=Pu,a.d2=450,a.d3=7,a.d4=AV,a.d5=ti,a.d6=Wf,a.d7=256,a.d8=_w,a.d9=wl,a.dA=ZP,a.dB=function(c){const i=[0,0,0],o=we.mat4.identity(new Float64Array(16));return we.mat4.multiply(o,c.pixelMatrix,c.globeMatrix),we.vec3.transformMat4(i,i,o),new ze(i[0],i[1])},a.dC=function(c,i,o=!1){if(Vn===zh||Vn===Fh||Vn===zf)throw new Error("setRTLTextPlugin cannot be called multiple times.");vl=zt.resolveURL(c),Vn=zh,du=i,Ym(),o||eg()},a.dD=Qm,a.dE=function(){Tb().acquire(fT)},a.dF=function(){const c=Wg;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(fT),Wg=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.dG=qg,a.dH=function(c){const i=Wi();if(!i)return;const o=i.delete(_r);c&&o.catch(c).then(()=>c())},a.dI=Hg,a.dJ=zC,a.dK=function(c){pT=zt.resolveURL(c),dp||(dp=new cp(Tb(),new Hc)),dp.broadcast("setDracoUrl",pT)},a.dL=FC,a.dM=function(c){hp=zt.resolveURL(c),dp||(dp=new cp(Tb(),new Hc)),dp.broadcast("setMeshoptUrl",hp)},a.dN=jt,a.dO=Ou,a.dP=Wa,a.dQ=WC,a.dR=XC,a.dS=Y2,a.dT=ha,a.dU=OA,a.dV=function(c,i,o,u,p,h,m,b,S,A,y){c.createArrays(),c.tilePixelRatio=It/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const w=c.layers[0].layout,P=c.layers[0]._unevaluatedLayout._values,E={};if(c.textSizeData.kind==="composite"){const{minZoom:z,maxZoom:V}=c.textSizeData;E.compositeTextSizes=[P["text-size"].possiblyEvaluate(new nn(z),b),P["text-size"].possiblyEvaluate(new nn(V),b)]}if(c.iconSizeData.kind==="composite"){const{minZoom:z,maxZoom:V}=c.iconSizeData;E.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new nn(z),b),P["icon-size"].possiblyEvaluate(new nn(V),b)]}E.layoutTextSize=P["text-size"].possiblyEvaluate(new nn(S+1),b),E.layoutIconSize=P["icon-size"].possiblyEvaluate(new nn(S+1),b),E.textMaxSize=P["text-size"].possiblyEvaluate(new nn(18),b);const O=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point",M=w.get("text-size");let R=!1;for(const z of c.features)if(z.icon&&z.icon.nameSecondary){R=!0;break}for(const z of c.features){const V=w.get("text-font").evaluate(z,{},b).join(","),G=M.evaluate(z,{},b),F=E.layoutTextSize.evaluate(z,{},b),q=(E.layoutIconSize.evaluate(z,{},b),{horizontal:{},vertical:void 0}),W=z.text;let te,se=[0,0];if(W){const me=W.toString(),he=w.get("text-letter-spacing").evaluate(z,{},b)*io,_e=w.get("text-line-height").evaluate(z,{},b)*io,Ae=Y1(me)?he:0,Me=w.get("text-anchor").evaluate(z,{},b),Re=w.get("text-variable-anchor");if(!Re){const ut=w.get("text-radial-offset").evaluate(z,{},b);se=ut?IA(Me,[ut*io,Hw]):w.get("text-offset").evaluate(z,{},b).map(Xe=>Xe*io)}let Be=O?"center":w.get("text-justify").evaluate(z,{},b);const Ge=w.get("symbol-placement")==="point",Fe=Ge?w.get("text-max-width").evaluate(z,{},b)*io:1/0,tt=ut=>{c.allowVerticalPlacement&&Lf(me)&&(q.vertical=jw(W,i,o,p,V,Fe,_e,Me,ut,Ae,se,Ws.vertical,!0,F,G))};if(!O&&Re){const ut=Be==="auto"?Re.map(Lt=>qw(Lt)):[Be];let Xe=!1;for(let Lt=0;Lt<ut.length;Lt++){const Pt=ut[Lt];if(!q.horizontal[Pt])if(Xe)q.horizontal[Pt]=q.horizontal[0];else{const bt=jw(W,i,o,p,V,Fe,_e,"center",Pt,Ae,se,Ws.horizontal,!1,F,G);bt&&(q.horizontal[Pt]=bt,Xe=bt.positionedLines.length===1)}}tt("left")}else{if(Be==="auto"&&(Be=qw(Me)),Ge||w.get("text-writing-mode").indexOf("horizontal")>=0||!Lf(me)){const ut=jw(W,i,o,p,V,Fe,_e,Me,Be,Ae,se,Ws.horizontal,!1,F,G);ut&&(q.horizontal[Be]=ut)}tt(Ge?"left":Be)}}let le=!1;if(z.icon&&z.icon.namePrimary){const me=u[z.icon.namePrimary];me&&(te=lV(p[z.icon.namePrimary],z.icon.nameSecondary?p[z.icon.nameSecondary]:void 0,w.get("icon-offset").evaluate(z,{},b),w.get("icon-anchor").evaluate(z,{},b)),le=me.sdf,c.sdfIcons===void 0?c.sdfIcons=me.sdf:c.sdfIcons!==me.sdf&&Jr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(me.pixelRatio!==c.pixelRatio||w.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const ne=RA(q.horizontal)||q.vertical;c.iconsInText||(c.iconsInText=!!ne&&ne.iconsInText),(ne||te)&&mV(c,z,q,te,u,E,F,0,se,le,m,b,A,y,R)}h&&c.generateCollisionDebugBuffers(S,c.collisionBoxArray)},a.dW=tp,a.dX=wb,a.dY=Qe,a.dZ=w2,a.d_=hA,a.da=Ua,a.db=ug,a.dc=function(c,i,o,u,p){return Dt((c-i)/(o-i)*(p-u)+u,u,p)},a.dd=Of,a.de=Ce,a.df=class{constructor(c,i,o,u){this.context=c,this.format=u,this.size=o,this.texture=c.gl.createTexture();const[p,h,m]=this.size,{gl:b}=c;b.bindTexture(b.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),b.texImage3D(b.TEXTURE_3D,0,this.format,p,h,m,0,Qw(this.format),eT(this.format),i.data)}bind(c,i){const{context:o}=this,{gl:u}=o;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),i!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,i),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},a.dg=nT,a.dh=[1,1,1],a.di=lp,a.dj=ap,a.dk=Tl,a.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new ze(1/0,1/0),max:new ze(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,i=!1){const o=A2(new ze(0,0),new ze(It,It),c),u=[];if(i&&!Mw(o,this._globalClipBounds))return u;for(const p of this._activeRegions){if(p.hiddenByOverlap||!Mw(o,p))continue;const h=Ej(p.min,p.max,c);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return u}setSources(c){this._setSources(c.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const o=[];for(const u of i.cache.getVisibleCoordinates()){const p=i.cache.getTile(u).buckets[i.layer];p&&p.updateFootprints(u.toUnwrapped(),o)}return o},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(c){const i=c.getFootprints();if(i.length===0)return;const o=c.getOrder(),u=c.getClipMask(),p=c.getClipScope();for(const h of i){if(!h.footprint)continue;const m=A2(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:m.min,max:m.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:o,clipMask:u,clipScope:p})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,o)=>i.priority-o.priority||Kv(i.min,o.min)||Kv(i.max,o.max)||i.order-o.order||i.clipMask-o.clipMask||function(u,p){const h=(m,b)=>m+b;return u.length-p.length||u.reduce(h,"").localeCompare(p.reduce(h,""))}(i.clipScope,o.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let i=0;for(;!c&&i!==this._activeRegions.length;){const o=this._activeRegions[i],u=this._prevRegions[i];c=o.priority!==u.priority||!P2(o,u)||o.order!==u.order||o.clipMask!==u.clipMask||!Bt(o.clipScope,u.clipScope),++i}}if(c){++this._updateTime;for(const o of this._activeRegions)o.order!==Xv&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const i=o=>{const u=this._activeRegions;if(o>=u.length)return o;const p=u[o].priority;for(;o<u.length&&u[o].priority===p;)++o;return o};if(this._sourceIds.length>1){let o=0,u=i(o);for(;o!==u;){let p=o;const h=o;for(;p!==u;){const m=this._activeRegions[p];m.hiddenByOverlap=!1;for(let b=0;b<h;b++){const S=this._activeRegions[b];if(!S.hiddenByOverlap&&m.order===Xv&&Mw(m,S)&&(m.hiddenByOverlap=M2(m.footprint,m.tileId,S.footprint,S.tileId),m.hiddenByOverlap))break}++p}o=u,u=i(o)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=c.length-1;i>=0;i--)this._addSource(c[i]);this._computeReplacement()}},a.dm=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,i){const o=new bl,u=new Jn,p=[],h=c+1+2,m=i[0]+1,b=i[0]+1+(1+i.length),S=(A,y,w)=>{let P=A===h-1?A-2:A===0?A:A-1;return P+=w?24575:0,[P,y]};for(let A=0;A<h;++A)o.emplaceBack(...S(A,0,!0));for(let A=0;A<m;++A)for(let y=0;y<h;++y)o.emplaceBack(...S(y,A,(y===0||y===h-1)&&!0));for(let A=0;A<i.length;++A){const y=i[A];for(let w=0;w<h;++w)o.emplaceBack(...S(w,y,!0))}for(let A=0;A<i.length;++A){const y=u.length,w=i[A]+1+2,P=new Jn;for(let M=0;M<w-1;M++){const R=M===w-2,z=R?h*(b-i.length+A-M):h;for(let V=0;V<h-1;V++){const G=M*h+V;M===0||R||V===0||V===h-2?(P.emplaceBack(G+1,G,G+z),P.emplaceBack(G+z,G+z+1,G+1)):(u.emplaceBack(G+1,G,G+z),u.emplaceBack(G+z,G+z+1,G+1))}}const E=on.simpleSegment(0,y,o.length,u.length-y);for(let M=0;M<P.uint16.length;M+=3)u.emplaceBack(P.uint16[M],P.uint16[M+1],P.uint16[M+2]);const O=on.simpleSegment(0,y,o.length,u.length-y);p.push({withoutSkirts:E,withSkirts:O})}return{vertices:o,indices:u,segments:p}}_createGrid(c){const i=this._fillGridMeshWithLods(v,x);this._gridSegments=i.segments,this._gridBuffer=c.createVertexBuffer(i.vertices,gs.members),this._gridIndexBuffer=c.createIndexBuffer(i.indices,!0)}_createPoles(c){const i=new Jn;for(let m=0;m<=v;m++)i.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=c.createIndexBuffer(i,!0);const o=new Ua,u=new Ua,p=new Ua,h=new Ua;this._poleSegments=[];for(let m=0,b=0;m<l;m++){const S=360/(1<<m);o.emplaceBack(0,-n,0,.5,0),u.emplaceBack(0,-n,0,.5,1),p.emplaceBack(0,-n,0,.5,.5),h.emplaceBack(0,-n,0,.5,.5);for(let A=0;A<=v;A++){let y=A/v,w=0;const P=nr(0,S,y),[E,O,M]=L(Q$,ej,P,n);o.emplaceBack(E,O,M,y,w),u.emplaceBack(E,O,M,y,1-w);const R=Mt(P);y=.5+.5*Math.sin(R),w=.5+.5*Math.cos(R),p.emplaceBack(E,O,M,y,w),h.emplaceBack(E,O,M,y,1-w)}this._poleSegments.push(on.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(o,es,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,es,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(p,es,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(h,es,!1)}getGridBuffers(c,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},a.dn=Xv,a.dp=br,a.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.dr=ar,a.ds=Oe,a.dt=B,a.du=function([c,i,o]){const u=Math.hypot(c,i,o),p=Math.atan2(c,o),h=.5*Math.PI-Math.acos(-i/u);return new U(Vt(p),Vt(h))},a.dv=iT,a.dw=$,a.dx=function(c){const i=c.navigator?c.navigator.userAgent:null;return!!function(o){if(gh==null){const u=o.navigator?o.navigator.userAgent:null;gh=!!o.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return gh}(c)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.dy=function(c,i){mr=c,ai=i},a.dz=vw,a.e=Se,a.e0=function(c){let i=0;if(new Uint32Array(c,0,1)[0]!==$C){const o=new Uint32Array(c,0,7),[,,u,p,h,m]=o;i=o.byteLength+p+h+m+h,(u!==c.byteLength||i>=c.byteLength)&&Jr("Invalid b3dm header information.")}return GC(c,i)},a.e1=function(c,i){const o=qC(c);for(const u of o){for(const p of u.meshes)O6(p);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(P6(u.lights,i)))}return o},a.e2=xb,a.e3=bC,a.e4=No,a.e5=function(c){On(),Or!=null&&Or.then(i=>{i.keys().then(o=>{for(let u=0;u<o.length-c;u++)i.delete(o[u])})})},a.f=function(c){return c.indexOf("mapbox:")===0},a.g=function(c,i){return yh(Kr(c,{method:"GET"}),i)},a.h=be,a.i=function(c){return Se.API_STYLE_REGEX.test(c)&&!ke(c)},a.j=function(c){return decodeURIComponent(atob(c).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},a.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(i,o)=>String.fromCharCode(Number("0x"+o))))},a.l=Kr,a.m=Yn,a.n=function(c,i){return yh(Kr(c,{type:"json"}),i)},a.o=fa,a.p=function(c,i){return yh(Kr(c,{method:"POST"}),i)},a.q=zt,a.r=Ao,a.s=function(c){try{const i=self[c];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=bh,a.u=function(){return function c(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},a.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},a.w=Jr,a.x=fl,a.y=2,a.z=SA}),T(["./shared"],function(a){function N(qe){const Q=qe?qe.url.toString():void 0;return Q?performance.getEntriesByName(Q):[]}function H(qe){if(typeof qe=="number"||typeof qe=="boolean"||typeof qe=="string"||qe==null)return JSON.stringify(qe);if(Array.isArray(qe)){let re="[";for(const pe of qe)re+=`${H(pe)},`;return`${re}]`}let Q="{";for(const re of Object.keys(qe).sort())Q+=`${re}:${H(qe[re])},`;return`${Q}}`}function K(qe){let Q="";for(const re of a.bg)Q+=`/${H(qe[re])}`;return Q}class ee{constructor(Q){this.keyCache={},this._layers={},this._layerConfigs={},Q&&this.replace(Q)}replace(Q,re){this._layerConfigs={},this._layers={},this.update(Q,[],re)}update(Q,re,pe){this._options=pe;for(const be of Q)this._layerConfigs[be.id]=be,(this._layers[be.id]=a.cq(be,this.scope,null,this._options)).compileFilter(pe),this.keyCache[be.id]&&delete this.keyCache[be.id];for(const be of re)delete this.keyCache[be],delete this._layerConfigs[be],delete this._layers[be];this.familiesBySource={};const Se=function(be,ke){const We={};for(let Ze=0;Ze<be.length;Ze++){const it=ke&&ke[be[Ze].id]||K(be[Ze]);ke&&(ke[be[Ze].id]=it);let et=We[it];et||(et=We[it]=[]),et.push(be[Ze])}const Ve=[];for(const Ze in We)Ve.push(We[Ze]);return Ve}(a.bd(this._layerConfigs),this.keyCache);for(const be of Se){const ke=be.map(yt=>this._layers[yt.id]),We=ke[0];if(We.visibility==="none")continue;const Ve=We.source||"";let Ze=this.familiesBySource[Ve];Ze||(Ze=this.familiesBySource[Ve]={});const it=We.sourceLayer||"_geojsonTileLayer";let et=Ze[it];et||(et=Ze[it]=[]),et.push(ke)}}}const ue=1*a.dP;class Pe{constructor(Q){const re={},pe=[];for(const We in Q){const Ve=Q[We],Ze=re[We]={};for(const it in Ve.glyphs){const et=Ve.glyphs[+it];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const yt=et.metrics.localGlyph?ue:1,kt={x:0,y:0,w:et.bitmap.width+2*yt,h:et.bitmap.height+2*yt};pe.push(kt),Ze[it]=kt}}const{w:Se,h:be}=a.z(pe),ke=new a.dO({width:Se||1,height:be||1});for(const We in Q){const Ve=Q[We];for(const Ze in Ve.glyphs){const it=Ve.glyphs[+Ze];if(!it||it.bitmap.width===0||it.bitmap.height===0)continue;const et=re[We][Ze],yt=it.metrics.localGlyph?ue:1;a.dO.copy(it.bitmap,ke,{x:0,y:0},{x:et.x+yt,y:et.y+yt},it.bitmap)}}this.image=ke,this.positions=re}}a.dN(Pe,"GlyphAtlas");class xe{constructor(Q){this.tileID=new a.aA(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.tileZoom=Q.tileZoom,this.uid=Q.uid,this.zoom=Q.zoom,this.lut=Q.lut,this.canonical=Q.tileID.canonical,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.scope=Q.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.promoteId=Q.promoteId,this.isSymbolTile=Q.isSymbolTile,this.tileTransform=a.aK(Q.tileID.canonical,Q.projection),this.projection=Q.projection,this.brightness=Q.brightness,this.extraShadowCaster=!!Q.extraShadowCaster,this.tessellationStep=Q.tessellationStep}parse(Q,re,pe,Se,be){this.status="parsing",this.data=Q,this.collisionBoxArray=new a.aQ;const ke=new a.dQ(Object.keys(Q.layers).sort()),We=new a.dR(this.tileID,this.promoteId);We.bucketLayerIDs=[];const Ve={},Ze=new a.dS(256,256),it={featureIndex:We,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Ze,availableImages:pe,brightness:this.brightness},et=re.familiesBySource[this.source];for(const mr in et){const ai=Q.layers[mr];if(!ai)continue;let pi=!1,Or=!1,di=!1;for(const Mn of et[mr])Mn[0].type==="symbol"?pi=!0:Or=!0,Mn[0].is3D()&&Mn[0].type!=="model"&&(di=!0);if(this.extraShadowCaster&&!di||this.isSymbolTile===!0&&!pi||this.isSymbolTile===!1&&!Or)continue;ai.version===1&&a.w(`Vector tile source "${this.source}" layer "${mr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Wi=ke.encode(mr),On=[];for(let Mn=0;Mn<ai.length;Mn++){const Yn=ai.feature(Mn),Fs=We.getId(Yn,mr);On.push({feature:Yn,id:Fs,index:Mn,sourceLayerIndex:Wi})}for(const Mn of et[mr]){const Yn=Mn[0];(!this.extraShadowCaster||Yn.is3D()&&Yn.type!=="model")&&(this.isSymbolTile!==void 0&&Yn.type==="symbol"!==this.isSymbolTile||Yn.minzoom&&this.zoom<Math.floor(Yn.minzoom)||Yn.maxzoom&&this.zoom>=Yn.maxzoom||Yn.visibility!=="none"&&(Ie(Mn,this.zoom,it.brightness,pe),(Ve[Yn.id]=Yn.createBucket({index:We.bucketLayerIDs.length,layers:Mn,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Wi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(On,it,this.tileID.canonical,this.tileTransform),We.bucketLayerIDs.push(Mn.map(Fs=>Fs.id))))}}let yt,kt,zt,ur;Ze.trim();const pr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},_r=()=>{if(yt)return this.status="done",be(yt);if(this.extraShadowCaster)this.status="done",be(null,{buckets:a.bd(Ve).filter(mr=>!mr.isEmpty()),featureIndex:We,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:it.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(kt&&zt&&ur){const mr=new Pe(kt),ai=new a.dU(zt,ur,this.lut);for(const pi in Ve){const Or=Ve[pi];Or instanceof a.aR?(Ie(Or.layers,this.zoom,it.brightness,pe),a.dV(Or,kt,mr.positions,zt,ai.iconPositions,this.showCollisionBoxes,pe,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Or.hasPattern&&(Or instanceof a.aX||Or instanceof a.aY||Or instanceof a.d0)&&(Ie(Or.layers,this.zoom,it.brightness,pe),Or.addFeatures(it,this.tileID.canonical,ai.patternPositions,pe,this.tileTransform,this.brightness))}this.status="done",be(null,{buckets:a.bd(Ve).filter(pi=>!pi.isEmpty()),featureIndex:We,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:mr.image,lineAtlas:Ze,imageAtlas:ai,brightness:it.brightness})}};if(!this.extraShadowCaster){const mr=a.dT(it.glyphDependencies,Or=>Object.keys(Or).map(Number));Object.keys(mr).length?Se.send("getGlyphs",{uid:this.uid,stacks:mr,scope:this.scope},(Or,di)=>{yt||(yt=Or,kt=di,_r())},void 0,!1,pr):kt={};const ai=Object.keys(it.iconDependencies);ai.length?Se.send("getImages",{icons:ai,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Or,di)=>{yt||(yt=Or,zt=di,_r())},void 0,!1,pr):zt={};const pi=Object.keys(it.patternDependencies);pi.length?Se.send("getImages",{icons:pi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Or,di)=>{yt||(yt=Or,ur=di,_r())},void 0,!1,pr):ur={}}_r()}}function Ie(qe,Q,re,pe){const Se=new a.a3(Q,{brightness:re});for(const be of qe)be.recalculate(Se,pe)}class dt extends a.E{constructor(Q,re,pe,Se,be,ke){super(),this.actor=Q,this.layerIndex=re,this.availableImages=pe,this.loadVectorData=be||a.aw,this.loading={},this.loaded={},this.deduped=new a.au(Q.scheduler),this.isSpriteLoaded=Se,this.scheduler=Q.scheduler,this.brightness=ke}loadTile(Q,re){const pe=Q.uid,Se=Q&&Q.request,be=Se&&Se.collectResourceTiming,ke=this.loading[pe]=new xe(Q);ke.abort=this.loadVectorData(Q,(We,Ve)=>{const Ze=!this.loading[pe];if(delete this.loading[pe],Ze||We||!Ve)return ke.status="done",Ze||(this.loaded[pe]=ke),re(We);const it=Ve.rawData,et={};Ve.expires&&(et.expires=Ve.expires),Ve.cacheControl&&(et.cacheControl=Ve.cacheControl),ke.vectorTile=Ve.vectorTile||new a.dW.VectorTile(new a.bb(it));const yt=()=>{ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,(kt,zt)=>{if(kt||!zt)return re(kt);const ur={};if(be){const pr=N(Se);pr.length>0&&(ur.resourceTiming=JSON.parse(JSON.stringify(pr)))}re(null,a.l({rawTileData:it.slice(0)},zt,et,ur))})};this.isSpriteLoaded?yt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(yt,{type:"parseTile",isSymbolTile:Q.isSymbolTile,zoom:Q.tileZoom}):yt()}),this.loaded=this.loaded||{},this.loaded[pe]=ke})}reloadTile(Q,re){const pe=this.loaded,Se=Q.uid;if(pe&&pe[Se]){const be=pe[Se];be.showCollisionBoxes=Q.showCollisionBoxes,be.projection=Q.projection,be.brightness=Q.brightness,be.tileTransform=a.aK(Q.tileID.canonical,Q.projection),be.extraShadowCaster=Q.extraShadowCaster,be.lut=Q.lut;const ke=(We,Ve)=>{const Ze=be.reloadCallback;Ze&&(delete be.reloadCallback,be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,Ze)),re(We,Ve)};be.status==="parsing"?be.reloadCallback=ke:be.status==="done"&&(be.vectorTile?be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,ke):ke())}else re(null,void 0)}abortTile(Q,re){const pe=Q.uid,Se=this.loading[pe];Se&&(Se.abort&&Se.abort(),delete this.loading[pe]),re()}removeTile(Q,re){const pe=this.loaded,Se=Q.uid;pe&&pe[Se]&&delete pe[Se],re()}}class Le{loadTile(Q,re){const{uid:pe,encoding:Se,rawImageData:be,padding:ke}=Q,We=ImageBitmap&&be instanceof ImageBitmap?this.getImageData(be,ke):be;re(null,new a.dX(pe,We,Se,ke<1))}getImageData(Q,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const pe=this.offscreenCanvasContext.getImageData(-re,-re,Q.width+2*re,Q.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),pe}}a.ba.setPbf(a.bb);class De{decodeRasterArray({task:Q,buffer:re},pe){a.ba.performDecoding(re,Q).then(Se=>{pe(null,Se)},Se=>{pe(Se)})}}const Ye=a.dW.VectorTileFeature.prototype.toGeoJSON;class He{constructor(Q){this._feature=Q,this.extent=a.ab,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const re of this._feature.geometry)Q.push([new a.P(re[0],re[1])]);return Q}{const Q=[];for(const re of this._feature.geometry){const pe=[];for(const Se of re)pe.push(new a.P(Se[0],Se[1]));Q.push(pe)}return Q}}toGeoJSON(Q,re,pe){return Ye.call(this,Q,re,pe)}}class ht{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.ab,this.length=Q.length,this._features=Q}feature(Q){return new He(this._features[Q])}}const St=64/4096,st=128;class gt{constructor(){this.features=new Map}clear(){this.features.clear()}load(Q=[],re){for(const pe of Q){const Se=pe.id;if(Se==null)continue;let be=this.features.get(Se);be&&this.updateCache(be,re),pe.geometry?(be=at(pe),this.updateCache(be,re),this.features.set(Se,be)):this.features.delete(Se),this.updateCache(be,re)}}updateCache(Q,re){for(const{canonical:pe,uid:Se}of Object.values(re)){const{z:be,x:ke,y:We}=pe;Tt(Q,Math.pow(2,be),ke,We)&&delete re[Se]}}getTile(Q,re,pe){const Se=Math.pow(2,Q),be=[];for(const ke of this.features.values())Tt(ke,Se,re,pe)&&be.push(Jt(ke,Se,re,pe));return{features:be}}getFeatures(){return[...this.features.values()]}}function Tt({minX:qe,minY:Q,maxX:re,maxY:pe},Se,be,ke){return qe<(be+1+St)/Se&&Q<(ke+1+St)/Se&&re>(be-St)/Se&&pe>(ke-St)/Se}function at(qe){const{id:Q,geometry:re,properties:pe}=qe;if(!re)return;if(re.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Se,coordinates:be}=re,ke={id:Q,type:1,geometry:[],tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},We=ke.geometry;if(Se==="Point")ft(be,We,ke);else if(Se==="MultiPoint")for(const Ve of be)ft(Ve,We,ke);else if(Se==="LineString")ke.type=2,gr(be,We,ke);else if(Se==="MultiLineString")ke.type=2,xr(be,We,ke);else if(Se==="Polygon")ke.type=3,xr(be,We,ke,!0);else{if(Se!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");ke.type=3;for(const Ve of be)xr(Ve,We,ke,!0)}return ke}function ft([qe,Q],re,pe){const Se=a.am(qe);let be=a.at(Q);be=be<0?0:be>1?1:be,re.push(Se,be),pe.minX=Math.min(pe.minX,Se),pe.minY=Math.min(pe.minY,be),pe.maxX=Math.max(pe.maxX,Se),pe.maxY=Math.max(pe.maxY,be)}function gr(qe,Q,re,pe=!1,Se=!1){const be=[];for(const ke of qe)ft(ke,be,re);Q.push(be),pe&&function(ke,We){let Ve=0;for(let Ze=0,it=ke.length,et=it-2;Ze<it;et=Ze,Ze+=2)Ve+=(ke[Ze]-ke[et])*(ke[Ze+1]+ke[et+1]);if(Ve>0===We)for(let Ze=0,it=ke.length;Ze<it/2;Ze+=2){const et=ke[Ze],yt=ke[Ze+1];ke[Ze]=ke[it-2-Ze],ke[Ze+1]=ke[it-1-Ze],ke[it-2-Ze]=et,ke[it-1-Ze]=yt}}(be,Se)}function xr(qe,Q,re,pe=!1){for(let Se=0;Se<qe.length;Se++)gr(qe[Se],Q,re,pe,Se===0)}function Jt(qe,Q,re,pe){const{id:Se,type:be,geometry:ke,tags:We}=qe,Ve=[];if(be===1)(function(Ze,it,et,yt,kt){for(let zt=0;zt<Ze.length;zt+=2){const ur=Math.round(a.ab*(Ze[zt+0]*it-et)),pr=Math.round(a.ab*(Ze[zt+1]*it-yt));kt.push([ur,pr])}})(ke,Q,re,pe,Ve);else for(const Ze of ke)Zt(Ze,Q,re,pe,Ve);return{id:Se,type:be,geometry:Ve,tags:We}}function Zt(qe,Q,re,pe,Se){const be=-st,ke=a.ab+st;let We;for(let Ve=0;Ve<qe.length-2;Ve+=2){let Ze=Math.round(a.ab*(qe[Ve+0]*Q-re)),it=Math.round(a.ab*(qe[Ve+1]*Q-pe)),et=Math.round(a.ab*(qe[Ve+2]*Q-re)),yt=Math.round(a.ab*(qe[Ve+3]*Q-pe));const kt=et-Ze,zt=yt-it;Ze<be&&et<be||(Ze<be?(it+=Math.round(zt*((be-Ze)/kt)),Ze=be):et<be&&(yt=it+Math.round(zt*((be-Ze)/kt)),et=be),it<be&&yt<be||(it<be?(Ze+=Math.round(kt*((be-it)/zt)),it=be):yt<be&&(et=Ze+Math.round(kt*((be-it)/zt)),yt=be),Ze>=ke&&et>=ke||(Ze>=ke?(it+=Math.round(zt*((ke-Ze)/kt)),Ze=ke):et>=ke&&(yt=it+Math.round(zt*((ke-Ze)/kt)),et=ke),it>=ke&&yt>=ke||(it>=ke?(Ze+=Math.round(kt*((ke-it)/zt)),it=ke):yt>=ke&&(et=Ze+Math.round(kt*((ke-it)/zt)),yt=ke),We&&Ze===We[We.length-1][0]&&it===We[We.length-1][1]||(We=[[Ze,it]],Se.push(We)),We.push([et,yt])))))}}var Et,fr,jr,er={exports:{}},tn=function(){if(jr)return er.exports;jr=1;var qe=a.d_(),Q=function(){if(fr)return Et;fr=1;var it=a.dY(),et=a.dZ().VectorTileFeature;function yt(zt,ur){this.options=ur||{},this.features=zt,this.length=zt.length}function kt(zt,ur){this.id=typeof zt.id=="number"?zt.id:void 0,this.type=zt.type,this.rawGeometry=zt.type===1?[zt.geometry]:zt.geometry,this.properties=zt.tags,this.extent=ur||4096}return Et=yt,yt.prototype.feature=function(zt){return new kt(this.features[zt],this.options.extent)},kt.prototype.loadGeometry=function(){var zt=this.rawGeometry;this.geometry=[];for(var ur=0;ur<zt.length;ur++){for(var pr=zt[ur],_r=[],mr=0;mr<pr.length;mr++)_r.push(new it(pr[mr][0],pr[mr][1]));this.geometry.push(_r)}return this.geometry},kt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var zt=this.geometry,ur=1/0,pr=-1/0,_r=1/0,mr=-1/0,ai=0;ai<zt.length;ai++)for(var pi=zt[ai],Or=0;Or<pi.length;Or++){var di=pi[Or];ur=Math.min(ur,di.x),pr=Math.max(pr,di.x),_r=Math.min(_r,di.y),mr=Math.max(mr,di.y)}return[ur,_r,pr,mr]},kt.prototype.toGeoJSON=et.prototype.toGeoJSON,Et}();function re(it){var et=new qe;return function(yt,kt){for(var zt in yt.layers)kt.writeMessage(3,pe,yt.layers[zt])}(it,et),et.finish()}function pe(it,et){var yt;et.writeVarintField(15,it.version||1),et.writeStringField(1,it.name||""),et.writeVarintField(5,it.extent||4096);var kt={keys:[],values:[],keycache:{},valuecache:{}};for(yt=0;yt<it.length;yt++)kt.feature=it.feature(yt),et.writeMessage(2,Se,kt);var zt=kt.keys;for(yt=0;yt<zt.length;yt++)et.writeStringField(3,zt[yt]);var ur=kt.values;for(yt=0;yt<ur.length;yt++)et.writeMessage(4,Ze,ur[yt])}function Se(it,et){var yt=it.feature;yt.id!==void 0&&et.writeVarintField(1,yt.id),et.writeMessage(2,be,it),et.writeVarintField(3,yt.type),et.writeMessage(4,Ve,yt)}function be(it,et){var yt=it.feature,kt=it.keys,zt=it.values,ur=it.keycache,pr=it.valuecache;for(var _r in yt.properties){var mr=yt.properties[_r],ai=ur[_r];if(mr!==null){ai===void 0&&(kt.push(_r),ur[_r]=ai=kt.length-1),et.writeVarint(ai);var pi=typeof mr;pi!=="string"&&pi!=="boolean"&&pi!=="number"&&(mr=JSON.stringify(mr));var Or=pi+":"+mr,di=pr[Or];di===void 0&&(zt.push(mr),pr[Or]=di=zt.length-1),et.writeVarint(di)}}}function ke(it,et){return(et<<3)+(7&it)}function We(it){return it<<1^it>>31}function Ve(it,et){for(var yt=it.loadGeometry(),kt=it.type,zt=0,ur=0,pr=yt.length,_r=0;_r<pr;_r++){var mr=yt[_r],ai=1;kt===1&&(ai=mr.length),et.writeVarint(ke(1,ai));for(var pi=kt===3?mr.length-1:mr.length,Or=0;Or<pi;Or++){Or===1&&kt!==1&&et.writeVarint(ke(2,pi-1));var di=mr[Or].x-zt,Wi=mr[Or].y-ur;et.writeVarint(We(di)),et.writeVarint(We(Wi)),zt+=di,ur+=Wi}kt===3&&et.writeVarint(ke(7,1))}}function Ze(it,et){var yt=typeof it;yt==="string"?et.writeStringField(1,it):yt==="boolean"?et.writeBooleanField(7,it):yt==="number"&&(it%1!=0?et.writeDoubleField(3,it):it<0?et.writeSVarintField(6,it):et.writeVarintField(5,it))}return er.exports=re,er.exports.fromVectorTileJs=re,er.exports.fromGeojsonVt=function(it,et){et=et||{};var yt={};for(var kt in it)yt[kt]=new Q(it[kt].features,et),yt[kt].name=kt,yt[kt].version=et.version,yt[kt].extent=et.extent;return re({layers:yt})},er.exports.GeoJSONWrapper=Q,er.exports}(),ln=a.d$(tn);const Yi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:qe=>qe},ir=Math.fround||(us=new Float32Array(1),qe=>(us[0]=+qe,us[0]));var us;const rn=3,yi=5,Si=6;class hs{constructor(Q){this.options=Object.assign(Object.create(Yi),Q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Q){const{log:re,minZoom:pe,maxZoom:Se}=this.options;re&&console.time("total time");const be=`prepare ${Q.length} points`;re&&console.time(be),this.points=Q;const ke=[];for(let Ve=0;Ve<Q.length;Ve++){const Ze=Q[Ve];if(!Ze.geometry)continue;const[it,et]=Ze.geometry.coordinates,yt=ir(Kn(it)),kt=ir(Ne(et));ke.push(yt,kt,1/0,Ve,-1,1),this.options.reduce&&ke.push(0)}let We=this.trees[Se+1]=this._createTree(ke);re&&console.timeEnd(be);for(let Ve=Se;Ve>=pe;Ve--){const Ze=+Date.now();We=this.trees[Ve]=this._createTree(this._cluster(We,Ve)),re&&console.log("z%d: %d clusters in %dms",Ve,We.numItems,+Date.now()-Ze)}return re&&console.timeEnd("total time"),this}getClusters(Q,re){let pe=((Q[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,Q[1]));let be=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)pe=-180,be=180;else if(pe>be){const et=this.getClusters([pe,Se,180,ke],re),yt=this.getClusters([-180,Se,be,ke],re);return et.concat(yt)}const We=this.trees[this._limitZoom(re)],Ve=We.range(Kn(pe),Ne(ke),Kn(be),Ne(Se)),Ze=We.data,it=[];for(const et of Ve){const yt=this.stride*et;it.push(Ze[yt+yi]>1?qi(Ze,yt,this.clusterProps):this.points[Ze[yt+rn]])}return it}getChildren(Q){const re=this._getOriginId(Q),pe=this._getOriginZoom(Q),Se="No cluster with the specified id.",be=this.trees[pe];if(!be)throw new Error(Se);const ke=be.data;if(re*this.stride>=ke.length)throw new Error(Se);const We=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),Ve=be.within(ke[re*this.stride],ke[re*this.stride+1],We),Ze=[];for(const it of Ve){const et=it*this.stride;ke[et+4]===Q&&Ze.push(ke[et+yi]>1?qi(ke,et,this.clusterProps):this.points[ke[et+rn]])}if(Ze.length===0)throw new Error(Se);return Ze}getLeaves(Q,re,pe){const Se=[];return this._appendLeaves(Se,Q,re=re||10,pe=pe||0,0),Se}getTile(Q,re,pe){const Se=this.trees[this._limitZoom(Q)],be=Math.pow(2,Q),{extent:ke,radius:We}=this.options,Ve=We/ke,Ze=(pe-Ve)/be,it=(pe+1+Ve)/be,et={features:[]};return this._addTileFeatures(Se.range((re-Ve)/be,Ze,(re+1+Ve)/be,it),Se.data,re,pe,be,et),re===0&&this._addTileFeatures(Se.range(1-Ve/be,Ze,1,it),Se.data,be,pe,be,et),re===be-1&&this._addTileFeatures(Se.range(0,Ze,Ve/be,it),Se.data,-1,pe,be,et),et.features.length?et:null}getClusterExpansionZoom(Q){let re=this._getOriginZoom(Q)-1;for(;re<=this.options.maxZoom;){const pe=this.getChildren(Q);if(re++,pe.length!==1)break;Q=pe[0].properties.cluster_id}return re}_appendLeaves(Q,re,pe,Se,be){const ke=this.getChildren(re);for(const We of ke){const Ve=We.properties;if(Ve&&Ve.cluster?be+Ve.point_count<=Se?be+=Ve.point_count:be=this._appendLeaves(Q,Ve.cluster_id,pe,Se,be):be<Se?be++:Q.push(We),Q.length===pe)break}return be}_createTree(Q){const re=new a.by(Q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let pe=0;pe<Q.length;pe+=this.stride)re.add(Q[pe],Q[pe+1]);return re.finish(),re.data=Q,re}_addTileFeatures(Q,re,pe,Se,be,ke){for(const We of Q){const Ve=We*this.stride,Ze=re[Ve+yi]>1;let it,et,yt;if(Ze)it=we(re,Ve,this.clusterProps),et=re[Ve],yt=re[Ve+1];else{const ur=this.points[re[Ve+rn]];it=ur.properties;const[pr,_r]=ur.geometry.coordinates;et=Kn(pr),yt=Ne(_r)}const kt={type:1,geometry:[[Math.round(this.options.extent*(et*be-pe)),Math.round(this.options.extent*(yt*be-Se))]],tags:it};let zt;zt=Ze||this.options.generateId?re[Ve+rn]:this.points[re[Ve+rn]].id,zt!==void 0&&(kt.id=zt),ke.features.push(kt)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,re){const{radius:pe,extent:Se,reduce:be,minPoints:ke}=this.options,We=pe/(Se*Math.pow(2,re)),Ve=Q.data,Ze=[],it=this.stride;for(let et=0;et<Ve.length;et+=it){if(Ve[et+2]<=re)continue;Ve[et+2]=re;const yt=Ve[et],kt=Ve[et+1],zt=Q.within(Ve[et],Ve[et+1],We),ur=Ve[et+yi];let pr=ur;for(const _r of zt){const mr=_r*it;Ve[mr+2]>re&&(pr+=Ve[mr+yi])}if(pr>ur&&pr>=ke){let _r,mr=yt*ur,ai=kt*ur,pi=-1;const Or=(et/it<<5)+(re+1)+this.points.length;for(const di of zt){const Wi=di*it;if(Ve[Wi+2]<=re)continue;Ve[Wi+2]=re;const On=Ve[Wi+yi];mr+=Ve[Wi]*On,ai+=Ve[Wi+1]*On,Ve[Wi+4]=Or,be&&(_r||(_r=this._map(Ve,et,!0),pi=this.clusterProps.length,this.clusterProps.push(_r)),be(_r,this._map(Ve,Wi)))}Ve[et+4]=Or,Ze.push(mr/pr,ai/pr,1/0,Or,-1,pr),be&&Ze.push(pi)}else{for(let _r=0;_r<it;_r++)Ze.push(Ve[et+_r]);if(pr>1)for(const _r of zt){const mr=_r*it;if(!(Ve[mr+2]<=re)){Ve[mr+2]=re;for(let ai=0;ai<it;ai++)Ze.push(Ve[mr+ai])}}}}return Ze}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,re,pe){if(Q[re+yi]>1){const ke=this.clusterProps[Q[re+Si]];return pe?Object.assign({},ke):ke}const Se=this.points[Q[re+rn]].properties,be=this.options.map(Se);return pe&&be===Se?Object.assign({},be):be}}function qi(qe,Q,re){return{type:"Feature",id:qe[Q+rn],properties:we(qe,Q,re),geometry:{type:"Point",coordinates:[(pe=qe[Q],360*(pe-.5)),Qe(qe[Q+1])]}};var pe}function we(qe,Q,re){const pe=qe[Q+yi],Se=pe>=1e4?`${Math.round(pe/1e3)}k`:pe>=1e3?Math.round(pe/100)/10+"k":pe,be=qe[Q+Si],ke=be===-1?{}:Object.assign({},re[be]);return Object.assign(ke,{cluster:!0,cluster_id:qe[Q+rn],point_count:pe,point_count_abbreviated:Se})}function Kn(qe){return qe/360+.5}function Ne(qe){const Q=Math.sin(qe*Math.PI/180),re=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return re<0?0:re>1?1:re}function Qe(qe){const Q=(180-360*qe)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function ze(qe,Q,re,pe){let Se=pe;const be=Q+(re-Q>>1);let ke,We=re-Q;const Ve=qe[Q],Ze=qe[Q+1],it=qe[re],et=qe[re+1];for(let yt=Q+3;yt<re;yt+=3){const kt=Bt(qe[yt],qe[yt+1],Ve,Ze,it,et);if(kt>Se)ke=yt,Se=kt;else if(kt===Se){const zt=Math.abs(yt-be);zt<We&&(ke=yt,We=zt)}}Se>pe&&(ke-Q>3&&ze(qe,Q,ke,pe),qe[ke+2]=Se,re-ke>3&&ze(qe,ke,re,pe))}function Bt(qe,Q,re,pe,Se,be){let ke=Se-re,We=be-pe;if(ke!==0||We!==0){const Ve=((qe-re)*ke+(Q-pe)*We)/(ke*ke+We*We);Ve>1?(re=Se,pe=be):Ve>0&&(re+=ke*Ve,pe+=We*Ve)}return ke=qe-re,We=Q-pe,ke*ke+We*We}function At(qe,Q,re,pe){const Se={id:qe!=null?qe:null,type:Q,geometry:re,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Q==="Point"||Q==="MultiPoint"||Q==="LineString")qt(Se,re);else if(Q==="Polygon")qt(Se,re[0]);else if(Q==="MultiLineString")for(const be of re)qt(Se,be);else if(Q==="MultiPolygon")for(const be of re)qt(Se,be[0]);return Se}function qt(qe,Q){for(let re=0;re<Q.length;re+=3)qe.minX=Math.min(qe.minX,Q[re]),qe.minY=Math.min(qe.minY,Q[re+1]),qe.maxX=Math.max(qe.maxX,Q[re]),qe.maxY=Math.max(qe.maxY,Q[re+1])}function Mt(qe,Q,re,pe){if(!Q.geometry)return;const Se=Q.geometry.coordinates;if(Se&&Se.length===0)return;const be=Q.geometry.type,ke=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2);let We=[],Ve=Q.id;if(re.promoteId?Ve=Q.properties[re.promoteId]:re.generateId&&(Ve=pe||0),be==="Point")Vt(Se,We);else if(be==="MultiPoint")for(const Ze of Se)Vt(Ze,We);else if(be==="LineString")Gt(Se,We,ke,!1);else if(be==="MultiLineString"){if(re.lineMetrics){for(const Ze of Se)We=[],Gt(Ze,We,ke,!1),qe.push(At(Ve,"LineString",We,Q.properties));return}Nt(Se,We,ke,!1)}else if(be==="Polygon")Nt(Se,We,ke,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(const Ze of Q.geometry.geometries)Mt(qe,{id:Ve,geometry:Ze,properties:Q.properties},re,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ze of Se){const it=[];Nt(Ze,it,ke,!0),We.push(it)}}qe.push(At(Ve,be,We,Q.properties))}function Vt(qe,Q){Q.push(br(qe[0]),ar(qe[1]),0)}function Gt(qe,Q,re,pe){let Se,be,ke=0;for(let Ve=0;Ve<qe.length;Ve++){const Ze=br(qe[Ve][0]),it=ar(qe[Ve][1]);Q.push(Ze,it,0),Ve>0&&(ke+=pe?(Se*it-Ze*be)/2:Math.sqrt(Math.pow(Ze-Se,2)+Math.pow(it-be,2))),Se=Ze,be=it}const We=Q.length-3;Q[2]=1,ze(Q,0,We,re),Q[We+2]=1,Q.size=Math.abs(ke),Q.start=0,Q.end=Q.size}function Nt(qe,Q,re,pe){for(let Se=0;Se<qe.length;Se++){const be=[];Gt(qe[Se],be,re,pe),Q.push(be)}}function br(qe){return qe/360+.5}function ar(qe){const Q=Math.sin(qe*Math.PI/180),re=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return re<0?0:re>1?1:re}function Dt(qe,Q,re,pe,Se,be,ke,We){if(pe/=Q,be>=(re/=Q)&&ke<pe)return qe;if(ke<re||be>=pe)return null;const Ve=[];for(const Ze of qe){const it=Ze.geometry;let et=Ze.type;const yt=Se===0?Ze.minX:Ze.minY,kt=Se===0?Ze.maxX:Ze.maxY;if(yt>=re&&kt<pe){Ve.push(Ze);continue}if(kt<re||yt>=pe)continue;let zt=[];if(et==="Point"||et==="MultiPoint")zr(it,zt,re,pe,Se);else if(et==="LineString")Hr(it,zt,re,pe,Se,!1,We.lineMetrics);else if(et==="MultiLineString")Kr(it,zt,re,pe,Se,!1);else if(et==="Polygon")Kr(it,zt,re,pe,Se,!0);else if(et==="MultiPolygon")for(const ur of it){const pr=[];Kr(ur,pr,re,pe,Se,!0),pr.length&&zt.push(pr)}if(zt.length){if(We.lineMetrics&&et==="LineString"){for(const ur of zt)Ve.push(At(Ze.id,et,ur,Ze.tags));continue}et!=="LineString"&&et!=="MultiLineString"||(zt.length===1?(et="LineString",zt=zt[0]):et="MultiLineString"),et!=="Point"&&et!=="MultiPoint"||(et=zt.length===3?"Point":"MultiPoint"),Ve.push(At(Ze.id,et,zt,Ze.tags))}}return Ve.length?Ve:null}function zr(qe,Q,re,pe,Se){for(let be=0;be<qe.length;be+=3){const ke=qe[be+Se];ke>=re&&ke<=pe&&Pi(Q,qe[be],qe[be+1],qe[be+2])}}function Hr(qe,Q,re,pe,Se,be,ke){let We=Oi(qe);const Ve=Se===0?to:ds;let Ze,it,et=qe.start;for(let pr=0;pr<qe.length-3;pr+=3){const _r=qe[pr],mr=qe[pr+1],ai=qe[pr+2],pi=qe[pr+3],Or=qe[pr+4],di=Se===0?_r:mr,Wi=Se===0?pi:Or;let On=!1;ke&&(Ze=Math.sqrt(Math.pow(_r-pi,2)+Math.pow(mr-Or,2))),di<re?Wi>re&&(it=Ve(We,_r,mr,pi,Or,re),ke&&(We.start=et+Ze*it)):di>pe?Wi<pe&&(it=Ve(We,_r,mr,pi,Or,pe),ke&&(We.start=et+Ze*it)):Pi(We,_r,mr,ai),Wi<re&&di>=re&&(it=Ve(We,_r,mr,pi,Or,re),On=!0),Wi>pe&&di<=pe&&(it=Ve(We,_r,mr,pi,Or,pe),On=!0),!be&&On&&(ke&&(We.end=et+Ze*it),Q.push(We),We=Oi(qe)),ke&&(et+=Ze)}let yt=qe.length-3;const kt=qe[yt],zt=qe[yt+1],ur=Se===0?kt:zt;ur>=re&&ur<=pe&&Pi(We,kt,zt,qe[yt+2]),yt=We.length-3,be&&yt>=3&&(We[yt]!==We[0]||We[yt+1]!==We[1])&&Pi(We,We[0],We[1],We[2]),We.length&&Q.push(We)}function Oi(qe){const Q=[];return Q.size=qe.size,Q.start=qe.start,Q.end=qe.end,Q}function Kr(qe,Q,re,pe,Se,be){for(const ke of qe)Hr(ke,Q,re,pe,Se,be,!1)}function Pi(qe,Q,re,pe){qe.push(Q,re,pe)}function to(qe,Q,re,pe,Se,be){const ke=(be-Q)/(pe-Q);return Pi(qe,be,re+(Se-re)*ke,1),ke}function ds(qe,Q,re,pe,Se,be){const ke=(be-re)/(Se-re);return Pi(qe,Q+(pe-Q)*ke,be,1),ke}function ka(qe,Q){const re=[];for(let pe=0;pe<qe.length;pe++){const Se=qe[pe],be=Se.type;let ke;if(be==="Point"||be==="MultiPoint"||be==="LineString")ke=xo(Se.geometry,Q);else if(be==="MultiLineString"||be==="Polygon"){ke=[];for(const We of Se.geometry)ke.push(xo(We,Q))}else if(be==="MultiPolygon"){ke=[];for(const We of Se.geometry){const Ve=[];for(const Ze of We)Ve.push(xo(Ze,Q));ke.push(Ve)}}re.push(At(Se.id,be,ke,Se.tags))}return re}function xo(qe,Q){const re=[];re.size=qe.size,qe.start!==void 0&&(re.start=qe.start,re.end=qe.end);for(let pe=0;pe<qe.length;pe+=3)re.push(qe[pe]+Q,qe[pe+1],qe[pe+2]);return re}function ha(qe,Q){if(qe.transformed)return qe;const re=1<<qe.z,pe=qe.x,Se=qe.y;for(const be of qe.features){const ke=be.geometry,We=be.type;if(be.geometry=[],We===1)for(let Ve=0;Ve<ke.length;Ve+=2)be.geometry.push(Nn(ke[Ve],ke[Ve+1],Q,re,pe,Se));else for(let Ve=0;Ve<ke.length;Ve++){const Ze=[];for(let it=0;it<ke[Ve].length;it+=2)Ze.push(Nn(ke[Ve][it],ke[Ve][it+1],Q,re,pe,Se));be.geometry.push(Ze)}}return qe.transformed=!0,qe}function Nn(qe,Q,re,pe,Se,be){return[Math.round(re*(qe*pe-Se)),Math.round(re*(Q*pe-be))]}function vn(qe,Q,re,pe,Se){const be=Q===Se.maxZoom?0:Se.tolerance/((1<<Q)*Se.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:qe.length,source:null,x:re,y:pe,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const We of qe)dl(ke,We,be,Se);return ke}function dl(qe,Q,re,pe){const Se=Q.geometry,be=Q.type,ke=[];if(qe.minX=Math.min(qe.minX,Q.minX),qe.minY=Math.min(qe.minY,Q.minY),qe.maxX=Math.max(qe.maxX,Q.maxX),qe.maxY=Math.max(qe.maxY,Q.maxY),be==="Point"||be==="MultiPoint")for(let We=0;We<Se.length;We+=3)ke.push(Se[We],Se[We+1]),qe.numPoints++,qe.numSimplified++;else if(be==="LineString")Jr(ke,Se,qe,re,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(let We=0;We<Se.length;We++)Jr(ke,Se[We],qe,re,be==="Polygon",We===0);else if(be==="MultiPolygon")for(let We=0;We<Se.length;We++){const Ve=Se[We];for(let Ze=0;Ze<Ve.length;Ze++)Jr(ke,Ve[Ze],qe,re,!0,Ze===0)}if(ke.length){let We=Q.tags||null;if(be==="LineString"&&pe.lineMetrics){We={};for(const Ze in Q.tags)We[Ze]=Q.tags[Ze];We.mapbox_clip_start=Se.start/Se.size,We.mapbox_clip_end=Se.end/Se.size}const Ve={geometry:ke,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:We};Q.id!==null&&(Ve.id=Q.id),qe.features.push(Ve)}}function Jr(qe,Q,re,pe,Se,be){const ke=pe*pe;if(pe>0&&Q.size<(Se?ke:pe))return void(re.numPoints+=Q.length/3);const We=[];for(let Ve=0;Ve<Q.length;Ve+=3)(pe===0||Q[Ve+2]>ke)&&(re.numSimplified++,We.push(Q[Ve],Q[Ve+1])),re.numPoints++;Se&&function(Ve,Ze){let it=0;for(let et=0,yt=Ve.length,kt=yt-2;et<yt;kt=et,et+=2)it+=(Ve[et]-Ve[kt])*(Ve[et+1]+Ve[kt+1]);if(it>0===Ze)for(let et=0,yt=Ve.length;et<yt/2;et+=2){const kt=Ve[et],zt=Ve[et+1];Ve[et]=Ve[yt-2-et],Ve[et+1]=Ve[yt-1-et],Ve[yt-2-et]=kt,Ve[yt-1-et]=zt}}(We,be),qe.push(We)}const da={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Jd{constructor(Q,re){const pe=(re=this.options=function(be,ke){for(const We in ke)be[We]=ke[We];return be}(Object.create(da),re)).debug;if(pe&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");let Se=function(be,ke){const We=[];if(be.type==="FeatureCollection")for(let Ve=0;Ve<be.features.length;Ve++)Mt(We,be.features[Ve],ke,Ve);else Mt(We,be.type==="Feature"?be:{geometry:be},ke);return We}(Q,re);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Se=function(be,ke){const We=ke.buffer/ke.extent;let Ve=be;const Ze=Dt(be,1,-1-We,We,0,-1,2,ke),it=Dt(be,1,1-We,2+We,0,-1,2,ke);return(Ze||it)&&(Ve=Dt(be,1,-We,1+We,0,-1,2,ke)||[],Ze&&(Ve=ka(Ze,1).concat(Ve)),it&&(Ve=Ve.concat(ka(it,-1)))),Ve}(Se,re),Se.length&&this.splitTile(Se,0,0,0),pe&&(Se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Q,re,pe,Se,be,ke,We){const Ve=[Q,re,pe,Se],Ze=this.options,it=Ze.debug;for(;Ve.length;){Se=Ve.pop(),pe=Ve.pop(),re=Ve.pop(),Q=Ve.pop();const et=1<<re,yt=Wo(re,pe,Se);let kt=this.tiles[yt];if(!kt&&(it>1&&console.time("creation"),kt=this.tiles[yt]=vn(Q,re,pe,Se,Ze),this.tileCoords.push({z:re,x:pe,y:Se}),it)){it>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,pe,Se,kt.numFeatures,kt.numPoints,kt.numSimplified),console.timeEnd("creation"));const On=`z${re}`;this.stats[On]=(this.stats[On]||0)+1,this.total++}if(kt.source=Q,be==null){if(re===Ze.indexMaxZoom||kt.numPoints<=Ze.indexMaxPoints)continue}else{if(re===Ze.maxZoom||re===be)continue;if(be!=null){const On=be-re;if(pe!==ke>>On||Se!==We>>On)continue}}if(kt.source=null,Q.length===0)continue;it>1&&console.time("clipping");const zt=.5*Ze.buffer/Ze.extent,ur=.5-zt,pr=.5+zt,_r=1+zt;let mr=null,ai=null,pi=null,Or=null,di=Dt(Q,et,pe-zt,pe+pr,0,kt.minX,kt.maxX,Ze),Wi=Dt(Q,et,pe+ur,pe+_r,0,kt.minX,kt.maxX,Ze);Q=null,di&&(mr=Dt(di,et,Se-zt,Se+pr,1,kt.minY,kt.maxY,Ze),ai=Dt(di,et,Se+ur,Se+_r,1,kt.minY,kt.maxY,Ze),di=null),Wi&&(pi=Dt(Wi,et,Se-zt,Se+pr,1,kt.minY,kt.maxY,Ze),Or=Dt(Wi,et,Se+ur,Se+_r,1,kt.minY,kt.maxY,Ze),Wi=null),it>1&&console.timeEnd("clipping"),Ve.push(mr||[],re+1,2*pe,2*Se),Ve.push(ai||[],re+1,2*pe,2*Se+1),Ve.push(pi||[],re+1,2*pe+1,2*Se),Ve.push(Or||[],re+1,2*pe+1,2*Se+1)}}getTile(Q,re,pe){Q=+Q,re=+re,pe=+pe;const Se=this.options,{extent:be,debug:ke}=Se;if(Q<0||Q>24)return null;const We=1<<Q,Ve=Wo(Q,re=re+We&We-1,pe);if(this.tiles[Ve])return ha(this.tiles[Ve],be);ke>1&&console.log("drilling down to z%d-%d-%d",Q,re,pe);let Ze,it=Q,et=re,yt=pe;for(;!Ze&&it>0;)it--,et>>=1,yt>>=1,Ze=this.tiles[Wo(it,et,yt)];return Ze&&Ze.source?(ke>1&&(console.log("found parent tile z%d-%d-%d",it,et,yt),console.time("drilling down")),this.splitTile(Ze.source,it,et,yt,Q,re,pe),ke>1&&console.timeEnd("drilling down"),this.tiles[Ve]?ha(this.tiles[Ve],be):null):null}}function Wo(qe,Q,re){return 32*((1<<qe)*re+Q)+qe}function Kl(qe,Q){const re=qe.tileID.canonical;if(!this._geoJSONIndex)return void Q(null,null);const pe=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!pe)return void Q(null,null);const Se=new ht(pe.features);let be=ln(Se);be.byteOffset===0&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),Q(null,{vectorTile:Se,rawData:be.buffer})}class mh extends dt{constructor(Q,re,pe,Se,be,ke){super(Q,re,pe,Se,Kl,ke),be&&(this.loadGeoJSON=be),this._dynamicIndex=new gt}loadData(Q,re){const pe=Q&&Q.request,Se=pe&&pe.collectResourceTiming;this.loadGeoJSON(Q,(be,ke)=>{if(be||!ke)return re(be);if(typeof ke!="object")return re(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{try{if(Q.filter){const Ve=a.M(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ve.result==="error")throw new Error(Ve.value.map(Ze=>`${Ze.key}: ${Ze.message}`).join(", "));ke.features=ke.features.filter(Ze=>Ve.value.evaluate({zoom:0},Ze))}Q.dynamic?(ke.type==="Feature"&&(ke={type:"FeatureCollection",features:[ke]}),Q.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(ke.features,this.loaded),Q.cluster&&(ke.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Q.cluster?new hs(function({superclusterOptions:Ve,clusterProperties:Ze}){if(!Ze||!Ve)return Ve;const it={},et={},yt={accumulated:null,zoom:0},kt={properties:null},zt=Object.keys(Ze);for(const ur of zt){const[pr,_r]=Ze[ur],mr=a.M(_r),ai=a.M(typeof pr=="string"?[pr,["accumulated"],["get",ur]]:pr);it[ur]=mr.value,et[ur]=ai.value}return Ve.map=ur=>{kt.properties=ur;const pr={};for(const _r of zt)pr[_r]=it[_r].evaluate(yt,kt);return pr},Ve.reduce=(ur,pr)=>{kt.properties=pr;for(const _r of zt)yt.accumulated=ur[_r],ur[_r]=et[_r].evaluate(yt,kt)},Ve}(Q)).load(ke.features):Q.dynamic?this._dynamicIndex:function(Ve,Ze){return new Jd(Ve,Ze)}(ke,Q.geojsonVtOptions)}catch(Ve){return re(Ve)}const We={};if(Se){const Ve=N(pe);Ve&&(We.resourceTiming={},We.resourceTiming[Q.source]=JSON.parse(JSON.stringify(Ve)))}re(null,We)}})}reloadTile(Q,re){const pe=this.loaded;return pe&&pe[Q.uid]?Q.partial?re(null,void 0):super.reloadTile(Q,re):this.loadTile(Q,re)}loadGeoJSON(Q,re){if(Q.request)a.n(Q.request,re);else{if(typeof Q.data!="string")return re(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(Q.data))}catch{return re(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Q,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(pe){re(pe)}}getClusterChildren(Q,re){try{re(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(pe){re(pe)}}getClusterLeaves(Q,re){try{re(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(pe){re(pe)}}}class $c{constructor(Q,re){this.tileID=new a.aA(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.tileZoom=Q.tileZoom,this.uid=Q.uid,this.zoom=Q.zoom,this.canonical=Q.tileID.canonical,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Q.projection,this.brightness=re}parse(Q,re,pe,Se){this.status="parsing";const be=new a.aA(pe.tileID.overscaledZ,pe.tileID.wrap,pe.tileID.canonical.z,pe.tileID.canonical.x,pe.tileID.canonical.y),ke={},We=re.familiesBySource[pe.source],Ve=new a.dR(be,pe.promoteId);return Ve.bucketLayerIDs=[],Ve.is3DTile=!0,a.e0(Q).then(Ze=>{if(!Ze)return Se(new Error("Could not parse tile"));const it=a.e1(Ze,1/a.c8(pe.tileID.canonical)),et=Ze.json.extensionsUsed&&Ze.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ze.json.asset.extras&&Ze.json.asset.extras.MAPBOX_mesh_features,yt=Ze.json.extensionsUsed&&Ze.json.extensionsUsed.includes("EXT_meshopt_compression"),kt=new a.a3(this.zoom,{brightness:this.brightness});for(const zt in We)for(const ur of We[zt]){const pr=ur[0];Ve.bucketLayerIDs.push(ur.map(mr=>mr.id)),pr.recalculate(kt,[]);const _r=new a.e2(it,be,et,yt,this.brightness,Ve);et||(_r.needsUpload=!0),ke[pr.fqid]=_r,_r.evaluate(pr)}this.status="done",Se(null,{buckets:ke,featureIndex:Ve})}).catch(Ze=>Se(new Error(Ze.message)))}}class gh{constructor(Q,re,pe,Se,be,ke){this.actor=Q,this.layerIndex=re,this.brightness=ke,this.loading={},this.loaded={}}loadTile(Q,re){const pe=Q.uid,Se=this.loading[pe]=new $c(Q,this.brightness);a.bc(Q.request,(be,ke)=>{const We=!this.loading[pe];return delete this.loading[pe],We||be?(Se.status="done",We||(this.loaded[pe]=Se),re(be)):ke&&ke.byteLength!==0?void Se.parse(ke,this.layerIndex,Q,(Ve,Ze)=>{Se.status="done",this.loaded=this.loaded||{},this.loaded[pe]=Se,Ve||!Ze?re(Ve):re(null,Ze)}):(Se.status="done",this.loaded[pe]=Se,re())})}reloadTile(Q,re){const pe=this.loaded,Se=Q.uid;if(pe&&pe[Se]){const be=pe[Se];be.projection=Q.projection,be.brightness=Q.brightness;const ke=(We,Ve)=>{be.reloadCallback&&(delete be.reloadCallback,this.loadTile(Q,re)),re(We,Ve)};be.status==="parsing"?be.reloadCallback=ke:be.status==="done"&&this.loadTile(Q,re)}}abortTile(Q,re){const pe=Q.uid;this.loading[pe]&&delete this.loading[pe],re()}removeTile(Q,re){const pe=this.loaded,Se=Q.uid;pe&&pe[Se]&&delete pe[Se],re()}}class Yl{constructor(Q){this.self=Q,this.actor=new a.e3(Q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.bL({name:"mercator"}),this.workerSourceTypes={vector:dt,geojson:mh,"batched-model":gh},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,pe)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=pe},this.self.registerRTLTextPlugin=re=>{if(a.e4.isParsed())throw new Error("RTL text plugin already registered.");a.e4.applyArabicShaping=re.applyArabicShaping,a.e4.processBidirectionalText=re.processBidirectionalText,a.e4.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(Q,re,pe){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q],delete this.rasterArrayWorkerSource,pe()}checkIfReady(Q,re,pe){pe()}setReferrer(Q,re){this.referrer=re}spriteLoaded(Q,{scope:re,isLoaded:pe}){if(this.isSpriteLoaded[Q]||(this.isSpriteLoaded[Q]={}),this.isSpriteLoaded[Q][re]=pe,this.workerSources[Q]&&this.workerSources[Q][re])for(const Se in this.workerSources[Q][re]){const be=this.workerSources[Q][re][Se];for(const ke in be){const We=be[ke];We instanceof dt&&(We.isSpriteLoaded=pe,We.fire(new a.x("isSpriteLoaded")))}}}setImages(Q,{scope:re,images:pe},Se){if(this.availableImages[Q]||(this.availableImages[Q]={}),this.availableImages[Q][re]=pe,this.workerSources[Q]&&this.workerSources[Q][re]){for(const be in this.workerSources[Q][re]){const ke=this.workerSources[Q][re][be];for(const We in ke)ke[We].availableImages=pe}Se()}else Se()}setProjection(Q,re){this.projections[Q]=a.bL(re)}setBrightness(Q,re,pe){this.brightness=re,pe()}setLayers(Q,re,pe){this.getLayerIndex(Q,re.scope).replace(re.layers,re.options),pe()}updateLayers(Q,re,pe){this.getLayerIndex(Q,re.scope).update(re.layers,re.removedIds,re.options),pe()}loadTile(Q,re,pe){re.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,re.type,re.source,re.scope).loadTile(re,pe)}loadDEMTile(Q,re,pe){this.getDEMWorkerSource(Q,re.source,re.scope).loadTile(re,pe)}decodeRasterArray(Q,re,pe){this.getRasterArrayWorkerSource().decodeRasterArray(re,pe)}reloadTile(Q,re,pe){re.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,re.type,re.source,re.scope).reloadTile(re,pe)}abortTile(Q,re,pe){this.getWorkerSource(Q,re.type,re.source,re.scope).abortTile(re,pe)}removeTile(Q,re,pe){this.getWorkerSource(Q,re.type,re.source,re.scope).removeTile(re,pe)}removeSource(Q,re,pe){if(!(this.workerSources[Q]&&this.workerSources[Q][re.scope]&&this.workerSources[Q][re.scope][re.type]&&this.workerSources[Q][re.scope][re.type][re.source]))return;const Se=this.workerSources[Q][re.scope][re.type][re.source];delete this.workerSources[Q][re.scope][re.type][re.source],Se.removeSource!==void 0?Se.removeSource(re,pe):pe()}loadWorkerSource(Q,re,pe){try{this.self.importScripts(re.url),pe()}catch(Se){pe(Se.toString())}}syncRTLPluginState(Q,re,pe){try{a.e4.setState(re);const Se=a.e4.getPluginURL();if(a.e4.isLoaded()&&!a.e4.isParsed()&&Se!=null){this.self.importScripts(Se);const be=a.e4.isParsed();pe(be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Se}`),be)}}catch(Se){pe(Se.toString())}}setDracoUrl(Q,re){this.dracoUrl=re}getAvailableImages(Q,re){this.availableImages[Q]||(this.availableImages[Q]={});let pe=this.availableImages[Q][re];return pe||(pe=[]),pe}getLayerIndex(Q,re){this.layerIndexes[Q]||(this.layerIndexes[Q]={});let pe=this.layerIndexes[Q][re];return pe||(pe=this.layerIndexes[Q][re]=new ee,pe.scope=re),pe}getWorkerSource(Q,re,pe,Se){return this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][Se]||(this.workerSources[Q][Se]={}),this.workerSources[Q][Se][re]||(this.workerSources[Q][Se][re]={}),this.isSpriteLoaded[Q]||(this.isSpriteLoaded[Q]={}),this.workerSources[Q][Se][re][pe]||(this.workerSources[Q][Se][re][pe]=new this.workerSourceTypes[re]({send:(be,ke,We,Ve,Ze,it)=>{this.actor.send(be,ke,We,Q,Ze,it)},scheduler:this.actor.scheduler},this.getLayerIndex(Q,Se),this.getAvailableImages(Q,Se),this.isSpriteLoaded[Q][Se],void 0,this.brightness)),this.workerSources[Q][Se][re][pe]}getDEMWorkerSource(Q,re,pe){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][pe]||(this.demWorkerSources[Q][pe]={}),this.demWorkerSources[Q][pe][re]||(this.demWorkerSources[Q][pe][re]=new Le),this.demWorkerSources[Q][pe][re]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new De),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Q,re){a.e5(re)}getWorkerPerformanceMetrics(Q,re,pe){pe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Yl(self)),Yl}),T(["./shared"],function(a){var N="3.7.0";const H={create:"create",load:"load",fullLoad:"fullLoad"},K={mark(d){performance.mark(d)},measure(d,n,l){performance.measure(d,n,l)}};function ee(d){const n=d.name.split("?")[0];return a.a(n)&&n.includes("mapbox-gl.js")?"javascript":a.a(n)&&n.includes("mapbox-gl.css")?"css":a.b(n)?"fontRange":a.c(n)?"sprite":a.i(n)?"style":a.d(n)?"tilejson":"other"}var ue,Pe={},xe=function(){if(ue)return Pe;function d(f){return!n(f)}function n(f){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,x,C=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(C);try{x=new Worker(D),v=!0}catch{v=!1}return x&&x.terminate(),URL.revokeObjectURL(D),v}()?function(){var v=document.createElement("canvas");v.width=v.height=1;var x=v.getContext("2d");if(!x)return!1;var C=x.getImageData(0,0,1,1);return C&&C.width===v.width}()?(l[_=f&&f.failIfMajorPerformanceCaveat]===void 0&&(l[_]=function(v){var x,C=function(D){var L=document.createElement("canvas"),B=Object.create(d.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=D,L.getContext("webgl2",B)}(v);if(!C)return!1;try{x=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!x||C.isContextLost())&&(C.shaderSource(x,"void main() {}"),C.compileShader(x),C.getShaderParameter(x,C.COMPILE_STATUS)===!0)}(_)),l[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var _}ue=1,Pe.supported=d,Pe.notSupportedReason=n;var l={};return d.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},Pe}();function Ie(d,n,l){const f=document.createElement(d);return n!=null&&(f.className=n),l&&l.appendChild(f),f}function dt(d,n,l){const f=document.createElementNS("http://www.w3.org/2000/svg",d);for(const _ of Object.keys(n))f.setAttributeNS(null,_,String(n[_]));return l&&l.appendChild(f),f}const Le=typeof document<"u"?document.documentElement&&document.documentElement.style:null,De=Le&&Le.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ye;function He(){Le&&De&&(Ye=Le[De],Le[De]="none")}function ht(){Le&&De&&(Le[De]=Ye)}function St(d){d.preventDefault(),d.stopPropagation(),window.removeEventListener("click",St,!0)}function st(){window.addEventListener("click",St,!0),window.setTimeout(()=>{window.removeEventListener("click",St,!0)},0)}function gt(d,n){const l=d.getBoundingClientRect();return ft(d,l,n)}function Tt(d,n){const l=d.getBoundingClientRect(),f=[];for(let _=0;_<n.length;_++)f.push(ft(d,l,n[_]));return f}function at(d){return window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function ft(d,n,l){const f=d.offsetWidth===n.width?1:d.offsetWidth/n.width;return new a.P((l.clientX-n.left)*f,(l.clientY-n.top)*f)}const gr="01",xr="NO_ACCESS_TOKEN";class Jt{constructor(n,l,f){this._transformRequestFn=n,this._customAccessToken=l,this._silenceAuthErrors=!!f,this._createSkuToken()}_createSkuToken(){const n=function(){let l="";for(let f=0;f<10;f++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",gr,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}normalizeStyleURL(n,l){if(!a.f(n))return n;const f=Et(n);return f.params.push(`sdk=js-${N}`),f.path=`/styles/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeGlyphsURL(n,l){if(!a.f(n))return n;const f=Et(n);return f.path=`/fonts/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeModelURL(n,l){if(!a.f(n))return n;const f=Et(n);return f.path=`/models/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeSourceURL(n,l,f,_){if(!a.f(n))return n;const v=Et(n);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),f&&v.params.push(`language=${f}`),_&&v.params.push(`worldview=${_}`),this._makeAPIURL(v,this._customAccessToken||l)}normalizeSpriteURL(n,l,f,_){const v=Et(n);return a.f(n)?(v.path=`/styles/v1${v.path}/sprite${l}${f}`,this._makeAPIURL(v,this._customAccessToken||_)):(v.path+=`${l}${f}`,fr(v))}normalizeTileURL(n,l,f){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!a.f(n))return n;const _=Et(n);_.path=_.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||f&&_.authority!=="raster"&&f===512?"@2x":""}${a.m.supported?".webp":"$1"}`),_.authority==="raster"?_.path=`/${a.e.RASTER_URL_PREFIX}${_.path}`:_.authority==="rasterarrays"?_.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${_.path}`:_.authority==="3dtiles"?_.path=`/${a.e.TILES3D_URL_PREFIX}${_.path}`:(_.path=_.path.replace(/^.+\/v4\//,"/"),_.path=`/${a.e.TILE_URL_VERSION}${_.path}`);const v=this._customAccessToken||function(x){for(const C of x){const D=C.match(/^access_token=(.*)$/);if(D)return D[1]}return null}(_.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&_.params.push(`sku=${this._skuToken}`),this._makeAPIURL(_,v)}canonicalizeTileURL(n,l){const f=Et(n);if(!f.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!f.path.match(/\.[\w]+$/))return n;let _="mapbox://";f.path.match(/^\/raster\/v1\//)?_+=`raster/${f.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:f.path.match(/^\/rasterarrays\/v1\//)?_+=`rasterarrays/${f.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:_+=`tiles/${f.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let v=f.params;return l&&(v=v.filter(x=>!x.match(/^access_token=/))),v.length&&(_+=`?${v.join("&")}`),_}canonicalizeTileset(n,l){const f=!!l&&a.f(l),_=[];for(const v of n.tiles||[])a.h(v)?_.push(this.canonicalizeTileURL(v,f)):_.push(v);return _}_makeAPIURL(n,l){const f="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",_=Et(a.e.API_URL);if(n.protocol=_.protocol,n.authority=_.authority,n.protocol==="http"){const v=n.params.indexOf("secure");v>=0&&n.params.splice(v,1)}if(_.path!=="/"&&(n.path=`${_.path}${n.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return fr(n);if(l=l||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${f}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${f}`)}return n.params=n.params.filter(v=>v.indexOf("access_token")===-1),n.params.push(`access_token=${l||""}`),fr(n)}}const Zt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Et(d){const n=d.match(Zt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function fr(d){const n=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${n}`}const jr="mapbox.eventData";function er(d){if(!d)return null;const n=d.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(a.j(n[1]))}catch{return null}}class tn{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const l=er(a.e.ACCESS_TOKEN);let f="";return f=l&&l.u?a.k(l.u):a.e.ACCESS_TOKEN||"",n?`${jr}.${n}:${f}`:`${jr}:${f}`}fetchEventData(){const n=a.s("localStorage"),l=this.getStorageKey(),f=this.getStorageKey("uuid");if(n)try{const _=localStorage.getItem(l);_&&(this.eventData=JSON.parse(_));const v=localStorage.getItem(f);v&&(this.anonId=v)}catch{a.w("Unable to read from LocalStorage")}}saveEventData(){const n=a.s("localStorage"),l=this.getStorageKey(),f=this.getStorageKey("uuid"),_=this.anonId;if(n&&_)try{localStorage.setItem(f,_),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{a.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,l,f,_){if(!a.e.EVENTS_URL)return;const v=Et(a.e.EVENTS_URL);v.params.push(`access_token=${_||a.e.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(n).toISOString()},C=l?a.l(x,l):x,D={url:fr(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=a.p(D,L=>{this.pendingRequest=null,f(L),this.saveEventData(),this.processRequests(_)})}queueRequest(n,l){this.queue.push(n),this.processRequests(l)}}const ln=new class extends tn{constructor(d){super("appUserTurnstile"),this._customAccessToken=d}postTurnstileEvent(d,n){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(d)&&d.some(l=>a.f(l)||a.h(l))&&this.queueRequest(Date.now(),n)}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=er(a.e.ACCESS_TOKEN),l=n?n.u:a.e.ACCESS_TOKEN;let f=l!==this.eventData.tokenU;a.v(this.anonId)||(this.anonId=a.u(),f=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),x=new Date(_),C=(_-this.eventData.lastSuccess)/864e5;f=f||C>=1||C<-1||v.getDate()!==x.getDate()}else f=!0;f?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:N,skuId:gr,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=_,this.eventData.tokenU=l)},d):this.processRequests()}},Yi=ln.postTurnstileEvent.bind(ln),ir=new class extends tn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(d,n,l,f){this.skuToken=n,this.errorCb=f,a.e.EVENTS_URL&&(l||a.e.ACCESS_TOKEN?this.queueRequest({id:d,timestamp:Date.now()},l):this.errorCb(new Error(xr)))}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:l}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),a.v(this.anonId)||(this.anonId=a.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:N,skuId:gr,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):n&&(this.success[n]=!0)},d))}remove(){this.errorCb=null}},us=ir.postMapLoadEvent.bind(ir),rn=new class extends tn{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(d){let n=this.mapInstanceIdMap.get(d);return n||(n=a.u(),this.mapInstanceIdMap.set(d,n)),n}getEventId(d){const n=this.eventIdPerMapInstanceMap.get(d)||0;return this.eventIdPerMapInstanceMap.set(d,n+1),n}postStyleLoadEvent(d,n){const{map:l,style:f,importedStyles:_}=n;if(!a.e.EVENTS_URL||!d&&!a.e.ACCESS_TOKEN)return;const v=this.getMapInstanceId(l),x={mapInstanceId:v,eventId:this.getEventId(v),style:f};_.length&&(x.importedStyles=_),this.queueRequest({timestamp:Date.now(),payload:x},d)}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:l}=this.queue.shift();this.postEvent(n,l,()=>{},d)}},yi=rn.postStyleLoadEvent.bind(rn),Si=new class extends tn{constructor(){super("gljs.performance")}postPerformanceEvent(d,n){a.e.EVENTS_URL&&(d||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},d)}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:l}=this.queue.shift(),f=function(_){const v=performance.getEntriesByType("resource"),x=performance.getEntriesByType("mark"),C=function(U){const Z={};if(U){for(const X in U)if(X!=="other")for(const Y of U[X]){const J=`${X}ResolveRangeMin`,ae=`${X}ResolveRangeMax`,ce=`${X}RequestCount`,oe=`${X}RequestCachedCount`;Z[J]=Math.min(Z[J]||1/0,Y.startTime),Z[ae]=Math.max(Z[ae]||-1/0,Y.responseEnd);const fe=de=>{Z[de]===void 0&&(Z[de]=0),++Z[de]};Y.transferSize!==void 0&&Y.transferSize===0&&fe(oe),fe(ce)}}return Z}(function(U,Z){const X={};if(U)for(const Y of U){const J=Z(Y);X[J]===void 0&&(X[J]=[]),X[J].push(Y)}return X}(v,ee)),D=window.devicePixelRatio,L=navigator.connection||navigator.mozConnection||navigator.webkitConnection,B=L?L.effectiveType:void 0,$={counters:[],metadata:[],attributes:[]},j=(U,Z,X)=>{X!=null&&U.push({name:Z,value:X.toString()})};for(const U in C)j($.counters,U,C[U]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(j($.counters,"interactionRangeMin",_.interactionRange[0]),j($.counters,"interactionRangeMax",_.interactionRange[1])),x)for(const U of Object.keys(H)){const Z=H[U],X=x.find(Y=>Y.name===Z);X&&j($.counters,Z,X.startTime)}return j($.counters,"visibilityHidden",_.visibilityHidden),j($.attributes,"style",function(U){if(U)for(const Z of U){const X=Z.name.split("?")[0];if(a.i(X)){const Y=X.split("/").slice(-2);if(Y.length===2)return`mapbox://styles/${Y[0]}/${Y[1]}`}}}(v)),j($.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),j($.attributes,"fogEnabled",_.fogEnabled?"true":"false"),j($.attributes,"projection",_.projection),j($.attributes,"zoom",_.zoom),j($.metadata,"devicePixelRatio",D),j($.metadata,"connectionEffectiveType",B),j($.metadata,"navigatorUserAgent",navigator.userAgent),j($.metadata,"screenWidth",window.screen.width),j($.metadata,"screenHeight",window.screen.height),j($.metadata,"windowWidth",window.innerWidth),j($.metadata,"windowHeight",window.innerHeight),j($.metadata,"mapWidth",_.width/D),j($.metadata,"mapHeight",_.height/D),j($.metadata,"webglRenderer",_.renderer),j($.metadata,"webglVendor",_.vendor),j($.metadata,"sdkVersion",N),j($.metadata,"sdkIdentifier","mapbox-gl-js"),$}(l);for(const _ of f.metadata);for(const _ of f.counters);for(const _ of f.attributes);this.postEvent(n,f,()=>{},d)}},hs=Si.postPerformanceEvent.bind(Si),qi=new class extends tn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(d,n,l,f){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const _=Et(a.e.API_URL+a.e.SESSION_PATH);_.params.push(`sku=${n||""}`),_.params.push(`access_token=${f||a.e.ACCESS_TOKEN||""}`);const v={url:fr(_),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(v,x=>{this.pendingRequest=null,l(x),this.saveEventData(),this.processRequests(f)})}getSessionAPI(d,n,l,f){this.skuToken=n,this.errorCb=f,a.e.SESSION_PATH&&a.e.API_URL&&(l||a.e.ACCESS_TOKEN?this.queueRequest({id:d,timestamp:Date.now()},l):this.errorCb(new Error(xr)))}processRequests(d){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:l}=this.queue.shift();n&&this.success[n]||this.getSession(l,this.skuToken,f=>{f?this.errorCb(f):n&&(this.success[n]=!0)},d)}remove(){this.errorCb=null}},we=qi.getSessionAPI.bind(qi),Kn=new Set;function Ne(d,n){n?Kn.add(d):Kn.delete(d)}class Qe{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,l){this._updatedSourceCaches[n]=l,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const l=n.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(n.id),this.setDirty()}removeLayer(n){const l=n.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][n.id]=n,this._updatedLayers[l].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const l in this._updatedLayers)n[l]=n[l]||{},n[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)n[l]=n[l]||{},n[l].removedIds=Object.keys(this._removedLayers[l]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(n){this._updatedImages.add(n),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function ze(d){const{userImage:n}=d;return!!(n&&n.render&&n.render())&&(d.data.replace(new Uint8Array(n.data.buffer)),!0)}class Bt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(n){this.images[n]={},this.loaded[n]=!1,this.updatedImages[n]={},this.patterns[n]={},this.callbackDispatchedThisFrame[n]={},this.atlasImage[n]=new a.r({width:1,height:1})}isLoaded(){for(const n in this.loaded)if(!this.loaded[n])return!1;return!0}setLoaded(n,l){if(this.loaded[l]!==n&&(this.loaded[l]=n,n)){for(const{ids:f,callback:_}of this.requestors)this._notify(f,l,_);this.requestors=[]}}hasImage(n,l){return!!this.getImage(n,l)}getImage(n,l){return this.images[l][n]}addImage(n,l,f){this._validate(n,f)&&(this.images[l][n]=f)}_validate(n,l){let f=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new a.t(new Error(`Image "${n}" has invalid "stretchX" value`))),f=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new a.t(new Error(`Image "${n}" has invalid "stretchY" value`))),f=!1),this._validateContent(l.content,l)||(this.fire(new a.t(new Error(`Image "${n}" has invalid "content" value`))),f=!1),f}_validateStretch(n,l){if(!n)return!0;let f=0;for(const _ of n){if(_[0]<f||_[1]<_[0]||l<_[1])return!1;f=_[1]}return!0}_validateContent(n,l){return!(n&&(n.length!==4||n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,l,f){f.version=this.images[l][n].version+1,this.images[l][n]=f,this.updatedImages[l][n]=!0}removeImage(n,l){const f=this.images[l][n];delete this.images[l][n],delete this.patterns[l][n],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(n){return Object.keys(this.images[n])}getImages(n,l,f){let _=!0;const v=!!this.loaded[l];if(!v)for(const x of n)this.images[l][x]||(_=!1);v||_?this._notify(n,l,f):this.requestors.push({ids:n,scope:l,callback:f})}getUpdatedImages(n){return this.updatedImages[n]}_notify(n,l,f){const _={};for(const v of n){this.images[l][v]||this.fire(new a.x("styleimagemissing",{id:v}));const x=this.images[l][v];x?_[v]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:Boolean(x.userImage&&x.userImage.render)}:a.w(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,_)}getPixelSize(n){const{width:l,height:f}=this.atlasImage[n];return{width:l,height:f}}getPattern(n,l,f){const _=this.patterns[l][n],v=this.getImage(n,l);if(!v)return null;if(_&&_.position.version===v.version)return _.position;if(_)_.position.version=v.version;else{const x={w:v.data.width+2*a.y,h:v.data.height+2*a.y,x:0,y:0},C=new a.I(x,v,a.y);this.patterns[l][n]={bin:x,position:C}}return this._updatePatternAtlas(l,f),this.patterns[l][n].position}bind(n,l){const f=n.gl;let _=this.atlasTexture[l];_?this.dirty&&(_.update(this.atlasImage[l]),this.dirty=!1):(_=new a.T(n,this.atlasImage[l],f.RGBA8),this.atlasTexture[l]=_),_.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(n,l){const f=[];for(const C in this.patterns[n])f.push(this.patterns[n][C].bin);const{w:_,h:v}=a.z(f),x=this.atlasImage[n];x.resize({width:_||1,height:v||1});for(const C in this.patterns[n]){const{bin:D,position:L}=this.patterns[n][C];let B=L.padding;const $=D.x+B,j=D.y+B,U=this.images[n][C].data,Z=U.width,X=U.height;B=B>1?B-1:B,a.r.copy(U,x,{x:0,y:0},{x:$,y:j},{width:Z,height:X},l),a.r.copy(U,x,{x:0,y:X-B},{x:$,y:j-B},{width:Z,height:B},l),a.r.copy(U,x,{x:0,y:0},{x:$,y:j+X},{width:Z,height:B},l),a.r.copy(U,x,{x:Z-B,y:0},{x:$-B,y:j},{width:B,height:X},l),a.r.copy(U,x,{x:0,y:0},{x:$+Z,y:j},{width:B,height:X},l),a.r.copy(U,x,{x:Z-B,y:X-B},{x:$-B,y:j-B},{width:B,height:B},l),a.r.copy(U,x,{x:0,y:X-B},{x:$+Z,y:j-B},{width:B,height:B},l),a.r.copy(U,x,{x:0,y:0},{x:$+Z,y:j+X},{width:B,height:B},l),a.r.copy(U,x,{x:Z-B,y:0},{x:$-B,y:j+X},{width:B,height:B},l)}this.dirty=!0}beginFrame(){for(const n in this.images)this.callbackDispatchedThisFrame[n]={}}dispatchRenderCallbacks(n,l){for(const f of n){if(this.callbackDispatchedThisFrame[l][f])continue;this.callbackDispatchedThisFrame[l][f]=!0;const _=this.images[l][f];ze(_)&&this.updateImage(f,l,_)}}}function At(d){const n=d.key,l=d.value,f=d.valueSpec||{},_=d.objectElementValidators||{},v=d.style,x=d.styleSpec;let C=[];const D=a.B(l);if(D!=="object")return[new a.V(n,l,`object expected, ${D} found`)];for(const L in l){const B=L.split(".")[0];let $;_[B]?$=_[B]:f[B]?$=Jr:_["*"]?$=_["*"]:f["*"]&&($=Jr),$?C=C.concat($({key:(n&&`${n}.`)+L,value:l[L],valueSpec:f[B]||f["*"],style:v,styleSpec:x,object:l,objectKey:L},l)):C.push(new a.A(n,l[L],`unknown property "${L}"`))}for(const L in f)_[L]||f[L].required&&f[L].default===void 0&&l[L]===void 0&&C.push(new a.V(n,l,`missing required property "${L}"`));return C}function qt(d){const n=d.value,l=d.valueSpec,f=d.style,_=d.styleSpec,v=d.key,x=d.arrayElementValidator||Jr;if(a.B(n)!=="array")return[new a.V(v,n,`array expected, ${a.B(n)} found`)];if(l.length&&n.length!==l.length)return[new a.V(v,n,`array length ${l.length} expected, length ${n.length} found`)];if(l["min-length"]&&n.length<l["min-length"])return[new a.V(v,n,`array length at least ${l["min-length"]} expected, length ${n.length} found`)];let C={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};_.$version<7&&(C.function=l.function),a.B(l.value)==="object"&&(C=l.value);let D=[];for(let L=0;L<n.length;L++)D=D.concat(x({array:n,arrayIndex:L,value:n[L],valueSpec:C,style:f,styleSpec:_,key:`${v}[${L}]`},!0));return D}function Mt(d){const n=d.key,l=d.value,f=d.valueSpec;let _=a.B(l);if(_==="number"&&l!=l&&(_="NaN"),_!=="number")return[new a.V(n,l,`number expected, ${_} found`)];if("minimum"in f){let v=f.minimum;if(a.B(f.minimum)==="array"&&(v=f.minimum[d.arrayIndex]),l<v)return[new a.V(n,l,`${l} is less than the minimum value ${v}`)]}if("maximum"in f){let v=f.maximum;if(a.B(f.maximum)==="array"&&(v=f.maximum[d.arrayIndex]),l>v)return[new a.V(n,l,`${l} is greater than the maximum value ${v}`)]}return[]}function Vt(d){const n=d.valueSpec,l=a.D(d.value.type);let f,_,v,x={};const C=l!=="categorical"&&d.value.property===void 0,D=!C,L=a.B(d.value.stops)==="array"&&a.B(d.value.stops[0])==="array"&&a.B(d.value.stops[0][0])==="object",B=At({key:d.key,value:d.value,valueSpec:d.styleSpec.function,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(U){if(l==="identity")return[new a.V(U.key,U.value,'identity function may not have a "stops" property')];let Z=[];const X=U.value;return Z=Z.concat(qt({key:U.key,value:X,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:$})),a.B(X)==="array"&&X.length===0&&Z.push(new a.V(U.key,X,"array must have at least one stop")),Z},default:function(U){return Jr({key:U.key,value:U.value,valueSpec:n,style:U.style,styleSpec:U.styleSpec})}}});return l==="identity"&&C&&B.push(new a.V(d.key,d.value,'missing required property "property"')),l==="identity"||d.value.stops||B.push(new a.V(d.key,d.value,'missing required property "stops"')),l==="exponential"&&d.valueSpec.expression&&!a.F(d.valueSpec)&&B.push(new a.V(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(D&&!a.G(d.valueSpec)?B.push(new a.V(d.key,d.value,"property functions not supported")):C&&!a.H(d.valueSpec)&&B.push(new a.V(d.key,d.value,"zoom functions not supported"))),l!=="categorical"&&!L||d.value.property!==void 0||B.push(new a.V(d.key,d.value,'"property" property is required')),B;function $(U){let Z=[];const X=U.value,Y=U.key;if(a.B(X)!=="array")return[new a.V(Y,X,`array expected, ${a.B(X)} found`)];if(X.length!==2)return[new a.V(Y,X,`array length 2 expected, length ${X.length} found`)];if(L){if(a.B(X[0])!=="object")return[new a.V(Y,X,`object expected, ${a.B(X[0])} found`)];if(X[0].zoom===void 0)return[new a.V(Y,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new a.V(Y,X,"object stop key must have value")];const J=a.D(X[0].zoom);if(typeof J!="number")return[new a.V(Y,X[0].zoom,"stop zoom values must be numbers")];if(v&&v>J)return[new a.V(Y,X[0].zoom,"stop zoom values must appear in ascending order")];J!==v&&(v=J,_=void 0,x={}),Z=Z.concat(At({key:`${Y}[0]`,value:X[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Mt,value:j}}))}else Z=Z.concat(j({key:`${Y}[0]`,value:X[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},X));return a.J(a.K(X[1]))?Z.concat([new a.V(`${Y}[1]`,X[1],"expressions are not allowed in function stops.")]):Z.concat(Jr({key:`${Y}[1]`,value:X[1],valueSpec:n,style:U.style,styleSpec:U.styleSpec}))}function j(U,Z){const X=a.B(U.value),Y=a.D(U.value),J=U.value!==null?U.value:Z;if(f){if(X!==f)return[new a.V(U.key,J,`${X} stop domain type must match previous stop domain type ${f}`)]}else f=X;if(X!=="number"&&X!=="string"&&X!=="boolean"&&typeof Y!="number"&&typeof Y!="string"&&typeof Y!="boolean")return[new a.V(U.key,J,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&l!=="categorical"){let ae=`number expected, ${X} found`;return a.G(n)&&l===void 0&&(ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(U.key,J,ae)]}return l!=="categorical"||X!=="number"||typeof Y=="number"&&isFinite(Y)&&Math.floor(Y)===Y?l!=="categorical"&&X==="number"&&typeof Y=="number"&&typeof _=="number"&&_!==void 0&&Y<_?[new a.V(U.key,J,"stop domain values must appear in ascending order")]:(_=Y,l==="categorical"&&Y in x?[new a.V(U.key,J,"stop domain values must be unique")]:(x[Y]=!0,[])):[new a.V(U.key,J,`integer expected, found ${String(Y)}`)]}}function Gt(d){const n=(d.expressionContext==="property"?a.L:a.M)(a.K(d.value),d.valueSpec);if(n.result==="error")return n.value.map(f=>new a.V(`${d.key}${f.key}`,d.value,f.message));const l=n.value.expression||n.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!l.outputDefined())return[new a.V(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!a.N(l))return[new a.V(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter")return Nt(l,d);if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!a.O(l,["zoom","feature-state"]))return[new a.V(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!a.Q(l))return[new a.V(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Nt(d,n){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const _ of n.valueSpec.expression.parameters)l.delete(_);if(l.size===0)return[];const f=[];return d instanceof a.S&&l.has(d.name)?[new a.V(n.key,n.value,`["${d.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(d.eachChild(_=>{f.push(...Nt(_,n))}),f)}function br(d){const n=d.key,l=d.value,f=d.valueSpec,_=[];return Array.isArray(f.values)?f.values.indexOf(a.D(l))===-1&&_.push(new a.V(n,l,`expected one of [${f.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(f.values).indexOf(a.D(l))===-1&&_.push(new a.V(n,l,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(l)} found`)),_}function ar(d){return a.W(a.K(d.value))?Gt(a.C({},d,{expressionContext:"filter",valueSpec:d.styleSpec[`filter_${d.layerType||"fill"}`]})):Dt(d)}function Dt(d){const n=d.value,l=d.key;if(a.B(n)!=="array")return[new a.V(l,n,`array expected, ${a.B(n)} found`)];const f=d.styleSpec;let _,v=[];if(n.length<1)return[new a.V(l,n,"filter array must have at least 1 element")];switch(v=v.concat(br({key:`${l}[0]`,value:n[0],valueSpec:f.filter_operator,style:d.style,styleSpec:d.styleSpec})),a.D(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&a.D(n[1])==="$type"&&v.push(new a.V(l,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new a.V(l,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(_=a.B(n[1]),_!=="string"&&v.push(new a.V(`${l}[1]`,n[1],`string expected, ${_} found`)));for(let x=2;x<n.length;x++)_=a.B(n[x]),a.D(n[1])==="$type"?v=v.concat(br({key:`${l}[${x}]`,value:n[x],valueSpec:f.geometry_type,style:d.style,styleSpec:d.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&v.push(new a.V(`${l}[${x}]`,n[x],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)v=v.concat(Dt({key:`${l}[${x}]`,value:n[x],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":_=a.B(n[1]),n.length!==2?v.push(new a.V(l,n,`filter array for "${n[0]}" operator must have 2 elements`)):_!=="string"&&v.push(new a.V(`${l}[1]`,n[1],`string expected, ${_} found`))}return v}function zr(d,n){const l=d.key,f=d.style,_=d.layer,v=d.styleSpec,x=d.value,C=d.objectKey,D=v[`${n}_${d.layerType}`];if(!D)return[];const L=C.match(/^(.*)-transition$/);if(n==="paint"&&L&&D[L[1]]&&D[L[1]].transition)return Jr({key:l,value:x,valueSpec:v.transition,style:f,styleSpec:v});const B=d.valueSpec||D[C];if(!B)return[new a.A(l,x,`unknown property "${C}"`)];let $;if(a.B(x)==="string"&&a.G(B)&&!B.tokens&&($=/^{([^}]+)}$/.exec(x))){const U=`\`{ "type": "identity", "property": ${$?JSON.stringify($[1]):'"_"'} }\``;return[new a.V(l,x,`"${C}" does not support interpolation syntax
Use an identity property function instead: ${U}.`)]}const j=[];if(d.layerType==="symbol")C!=="text-field"||!f||f.glyphs||f.imports||j.push(new a.V(l,x,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&a.X(a.K(x))&&a.D(x.type)==="identity"&&j.push(new a.V(l,x,'"text-font" does not support identity functions'));else if(d.layerType==="model"&&n==="paint"&&_&&_.layout&&_.layout.hasOwnProperty("model-id")&&a.G(B)&&(a.Y(B)||a.H(B))){const U=a.L(a.K(x),B),Z=U.value.expression||U.value._styleExpression.expression;Z&&!a.O(Z,["measure-light"])&&(C==="model-emissive-strength"&&a.Q(Z)&&a.N(Z)||j.push(new a.V(l,x,`${C} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return j.concat(Jr({key:d.key,value:x,valueSpec:B,style:f,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:C}))}function Hr(d){return zr(d,"paint")}function Oi(d){return zr(d,"layout")}function Kr(d){let n=[];const l=d.value,f=d.key,_=d.style,v=d.styleSpec;l.type||l.ref||n.push(new a.V(f,l,'either "type" or "ref" is required'));let x=a.D(l.type);const C=a.D(l.ref);if(l.id){const D=a.D(l.id);for(let L=0;L<d.arrayIndex;L++){const B=_.layers[L];a.D(B.id)===D&&n.push(new a.V(f,l.id,`duplicate layer id "${l.id}", previously used at line ${B.id.__line__}`))}}if("ref"in l){let D;["type","source","source-layer","filter","layout"].forEach(L=>{L in l&&n.push(new a.V(f,l[L],`"${L}" is prohibited for ref layers`))}),_.layers.forEach(L=>{a.D(L.id)===C&&(D=L)}),D?D.ref?n.push(new a.V(f,l.ref,"ref cannot reference another ref layer")):x=a.D(D.type):typeof C=="string"&&n.push(new a.V(f,l.ref,`ref layer "${C}" not found`))}else if(x!=="background"&&x!=="sky"&&x!=="slot")if(l.source){const D=_.sources&&_.sources[l.source],L=D&&a.D(D.type);D?L==="vector"&&x==="raster"?n.push(new a.V(f,l.source,`layer "${l.id}" requires a raster source`)):L==="raster"&&x!=="raster"?n.push(new a.V(f,l.source,`layer "${l.id}" requires a vector source`)):L!=="vector"||l["source-layer"]?L==="raster-dem"&&x!=="hillshade"?n.push(new a.V(f,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):L!=="raster-array"||["raster","raster-particle"].includes(x)?x!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||L==="geojson"&&D.lineMetrics?x==="raster-particle"&&L!=="raster-array"&&n.push(new a.V(f,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):n.push(new a.V(f,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new a.V(f,l.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new a.V(f,l,`layer "${l.id}" must specify a "source-layer"`)):n.push(new a.V(f,l.source,`source "${l.source}" not found`))}else n.push(new a.V(f,l,'missing required property "source"'));return n=n.concat(At({key:f,value:l,valueSpec:v.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Jr({key:`${f}.type`,value:l.type,valueSpec:v.layer.type,style:d.style,styleSpec:d.styleSpec,object:l,objectKey:"type"}),filter:D=>ar(a.C({layerType:x},D)),layout:D=>At({layer:l,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":L=>Oi(a.C({layerType:x},L))}}),paint:D=>At({layer:l,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":L=>Hr(a.C({layerType:x,layer:l},L))}})}})),n}function Pi(d){const n=d.value,l=d.key,f=a.B(n);return f!=="string"?[new a.V(l,n,`string expected, ${f} found`)]:[]}const to={promoteId:function({key:d,value:n}){if(a.B(n)==="string")return Pi({key:d,value:n});{const l=[];for(const f in n)l.push(...Pi({key:`${d}.${f}`,value:n[f]}));return l}}};function ds(d){const n=d.value,l=d.key,f=d.styleSpec,_=d.style;if(!n.type)return[new a.V(l,n,'"type" is required')];const v=a.D(n.type);let x=[];switch(["vector","raster","raster-dem","raster-array"].includes(v)&&(n.url||n.tiles||x.push(new a.A(l,n,'Either "url" or "tiles" is required.'))),v){case"vector":case"raster":case"raster-dem":case"raster-array":return x=x.concat(At({key:l,value:n,valueSpec:f[`source_${v.replace("-","_")}`],style:d.style,styleSpec:f,objectElementValidators:to})),x;case"geojson":if(x=At({key:l,value:n,valueSpec:f.source_geojson,style:_,styleSpec:f,objectElementValidators:to}),n.cluster)for(const C in n.clusterProperties){const[D,L]=n.clusterProperties[C],B=typeof D=="string"?[D,["accumulated"],["get",C]]:D;x.push(...Gt({key:`${l}.${C}.map`,value:L,expressionContext:"cluster-map"})),x.push(...Gt({key:`${l}.${C}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return x;case"video":return At({key:l,value:n,valueSpec:f.source_video,style:_,styleSpec:f});case"image":return At({key:l,value:n,valueSpec:f.source_image,style:_,styleSpec:f});case"canvas":return[new a.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return br({key:`${l}.type`,value:n.type,valueSpec:{values:ka(f)},style:_,styleSpec:f})}}function ka(d){return d.source.reduce((n,l)=>{const f=d[l];return f.type.type==="enum"&&(n=n.concat(Object.keys(f.type.values))),n},[])}function xo(d){const n=d.value,l=d.styleSpec,f=l.light,_=d.style;let v=[];const x=a.B(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new a.V("light",n,`object expected, ${x} found`)]),v;for(const C in n){const D=C.match(/^(.*)-transition$/);v=v.concat(D&&f[D[1]]&&f[D[1]].transition?Jr({key:C,value:n[C],valueSpec:l.transition,style:_,styleSpec:l}):f[C]?Jr({key:C,value:n[C],valueSpec:f[C],style:_,styleSpec:l}):[new a.V(C,n[C],`unknown property "${C}"`)])}return v}function ha(d){const n=d.value;let l=[];if(!n)return l;const f=a.B(n);if(f!=="object")return l=l.concat([new a.V("light-3d",n,`object expected, ${f} found`)]),l;const _=d.styleSpec,v=_["light-3d"],x=d.key,C=d.style,D=d.style.lights;for(const $ of["type","id"])if(!($ in n))return l=l.concat([new a.V("light-3d",n,`missing property ${$} on light`)]),l;if(n.type&&D)for(let $=0;$<d.arrayIndex;$++){const j=a.D(n.type),U=D[$];a.D(U.type)===j&&l.push(new a.V(x,n.id,`duplicate light type "${n.type}", previously defined at line ${U.id.__line__}`))}const L=`properties_light_${n.type}`;if(!(L in _))return l=l.concat([new a.V("light-3d",n,`Invalid light type ${n.type}`)]),l;const B=_[L];for(const $ in n)if($==="properties"){const j=n[$],U=a.B(j);if(U!=="object")return l=l.concat([new a.V("properties",j,`object expected, ${U} found`)]),l;for(const Z in j)l=l.concat(B[Z]?Jr({key:Z,value:j[Z],valueSpec:B[Z],style:C,styleSpec:_}):[new a.A(d.key,j[Z],`unknown property "${Z}"`)])}else{const j=$.match(/^(.*)-transition$/);l=l.concat(j&&v[j[1]]&&v[j[1]].transition?Jr({key:$,value:n[$],valueSpec:_.transition,style:C,styleSpec:_}):v[$]?Jr({key:$,value:n[$],valueSpec:v[$],style:C,styleSpec:_}):[new a.A($,n[$],`unknown property "${$}"`)])}return l}function Nn(d){const n=d.value,l=d.key,f=d.style,_=d.styleSpec,v=_.terrain;let x=[];const C=a.B(n);if(n===void 0||C==="null")return x;if(C!=="object")return x=x.concat([new a.V("terrain",n,`object expected, ${C} found`)]),x;for(const D in n){const L=D.match(/^(.*)-transition$/);x=x.concat(L&&v[L[1]]&&v[L[1]].transition?Jr({key:D,value:n[D],valueSpec:_.transition,style:f,styleSpec:_}):v[D]?Jr({key:D,value:n[D],valueSpec:v[D],style:f,styleSpec:_}):[new a.A(D,n[D],`unknown property "${D}"`)])}if(n.source){const D=f.sources&&f.sources[n.source],L=D&&a.D(D.type);D?L!=="raster-dem"&&x.push(new a.V(l,n.source,`terrain cannot be used with a source of type ${String(L)}, it only be used with a "raster-dem" source type`)):x.push(new a.V(l,n.source,`source "${n.source}" not found`))}else x.push(new a.V(l,n,'terrain is missing required property "source"'));return x}function vn(d){const n=d.value,l=d.style,f=d.styleSpec,_=f.fog;let v=[];const x=a.B(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new a.V("fog",n,`object expected, ${x} found`)]),v;for(const C in n){const D=C.match(/^(.*)-transition$/);v=v.concat(D&&_[D[1]]&&_[D[1]].transition?Jr({key:C,value:n[C],valueSpec:f.transition,style:l,styleSpec:f}):_[C]?Jr({key:C,value:n[C],valueSpec:_[C],style:l,styleSpec:f}):[new a.A(C,n[C],`unknown property "${C}"`)])}return v}const dl={"*":()=>[],array:qt,boolean:function(d){const n=d.value,l=d.key,f=a.B(n);return f!=="boolean"?[new a.V(l,n,`boolean expected, ${f} found`)]:[]},number:Mt,color:function(d){const n=d.key,l=d.value,f=a.B(l);return f!=="string"?[new a.V(n,l,`color expected, ${f} found`)]:a.U.parseCSSColor(l)===null?[new a.V(n,l,`color expected, "${l}" found`)]:[]},enum:br,filter:ar,function:Vt,layer:Kr,object:At,source:ds,model:a.Z,light:xo,"light-3d":ha,terrain:Nn,fog:vn,string:Pi,formatted:function(d){return Pi(d).length===0?[]:Gt(d)},resolvedImage:function(d){return Pi(d).length===0?[]:Gt(d)},projection:function(d){const n=d.value,l=d.styleSpec,f=l.projection,_=d.style;let v=[];const x=a.B(n);if(x==="object")for(const C in n)v=v.concat(Jr({key:C,value:n[C],valueSpec:f[C],style:_,styleSpec:l}));else x!=="string"&&(v=v.concat([new a.V("projection",n,`object or string expected, ${x} found`)]));return v},import:function(d){const{value:n,styleSpec:l}=d,{data:f,..._}=n;Object.defineProperty(_,"__line__",{value:n.__line__,enumerable:!1});let v=At(a.C({},d,{value:_,valueSpec:l.import}));return a.D(_.id)===""&&v.push(new a.V(`${d.key}.id`,_,"import id can't be an empty string")),f&&(v=v.concat(Jd(f,l,{key:`${d.key}.data`}))),v}};function Jr(d,n=!1){const l=d.value,f=d.valueSpec,_=d.styleSpec;if(f.expression&&a.X(a.D(l)))return Vt(d);if(f.expression&&a.J(a.K(l)))return Gt(d);if(f.type&&dl[f.type]){const v=dl[f.type](d);return n===!0&&v.length>0&&a.B(d.value)==="array"?Gt(d):v}return At(a.C({},d,{valueSpec:f.type?_[f.type]:f}))}function da(d){const n=d.value,l=d.key,f=Pi(d);return f.length||(n.indexOf("{fontstack}")===-1&&f.push(new a.V(l,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&f.push(new a.V(l,n,'"glyphs" url must include a "{range}" token'))),f}function Jd(d,n=a._,l={}){return Jr({key:l.key||"",value:d,valueSpec:n.$root,styleSpec:n,style:d,objectElementValidators:{glyphs:da,"*":()=>[]}})}function Wo(d,n=a._){return be(Jd(d,n))}const Kl=d=>be(ds(d)),mh=d=>be(xo(d)),$c=d=>be(ha(d)),gh=d=>be(Nn(d)),Yl=d=>be(vn(d)),qe=d=>be(Kr(d)),Q=d=>be(ar(d)),re=d=>be(Hr(d)),pe=d=>be(Oi(d)),Se=d=>be(a.Z(d));function be(d){return d.slice().sort((n,l)=>n.line&&l.line?n.line-l.line:0)}function ke(d,n){let l=!1;if(n&&n.length)for(const f of n)f instanceof a.A?a.w(f.message):(d.fire(new a.t(new Error(f.message))),l=!0);return l}let We;class Ve extends a.E{constructor(n,l="flat"){super(),this._transitionable=new a.$(We||(We=new a.a0({anchor:new a.a1(a._.light.anchor),position:new a.a2(a._.light.position),color:new a.a1(a._.light.color),intensity:new a.a1(a._.light.intensity)}))),this.setLight(n,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l,f={}){this._validate(mh,n,f)||(this._transitionable.setTransitionOrValue(n),this.id=l)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,f){return(!f||f.validate!==!1)&&ke(this,n.call(Wo,a.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a._})))}}const Ze=new a.a0({source:new a.a1(a._.terrain.source),exaggeration:new a.a1(a._.terrain.exaggeration)});let it=class extends a.E{constructor(d,n,l,f){super(),this.scope=l,this._transitionable=new a.$(Ze,l,f),this._transitionable.setTransitionOrValue(d,f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(d,n){this._transitionable.setTransitionOrValue(d,n)}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}getExaggeration(d){return this._transitioning.possiblyEvaluate(new a.a3(d)).get("exaggeration")}isZoomDependent(){const d=this._transitionable._values.exaggeration;return d!=null&&d.value!=null&&d.value.expression!=null&&d.value.expression instanceof a.a4}};const et=45,yt=65,kt=.05;function zt(d,n,l,f){const _=a.a7(et,yt,l),[v,x]=ur(d,f);let C=1-Math.min(1,Math.exp((n-v)/(x-v)*-6));return C*=C*C,C=Math.min(1,1.00747*C),C*_*d.alpha}function ur(d,n){const l=.5/Math.tan(.5*n);return[d.range[0]+l,d.range[1]+l]}function pr(d,n,l,f,_){const v=a.a6.vec3.transformMat4([],[n,l,f],_.mercatorFogMatrix);return zt(d,a.a6.vec3.length(v),_.pitch,_._fov)}function _r(d,n,l,f,_,v,x){const C=[[l,f,0],[_,f,0],[_,v,0],[l,v,0]];let D=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(const B of C){const $=a.a6.vec3.transformMat4([],B,n),j=a.a6.vec3.length($);D=Math.min(D,j),L=Math.max(L,j)}return[zt(d,D,x.pitch,x._fov),zt(d,L,x.pitch,x._fov)]}const mr=new a.a0({range:new a.a1(a._.fog.range),color:new a.a1(a._.fog.color),"high-color":new a.a1(a._.fog["high-color"]),"space-color":new a.a1(a._.fog["space-color"]),"horizon-blend":new a.a1(a._.fog["horizon-blend"]),"star-intensity":new a.a1(a._.fog["star-intensity"]),"vertical-range":new a.a1(a._.fog["vertical-range"])});class ai extends a.E{constructor(n,l,f,_){super(),this._transitionable=new a.$(mr,f,new Map(_)),this.set(n,_),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new a.a8(mr),this.scope=f}get state(){const n=this._transform,l=n.projection.name==="globe",f=a.a9(n.zoom),_=this.properties.get("range"),v=[.5,3];return{range:l?[a.aa(v[0],_[0],f),a.aa(v[1],_[1],f)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,l,f={}){if(this._validate(Yl,n,f))return;const _=a.l({},n);for(const v of Object.keys(a._.fog))_[v]===void 0&&(_[v]=a._.fog[v].default);this._options=_,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.a7(et,yt,n))*l.a}getOpacityAtLatLng(n,l){return this._transform.projection.supportsFog?function(f,_,v){const x=a.a5.fromLngLat(_),C=v.elevation?v.elevation.getAtPointOrZero(x):0;return pr(f,x.x,x.y,C,v)}(this.state,n,l):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(n.toUnwrapped());return _r(this.state,l,0,0,a.ab,a.ab,this._transform)}getOpacityForBounds(n,l,f,_,v){return this._transform.projection.supportsFog?_r(this.state,n,l,f,_,v,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?ur(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const f of l){const _=n.points[f];let v;if(_[2]>=0)v=_;else{const x=n.points[f-4];v=a.ac(x,_,x[2]/(x[2]-_[2]))}if(pr(this.state,v[0],v[1],0,this._transform)>=kt)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,f){return(!f||f.validate!==!1)&&ke(this,n.call(Wo,a.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a._})))}}class pi extends a.E{constructor(n,l,f,_){super(),this.scope=f,this._options=n,this.properties=new a.a8(l),this._transitionable=new a.$(l,f,new Map(_)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,l){this._options=n,this._transitionable.setTransitionOrValue(n.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let Or,di;class Wi{constructor(n,l,f,_){this.screenBounds=n,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(n,l){let f,_;if(n instanceof a.P||typeof n[0]=="number"){const v=a.P.convert(n);f=[v],_=l.isPointAboveHorizon(v)}else{const v=a.P.convert(n[0]),x=a.P.convert(n[1]);f=[v,x],_=a.ae(v,x).every(C=>l.isPointAboveHorizon(C))}return new Wi(f,l.getCameraPoint(),_,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return a.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const l=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],_=a.ae(l,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<f.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?_[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(_[3]=this.cameraPoint)),a.af(_,n)}bufferedCameraGeometryGlobe(n){const l=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],_=a.ae(l,f,n),v=this.cameraPoint.clone();switch(3*((v.y>l.y)+(v.y>f.y))+((v.x>l.x)+(v.x>f.x))){case 0:_[0]=v,_[4]=v.clone();break;case 1:_.splice(1,0,v);break;case 2:_[1]=v;break;case 3:_.splice(4,0,v);break;case 5:_.splice(2,0,v);break;case 6:_[3]=v;break;case 7:_.splice(3,0,v);break;case 8:_[2]=v}return _}containsTile(n,l,f,_=0){const v=n.queryPadding/l._pixelsPerMercatorPixel+1,x=f?this._bufferedCameraMercator(v,l):this._bufferedScreenMercator(v,l);let C=n.tileID.wrap+(x.unwrapped?_:0);const D=x.polygon.map(Y=>a.ag(n.tileTransform,Y,C));if(!a.ah(D,0,0,a.ab,a.ab))return;C=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const L=this.screenGeometryMercator.polygon.map(Y=>a.ai(n.tileTransform,Y,C)),B=L.map(Y=>new a.P(Y[0],Y[1])),$=l.getFreeCameraOptions().position||new a.a5(0,0,0),j=a.ai(n.tileTransform,$,C),U=L.map(Y=>{const J=a.a6.vec3.sub(Y,Y,j);return a.a6.vec3.normalize(J,J),new a.aj(j,J)}),Z=a.ak(n,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:B,tilespaceRays:U,bufferedTilespaceGeometry:D,bufferedTilespaceBounds:(X=a.al(D),X.min.x=a.ap(X.min.x,0,a.ab),X.min.y=a.ap(X.min.y,0,a.ab),X.max.x=a.ap(X.max.x,0,a.ab),X.max.y=a.ap(X.max.y,0,a.ab),X),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:Z};var X}_bufferedScreenMercator(n,l){const f=Yn(n);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let _;return _=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),l):{polygon:this.bufferedScreenGeometry(n).map(v=>l.pointCoordinate3D(v)),unwrapped:!0},this._screenRaycastCache[f]=_,_}}_bufferedCameraMercator(n,l){const f=Yn(n);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let _;return _=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),l):{polygon:this.bufferedCameraGeometry(n).map(v=>l.pointCoordinate3D(v)),unwrapped:!0},this._cameraRaycastCache[f]=_,_}}_projectAndResample(n,l){const f=function(v,x){const C=a.a6.mat4.multiply([],x.pixelMatrix,x.globeMatrix),D=[0,-a.aq,0,1],L=[0,a.aq,0,1],B=[0,0,0,1];a.a6.vec4.transformMat4(D,D,C),a.a6.vec4.transformMat4(L,L,C),a.a6.vec4.transformMat4(B,B,C);const $=new a.P(D[0]/D[3],D[1]/D[3]),j=new a.P(L[0]/L[3],L[1]/L[3]),U=a.an(v,$)&&D[3]<B[3],Z=a.an(v,j)&&L[3]<B[3];if(!U&&!Z)return null;const X=function(ye,ge,ve){for(let Ce=1;Ce<ye.length;Ce++){const Oe=Mn(ge.pointCoordinate3D(ye[Ce-1]).x),Te=Mn(ge.pointCoordinate3D(ye[Ce]).x);if(ve<0){if(Oe<Te)return{idx:Ce,t:-Oe/(Te-1-Oe)}}else if(Te<Oe)return{idx:Ce,t:(1-Oe)/(Te+1-Oe)}}return null}(v,x,U?-1:1);if(!X)return null;const{idx:Y,t:J}=X;let ae=Y>1?On(v.slice(0,Y),x):[],ce=Y<v.length?On(v.slice(Y),x):[];ae=ae.map(ye=>new a.P(Mn(ye.x),ye.y)),ce=ce.map(ye=>new a.P(Mn(ye.x),ye.y));const oe=[...ae];oe.length===0&&oe.push(ce[ce.length-1]);const fe=a.aa(oe[oe.length-1].y,(ce.length===0?ae[0]:ce[0]).y,J);let de;return de=U?[new a.P(0,fe),new a.P(0,0),new a.P(1,0),new a.P(1,fe)]:[new a.P(1,fe),new a.P(1,1),new a.P(0,1),new a.P(0,fe)],oe.push(...de),ce.length===0?oe.push(ae[0]):oe.push(...ce),{polygon:oe.map(ye=>new a.a5(ye.x,ye.y)),unwrapped:!1}}(n,l);if(f)return f;const _=function(v,x){let C=!1,D=-1/0,L=0;for(let $=0;$<v.length-1;$++)v[$].x>D&&(D=v[$].x,L=$);for(let $=0;$<v.length-1;$++){const j=(L+$)%(v.length-1),U=v[j],Z=v[j+1];Math.abs(U.x-Z.x)>.5&&(U.x<Z.x?(U.x+=1,j===0&&(v[v.length-1].x+=1)):(Z.x+=1,j+1===v.length-1&&(v[0].x+=1)),C=!0)}const B=a.am(x.center.lng);return C&&B<Math.abs(B-1)&&v.forEach($=>{$.x-=1}),{polygon:v,unwrapped:C}}(On(n,l).map(v=>new a.P(Mn(v.x),v.y)),l);return{polygon:_.polygon.map(v=>new a.a5(v.x,v.y)),unwrapped:_.unwrapped}}}function On(d,n){return a.ao(d,l=>{const f=n.pointCoordinate3D(l);l.x=f.x,l.y=f.y},1/256)}function Mn(d){return d<0?1+d%1:d%1}function Yn(d){return 100*d|0}function Fs(d,n,l,f,_){const v=function(C,D){if(C)return _(C);if(D){if(d.url&&D.tiles&&d.tiles&&delete d.tiles,D.variants){if(!Array.isArray(D.variants))return _(new Error("variants must be an array"));for(const B of D.variants){if(B==null||typeof B!="object"||B.constructor!==Object)return _(new Error("variant must be an object"));if(!Array.isArray(B.capabilities))return _(new Error("capabilities must be an array"));if(B.capabilities.length===1&&B.capabilities[0]==="meshopt"){D=a.l(D,B);break}}}const L=a.ar(a.l(D,d),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(L.vectorLayers=D.vector_layers,L.vectorLayerIds=L.vectorLayers.map(B=>B.id)),D.raster_layers&&(L.rasterLayers=D.raster_layers,L.rasterLayerIds=L.rasterLayers.map(B=>B.id)),L.tiles=n.canonicalizeTileset(L,d.url),_(null,L)}},x=function(C,D,L){if(!C)return null;if(!D&&!L)return C;L=L||C.worldview_default;const B=Object.values(C.language||{});if(B.length===0)return null;const $=Object.values(C.worldview||{});if($.length===0)return null;const j=B.every(Z=>Z===D),U=$.every(Z=>Z===L);return j&&U?C:D in(C.language_options||{})||L in(C.worldview_options||{})?null:C.language_options&&C.worldview_options?C:null}(d.data,l,f);return x?a.q.frame(()=>v(null,x)):d.url?a.n(n.transformRequest(n.normalizeSourceURL(d.url,null,l,f),a.R.Source),v):a.q.frame(()=>{const{data:C,...D}=d;v(null,D)})}class za{constructor(n,l,f){this.bounds=a.as.convert(this.validateBounds(n)),this.minzoom=l||0,this.maxzoom=f||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const l=Math.pow(2,n.z),f=Math.floor(a.am(this.bounds.getWest())*l),_=Math.floor(a.at(this.bounds.getNorth())*l),v=Math.ceil(a.am(this.bounds.getEast())*l),x=Math.ceil(a.at(this.bounds.getSouth())*l);return n.x>=f&&n.x<v&&n.y>=_&&n.y<x}}class Qd extends a.E{constructor(n,l,f,_){if(super(),this.id=n,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.l(this,a.ar(l,["url","scheme","tileSize","promoteId"])),this._options=a.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new a.au}load(n){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map._worldview;this._tileJSONRequest=Fs(this._options,this.map._requestManager,l,f,(_,v)=>{this._tileJSONRequest=null,this._loaded=!0,_?(l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new a.t(_))):v&&(a.l(this,v),v.bounds&&(this.tileBounds=new za(v.bounds,this.minzoom,this.maxzoom)),Yi(v.tiles,this.map._requestManager._customAccessToken),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),n&&n(_)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=a.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}loadTile(n,l){const f=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),_=this.map._requestManager.transformRequest(f,a.R.Tile),v=this.map.style?this.map.style.getLut(this.scope):null,x={request:_,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,lut:v?{image:v.image.clone()}:null,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(x.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",x,C.bind(this));else if(n.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",x,C.bind(this),void 0,!0);else{const D=a.aw.call({deduped:this._deduped},x,(L,B)=>{L||!B?C.call(this,L):(x.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},n.actor&&n.actor.send("loadTile",x,C.bind(this),void 0,!0))},!0);n.request={cancel:D}}function C(D,L){return delete n.request,n.aborted?l(null):D&&D.status!==404?l(D):(L&&L.resourceTiming&&(n.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&n.setExpiryData(L),n.loadVectorData(L,this.map.painter),a.ax(this.dispatcher),l(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,l){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class _h extends a.E{constructor(n,l,f,_){super(),this.id=n,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.l({type:"raster"},l),a.l(this,a.ar(l,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"})),this._tileJSONRequest=Fs(this._options,this.map._requestManager,null,null,(l,f)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new a.t(l)):f&&(a.l(this,f),f.bounds&&(this.tileBounds=new za(f.bounds,this.minzoom,this.maxzoom)),Yi(f.tiles),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),n&&n(l)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=a.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,l){const f=a.q.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);n.request=a.o(this.map._requestManager.transformRequest(_,a.R.Tile),(v,x,C,D)=>(delete n.request,n.aborted?(n.state="unloaded",l(null)):v?(n.state="errored",l(v)):x?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:C,expires:D}),n.setTexture(x,this.map.painter),n.state="loaded",a.ax(this.dispatcher),void l(null)):l(null)))}abortTile(n,l){n.request&&(n.request.cancel(),delete n.request),l&&l()}unloadTile(n,l){n.texture&&n.texture instanceof a.T?(n.destroy(!0),n.texture&&n.texture instanceof a.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class jc extends _h{constructor(n,l,f,_){super(n,l,f,_),this.type="raster-array",this.maxzoom=22,this._options=a.l({type:"raster-array"},l)}triggerRepaint(n){const l=this.map.painter._terrain,f=this.map.style.getSourceCache(this.id);l&&l.enabled&&f&&l._clearRenderCacheForTile(f.id,n.tileID),this.map.triggerRepaint()}loadTile(n,l){const f=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),_=this.map._requestManager.transformRequest(f,a.R.Tile);n.requestParams=_,n.actor||(n.actor=this.dispatcher.getActor()),n.request=n.fetchHeader(void 0,(v,x,C,D)=>{if(delete n.request,n.aborted)return n.state="unloaded",l(null);if(v)return v.code===20?void 0:(n.state="errored",l(v));this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:C,expires:D}),n.state="empty",l(null)})}unloadTile(n,l){const f=n.texture;f&&f instanceof a.T?(n.destroy(!0),this.map.painter.saveTileTexture(f)):(n.destroy(),n.flushQueues(),n._isHeaderLoaded=!1,delete n._mrt,delete n.textureDescriptor),n.fbo&&(n.fbo.destroy(),delete n.fbo),delete n.request,delete n.requestParams,delete n.neighboringTiles,n.state="unloaded"}prepareTile(n,l,f){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBand(l,f,(_,v)=>{if(_)return n.state="errored",this.fire(new a.t(_)),void this.triggerRepaint(n);v&&(n.setTexture(v,this.map.painter),n.state="loaded",this.triggerRepaint(n))}))}getInitialBand(n){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:v})=>v===n),f=l&&l.fields,_=f&&f.bands&&f.bands;return _?_[0]:0}getTextureDescriptor(n,l,f){if(!n)return;const _=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!_)return;let v=null;l instanceof a.aB?v=l.paint.get("raster-array-band"):l instanceof a.aC&&(v=l.paint.get("raster-particle-array-band"));const x=v||this.getInitialBand(_);if(x!=null)if(n.textureDescriptor){if(!n.updateNeeded(_,x)||f)return Object.assign({},n.textureDescriptor,{texture:n.texture})}else this.prepareTile(n,_,x)}}const ef={vector:Qd,raster:_h,"raster-dem":class extends _h{constructor(d,n,l,f){super(d,n,l,f),this.type="raster-dem",this.maxzoom=22,this._options=a.l({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(d,n){const l=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(_,v){_&&(d.state="errored",n(_)),v&&(d.dem=v,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",n(null))}d.request=a.o(this.map._requestManager.transformRequest(l,a.R.Tile),function(_,v,x,C){if(delete d.request,d.aborted)d.state="unloaded",n(null);else if(_)d.state="errored",n(_);else if(v){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:x,expires:C});const D=ImageBitmap&&v instanceof ImageBitmap&&a.ay(),L=1-(v.width-a.az(v.width))/2;L<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const B=D?v:a.q.getImageData(v,L),$={uid:d.uid,coord:d.tileID,source:this.id,scope:this.scope,rawImageData:B,encoding:this.encoding,padding:L};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",$,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const n=d.canonical,l=Math.pow(2,n.z),f=(n.x-1+l)%l,_=n.x===0?d.wrap-1:d.wrap,v=(n.x+1+l)%l,x=n.x+1===l?d.wrap+1:d.wrap,C={};return C[new a.aA(d.overscaledZ,_,n.z,f,n.y).key]={backfilled:!1},C[new a.aA(d.overscaledZ,x,n.z,v,n.y).key]={backfilled:!1},n.y>0&&(C[new a.aA(d.overscaledZ,_,n.z,f,n.y-1).key]={backfilled:!1},C[new a.aA(d.overscaledZ,d.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},C[new a.aA(d.overscaledZ,x,n.z,v,n.y-1).key]={backfilled:!1}),n.y+1<l&&(C[new a.aA(d.overscaledZ,_,n.z,f,n.y+1).key]={backfilled:!1},C[new a.aA(d.overscaledZ,d.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},C[new a.aA(d.overscaledZ,x,n.z,v,n.y+1).key]={backfilled:!1}),C}},"raster-array":jc,geojson:class extends a.E{constructor(d,n,l,f){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(f),this._data=n.data,this._options=a.l({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const _=a.ab/this.tileSize;this.workerOptions=a.l({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*_,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*_,extent:a.ab,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:a.ab,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*_,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}updateData(d){if(!this._options.dynamic)return this.fire(new a.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof d!="string"&&(d.type==="Feature"&&(d={type:"FeatureCollection",features:[d]}),d.type!=="FeatureCollection"))return this.fire(new a.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof d!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const l of this._data.features)n.set(l.id,l);for(const l of d.features)n.set(l.id,l);this._data.features=[...n.values()]}else this._data=d;return this._updateWorkerData(!0),this}getClusterExpansionZoom(d,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id,scope:this.scope},n),this}getClusterChildren(d,n){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id,scope:this.scope},n),this}getClusterLeaves(d,n,l,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:d,limit:n,offset:l},f),this}_updateWorkerData(d=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.x("dataloading",{dataType:"source"})),this._loaded=!1;const n=a.l({append:d},this.workerOptions);n.scope=this.scope;const l=this._data;typeof l=="string"?(n.request=this.map._requestManager.transformRequest(a.q.resolveURL(l),a.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(f,_)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new a.t(f));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(v.resourceTiming=_.resourceTiming[this.id]),d&&(this._partialReload=!0),this.fire(new a.x("data",v)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(d),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,n){const l=d.actor?"reloadTile":"loadTile";d.actor=this.actor;const f=this.map.style?this.map.style.getLut(this.scope):null,_=this._partialReload,v={type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:f?{image:f.image.clone()}:null,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:_};d.request=this.actor.send(l,v,(x,C)=>_&&!C?(d.state="loaded",n(null)):(delete d.request,d.destroy(),d.aborted?n(null):x?n(x):(d.loadVectorData(C,this.map.painter,l==="reloadTile"),n(null))),void 0,l==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d,n){this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id,scope:this.scope}),d.destroy()}onRemove(d){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aD{constructor(d,n,l,f){super(d,n,l,f),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const n of d.urls)this.urls.push(this.map._requestManager.transformRequest(n,a.R.Source).url);a.aE(this.urls,(n,l)=>{this._loaded=!0,n?this.fire(new a.t(n)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const n=this.video.seekable;d<n.start(0)||d>n.end(0)?this.fire(new a.t(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,n=d.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(d,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aD,model:class extends a.E{constructor(d,n,l,f){super(),this.id=d,this.type="model",this.models=[],this._loaded=!1,this._options=n}load(){const d=[];for(const n in this._options.models){const l=this._options.models[n],f=a.aG(this.map._requestManager.transformRequest(l.uri,a.R.Model).url).then(_=>{if(!_)return;const v=a.aH(_),x=new a.aI(n,l.position,l.orientation,v);x.computeBoundsAndApplyParent(),this.models.push(x)}).catch(_=>{this.fire(new a.t(new Error(`Could not load model ${n} from ${l.uri}: ${_.message}`)))});d.push(f)}return Promise.allSettled(d).then(()=>{this._loaded=!0,this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(n=>{this.fire(new a.t(new Error(`Could not load models: ${n.message}`)))})}onAdd(d){this.map=d,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(d,n){}serialize(){return{type:"model"}}},"batched-model":class extends a.E{constructor(d,n,l,f){super(),this.type="batched-model",this.id=d,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(f)}onAdd(d){this.map=d,this.load()}load(d){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=Fs(this._options,this.map._requestManager,n,l,(f,_)=>{this._tileJSONRequest=null,this._loaded=!0,f?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new a.t(f))):_&&(a.l(this,_),_.bounds&&(this.tileBounds=new za(_.bounds,this.minzoom,this.maxzoom)),Yi(_.tiles,this.map._requestManager._customAccessToken),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),d&&d(f)})}hasTransition(){return!1}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loaded(){return this._loaded}loadTile(d,n){const l=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(l,a.R.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:d.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(d.actor&&d.state!=="expired")if(d.state==="loading")d.reloadCallback=n;else{if(d.buckets){const v=Object.values(d.buckets);for(const x of v)x.dirty=!0;return void(d.state="loaded")}d.request=d.actor.send("reloadTile",f,_.bind(this))}else d.actor=this.dispatcher.getActor(),d.request=d.actor.send("loadTile",f,_.bind(this),void 0,!0);function _(v,x){return d.aborted?n(null):v&&v.status!==404?n(v):(x&&(x.resourceTiming&&(d.resourceTiming=x.resourceTiming),this.map._refreshExpiredTiles&&d.setExpiryData(x),d.buckets={...d.buckets,...x.buckets},x.featureIndex&&(d.latestFeatureIndex=x.featureIndex)),d.state="loaded",void n(null))}}serialize(){return a.l({},this._options)}},canvas:class extends a.aD{constructor(d,n,l,f){super(d,n,l,f),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(v=>typeof v!="number"))||this.fire(new a.t(new a.V(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.t(new a.V(`sources.${d}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new a.t(new a.V(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new a.t(new a.V(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.t(new a.V(`sources.${d}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(d){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!d&&!this._playing||this.texture instanceof a.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends a.E{constructor(d,n,l,f){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=n,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new za(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),a.l(this,a.ar(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this.map=d,this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:n,y:l,z:f}=d.canonical;return this._implementation.hasTile({x:n,y:l,z:f})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,n){const{x:l,y:f,z:_}=d.tileID.canonical,v=new AbortController;d.request=Promise.resolve(this._implementation.loadTile({x:l,y:f,z:_},{signal:v.signal})).then(function(x){return delete d.request,d.aborted?(d.state="unloaded",n(null)):x===void 0?(d.state="errored",n(null)):x===null?(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",n(null)):function(C){return C instanceof ImageData||C instanceof HTMLCanvasElement||C instanceof ImageBitmap||C instanceof HTMLImageElement}(x)?(this.loadTileData(d,x),d.state="loaded",void n(null)):(d.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(x=>{x.code!==20&&(d.state="errored",n(x))}),d.request.cancel=()=>v.abort()}loadTileData(d,n){d.setTexture(n,this.map.painter)}unloadTile(d,n){if(d.texture&&d.texture instanceof a.T?(d.destroy(!0),d.texture&&d.texture instanceof a.T&&this.map.painter.saveTileTexture(d.texture)):d.destroy(),this._implementation.unloadTile){const{x:l,y:f,z:_}=d.tileID.canonical;this._implementation.unloadTile({x:l,y:f,z:_})}n&&n()}abortTile(d,n){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_clearTiles(){const d=a.av(this.id,this.scope);this.map.style.clearSource(d)}_update(){this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))}}},Vc=function(d,n,l,f){const _=new ef[n.type](d,n,l,f);if(_.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${_.id}`);return a.aJ(["load","abort","unload","serialize","prepare"],_),_};function dm(d,n){const l=a.a6.mat4.identity([]);return a.a6.mat4.scale(l,l,[.5*d.width,.5*-d.height,1]),a.a6.mat4.translate(l,l,[1,-1,0]),a.a6.mat4.multiply(l,l,d.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(l)}function fm(d,n,l,f,_,v,x,C=!1){const D=d.tilesIn(f,x,C);D.sort(Uc);const L=[];for(const $ of D)L.push({wrappedTileID:$.tile.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(n,l,d._state,$,_,v,dm(d.transform,$.tile.tileID),C)});const B=function($){const j={},U={};for(const Z of $){const X=Z.queryResults,Y=Z.wrappedTileID,J=U[Y]=U[Y]||{};for(const ae in X){const ce=X[ae],oe=J[ae]=J[ae]||{},fe=j[ae]=j[ae]||[];for(const de of ce)oe[de.featureIndex]||(oe[de.featureIndex]=!0,fe.push(de))}}return j}(L);for(const $ in B)B[$].forEach(j=>{const U=j.feature,Z=U.layer;Z&&Z.type!=="background"&&Z.type!=="sky"&&Z.type!=="slot"&&(U.source=Z.source,Z["source-layer"]&&(U.sourceLayer=Z["source-layer"]),U.state=U.id!==void 0?d.getFeatureState(Z["source-layer"],U.id):{})});return B}function yh(d,n){const l=d.getRenderableIds().map(v=>d.getTileByID(v)),f=[],_={};for(let v=0;v<l.length;v++){const x=l[v],C=x.tileID.canonical.key;_[C]||(_[C]=!0,x.querySourceFeatures(f,n))}return f}function Uc(d,n){const l=d.tileID,f=n.tileID;return l.overscaledZ-f.overscaledZ||l.canonical.y-f.canonical.y||l.wrap-f.wrap||l.canonical.x-f.canonical.x}const fs=32,Ns=33,$s=new Uint16Array(8184);for(let d=0;d<2046;d++){let n=d+2,l=0,f=0,_=0,v=0,x=0,C=0;for(1&n?_=v=x=fs:l=f=C=fs;(n>>=1)>1;){const L=l+_>>1,B=f+v>>1;1&n?(_=l,v=f,l=x,f=C):(l=_,f=v,_=x,v=C),x=L,C=B}const D=4*d;$s[D+0]=l,$s[D+1]=f,$s[D+2]=_,$s[D+3]=v}const Lo=new Uint16Array(2178),fa=new Uint8Array(1089),vh=new Uint16Array(1089);function pm(d){return d===0?-.03125:d===32?.03125:0}const mm=(()=>({type:2,extent:a.ab,loadGeometry:()=>[[new a.P(0,0),new a.P(a.ab+1,0),new a.P(a.ab+1,a.ab+1),new a.P(0,a.ab+1),new a.P(0,0)]]}))();class pa{constructor(n,l,f,_,v){this.tileID=n,this.uid=a.aP(),this.uses=0,this.tileSize=l,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,_&&_.style&&(this._lastUpdatedBrightness=_.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(n){const l=n+this.timeAdded;l<a.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,l,f){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(_,v){const x={};if(!v)return x;for(const C of _){const D=C.layerIds.map(L=>v.getLayer(L)).filter(Boolean);if(D.length!==0){C.layers=D,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(L=>D.filter(B=>B.id===L)[0]));for(const L of D)x[L.fqid]=C}}return x}(n.buckets,l.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof a.aR){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof a.aR&&v.hasRTLText){this.hasRTLText=!0,a.aS();break}}this.queryPadding=0;for(const _ in this.buckets){const v=this.buckets[_],x=l.style.getOwnLayer(_);if(!x)continue;const C=x.queryRadius(v);this.queryPadding=Math.max(this.queryPadding,C)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new a.aQ}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.fqid]}upload(n){for(const _ in this.buckets){const v=this.buckets[_];v.uploadPending()&&v.upload(n)}const l=n.gl,f=this.imageAtlas;if(f&&!f.uploaded){const _=!!Object.keys(f.patternPositions).length;this.imageAtlasTexture=new a.T(n,f.image,l.RGBA8,{useMipmap:_}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(n,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(n,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(n,l,f){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,f),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const _=l.style.getBrightness();(this._lastUpdatedBrightness||_)&&(this._lastUpdatedBrightness&&_&&Math.abs(this._lastUpdatedBrightness-_)<.001||(this._lastUpdatedBrightness=_,this.updateBuckets(l)))}queryRenderedFeatures(n,l,f,_,v,x,C,D){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:_,pixelPosMatrix:C,transform:x,params:v,tileTransform:this.tileTransform},n,l,f):{}}querySourceFeatures(n,l){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const _=f.loadVTLayers(),v=l?l.sourceLayer:"",x=_._geojsonTileLayer||_[v];if(!x)return;const C=a.aT(l&&l.filter),{z:D,x:L,y:B}=this.tileID.canonical,$={z:D,x:L,y:B};for(let j=0;j<x.length;j++){const U=x.feature(j);if(C.needGeometry){const Y=a.aU(U,!0);if(!C.filter(new a.a3(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!C.filter(new a.a3(this.tileID.overscaledZ),U))continue;const Z=f.getId(U,v),X=new a.aV(U,D,L,B,Z);X.tile=$,n.push(X)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const f=a.aW(n.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const f=Date.now();let _=!1;if(this.expirationTime>f)_=!1;else if(l)if(this.expirationTime<l)_=!0;else{const v=this.expirationTime-l;v?this.expirationTime=f+Math.max(v,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,l){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(n).length!==0&&l&&this.updateBuckets(l)}updateBuckets(n){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),f=n.style.listImages(),_=n.style.getBrightness();for(const v in this.buckets){if(!n.style.hasLayer(v))continue;const x=this.buckets[v],C=x.layers[0].sourceLayer||"_geojsonTileLayer",D=l[C],L=n.style.getOwnSourceCache(x.layers[0].source);let B={};L&&(B=L._state.getState(C,void 0)),x.update(B,D,f,this.imageAtlas&&this.imageAtlas.patternPositions||{},_),(x instanceof a.aX||x instanceof a.aY)&&n._terrain&&n._terrain.enabled&&L&&x.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(L.id,this.tileID);const $=n&&n.style&&n.style.getOwnLayer(v);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=a.q.now()+n}setTexture(n,l){const f=l.context,_=f.gl;this.texture=this.texture||l.getTileTexture(n.width),this.texture&&this.texture instanceof a.T?this.texture.update(n):(this.texture=new a.T(f,n,_.RGBA8,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE))}setDependencies(n,l){const f={};for(const _ of l)f[_]=!0;this.dependencies[n]=f}hasDependency(n,l){for(const f of n){const _=this.dependencies[f];if(_){for(const v of l)if(_[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const f=a.aZ(mm,this.tileID.canonical,this.tileTransform)[0],_=new a.a_,v=new a.a$;for(let x=0;x<f.length;x++){const{x:C,y:D}=f[x];_.emplaceBack(C,D),v.emplaceBack(x)}v.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(v),this._tileDebugBuffer=n.createVertexBuffer(_,a.b0.members),this._tileDebugSegments=a.b1.simpleSegment(0,0,_.length,v.length)}_makeTileBoundsBuffers(n,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const f=a.aZ(mm,this.tileID.canonical,this.tileTransform)[0];let _,v;if(this.isRaster){const x=function(C,D){const L=a.aK(C,D),B=Math.pow(2,C.z);for(let Y=0;Y<Ns;Y++)for(let J=0;J<Ns;J++){const ae=a.aL((C.x+(J+pm(J))/fs)/B),ce=a.aM((C.y+(Y+pm(Y))/fs)/B),oe=D.project(ae,ce),fe=Y*Ns+J;Lo[2*fe+0]=Math.round((oe.x*L.scale-L.x)*a.ab),Lo[2*fe+1]=Math.round((oe.y*L.scale-L.y)*a.ab)}fa.fill(0),vh.fill(0);for(let Y=2045;Y>=0;Y--){const J=4*Y,ae=$s[J+0],ce=$s[J+1],oe=$s[J+2],fe=$s[J+3],de=ae+oe>>1,ye=ce+fe>>1,ge=de+ye-ce,ve=ye+ae-de,Ce=ce*Ns+ae,Oe=fe*Ns+oe,Te=ye*Ns+de,$e=Math.hypot((Lo[2*Ce+0]+Lo[2*Oe+0])/2-Lo[2*Te+0],(Lo[2*Ce+1]+Lo[2*Oe+1])/2-Lo[2*Te+1])>=16;fa[Te]=fa[Te]||($e?1:0),Y<1022&&(fa[Te]=fa[Te]||fa[(ce+ve>>1)*Ns+(ae+ge>>1)]||fa[(fe+ve>>1)*Ns+(oe+ge>>1)])}const $=new a.aN,j=new a.aO;let U=0;function Z(Y,J){const ae=J*Ns+Y;return vh[ae]===0&&($.emplaceBack(Lo[2*ae+0],Lo[2*ae+1],Y*a.ab/fs,J*a.ab/fs),vh[ae]=++U),vh[ae]-1}function X(Y,J,ae,ce,oe,fe){const de=Y+ae>>1,ye=J+ce>>1;if(Math.abs(Y-oe)+Math.abs(J-fe)>1&&fa[ye*Ns+de])X(oe,fe,Y,J,de,ye),X(ae,ce,oe,fe,de,ye);else{const ge=Z(Y,J),ve=Z(ae,ce),Ce=Z(oe,fe);j.emplaceBack(ge,ve,Ce)}}return X(0,0,fs,fs,fs,0),X(fs,fs,0,0,0,fs),{vertices:$,indices:j}}(this.tileID.canonical,l);_=x.vertices,v=x.indices}else{_=new a.aN,v=new a.aO;for(const{x:C,y:D}of f)_.emplaceBack(C,D,0,0);const x=a.b2(_.int16,void 0,4);for(let C=0;C<x.length;C+=3)v.emplaceBack(x[C],x[C+1],x[C+2])}this._tileBoundsBuffer=n.createVertexBuffer(_,a.b3.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(v),this._tileBoundsSegments=a.b1.simpleSegment(0,0,_.length,v.length)}_makeGlobeTileDebugBuffers(n,l){const f=l.projection;if(!f||f.name!=="globe"||l.freezeTileCoverage)return;const _=this.tileID.canonical,v=a.b4(_,l),x=a.b5(v),C=a.a9(l.zoom);let D;C>0&&(D=a.a6.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,_,l,x,D,C),this._makeGlobeTileDebugTextBuffer(n,_,l,x,D,C)}_globePoint(n,l,f,_,v,x,C){let D=a.b6(n,l,f);if(x){const L=1<<f.z,B=a.am(_.center.lng),$=a.at(_.center.lat),j=(f.x+.5)/L-B;let U=0;j>.5?U=-1:j<-.5&&(U=1);let Z=(n/a.ab+f.x)/L+U,X=(l/a.ab+f.y)/L;Z=(Z-B)*_._pixelsPerMercatorPixel+B,X=(X-$)*_._pixelsPerMercatorPixel+$;const Y=[Z*_.worldSize,X*_.worldSize,0];a.a6.vec3.transformMat4(Y,Y,x),D=a.b7(D,Y,C)}return a.a6.vec3.transformMat4(D,D,v)}_makeGlobeTileDebugBorderBuffer(n,l,f,_,v,x){const C=new a.a_,D=new a.a$,L=new a.b8,B=(j,U,Z,X,Y)=>{const J=(Z-j)/(Y-1),ae=(X-U)/(Y-1),ce=C.length;for(let oe=0;oe<Y;oe++){const fe=j+oe*J,de=U+oe*ae;C.emplaceBack(fe,de);const ye=this._globePoint(fe,de,l,f,_,v,x);L.emplaceBack(ye[0],ye[1],ye[2]),D.emplaceBack(ce+oe)}},$=a.ab;B(0,0,$,0,16),B($,0,$,$,16),B($,$,0,$,16),B(0,$,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(D),this._tileDebugBuffer=n.createVertexBuffer(C,a.b0.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(L,a.b9.members),this._tileDebugSegments=a.b1.simpleSegment(0,0,C.length,D.length)}_makeGlobeTileDebugTextBuffer(n,l,f,_,v,x){const C=a.ab/4,D=new a.a_,L=new a.aO,B=new a.b8,$=25;L.reserve(32),D.reserve($),B.reserve($);const j=(U,Z)=>$*U+Z;for(let U=0;U<$;U++){const Z=U*C;for(let X=0;X<$;X++){const Y=X*C;D.emplaceBack(Y,Z);const J=this._globePoint(Y,Z,l,f,_,v,x);B.emplaceBack(J[0],J[1],J[2])}}for(let U=0;U<4;U++)for(let Z=0;Z<4;Z++){const X=j(U,Z),Y=j(U,Z+1),J=j(U+1,Z),ae=j(U+1,Z+1);L.emplaceBack(X,Y,J),L.emplaceBack(J,Y,ae)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(L),this._tileDebugTextBuffer=n.createVertexBuffer(D,a.b0.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(B,a.b9.members),this._tileDebugTextSegments=a.b1.simpleSegment(0,0,$,32)}destroy(n=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.ba.setPbf(a.bb);class tf extends pa{constructor(n,l,f,_,v){super(n,l,f,_,v),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(n,l){const f=l.context,_=f.gl;this.texture=this.texture||l.getTileTexture(n.width),this.texture&&this.texture instanceof a.T?this.texture.update(n,{premultiply:!1}):this.texture=new a.T(f,n,_.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(n=16384,l){const f=this._mrt=new a.ba(30),_=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=a.bc(_,(v,x,C,D)=>{if(v)l(v);else try{const L=f.getHeaderLength(x);if(L>n)return void(this.request=this.fetchHeader(L,l));f.parseHeader(x),this._isHeaderLoaded=!0;let B=0;for(const $ of Object.values(f.layers))B=Math.max(B,$.dataIndex[$.dataIndex.length-1].last_byte);x.byteLength>=B&&(this.entireBuffer=x),l(null,this.entireBuffer||x,C,D)}catch(L){l(L)}}),this.request}fetchBand(n,l,f){const _=this._mrt;if(!this._isHeaderLoaded||!_)return void f(new Error("Tile header is not ready"));const v=this.actor;if(!v)return void f(new Error("Can't fetch tile band without an actor"));let x;const C=($,j)=>{x.complete($,j),$?f($):(this.updateTextureDescriptor(n,l),f(null,this.textureDescriptor&&this.textureDescriptor.img))},D=($,j)=>{if($)return f($);const U=v.send("decodeRasterArray",{buffer:j,task:x},C,void 0,!0);this._workQueue.push(()=>{U&&U.cancel(),x.cancel()})},L=_.getLayer(n);if(!L)return void f(new Error(`Unknown sourceLayer "${n}"`));if(L.hasDataForBand(l))return this.updateTextureDescriptor(n,l),void f(null,this.textureDescriptor?this.textureDescriptor.img:null);const B=L.getDataRange([l]);if(x=_.createDecodingTask(B),!x||x.tasks.length)if(this.flushQueues(),this.entireBuffer)D(null,this.entireBuffer.slice(B.firstByte,B.lastByte+1));else{const $=Object.assign({},this.requestParams,{headers:{Range:`bytes=${B.firstByte}-${B.lastByte}`}}),j=a.bc($,D);this._fetchQueue.push(()=>{j.cancel(),x.cancel()})}else f(null)}updateNeeded(n,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==n)&&this.state!=="errored"}updateTextureDescriptor(n,l){if(!this._mrt)return;const f=this._mrt.getLayer(n);if(!f||!f.hasBand(l)||!f.hasDataForBand(l))return;const{bytes:_,tileSize:v,buffer:x,offset:C,scale:D}=f.getBandView(l),L=v+2*x,B={data:_,width:L,height:L},$=this.texture;$&&$ instanceof a.T&&$.update(B,{premultiply:!1}),this.textureDescriptor={layer:n,band:l,img:B,buffer:x,offset:C,tileSize:v,format:f.pixelFormat,mix:[D,256*D,65536*D,16777216*D]}}}class zy{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,f){const _=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const v={value:l,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(n,v)},f)),this.data[_].push(v),this.order.push(_),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const f=n.wrapped().key,_=l===void 0?0:this.data[f].indexOf(l),v=this.data[f][_];return this.data[f].splice(_,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const f in this.data)for(const _ of this.data[f])n(_.value)||l.push(_);for(const f of l)this.remove(f.value.tileID,f)}}class F1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,f){const _=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][_]=this.stateChanges[n][_]||{},a.l(this.stateChanges[n][_],f),this.deletedStates[n]===null){this.deletedStates[n]={};for(const v in this.state[n])v!==_&&(this.deletedStates[n][v]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][_]===null){this.deletedStates[n][_]={};for(const v in this.state[n][_])f[v]||(this.deletedStates[n][_][v]=null)}else for(const v in f)this.deletedStates[n]&&this.deletedStates[n][_]&&this.deletedStates[n][_][v]===null&&delete this.deletedStates[n][_][v]}removeFeatureState(n,l,f){if(this.deletedStates[n]===null)return;const _=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},f&&l!==void 0)this.deletedStates[n][_]!==null&&(this.deletedStates[n][_]=this.deletedStates[n][_]||{},this.deletedStates[n][_][f]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][_])for(f in this.deletedStates[n][_]={},this.stateChanges[n][_])this.deletedStates[n][_][f]=null;else this.deletedStates[n][_]=null;else this.deletedStates[n]=null}getState(n,l){const f=this.state[n]||{},_=this.stateChanges[n]||{},v=this.deletedStates[n];if(v===null)return{};if(l!==void 0){const C=String(l),D=a.l({},f[C],_[C]);if(v){const L=v[l];if(L===null)return{};for(const B in L)delete D[B]}return D}const x=a.l({},f,_);if(v)for(const C in v)delete x[C];return x}initializeTileState(n,l){n.setFeatureState(this.state,l)}coalesceChanges(n,l){const f={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const v={};for(const x in this.stateChanges[_])this.state[_][x]||(this.state[_][x]={}),a.l(this.state[_][x],this.stateChanges[_][x]),v[x]=this.state[_][x];f[_]=v}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const v={};if(this.deletedStates[_]===null)for(const x in this.state[_])v[x]={},this.state[_][x]={};else for(const x in this.deletedStates[_]){if(this.deletedStates[_][x]===null)this.state[_][x]={};else if(this.state[_][x])for(const C of Object.keys(this.deletedStates[_][x]))delete this.state[_][x][C];v[x]=this.state[_][x]}f[_]=f[_]||{},a.l(f[_],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const _ in n)n[_].setFeatureState(f,l)}}class Bo extends a.E{constructor(n,l,f){super(),this.id=n,this._onlySymbols=f,l.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new zy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new F1,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const l=this._tiles[n];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,l){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,l)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const f=this._tiles[l];f.upload(n),f.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return a.bd(this._tiles).map(n=>n.tileID).sort(fl).map(n=>n.key)}getRenderableIds(n,l){const f=[];for(const _ in this._tiles)this._isIdRenderable(+_,n,l)&&f.push(this._tiles[_]);return n?f.sort((_,v)=>{const x=_.tileID,C=v.tileID,D=new a.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle),L=new a.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle);return x.overscaledZ-C.overscaledZ||L.y-D.y||L.x-D.x}).map(_=>_.tileID.key):f.map(_=>_.tileID).sort(fl).map(_=>_.key)}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l,f){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())&&(f||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,l){const f=this._tiles[n];f&&(f.state!=="loading"&&(f.state=l),this._loadTile(f,this._tileLoaded.bind(this,f,n,l)))}_tileLoaded(n,l,f,_){if(_)if(n.state="errored",_.status!==404)this._source.fire(new a.t(_,{tile:n}));else{if(this._source.fire(new a.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform)}else n.timeAdded=a.q.now(),f==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new a.x("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const l=this.getRenderableIds();for(let _=0;_<l.length;_++){const v=l[_];if(n.neighboringTiles&&n.neighboringTiles[v]){const x=this.getTileByID(v);f(n,x),f(x,n)}}function f(_,v){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let x=v.tileID.canonical.x-_.tileID.canonical.x;const C=v.tileID.canonical.y-_.tileID.canonical.y,D=Math.pow(2,_.tileID.canonical.z),L=v.tileID.key;x===0&&C===0||Math.abs(C)>1||(Math.abs(x)>1&&(Math.abs(x+D)===1?x+=D:Math.abs(x-D)===1&&(x-=D)),v.dem&&_.dem&&(_.dem.backfillBorder(v.dem,x,C),_.neighboringTiles&&_.neighboringTiles[L]&&(_.neighboringTiles[L].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,f,_){for(const v in this._tiles){let x=this._tiles[v];if(_[v]||!x.hasData()||x.tileID.overscaledZ<=l||x.tileID.overscaledZ>f)continue;let C=x.tileID;for(;x&&x.tileID.overscaledZ>l+1;){const L=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[L.key],x&&x.hasData()&&(C=L)}let D=C;for(;D.overscaledZ>l;)if(D=D.scaledTo(D.overscaledZ-1),n[D.key]){_[C.key]=C;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const f=this._loadedParentTiles[n.key];return f&&f.tileID.overscaledZ>=l?f:null}for(let f=n.overscaledZ-1;f>=l;f--){const _=n.scaledTo(f),v=this._getLoadedTile(_);if(v)return v}}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,l){l=l||this._source.tileSize;const f=Math.ceil(n.width/l)+1,_=Math.ceil(n.height/l)+1,v=Math.floor(f*_*5),x=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(C)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const f={};for(const _ in this._tiles){const v=this._tiles[_];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+l),f[v.tileID.key]=v}this._tiles=f;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(n,l,f,_){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;this.updateCacheSize(n,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const v=this._source.type==="batched-model";let x;if(this.used||this.usedForTerrain){if(this._source.tileID)x=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new a.aA(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y));else if(this.tileCoverLift!==0){const L=n.clone();L.tileCoverLift=this.tileCoverLift,x=L.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:v}),this._source.minzoom<=1&&n.projection.name==="globe"&&(x.push(new a.aA(1,0,1,0,0)),x.push(new a.aA(1,0,1,1,0)),x.push(new a.aA(1,0,1,0,1)),x.push(new a.aA(1,0,1,1,1)))}else if(x=n.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:v}),this._source.hasTile){const L=this._source.hasTile.bind(this._source);x=x.filter(B=>L(B))}}else x=[];if(x.length>0&&this.castsShadows&&_&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!bh(this._source.type)){const L=n.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!f}),B=Math.min(L,this._source.maxzoom);if(v){const $=n.extendTileCover(x,B);for(const j of $)x.push(j)}else{const $=n.extendTileCover(x,B,_);for(const j of $)this._shadowCasterTiles[j.key]=!0,x.push(j)}}const C=this._updateRetainedTiles(x);if(bh(this._source.type)&&x.length!==0){const L={},B={},$=Object.keys(C);for(const U of $){const Z=C[U],X=this._tiles[U];if(!X||X.fadeEndTime&&X.fadeEndTime<=a.q.now())continue;const Y=this.findLoadedParent(Z,Math.max(Z.overscaledZ-Bo.maxOverzooming,this._source.minzoom));Y&&(this._addTile(Y.tileID),L[Y.tileID.key]=Y.tileID),B[U]=Z}const j=x[x.length-1].overscaledZ;for(const U in this._tiles){const Z=this._tiles[U];if(C[U]||!Z.hasData())continue;let X=Z.tileID;for(;X.overscaledZ>j;){X=X.scaledTo(X.overscaledZ-1);const Y=this._tiles[X.key];if(Y&&Y.hasData()&&B[X.key]){C[U]=Z.tileID;break}}}for(const U in L)C[U]||(this._coveredTiles[U]=!0,C[U]=L[U])}for(const L in C)this._tiles[L].clearFadeHold();const D=a.be(this._tiles,C);for(const L of D){const B=this._tiles[L];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(+L)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const l={};if(n.length===0)return l;const f={},_=n.reduce((L,B)=>Math.min(L,B.overscaledZ),1/0),v=n[0].overscaledZ,x=Math.max(v-Bo.maxOverzooming,this._source.minzoom),C=Math.max(v+Bo.maxUnderzooming,this._source.minzoom),D={};for(const L of n){const B=this._addTile(L);l[L.key]=L,B.hasData()||_<this._source.maxzoom&&(D[L.key]=L)}this._retainLoadedChildren(D,_,C,l);for(const L of n){let B=this._tiles[L.key];if(B.hasData())continue;if(L.canonical.z>=this._source.maxzoom){const j=L.children(this._source.maxzoom)[0],U=this.getTile(j);if(U&&U.hasData()){l[j.key]=j;continue}}else{const j=L.children(this._source.maxzoom);if(l[j[0].key]&&l[j[1].key]&&l[j[2].key]&&l[j[3].key])continue}let $=B.wasRequested();for(let j=L.overscaledZ-1;j>=x;--j){const U=L.scaledTo(j);if(f[U.key]||(f[U.key]=!0,B=this.getTile(U),!B&&$&&(B=this._addTile(U)),B&&(l[U.key]=U,$=B.wasRequested(),B.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let f,_=this._tiles[n].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){f=this._loadedParentTiles[_.key];break}l.push(_.key);const v=_.scaledTo(_.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;_=v}for(const v of l)this._loadedParentTiles[v]=f}}_addTile(n){let l=this._tiles[n.key];if(l)return l.isExtraShadowCaster!==!0||!!this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const f=Boolean(l);if(!f){const _=this.map?this.map.painter:null,v=this._source.tileSize*n.overscaleFactor();l=this._source.type==="raster-array"?new tf(n,v,this.transform.tileZoom,_,this._isRaster):new pa(n,v,this.transform.tileZoom,_,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))}return l?(l.uses++,this._tiles[n.key]=l,f||this._source.fire(new a.x("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const f=l.getExpiryTimeout();f&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},f))}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,l,f){const _=[],v=this.transform;if(!v)return _;const x=v.projection.name==="globe",C=a.am(v.center.lng);for(const D in this._tiles){const L=this._tiles[D];if(f&&L.clearQueryDebugViz(),L.holdingForFade())continue;let B;if(x){const $=L.tileID.canonical;if($.z===0){const j=[Math.abs(a.ap(C,...Gc($,-1))-C),Math.abs(a.ap(C,...Gc($,1))-C)];B=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(a.ap(C,...Gc($,-1))-C),Math.abs(a.ap(C,...Gc($,0))-C),Math.abs(a.ap(C,...Gc($,1))-C)];B=[j.indexOf(Math.min(...j))-1]}}else B=[0];for(const $ of B){const j=n.containsTile(L,v,l,$);j&&_.push(j)}}return _}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,l){const f=this.getRenderableIds(n,l).map(v=>this._tiles[v].tileID),_=this.transform.projection.name==="globe";for(const v of f)v.projMatrix=this.transform.calculateProjMatrix(v.toUnwrapped()),v.expandedProjMatrix=_?this.transform.calculateProjMatrix(v.toUnwrapped(),!1,!0):v.projMatrix;return f}sortCoordinatesByDistance(n){const l=n.slice(),f=this.transform._camera.position,_=this.transform._camera.forward(),v={};for(const x of l){const C=1/(1<<x.canonical.z);v[x.key]=((x.canonical.x+.5)*C+x.wrap-f[0])*_[0]+((x.canonical.y+.5)*C-f[1])*_[1]-f[2]*_[2]}return l.sort((x,C)=>v[x.key]-v[C.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(bh(this._source.type))for(const n in this._tiles){const l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=a.q.now())return!0}return!1}setFeatureState(n,l,f){this._state.updateState(n=n||"_geojsonTileLayer",l,f)}removeFeatureState(n,l,f){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,f)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,f){const _=this._tiles[n];_&&_.setDependencies(l,f)}reloadTilesForDependencies(n,l){for(const f in this._tiles)this._tiles[f].hasDependency(n,l)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(n,l))}_preloadTiles(n,l){if(!this._sourceLoaded){const D=()=>{this._sourceLoaded&&(this._source.off("data",D),this._preloadTiles(n,l))};return void this._source.on("data",D)}const f=new Map,_=Array.isArray(n)?n:[n],v=this.map.painter.terrain,x=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const D of _){const L=D.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const B of L)f.set(B.key,B);this.usedForTerrain&&D.updateElevation(!1)}const C=Array.from(f.values());a.bf(C,(D,L)=>{const B=new pa(D,this._source.tileSize*D.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(B,$=>{this._source.type==="raster-dem"&&B.dem&&this._backfillDEM(B),L($,B)})},l)}}function fl(d,n){const l=Math.abs(2*d.wrap)-+(d.wrap<0),f=Math.abs(2*n.wrap)-+(n.wrap<0);return d.overscaledZ-n.overscaledZ||f-l||n.canonical.y-d.canonical.y||n.canonical.x-d.canonical.x}function bh(d){return d==="raster"||d==="image"||d==="video"||d==="custom"}function Gc(d,n){const l=1<<d.z;return[d.x/l+n,(d.x+1)/l+n]}Bo.maxOverzooming=10,Bo.maxUnderzooming=3;class gm{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,l=!1;for(const f in this.style._mergedLayers){const _=this.style._mergedLayers[f];if(_.type==="fill-extrusion")this.layers.push({layer:_,visible:n,visibilityChanged:l});else if(_.type==="model"){const v=this.style.getLayerSource(_);v&&v.type==="batched-model"&&this.layers.push({layer:_,visible:n,visibilityChanged:l})}}}onNewFrame(n){this.layersGotHidden=!1;for(const l of this.layers){const f=l.layer;let _=!1;f.type==="fill-extrusion"?_=!f.isHidden(n)&&f.paint.get("fill-extrusion-opacity")>0:f.type==="model"&&(_=!f.isHidden(n)&&f.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!_&&l.visible,l.visible=_}}updateZOffset(n,l){this.currentBuildingBuckets=[];for(const _ of this.layers){const v=_.layer,x=this.style.getLayerSourceCache(v);let C=1;v.type==="fill-extrusion"&&(C=_.visible?v.paint.get("fill-extrusion-vertical-scale"):0);let D=x?x.getTile(l):null;if(!D&&x&&l.canonical.z>x.getSource().minzoom){let L=l.scaledTo(Math.min(x.getSource().maxzoom,l.overscaledZ-1));for(;L.overscaledZ>=x.getSource().minzoom&&(D=x.getTile(L),!D&&L.overscaledZ!==0);)L=L.scaledTo(L.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:D?D.getBucket(v):null,tileID:D?D.tileID:l,verticalScale:C})}n.hasAnyZOffset=!1;let f=!1;for(let _=0;_<n.symbolInstances.length;_++){const v=n.symbolInstances.get(_),x=v.zOffset,C=this._getHeightAtTileOffset(l,v.tileAnchorX,v.tileAnchorY);v.zOffset=C!==Number.NEGATIVE_INFINITY?C:x,f||x===v.zOffset||(f=!0),n.hasAnyZOffset||v.zOffset===0||(n.hasAnyZOffset=!0)}f&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,l,f,_){let v=l,x=f;if(n.canonical.z!==_.canonical.z){const C=_.canonical,D=1/(1<<n.canonical.z-C.z);v=(l+n.canonical.x*a.ab)*D-C.x*a.ab|0,x=(f+n.canonical.y*a.ab)*D-C.y*a.ab|0}return{tileX:v,tileY:x}}_getHeightAtTileOffset(n,l,f){let _,v;for(let x=0;x<this.layers.length;++x){if(this.layers[x].layer.type!=="fill-extrusion")continue;const{bucket:C,tileID:D,verticalScale:L}=this.currentBuildingBuckets[x];if(!C)continue;const{tileX:B,tileY:$}=this._mapCoordToOverlappingTile(n,l,f,D),j=C.getHeightAtTileCoord(B,$);j&&j.height!==void 0&&(j.hidden?_=j.height:v=Math.max(j.height*L,v||0))}if(v!==void 0)return v;for(let x=0;x<this.layers.length;++x){const C=this.layers[x];if(C.layer.type!=="model"||!C.visible)continue;const{bucket:D,tileID:L}=this.currentBuildingBuckets[x];if(!D)continue;const{tileX:B,tileY:$}=this._mapCoordToOverlappingTile(n,l,f,L),j=D.getHeightAtTileCoord(B,$);if(j&&!j.hidden)return j.height===void 0&&_!==void 0?Math.min(j.maxHeight,_)*j.verticalScale:j.height?j.height*j.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Hc(d,n){const l={};for(const f in d)f!=="ref"&&(l[f]=d[f]);return a.bg.forEach(f=>{f in n&&(l[f]=n[f])}),l}function _m(d){d=d.slice();const n=Object.create(null);for(let l=0;l<d.length;l++)n[d[l].id]=d[l];for(let l=0;l<d.length;l++)"ref"in d[l]&&(d[l]=Hc(d[l],n[d[l].ref]));return d}const Qr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function ym(d,n,l){l.push({command:Qr.addSource,args:[d,n[d]]})}function li(d,n,l){n.push({command:Qr.removeSource,args:[d]}),l[d]=!0}function N1(d,n,l,f){li(d,l,f),ym(d,n,l)}function nr(d,n,l){let f;for(f in d[l])if(d[l].hasOwnProperty(f)&&f!=="data"&&!a.bh(d[l][f],n[l][f]))return!1;for(f in n[l])if(n[l].hasOwnProperty(f)&&f!=="data"&&!a.bh(d[l][f],n[l][f]))return!1;return!0}function xh(d,n,l,f,_,v){let x;for(x in n=n||{},d=d||{})d.hasOwnProperty(x)&&(a.bh(d[x],n[x])||l.push({command:v,args:[f,x,n[x],_]}));for(x in n)n.hasOwnProperty(x)&&!d.hasOwnProperty(x)&&(a.bh(d[x],n[x])||l.push({command:v,args:[f,x,n[x],_]}))}function Jl(d){return d.id}function qc(d,n){return d[n.id]=n,d}class ma{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.ap(n,0,1);let l=1,f=this._distances[l];const _=n*this.paddedLength+this.padding;for(;f<_&&l<this._distances.length;)f=this._distances[++l];const v=l-1,x=this._distances[v],C=f-x,D=C>0?(_-x)/C:0;return this.points[v].mult(1-D).add(this.points[l].mult(D))}}class rf{constructor(n,l,f){const _=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/f),this.yCellCount=Math.ceil(l/f);for(let x=0;x<this.xCellCount*this.yCellCount;x++)_.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,f,_,v){this._forEachCell(l,f,_,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(v)}insertCircle(n,l,f,_){this._forEachCell(l-_,f-_,l+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(f),this.circles.push(_)}_insertBoxCell(n,l,f,_,v,x){this.boxCells[v].push(x)}_insertCircleCell(n,l,f,_,v,x){this.circleCells[v].push(x)}_query(n,l,f,_,v,x){if(f<0||n>this.width||_<0||l>this.height)return!v&&[];const C=[];if(n<=0&&l<=0&&this.width<=f&&this.height<=_){if(v)return!0;for(let D=0;D<this.boxKeys.length;D++)C.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const L=this.circles[3*D],B=this.circles[3*D+1],$=this.circles[3*D+2];C.push({key:this.circleKeys[D],x1:L-$,y1:B-$,x2:L+$,y2:B+$})}return x?C.filter(x):C}return this._forEachCell(n,l,f,_,this._queryCell,C,{hitTest:v,seenUids:{box:{},circle:{}}},x),v?C.length>0:C}_queryCircle(n,l,f,_,v){const x=n-f,C=n+f,D=l-f,L=l+f;if(C<0||x>this.width||L<0||D>this.height)return!_&&[];const B=[];return this._forEachCell(x,D,C,L,this._queryCellCircle,B,{hitTest:_,circle:{x:n,y:l,radius:f},seenUids:{box:{},circle:{}}},v),_?B.length>0:B}query(n,l,f,_,v){return this._query(n,l,f,_,!1,v)}hitTest(n,l,f,_,v){return this._query(n,l,f,_,!0,v)}hitTestCircle(n,l,f,_){return this._queryCircle(n,l,f,!0,_)}_queryCell(n,l,f,_,v,x,C,D){const L=C.seenUids,B=this.boxCells[v];if(B!==null){const j=this.bboxes;for(const U of B)if(!L.box[U]){L.box[U]=!0;const Z=4*U;if(n<=j[Z+2]&&l<=j[Z+3]&&f>=j[Z+0]&&_>=j[Z+1]&&(!D||D(this.boxKeys[U]))){if(C.hitTest)return x.push(!0),!0;x.push({key:this.boxKeys[U],x1:j[Z],y1:j[Z+1],x2:j[Z+2],y2:j[Z+3]})}}}const $=this.circleCells[v];if($!==null){const j=this.circles;for(const U of $)if(!L.circle[U]){L.circle[U]=!0;const Z=3*U;if(this._circleAndRectCollide(j[Z],j[Z+1],j[Z+2],n,l,f,_)&&(!D||D(this.circleKeys[U]))){if(C.hitTest)return x.push(!0),!0;{const X=j[Z],Y=j[Z+1],J=j[Z+2];x.push({key:this.circleKeys[U],x1:X-J,y1:Y-J,x2:X+J,y2:Y+J})}}}}}_queryCellCircle(n,l,f,_,v,x,C,D){const L=C.circle,B=C.seenUids,$=this.boxCells[v];if($!==null){const U=this.bboxes;for(const Z of $)if(!B.box[Z]){B.box[Z]=!0;const X=4*Z;if(this._circleAndRectCollide(L.x,L.y,L.radius,U[X+0],U[X+1],U[X+2],U[X+3])&&(!D||D(this.boxKeys[Z])))return x.push(!0),!0}}const j=this.circleCells[v];if(j!==null){const U=this.circles;for(const Z of j)if(!B.circle[Z]){B.circle[Z]=!0;const X=3*Z;if(this._circlesCollide(U[X],U[X+1],U[X+2],L.x,L.y,L.radius)&&(!D||D(this.circleKeys[Z])))return x.push(!0),!0}}}_forEachCell(n,l,f,_,v,x,C,D){const L=this._convertToXCellCoord(n),B=this._convertToYCellCoord(l),$=this._convertToXCellCoord(f),j=this._convertToYCellCoord(_);for(let U=L;U<=$;U++)for(let Z=B;Z<=j;Z++)if(v.call(this,n,l,f,_,this.xCellCount*Z+U,x,C,D))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,f,_,v,x){const C=_-n,D=v-l,L=f+x;return L*L>C*C+D*D}_circleAndRectCollide(n,l,f,_,v,x,C){const D=(x-_)/2,L=Math.abs(n-(_+D));if(L>D+f)return!1;const B=(C-v)/2,$=Math.abs(l-(v+B));if($>B+f)return!1;if(L<=D||$<=B)return!0;const j=L-D,U=$-B;return j*j+U*U<=f*f}}const js={unknown:0,flipRequired:1,flipNotRequired:2},Ut=Math.tan(85*Math.PI/180);function qr(d,n,l,f,_,v,x){const C=a.a6.mat4.create();if(l)if(v.name==="globe"){const D=a.bi(_,n);a.a6.mat4.multiply(C,C,D)}else{const D=a.a6.mat2.invert([],x);C[0]=D[0],C[1]=D[1],C[4]=D[2],C[5]=D[3],f||a.a6.mat4.rotateZ(C,C,_.angle)}else a.a6.mat4.multiply(C,_.labelPlaneMatrix,d);return C}function Wr(d,n,l,f,_,v,x){const C=qr(d,n,l,f,_,v,x);return v.name==="globe"&&l||(C[2]=C[6]=C[10]=C[14]=0),C}function ko(d,n,l,f,_,v,x){if(l){if(v.name==="globe"){const C=qr(d,n,l,f,_,v,x);return a.a6.mat4.invert(C,C),a.a6.mat4.multiply(C,d,C),C}{const C=a.a6.mat4.clone(d),D=a.a6.mat4.identity([]);return D[0]=x[0],D[1]=x[1],D[4]=x[2],D[5]=x[3],a.a6.mat4.multiply(C,C,D),f||a.a6.mat4.rotateZ(C,C,-_.angle),C}}return _.glCoordMatrix}function co(d,n,l,f){const _=[d,n,l,1];l?a.a6.vec4.transformMat4(_,_,f):of(_,_,f);const v=_[3];return _[0]/=v,_[1]/=v,_[2]/=v,_}function Yr(d,n){return Math.min(.5+d/n*.5,1.5)}function nf(d,n){const l=d[0]/d[3],f=d[1]/d[3];return l>=-n[0]&&l<=n[0]&&f>=-n[1]&&f<=n[1]}function Wc(d,n,l,f,_,v,x,C,D,L){const B=l.transform,$=f?d.textSizeData:d.iconSizeData,j=a.bj($,l.transform.zoom),U=B.projection.name==="globe",Z=[256/l.width*2+1,256/l.height*2+1],X=f?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;X.clear();let Y=null;U&&(Y=f?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const J=d.lineVertexArray,ae=f?d.text.placedSymbolArray:d.icon.placedSymbolArray,ce=l.transform.width/l.transform.height;let oe,fe=!1;for(let de=0;de<ae.length;de++){const ye=ae.get(de),{numGlyphs:ge,writingMode:ve}=ye;if(ve!==a.bk.vertical||fe||oe===a.bk.horizontal||(fe=!0),oe=ve,(ye.hidden||ve===a.bk.vertical)&&!fe){ga(ge,X);continue}fe=!1;const Ce=new a.P(ye.tileAnchorX,ye.tileAnchorY);let{x:Oe,y:Te,z:$e}=B.projection.projectTilePoint(Ce.x,Ce.y,L.canonical);if(D){const[lt,pt,Kt]=D(Ce);Oe+=lt,Te+=pt,$e+=Kt}const Je=[Oe,Te,$e,1];if(a.a6.vec4.transformMat4(Je,Je,n),!nf(Je,Z)){ga(ge,X);continue}const ct=Je[3],Ke=Yr(l.transform.getCameraToCenterDistance(B.projection),ct),_t=a.bl($,j,ye),je=x?_t/Ke:_t*Ke,nt=co(Oe,Te,$e,_);if(nt[3]<=0){ga(ge,X);continue}let rt={};const vt=x?null:D,xt=cn(ye,je,!1,C,n,_,v,d.glyphOffsetArray,J,X,Y,nt,Ce,rt,ce,vt,B.projection,L,x);fe=xt.useVertical,vt&&xt.needsFlipping&&(rt={}),(xt.notEnoughRoom||fe||xt.needsFlipping&&cn(ye,je,!0,C,n,_,v,d.glyphOffsetArray,J,X,Y,nt,Ce,rt,ce,vt,B.projection,L,x).notEnoughRoom)&&ga(ge,X)}f?(d.text.dynamicLayoutVertexBuffer.updateData(X),Y&&d.text.globeExtVertexBuffer&&d.text.globeExtVertexBuffer.updateData(Y)):(d.icon.dynamicLayoutVertexBuffer.updateData(X),Y&&d.icon.globeExtVertexBuffer&&d.icon.globeExtVertexBuffer.updateData(Y))}function Zc(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X){const{lineStartIndex:Y,glyphStartIndex:J,segment:ae}=C,ce=J+C.numGlyphs,oe=Y+C.lineLength,fe=n.getoffsetX(J),de=n.getoffsetX(ce-1),ye=Kc(d*fe,l,f,_,v,x,ae,Y,oe,D,L,B,$,j,!0,U,Z,X);if(!ye)return null;const ge=Kc(d*de,l,f,_,v,x,ae,Y,oe,D,L,B,$,j,!0,U,Z,X);return ge?{first:ye,last:ge}:null}function wo(d,n,l,f){return d===a.bk.horizontal&&Math.abs(f)>Math.abs(l)?{useVertical:!0}:d===a.bk.vertical?f>0?{needsFlipping:!0}:null:n!==js.unknown&&function(_,v){return _===0||Math.abs(v/_)>Ut}(l,f)?n===js.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function cn(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y,J,ae){const ce=n/24,oe=d.lineOffsetX*ce,fe=d.lineOffsetY*ce,{lineStartIndex:de,glyphStartIndex:ye,numGlyphs:ge,segment:ve,writingMode:Ce,flipState:Oe}=d,Te=de+d.lineLength,$e=Je=>{if(B){const[je,nt,rt]=Je.up,vt=L.length;a.bm(B,vt+0,je,nt,rt),a.bm(B,vt+1,je,nt,rt),a.bm(B,vt+2,je,nt,rt),a.bm(B,vt+3,je,nt,rt)}const[ct,Ke,_t]=Je.point;a.bn(L,ct,Ke,_t,Je.angle)};if(ge>1){const Je=Zc(ce,C,oe,fe,l,$,j,d,D,v,U,X,!1,Y,J,ae);if(!Je)return{notEnoughRoom:!0};if(f&&!l){let[ct,Ke,_t]=Je.first.point,[je,nt,rt]=Je.last.point;[ct,Ke]=co(ct,Ke,_t,x),[je,nt]=co(je,nt,rt,x);const vt=wo(Ce,Oe,(je-ct)*Z,nt-Ke);if(d.flipState=vt&&vt.needsFlipping?js.flipRequired:js.flipNotRequired,vt)return vt}$e(Je.first);for(let ct=ye+1;ct<ye+ge-1;ct++){const Ke=Kc(ce*C.getoffsetX(ct),oe,fe,l,$,j,ve,de,Te,D,v,U,X,!1,!1,Y,J,ae);if(!Ke)return L.length-=4*(ct-ye),{notEnoughRoom:!0};$e(Ke)}$e(Je.last)}else{if(f&&!l){const ct=co(j.x,j.y,0,_),Ke=de+ve+1,_t=new a.P(D.getx(Ke),D.gety(Ke)),je=co(_t.x,_t.y,0,_),nt=je[3]>0?je:Xc(j,_t,ct,1,_,void 0,Y,J.canonical),rt=wo(Ce,Oe,(nt[0]-ct[0])*Z,nt[1]-ct[1]);if(d.flipState=rt&&rt.needsFlipping?js.flipRequired:js.flipNotRequired,rt)return rt}const Je=Kc(ce*C.getoffsetX(ye),oe,fe,l,$,j,ve,de,Te,D,v,U,X,!1,!1,Y,J,ae);if(!Je)return{notEnoughRoom:!0};$e(Je)}return{}}function Fy(d,n,l,f,_){const{x:v,y:x,z:C}=f.projectTilePoint(d.x,d.y,n);if(!_)return co(v,x,C,l);const[D,L,B]=_(d);return co(v+D,x+L,C+B,l)}function Xc(d,n,l,f,_,v,x,C){const D=Fy(d.sub(n)._unit()._add(d),C,_,x,v);return a.a6.vec3.sub(D,l,D),a.a6.vec3.normalize(D,D),a.a6.vec3.scaleAndAdd(D,l,D,f)}function Kc(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y,J){const ae=f?d-n:d+n;let ce=ae>0?1:-1,oe=0;f&&(ce*=-1,oe=Math.PI),ce<0&&(oe+=Math.PI);let fe=C+x+(ce>0?0:1)|0,de=_,ye=_,ge=0,ve=0;const Ce=Math.abs(ae),Oe=[],Te=[];let $e=v,Je=$e;const ct=()=>Xc(Je,$e,ye,Ce-ge+1,B,j,X,Y.canonical);for(;ge+ve<=Ce;){if(fe+=ce,fe<C||fe>=D)return null;if(ye=de,Je=$e,Oe.push(ye),U&&Te.push(Je),$e=new a.P(L.getx(fe),L.gety(fe)),de=$[fe],!de){const pt=Fy($e,Y.canonical,B,X,j);de=pt[3]>0?$[fe]=pt:ct()}ge+=ve,ve=a.a6.vec3.distance(ye,de)}Z&&j&&($[fe]&&(de=ct(),ve=a.a6.vec3.distance(ye,de)),$[fe]=de);const Ke=(Ce-ge)/ve,_t=$e.sub(Je)._mult(Ke)._add(Je),je=a.a6.vec3.sub([],de,ye),nt=a.a6.vec3.scaleAndAdd([],ye,je,Ke);let rt=[0,0,1],vt=je[0],xt=je[1];if(J&&(rt=X.upVector(Y.canonical,_t.x,_t.y),rt[0]!==0||rt[1]!==0||rt[2]!==1)){const pt=[rt[2],0,-rt[0]],Kt=a.a6.vec3.cross([],rt,pt);a.a6.vec3.normalize(pt,pt),a.a6.vec3.normalize(Kt,Kt),vt=a.a6.vec3.dot(je,pt),xt=a.a6.vec3.dot(je,Kt)}if(l){const pt=a.a6.vec3.cross([],rt,je);a.a6.vec3.normalize(pt,pt),a.a6.vec3.scaleAndAdd(nt,nt,pt,l*ce)}const lt=oe+Math.atan2(xt,vt);return Oe.push(nt),U&&Te.push(_t),{point:nt,angle:lt,path:Oe,tilePath:Te,up:rt}}function ga(d,n){const l=n.length,f=l+4*d;n.resize(f),n.float32.fill(-1/0,4*l,4*f)}function of(d,n,l){const f=n[0],_=n[1];return d[0]=l[0]*f+l[4]*_+l[12],d[1]=l[1]*f+l[5]*_+l[13],d[3]=l[3]*f+l[7]*_+l[15],d}const Zo=100;class uo{constructor(n,l,f=new rf(n.width+200,n.height+200,25),_=new rf(n.width+200,n.height+200,25)){this.transform=n,this.grid=f,this.ignoredGrid=_,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Zo,this.screenBottomBoundary=n.height+Zo,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=l}placeCollisionBox(n,l,f,_,v,x,C,D){let L=f.projectedAnchorX,B=f.projectedAnchorY,$=f.projectedAnchorZ;const j=f.elevation,U=f.tileID,Z=n.getProjection();if(j&&U){const[de,ye,ge]=Z.upVector(U.canonical,f.tileAnchorX,f.tileAnchorY),ve=Z.upVectorScale(U.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;L+=de*j*ve,B+=ye*j*ve,$+=ge*j*ve}const X=this.projectAndGetPerspectiveRatio(C,L,B,$,f.tileID,Z.name==="globe"||!!j||this.transform.pitch>0,Z),Y=x*X.perspectiveRatio,J=(f.x1*l+_.x-f.padding)*Y+X.point.x,ae=(f.y1*l+_.y-f.padding)*Y+X.point.y,ce=(f.x2*l+_.x+f.padding)*Y+X.point.x,oe=(f.y2*l+_.y+f.padding)*Y+X.point.y,fe=X.perspectiveRatio<=.55||X.occluded;return!this.isInsideGrid(J,ae,ce,oe)||!v&&this.grid.hitTest(J,ae,ce,oe,D)||fe?{box:[],offscreen:!1,occluded:X.occluded}:{box:[J,ae,ce,oe],offscreen:this.isOffscreen(J,ae,ce,oe),occluded:!1}}placeCollisionCircles(n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X){const Y=[],J=this.transform.elevation,ae=n.getProjection(),ce=J?J.getAtTileOffsetFunc(X,this.transform.center.lat,this.transform.worldSize,ae):null,oe=new a.P(f.tileAnchorX,f.tileAnchorY);let{x:fe,y:de,z:ye}=ae.projectTilePoint(oe.x,oe.y,X.canonical);if(ce){const[_t,je,nt]=ce(oe);fe+=_t,de+=je,ye+=nt}const ge=ae.name==="globe",ve=this.projectAndGetPerspectiveRatio(C,fe,de,ye,X,ge||!!J||this.transform.pitch>0,ae),{perspectiveRatio:Ce}=ve,Oe=($?x/Ce:x*Ce)/a.bq,Te=co(fe,de,ye,D),$e=ve.signedDistanceFromCamera>0?Zc(Oe,v,f.lineOffsetX*Oe,f.lineOffsetY*Oe,!1,Te,oe,f,_,D,{},J&&!$?ce:null,$&&!!J,ae,X,$):null;let Je=!1,ct=!1,Ke=!0;if($e&&!ve.occluded){const _t=.5*U*Ce+Z,je=new a.P(-100,-100),nt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),rt=new ma,{first:vt,last:xt}=$e,lt=vt.path.length;let pt=[];for(let Ft=lt-1;Ft>=1;Ft--)pt.push(vt.path[Ft]);for(let Ft=1;Ft<xt.path.length;Ft++)pt.push(xt.path[Ft]);const Kt=2.5*_t;L&&(pt=pt.map(([Ft,sr,Ht],tr)=>(ce&&!ge&&(Ht=ce(tr<lt-1?vt.tilePath[lt-1-tr]:xt.tilePath[tr-lt+2])[2]),co(Ft,sr,Ht,L))),pt.some(Ft=>Ft[3]<=0)&&(pt=[]));let Ot=[];if(pt.length>0){let Ft=1/0,sr=-1/0,Ht=1/0,tr=-1/0;for(const Ir of pt)Ft=Math.min(Ft,Ir[0]),Ht=Math.min(Ht,Ir[1]),sr=Math.max(sr,Ir[0]),tr=Math.max(tr,Ir[1]);sr>=je.x&&Ft<=nt.x&&tr>=je.y&&Ht<=nt.y&&(Ot=[pt.map(Ir=>new a.P(Ir[0],Ir[1]))],(Ft<je.x||sr>nt.x||Ht<je.y||tr>nt.y)&&(Ot=a.bo(Ot,je.x,je.y,nt.x,nt.y)))}for(const Ft of Ot){rt.reset(Ft,.25*_t);let sr=0;sr=rt.length<=.5*_t?1:Math.ceil(rt.paddedLength/Kt)+1;for(let Ht=0;Ht<sr;Ht++){const tr=Ht/Math.max(sr-1,1),Ir=rt.lerp(tr),Pr=Ir.x+Zo,fi=Ir.y+Zo;Y.push(Pr,fi,_t,0);const wi=Pr-_t,zi=fi-_t,ps=Pr+_t,gn=fi+_t;if(Ke=Ke&&this.isOffscreen(wi,zi,ps,gn),ct=ct||this.isInsideGrid(wi,zi,ps,gn),!l&&this.grid.hitTestCircle(Pr,fi,_t,j)&&(Je=!0,!B))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!B&&Je||!ct?[]:Y,offscreen:Ke,collisionDetected:Je,occluded:ve.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let f=1/0,_=1/0,v=-1/0,x=-1/0;for(const B of n){const $=new a.P(B.x+Zo,B.y+Zo);f=Math.min(f,$.x),_=Math.min(_,$.y),v=Math.max(v,$.x),x=Math.max(x,$.y),l.push($)}const C=this.grid.query(f,_,v,x).concat(this.ignoredGrid.query(f,_,v,x)),D={},L={};for(const B of C){const $=B.key;if(D[$.bucketInstanceId]===void 0&&(D[$.bucketInstanceId]={}),D[$.bucketInstanceId][$.featureIndex])continue;const j=[new a.P(B.x1,B.y1),new a.P(B.x2,B.y1),new a.P(B.x2,B.y2),new a.P(B.x1,B.y2)];a.bp(l,j)&&(D[$.bucketInstanceId][$.featureIndex]=!0,L[$.bucketInstanceId]===void 0&&(L[$.bucketInstanceId]=[]),L[$.bucketInstanceId].push($.featureIndex))}return L}insertCollisionBox(n,l,f,_,v){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:v},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,f,_,v){const x=l?this.ignoredGrid:this.grid,C={bucketInstanceId:f,featureIndex:_,collisionGroupID:v};for(let D=0;D<n.length;D+=4)x.insertCircle(C,n[D],n[D+1],n[D+2])}projectAndGetPerspectiveRatio(n,l,f,_,v,x,C){const D=[l,f,_,1];let L=!1;_||this.transform.pitch>0?(a.a6.vec4.transformMat4(D,D,n),this.fogState&&v&&C.name!=="globe"&&(L=function(j,U,Z,X,Y,J){const ae=J.calculateFogTileMatrix(Y),ce=[U,Z,X];return a.a6.vec3.transformMat4(ce,ce,ae),zt(j,a.a6.vec3.length(ce),J.pitch,J._fov)}(this.fogState,l,f,_,v.toUnwrapped(),this.transform)>.9)):of(D,D,n);const B=D[3];return{point:new a.P((D[0]/B+1)/2*this.transform.width+Zo,(-D[1]/B+1)/2*this.transform.height+Zo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(C)/B*.5,1.5),signedDistanceFromCamera:B,occluded:x&&D[2]>B||L}}isOffscreen(n,l,f,_){return f<Zo||n>=this.screenRightBoundary||_<Zo||l>this.screenBottomBoundary}isInsideGrid(n,l,f,_){return f>=0&&n<this.gridRightBoundary&&_>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=a.a6.mat4.identity([]);return a.a6.mat4.translate(n,n,[-100,-100,0]),n}}function To(d,n,l){const f=n.createTileMatrix(d,d.worldSize,l.toUnwrapped());return a.a6.mat4.multiply(new Float32Array(16),d.projMatrix,f)}function Ny(d,n,l){if(n.projection.name===l.projection.name)return d.projMatrix;const f=l.clone();return f.setProjection(n.projection),To(f,n.getProjection(),d)}function pl(d,n,l){return n.name===l.projection.name?d.projMatrix:To(l,n,d)}class bn{constructor(n,l,f,_){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):_&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Eo{constructor(n,l,f,_,v,x=!1){this.text=new bn(n?n.text:null,l,f,v),this.icon=new bn(n?n.icon:null,l,_,v),this.clipped=x}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Vs{constructor(n,l,f,_=!1){this.text=n,this.icon=l,this.skipFade=f,this.clipped=_}}class $n{constructor(){this.invProjMatrix=a.a6.mat4.create(),this.viewportMatrix=a.a6.mat4.create(),this.circles=[]}}class vm{constructor(n,l,f,_,v){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=v}}class Us{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:f=>f.collisionGroupID===l}}return this.collisionGroups[n]}}function Yc(d,n,l,f,_){const{horizontalAlign:v,verticalAlign:x}=a.bx(d),C=-(v-.5)*n,D=-(x-.5)*l,L=a.bw(d,f);return new a.P(C+L[0]*_,D+L[1]*_)}function Ql(d,n,l,f,_){const v=new a.P(d,n);return l&&v._rotate(f?_:-_),v}class ec{constructor(n,l,f,_,v,x){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new uo(this.transform,v),this.buildingIndex=x,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Us(f),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,l,f,_){const v=f.getBucket(l),x=f.latestFeatureIndex;if(!v||!x||l.fqid!==v.layerIds[0])return;const C=v.layers[0].layout,D=v.layers[0].paint,L=f.collisionBoxArray,B=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),$=f.tileSize/a.ab,j=f.tileID.toUnwrapped();this.transform.setProjection(v.projection);const U=(Z=f.tileID,X=v.getProjection(),Y=this.transform,X.name===this.projection?Y.calculateProjMatrix(Z.toUnwrapped()):To(Y,X,Z));var Z,X,Y;const J=C.get("text-pitch-alignment")==="map",ae=C.get("text-rotation-alignment")==="map";l.compileFilter();const ce=l.dynamicFilter(),oe=l.dynamicFilterNeedsFeature(),fe=this.transform.calculatePixelsToTileUnitsMatrix(f),de=Wr(U,f.tileID.canonical,J,ae,this.transform,v.getProjection(),fe);let ye=null;if(J){const Ce=ko(U,f.tileID.canonical,J,ae,this.transform,v.getProjection(),fe);ye=a.a6.mat4.multiply([],this.transform.labelPlaneMatrix,Ce)}let ge=null;ce&&f.latestFeatureIndex&&(ge={unwrappedTileID:j,dynamicFilter:ce,dynamicFilterNeedsFeature:oe}),this.retainedQueryData[v.bucketInstanceId]=new vm(v.bucketInstanceId,x,v.sourceLayerIndex,v.index,f.tileID);const ve={bucket:v,layout:C,paint:D,posMatrix:U,textLabelPlaneMatrix:de,labelToScreenMatrix:ye,clippingData:ge,scale:B,textPixelRatio:$,holdingForFade:f.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:a.bj(v.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.bj(v.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID),latestFeatureIndex:f.latestFeatureIndex};if(_)for(const Ce of v.sortKeyRanges){const{sortKey:Oe,symbolInstanceStart:Te,symbolInstanceEnd:$e}=Ce;n.push({sortKey:Oe,symbolInstanceStart:Te,symbolInstanceEnd:$e,parameters:ve})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y,J,ae){const{textOffset0:ce,textOffset1:oe,crossTileID:fe}=j,de=[ce,oe],ye=Yc(n,f,_,de,v),ge=this.collisionIndex.placeCollisionBox(Z,v,l,Ql(ye.x,ye.y,x,C,this.transform.angle),$,D,L,B.predicate);if(Y){const ve=Z.getSymbolInstanceIconSize(ae,this.transform.zoom,j.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Z,ve,Y,Ql(ye.x,ye.y,x,C,this.transform.angle),$,D,L,B.predicate).box.length===0)return}if(ge.box.length>0){let ve;return this.prevPlacement&&this.prevPlacement.variableOffsets[fe]&&this.prevPlacement.placements[fe]&&this.prevPlacement.placements[fe].text&&(ve=this.prevPlacement.variableOffsets[fe].anchor),this.variableOffsets[fe]={textOffset:de,width:f,height:_,anchor:n,textScale:v,prevAnchor:ve},this.markUsedJustification(Z,n,j,X),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,X,j),this.placedOrientations[fe]=X),{shift:ye,placedGlyphBoxes:ge}}}placeLayerBucketPart(n,l,f,_){const{bucket:v,layout:x,paint:C,posMatrix:D,textLabelPlaneMatrix:L,labelToScreenMatrix:B,clippingData:$,textPixelRatio:j,holdingForFade:U,collisionBoxArray:Z,partiallyEvaluatedTextSize:X,partiallyEvaluatedIconSize:Y,collisionGroup:J,latestFeatureIndex:ae}=n.parameters,ce=x.get("text-optional"),oe=x.get("icon-optional"),fe=x.get("text-allow-overlap"),de=x.get("icon-allow-overlap"),ye=x.get("text-rotation-alignment")==="map",ge=x.get("text-pitch-alignment")==="map",ve=x.get("symbol-z-elevate"),Ce=C.get("symbol-z-offset"),Oe=C.get("symbol-elevation-reference")==="sea";this.transform.setProjection(v.projection);let Te=fe&&(de||!v.hasIconData()||oe),$e=de&&(fe||!v.hasTextData()||ce);const Je=!Ce.isConstant();!v.collisionArrays&&Z&&v.deserializeCollisionBoxes(Z),f&&_&&v.updateCollisionDebugBuffers(this.transform.zoom,Z);const ct=(Ke,_t,je)=>{const{crossTileID:nt,numVerticalGlyphVertices:rt}=Ke;let vt=null;if($&&$.dynamicFilterNeedsFeature||Je){const Ar=this.retainedQueryData[v.bucketInstanceId];vt=ae.loadFeature({featureIndex:Ke.featureIndex,bucketIndex:Ar.bucketIndex,sourceLayerIndex:Ar.sourceLayerIndex,layoutVertexArrayOffset:0})}if($&&!(0,$.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},vt,this.retainedQueryData[v.bucketInstanceId].tileID.canonical,new a.P(Ke.tileAnchorX,Ke.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[nt]=new Vs(!1,!1,!1,!0),void l.add(nt);const xt=Ce.evaluate(vt,{});if(l.has(nt))return;if(U)return void(this.placements[nt]=new Vs(!1,!1,!1));let lt=!1,pt=!1,Kt=!0,Ot=!1,Ft=!1,sr=null,Ht={box:null,offscreen:null,occluded:null},tr={box:null,offscreen:null,occluded:null},Ir=null,Pr=null,fi=null,wi=0,zi=0,ps=0;je.textFeatureIndex?wi=je.textFeatureIndex:Ke.useRuntimeCollisionCircles&&(wi=Ke.featureIndex),je.verticalTextFeatureIndex&&(zi=je.verticalTextFeatureIndex);const gn=Ar=>{Ar.tileID=this.retainedQueryData[v.bucketInstanceId].tileID;const ri=this.transform.elevation;Ar.elevation=Oe?xt:xt+(ri?ri.getAtTileOffset(Ar.tileID,Ar.tileAnchorX,Ar.tileAnchorY):0),Ar.elevation+=Ke.zOffset},Fr=je.textBox;if(Fr){gn(Fr);const Ar=ci=>{let sn=a.bk.horizontal;if(v.allowVerticalPlacement&&!ci&&this.prevPlacement){const _n=this.prevPlacement.placedOrientations[nt];_n&&(this.placedOrientations[nt]=_n,sn=_n,this.markUsedOrientation(v,sn,Ke))}return sn},ri=(ci,sn)=>{if(v.allowVerticalPlacement&&rt>0&&je.verticalTextBox){for(const _n of v.writingModes)if(_n===a.bk.vertical?(Ht=sn(),tr=Ht):Ht=ci(),Ht&&Ht.box&&Ht.box.length)break}else Ht=ci()};if(x.get("text-variable-anchor")){let ci=x.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[nt]){const Xr=this.prevPlacement.variableOffsets[nt];ci.indexOf(Xr.anchor)>0&&(ci=ci.filter(In=>In!==Xr.anchor),ci.unshift(Xr.anchor))}const sn=(Xr,In,jn)=>{const Dn=v.getSymbolInstanceTextSize(X,Ke,this.transform.zoom,_t),Ii=(Xr.x2-Xr.x1)*Dn+2*Xr.padding,Oo=(Xr.y2-Xr.y1)*Dn+2*Xr.padding,Po=Ke.hasIconTextFit&&!de?In:null;Po&&gn(Po);let ms={box:[],offscreen:!1,occluded:!1};const es=fe?2*ci.length:ci.length;for(let $o=0;$o<es;++$o){const gs=this.attemptAnchorPlacement(ci[$o%ci.length],Xr,Ii,Oo,Dn,ye,ge,j,D,J,$o>=ci.length,Ke,_t,v,jn,Po,X,Y);if(gs&&(ms=gs.placedGlyphBoxes,ms&&ms.box&&ms.box.length)){lt=!0,sr=gs.shift;break}}return ms};ri(()=>sn(Fr,je.iconBox,a.bk.horizontal),()=>{const Xr=je.verticalTextBox;return Xr&&gn(Xr),v.allowVerticalPlacement&&!(Ht&&Ht.box&&Ht.box.length)&&rt>0&&Xr?sn(Xr,je.verticalIconBox,a.bk.vertical):{box:null,offscreen:null,occluded:null}}),Ht&&(lt=Ht.box,Kt=Ht.offscreen,Ot=Ht.occluded);const _n=Ar(!(!Ht||!Ht.box));if(!lt&&this.prevPlacement){const Xr=this.prevPlacement.variableOffsets[nt];Xr&&(this.variableOffsets[nt]=Xr,this.markUsedJustification(v,Xr.anchor,Ke,_n))}}else{const ci=(sn,_n)=>{const Xr=v.getSymbolInstanceTextSize(X,Ke,this.transform.zoom,_t),In=this.collisionIndex.placeCollisionBox(v,Xr,sn,new a.P(0,0),fe,j,D,J.predicate);return In&&In.box&&In.box.length&&(this.markUsedOrientation(v,_n,Ke),this.placedOrientations[nt]=_n),In};ri(()=>ci(Fr,a.bk.horizontal),()=>{const sn=je.verticalTextBox;return v.allowVerticalPlacement&&rt>0&&sn?(gn(sn),ci(sn,a.bk.vertical)):{box:null,offscreen:null,occluded:null}}),Ar(!!(Ht&&Ht.box&&Ht.box.length))}}if(Ir=Ht,lt=Ir&&Ir.box&&Ir.box.length>0,Kt=Ir&&Ir.offscreen,Ot=Ir&&Ir.occluded,Ke.useRuntimeCollisionCircles){const Ar=v.text.placedSymbolArray.get(Ke.centerJustifiedTextSymbolIndex>=0?Ke.centerJustifiedTextSymbolIndex:Ke.verticalPlacedTextSymbolIndex),ri=a.bl(v.textSizeData,X,Ar),ci=x.get("text-padding");Pr=this.collisionIndex.placeCollisionCircles(v,fe,Ar,v.lineVertexArray,v.glyphOffsetArray,ri,D,L,B,f,ge,J.predicate,Ke.collisionCircleDiameter*ri/a.bq,ci,this.retainedQueryData[v.bucketInstanceId].tileID),lt=fe||Pr.circles.length>0&&!Pr.collisionDetected,Kt=Kt&&Pr.offscreen,Ot=Pr.occluded}if(je.iconFeatureIndex&&(ps=je.iconFeatureIndex),je.iconBox){const Ar=ri=>{gn(ri);const ci=Ke.hasIconTextFit&&sr?Ql(sr.x,sr.y,ye,ge,this.transform.angle):new a.P(0,0),sn=v.getSymbolInstanceIconSize(Y,this.transform.zoom,Ke.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(v,sn,ri,ci,de,j,D,J.predicate)};tr&&tr.box&&tr.box.length&&je.verticalIconBox?(fi=Ar(je.verticalIconBox),pt=fi.box.length>0):(fi=Ar(je.iconBox),pt=fi.box.length>0),Kt=Kt&&fi.offscreen,Ft=fi.occluded}const vi=ce||Ke.numHorizontalGlyphVertices===0&&rt===0,Gi=oe||Ke.numIconVertices===0;if(vi||Gi?Gi?vi||(pt=pt&&lt):lt=pt&&lt:pt=lt=pt&&lt,lt&&Ir&&Ir.box&&this.collisionIndex.insertCollisionBox(Ir.box,x.get("text-ignore-placement"),v.bucketInstanceId,tr&&tr.box&&zi?zi:wi,J.ID),pt&&fi&&this.collisionIndex.insertCollisionBox(fi.box,x.get("icon-ignore-placement"),v.bucketInstanceId,ps,J.ID),Pr&&(lt&&this.collisionIndex.insertCollisionCircles(Pr.circles,x.get("text-ignore-placement"),v.bucketInstanceId,wi,J.ID),f)){const Ar=v.bucketInstanceId;let ri=this.collisionCircleArrays[Ar];ri===void 0&&(ri=this.collisionCircleArrays[Ar]=new $n);for(let ci=0;ci<Pr.circles.length;ci+=4)ri.circles.push(Pr.circles[ci+0]),ri.circles.push(Pr.circles[ci+1]),ri.circles.push(Pr.circles[ci+2]),ri.circles.push(Pr.collisionDetected?1:0)}const mi=v.projection.name!=="globe";Te=Te&&(mi||!Ot),$e=$e&&(mi||!Ft),this.placements[nt]=new Vs(lt||Te,pt||$e,Kt||v.justReloaded),l.add(nt)};if(ve&&this.buildingIndex&&(this.buildingIndex.updateZOffset(v,this.retainedQueryData[v.bucketInstanceId].tileID),v.updateZOffset()),v.sortFeaturesByY){const Ke=v.getSortedSymbolIndexes(this.transform.angle);for(let _t=Ke.length-1;_t>=0;--_t){const je=Ke[_t];ct(v.symbolInstances.get(je),je,v.collisionArrays[je])}v.hasAnyZOffset&&a.w(`${v.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(v.hasAnyZOffset){const Ke=v.getSortedIndexesByZOffset();for(let _t=0;_t<Ke.length;++_t){const je=Ke[_t];ct(v.symbolInstances.get(je),je,v.collisionArrays[je])}}else for(let Ke=n.symbolInstanceStart;Ke<n.symbolInstanceEnd;Ke++)ct(v.symbolInstances.get(Ke),Ke,v.collisionArrays[Ke]);if(f&&v.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[v.bucketInstanceId];a.a6.mat4.invert(Ke.invProjMatrix,D),Ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(n,l,f,_){const{leftJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:x,rightJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:D,crossTileID:L}=f,B=a.bv(l),$=_===a.bk.vertical?D:B==="left"?v:B==="center"?x:B==="right"?C:-1;v>=0&&(n.text.placedSymbolArray.get(v).crossTileID=$>=0&&v!==$?0:L),x>=0&&(n.text.placedSymbolArray.get(x).crossTileID=$>=0&&x!==$?0:L),C>=0&&(n.text.placedSymbolArray.get(C).crossTileID=$>=0&&C!==$?0:L),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=$>=0&&D!==$?0:L)}markUsedOrientation(n,l,f){const _=l===a.bk.horizontal||l===a.bk.horizontalOnly?l:0,v=l===a.bk.vertical?l:0,{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:L}=f,B=n.text.placedSymbolArray;x>=0&&(B.get(x).placedOrientation=_),C>=0&&(B.get(C).placedOrientation=_),D>=0&&(B.get(D).placedOrientation=_),L>=0&&(B.get(L).placedOrientation=v)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let f=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const _=l?l.symbolFadeChange(n):1,v=l?l.opacities:{},x=l?l.variableOffsets:{},C=l?l.placedOrientations:{};for(const D in this.placements){const L=this.placements[D],B=v[D];B?(this.opacities[D]=new Eo(B,_,L.text,L.icon,null,L.clipped),f=f||L.text!==B.text.placed||L.icon!==B.icon.placed):(this.opacities[D]=new Eo(null,_,L.text,L.icon,L.skipFade,L.clipped),f=f||L.text||L.icon)}for(const D in v){const L=v[D];if(!this.opacities[D]){const B=new Eo(L,_,!1,!1);B.isHidden()||(this.opacities[D]=B,f=f||L.text.placed||L.icon.placed)}}for(const D in x)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=x[D]);for(const D in C)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=C[D]);f?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l,f,_){const v=new Set;for(const x of l){const C=x.getBucket(n);C&&x.latestFeatureIndex&&n.fqid===C.layerIds[0]&&(this.updateBucketOpacities(C,v,x,x.collisionBoxArray,f,_,x.tileID,n.scope),C.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(C,x.tileID),C.updateZOffset()))}}updateBucketOpacities(n,l,f,_,v,x,C,D){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const L=n.layers[0].layout,B=n.layers[0].paint,$=!!n.layers[0].dynamicFilter(),j=new Eo(null,0,!1,!1,!0),U=L.get("text-allow-overlap"),Z=L.get("icon-allow-overlap"),X=L.get("text-variable-anchor"),Y=L.get("text-rotation-alignment")==="map",J=L.get("text-pitch-alignment")==="map",ae=B.get("symbol-z-offset"),ce=B.get("symbol-elevation-reference")==="sea",oe=!ae.isConstant(),fe=new Eo(null,0,U&&(Z||!n.hasIconData()||L.get("icon-optional")),Z&&(U||!n.hasTextData()||L.get("text-optional")),!0);!n.collisionArrays&&_&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(_);const de=(ge,ve,Ce)=>{for(let Oe=0;Oe<ve/4;Oe++)ge.opacityVertexArray.emplaceBack(Ce)};let ye=0;x&&n.updateReplacement(C,x);for(let ge=0;ge<n.symbolInstances.length;ge++){const ve=n.symbolInstances.get(ge),{numHorizontalGlyphVertices:Ce,numVerticalGlyphVertices:Oe,crossTileID:Te,numIconVertices:$e,tileAnchorX:Je,tileAnchorY:ct}=ve;let Ke=null;if(ve&&oe){const Ot=this.retainedQueryData[n.bucketInstanceId];Ke=f.latestFeatureIndex.loadFeature({featureIndex:ve.featureIndex,bucketIndex:Ot.bucketIndex,sourceLayerIndex:Ot.sourceLayerIndex,layoutVertexArrayOffset:0})}const _t=ae.evaluate(Ke,{}),je=l.has(Te);let nt=this.opacities[Te];je?nt=j:nt||(nt=fe,this.opacities[Te]=nt),l.add(Te);const rt=Ce>0||Oe>0,vt=$e>0,xt=this.placedOrientations[Te],lt=xt===a.bk.vertical,pt=xt===a.bk.horizontal||xt===a.bk.horizontalOnly;!rt&&!vt||nt.isHidden()||ye++;let Kt=!1;if((rt||vt)&&x)for(const Ot of n.activeReplacements){if(a.br(Ot,v,a.bs.Symbol,D)||Ot.min.x>Je||Je>Ot.max.x||Ot.min.y>ct||ct>Ot.max.y)continue;const Ft=a.bt(Je,ct,C.canonical,Ot.footprintTileId.canonical);if(Kt=a.bu(Ft,Ot.footprint),Kt)break}if(rt){const Ot=Kt?Qc:Jc(nt.text);de(n.text,Ce,lt?Qc:Ot),de(n.text,Oe,pt?Qc:Ot);const Ft=nt.text.isHidden(),{leftJustifiedTextSymbolIndex:sr,centerJustifiedTextSymbolIndex:Ht,rightJustifiedTextSymbolIndex:tr,verticalPlacedTextSymbolIndex:Ir}=ve,Pr=n.text.placedSymbolArray,fi=Ft||lt?1:0;sr>=0&&(Pr.get(sr).hidden=fi),Ht>=0&&(Pr.get(Ht).hidden=fi),tr>=0&&(Pr.get(tr).hidden=fi),Ir>=0&&(Pr.get(Ir).hidden=Ft||pt?1:0);const wi=this.variableOffsets[Te];wi&&this.markUsedJustification(n,wi.anchor,ve,xt);const zi=this.placedOrientations[Te];zi&&(this.markUsedJustification(n,"left",ve,zi),this.markUsedOrientation(n,zi,ve))}if(vt){const Ot=Kt?Qc:Jc(nt.icon),{placedIconSymbolIndex:Ft,verticalPlacedIconSymbolIndex:sr}=ve,Ht=n.icon.placedSymbolArray,tr=nt.icon.isHidden()?1:0;Ft>=0&&(de(n.icon,$e,lt?Qc:Ot),Ht.get(Ft).hidden=tr),sr>=0&&(de(n.icon,ve.numVerticalIconVertices,pt?Qc:Ot),Ht.get(sr).hidden=tr)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ot=n.collisionArrays[ge];if(Ot){let Ft=new a.P(0,0),sr=!0;if(Ot.textBox||Ot.verticalTextBox){if(X){const tr=this.variableOffsets[Te];tr?(Ft=Yc(tr.anchor,tr.width,tr.height,tr.textOffset,tr.textScale),Y&&Ft._rotate(J?this.transform.angle:-this.transform.angle)):sr=!1}$&&(sr=!nt.clipped),Ot.textBox&&sf(n.textCollisionBox.collisionVertexArray,nt.text.placed,!sr||lt,_t,ce,Ft.x,Ft.y),Ot.verticalTextBox&&sf(n.textCollisionBox.collisionVertexArray,nt.text.placed,!sr||pt,_t,ce,Ft.x,Ft.y)}const Ht=sr&&Boolean(!pt&&Ot.verticalIconBox);Ot.iconBox&&sf(n.iconCollisionBox.collisionVertexArray,nt.icon.placed,Ht,_t,ce,ve.hasIconTextFit?Ft.x:0,ve.hasIconTextFit?Ft.y:0),Ot.verticalIconBox&&sf(n.iconCollisionBox.collisionVertexArray,nt.icon.placed,!Ht,_t,ce,ve.hasIconTextFit?Ft.x:0,ve.hasIconTextFit?Ft.y:0)}}}if(n.fullyClipped=ye===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const ge=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=ge.invProjMatrix,n.placementViewportMatrix=ge.viewportMatrix,n.collisionCircleArray=ge.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const f=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*f>n}setStale(){this.stale=!0}}function sf(d,n,l,f,_,v,x){d.emplaceBack(n?1:0,l?1:0,v||0,x||0,f,_?1:0),d.emplaceBack(n?1:0,l?1:0,v||0,x||0,f,_?1:0),d.emplaceBack(n?1:0,l?1:0,v||0,x||0,f,_?1:0),d.emplaceBack(n?1:0,l?1:0,v||0,x||0,f,_?1:0)}const Fa=Math.pow(2,25),$1=Math.pow(2,24),$y=Math.pow(2,17),zo=Math.pow(2,16),j1=Math.pow(2,9),af=Math.pow(2,8),jy=Math.pow(2,1);function Jc(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const n=d.placed?1:0,l=Math.floor(127*d.opacity);return l*Fa+n*$1+l*$y+n*zo+l*j1+n*af+l*jy+n}const Qc=0;class V1{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,l,f,_,v){const x=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(x,_,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((C,D)=>C.sortKey-D.sortKey));this._currentPartIndex<x.length;){const C=x[this._currentPartIndex];if(l.placeLayerBucketPart(C,this._seenCrossTileIDs,f,C.symbolInstanceStart===0),this._currentPartIndex++,v())return!0}return!1}}class wh{constructor(n,l,f,_,v,x,C,D,L){this.placement=new ec(n,v,x,C,D,L),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(n,l,f,_){const v=a.q.now(),x=()=>{const C=a.q.now()-v;return!this._forceFullPlacement&&C>2};for(;this._currentPlacementIndex>=0;){const C=l[n[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(C.type==="symbol"&&(!C.minzoom||C.minzoom<=D)&&(!C.maxzoom||C.maxzoom>D)){const L=C,B=L.layout.get("symbol-z-elevate"),$=L.layout.get("symbol-sort-key").constantOr(1)!==void 0,j=L.layout.get("symbol-z-order"),U=j==="viewport-y"||j==="auto"&&!(j!=="viewport-y"&&$),Z=L.layout.get("text-allow-overlap")||L.layout.get("icon-allow-overlap")||L.layout.get("text-ignore-placement")||L.layout.get("icon-ignore-placement"),X=U&&Z,Y=this._inProgressLayer=this._inProgressLayer||new V1(L),J=a.av(C.source,C.scope);if(Y.continuePlacement(B||X?_[J]:f[J],this.placement,this._showCollisionBoxes,C,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const tc=512/a.ab/2;class U1{constructor(n,l,f){this.tileID=n,this.bucketInstanceId=f,this.index=new a.by(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=n.canonical.x*a.ab,v=n.canonical.y*a.ab;for(let x=0;x<l.length;x++){const{key:C,crossTileID:D,tileAnchorX:L,tileAnchorY:B}=l.get(x),$=Math.floor((_+L)*tc),j=Math.floor((v+B)*tc);this.index.add($,j),this.keys.push(C),this.crossTileIDs.push(D)}this.index.finish()}findMatches(n,l,f){const _=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),v=tc/Math.pow(2,l.canonical.z-this.tileID.canonical.z),x=l.canonical.x*a.ab,C=l.canonical.y*a.ab;for(let D=0;D<n.length;D++){const L=n.get(D);if(L.crossTileID)continue;const{key:B,tileAnchorX:$,tileAnchorY:j}=L,U=Math.floor((x+$)*v),Z=Math.floor((C+j)*v),X=this.index.range(U-_,Z-_,U+_,Z+_);for(const Y of X){const J=this.crossTileIDs[Y];if(this.keys[Y]===B&&!f.has(J)){f.add(J),L.crossTileID=J;break}}}}}class eu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vy{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const f in this.indexes){const _=this.indexes[f],v={};for(const x in _){const C=_[x];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+l),v[C.tileID.key]=C}this.indexes[f]=v}this.lng=n}addBucket(n,l,f){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let v=0;v<l.symbolInstances.length;v++)l.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const _=this.usedCrossTileIDs[n.overscaledZ];for(const v in this.indexes){const x=this.indexes[v];if(Number(v)>n.overscaledZ)for(const C in x){const D=x[C];D.tileID.isChildOf(n)&&D.findMatches(l.symbolInstances,n,_)}else{const C=x[n.scaledTo(Number(v)).key];C&&C.findMatches(l.symbolInstances,n,_)}}for(let v=0;v<l.symbolInstances.length;v++){const x=l.symbolInstances.get(v);x.crossTileID||(x.crossTileID=f.generate(),_.add(x.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new U1(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const f of l.crossTileIDs)this.usedCrossTileIDs[n].delete(f)}removeStaleBuckets(n){let l=!1;for(const f in this.indexes){const _=this.indexes[f];for(const v in _)n[_[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[v]),delete _[v],l=!0)}return l}}class lf{constructor(){this.layerIndexes={},this.crossTileIDs=new eu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,f,_){let v=this.layerIndexes[n.fqid];v===void 0&&(v=this.layerIndexes[n.fqid]=new Vy);let x=!1;const C={};_.name!=="globe"&&v.handleWrapJump(f);for(const D of l){const L=D.getBucket(n);L&&n.fqid===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(D.tileID,L,this.crossTileIDs)&&(x=!0),C[L.bucketInstanceId]=!0)}return v.removeStaleBuckets(C)&&(x=!0),x}pruneUnusedLayers(n){const l={};n.forEach(f=>{l[f]=!0});for(const f in this.layerIndexes)l[f]||delete this.layerIndexes[f]}}const Xo=771;class kr{constructor(n,l,f,_){this.blendFunction=n,this.blendColor=l,this.mask=f,this.blendEquation=_}}kr.Replace=[1,0,1,0],kr.disabled=new kr(kr.Replace,a.bz.transparent,[!1,!1,!1,!1]),kr.unblended=new kr(kr.Replace,a.bz.transparent,[!0,!0,!0,!0]),kr.alphaBlended=new kr([1,Xo,1,Xo],a.bz.transparent,[!0,!0,!0,!0]),kr.alphaBlendedNonPremultiplied=new kr([770,Xo,770,Xo],a.bz.transparent,[!0,!0,!0,!0]),kr.multiply=new kr([774,0,774,0],a.bz.transparent,[!0,!0,!0,!0]);class Qt{constructor(n,l,f){this.func=n,this.mask=l,this.range=f}}Qt.ReadOnly=!1,Qt.ReadWrite=!0,Qt.disabled=new Qt(519,Qt.ReadOnly,[0,1]);const bm=7680;class yr{constructor(n,l,f,_,v,x){this.test=n,this.ref=l,this.mask=f,this.fail=_,this.depthFail=v,this.pass=x}}yr.disabled=new yr({func:519,mask:0},0,0,bm,bm,bm);const xm=1029,Th=2305;class lr{constructor(n,l,f){this.enable=n,this.mode=l,this.frontFace=f}}function wm(d,n){const l=a.bC(d,3);a.a6.mat4.fromQuat(d,n),a.bE(d,3,l)}function cf(d,n){const l=a.a6.quat.identity([]);return a.a6.quat.rotateZ(l,l,-n),a.a6.quat.rotateX(l,l,-d),l}function Tm(d,n){const l=[d[0],d[1],0],f=[n[0],n[1],0];if(a.a6.vec3.length(l)>=1e-15){const x=a.a6.vec3.normalize([],l);a.a6.vec3.scale(f,x,a.a6.vec3.dot(f,x)),n[0]=f[0],n[1]=f[1]}const _=a.a6.vec3.cross([],n,d);if(a.a6.vec3.len(_)<1e-15)return null;const v=Math.atan2(-_[1],_[0]);return cf(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),v)}lr.disabled=new lr(!1,xm,Th),lr.backCCW=new lr(!0,xm,Th),lr.backCW=new lr(!0,xm,2304),lr.frontCW=new lr(!0,1028,2304),lr.frontCCW=new lr(!0,1028,Th);class ml{constructor(n,l){this.position=n,this.orientation=l}get position(){return this._position}set position(n){if(n){const l=n instanceof a.a5?n:new a.a5(n[0],n[1],n[2]);this._renderWorldCopies&&(l.x=a.bA(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(n,l){if(this.orientation=null,!this.position)return;const f=this.position,_=this._elevation?this._elevation.getAtPointOrZero(a.a5.fromLngLat(n)):0,v=a.a5.fromLngLat(n,_),x=[v.x-f.x,v.y-f.y,v.z-f.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=Tm(x,l)}setPitchBearing(n,l){this.orientation=cf(a.bB(n),a.bB(-l))}}class rc{constructor(n,l){this._transform=a.a6.mat4.identity([]),this.orientation=l,this.position=n}get mercatorPosition(){const n=this.position;return new a.a5(n[0],n[1],n[2])}get position(){const n=a.bC(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var l;n&&a.bE(this._transform,3,[(l=n)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||a.a6.quat.identity([]),n&&wm(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,l){this._orientation=cf(n,l),wm(this._transform,this._orientation)}forward(){const n=a.bC(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=a.bC(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=a.bC(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,l){const f=new Float64Array(16);return a.a6.mat4.invert(f,this.getWorldToCamera(n,l)),f}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,l,f){const _=this.position;a.a6.vec3.scale(_,_,-n);const v=new Float64Array(16);return a.a6.mat4.fromScaling(v,[f,f,f]),a.a6.mat4.translate(v,v,_),v[10]*=l,v}getWorldToCamera(n,l){const f=new Float64Array(16),_=new Float64Array(4),v=this.position;return a.a6.quat.conjugate(_,this._orientation),a.a6.vec3.scale(v,v,-n),a.a6.mat4.fromQuat(f,_),a.a6.mat4.translate(f,f,v),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=l,f[9]*=l,f[10]*=l,f[11]*=l,f}getCameraToClipPerspective(n,l,f,_){const v=new Float64Array(16);return a.a6.mat4.perspective(v,n,l,f,_),v}getCameraToClipOrthographic(n,l,f,_,v,x){const C=new Float64Array(16);return a.a6.mat4.ortho(C,n,l,f,_,v,x),C}getDistanceToElevation(n,l=!1){const f=n===0?0:a.bD(n,l?a.aM(this.position[1]):this.position[1]),_=this.forward();return(f-this.position[2])/_[2]}clone(){return new rc([...this.position],[...this.orientation])}}const ro={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class uf{constructor(n=0,l=0,f=0,_=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=f,this.right=_}interpolate(n,l,f){return l.top!=null&&n.top!=null&&(this.top=a.aa(n.top,l.top,f)),l.bottom!=null&&n.bottom!=null&&(this.bottom=a.aa(n.bottom,l.bottom,f)),l.left!=null&&n.left!=null&&(this.left=a.aa(n.left,l.left,f)),l.right!=null&&n.right!=null&&(this.right=a.aa(n.right,l.right,f)),this}getCenter(n,l){const f=a.ap((this.left+n-this.right)/2,0,n),_=a.ap((this.top+l-this.bottom)/2,0,l);return new a.P(f,_)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new uf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const tu=(d,n,l)=>(1-l)*d+l*n,ru=d=>d*d*d*d*d;class hf{constructor(n,l,f,_,v,x,C){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=f!=null?f:0,this._maxPitch=_!=null?_:60,this.setProjection(x),this.setMaxBounds(C),this.width=0,this.height=0,this._center=new a.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new uf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new rc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const n=new hf(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,l=!1){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(n||f)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return a.ar(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=a.bL(this.projectionOptions);const f=this.getProjection(),_=!a.bh(l,f);return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.bL({name:"mercator"});const l=n!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bA(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const l=-n*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=a.a6.mat2.create(),a.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const l=a.ap(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=a.bB(n),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const l=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const f=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&f.exaggeration()&&this._centerAltitudeValidForExaggeration!==f.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*f.exaggeration(),this._centerAltitudeValidForExaggeration=f.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=f.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let _=0,v=0;for(let x=0;x<l.length;x++){const C=new a.P(l[x][0]*this.width,f+l[x][1]*(this.height-f)),D=n.pointCoordinate(C);if(!D)continue;const L=1/Math.hypot(D[0]-this._camera.position[0],D[1]-this._camera.position[1]);_+=D[3]*L,v+=L}return v===0?NaN:_/v}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*l,_=this._mercatorZfromZoom(n),v=this._mercatorZfromZoom(this._maxZoom),x=Math.max(_-f,v);this._setZoom(this._zoomFromMercatorZ(x))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let f;f=n.z<this._camera.position[2]?[l.x,l.y,l.z]:[n.x,n.y,n.z];const _=a.a6.vec3.length(a.a6.vec3.sub([],this._camera.position,f));return a.ap(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let l=!1;if(n.orientation&&!a.a6.quat.exactEquals(n.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(n.orientation)),n.position){const f=[n.position.x,n.position.y,n.position.z];a.a6.vec3.exactEquals(f,this._camera.position)||(this._setCameraPosition(f),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,l=new ml;return l.position=new a.a5(n[0],n[1],n[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(n){if(!a.a6.quat.length(n))return!1;a.a6.quat.normalize(n,n);const l=a.a6.vec3.transformQuat([],[0,0,-1],n),f=a.a6.vec3.transformQuat([],[0,-1,0],n);if(f[2]<0)return!1;const _=Tm(l,f);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(n){const l=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;n[2]=a.ap(n[2],_/f,_/l),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,f){this._unmodified=!1,this._edgeInsets.interpolate(n,l,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const l=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(n){const l=[new a.bM(0,n)];if(this.renderWorldCopies){const f=this.pointCoordinate(new a.P(0,0)),_=this.pointCoordinate(new a.P(this.width,0)),v=this.pointCoordinate(new a.P(this.width,this.height)),x=this.pointCoordinate(new a.P(0,this.height)),C=Math.floor(Math.min(f.x,_.x,v.x,x.x)),D=Math.floor(Math.max(f.x,_.x,v.x,x.x)),L=1;for(let B=C-L;B<=D+L;B++)B!==0&&l.push(new a.bM(B,n))}return l}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,l,f){let _=[];const v=f!==void 0,x=!v;if(x&&this.zoom<l||v&&f[0]===0&&f[1]===0)return _;const C=new Set,D=(B,$,j,U,Z)=>{const X=a.c1($,B,j,U,Z);C.has(X)||(_.push(new a.aA(B,$,j,U,Z)),C.add(X))};for(let B=0;B<n.length;B++){const $=n[B];if(x&&$.canonical.z!==l)continue;const j=$.canonical,U=$.overscaledZ,Z=$.wrap,X=1<<j.z,Y=j.x+1<X,J=j.x>0,ae=j.y+1<X,ce=j.y>0,oe=$.wrap-(J?0:1),fe=$.wrap+(Y?0:1),de=J?j.x-1:X-1,ye=Y?j.x+1:0;if(v)f[0]<0?(D(U,fe,j.z,ye,j.y),f[1]<0&&ae&&(D(U,Z,j.z,j.x,j.y+1),D(U,fe,j.z,ye,j.y+1)),f[1]>0&&ce&&(D(U,Z,j.z,j.x,j.y-1),D(U,fe,j.z,ye,j.y-1))):f[0]>0?(D(U,oe,j.z,de,j.y),f[1]<0&&ae&&(D(U,Z,j.z,j.x,j.y+1),D(U,oe,j.z,de,j.y+1)),f[1]>0&&ce&&(D(U,Z,j.z,j.x,j.y-1),D(U,oe,j.z,de,j.y-1))):f[1]<0&&ae?D(U,Z,j.z,j.x,j.y+1):ce&&D(U,Z,j.z,j.x,j.y-1);else{const ge=$.visibleQuadrants;1&ge&&(D(U,oe,j.z,de,j.y),ce&&(D(U,Z,j.z,j.x,j.y-1),D(U,oe,j.z,de,j.y-1))),2&ge&&(D(U,fe,j.z,ye,j.y),ce&&(D(U,Z,j.z,j.x,j.y-1),D(U,fe,j.z,ye,j.y-1))),4&ge&&(D(U,oe,j.z,de,j.y),ae&&(D(U,Z,j.z,j.x,j.y+1),D(U,oe,j.z,de,j.y+1))),8&ge&&(D(U,fe,j.z,ye,j.y),ae&&(D(U,Z,j.z,j.x,j.y+1),D(U,fe,j.z,ye,j.y+1)))}}const L=[];for(const B of _)_.some($=>B.isChildOf($))||L.push(B);if(_=L.filter(B=>!n.some($=>!!(B.overscaledZ<l&&$.isChildOf(B))||B.equals($)||B.isChildOf($))),x){const B=1<<l,$=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),j=[B*$.x,B*$.y],U=4,Z=U*U;_=_.filter(X=>{const Y=X.canonical.x+.5-j[0],J=X.canonical.y+.5-j[1];return Y*Y+J*J<Z})}return _}coveringTiles(n){let l=this.coveringZoomLevel(n);const f=l,_=this.elevation&&this.elevation.exaggeration(),v=_&&!n.isTerrainDEM,x=this.projection.name==="mercator";if(n.minzoom!==void 0&&l<n.minzoom)return[];n.maxzoom!==void 0&&l>n.maxzoom&&(l=n.maxzoom);const C=this.locationCoordinate(this.center),D=this.center.lat,L=1<<l,B=[L*C.x,L*C.y,0],$=this.projection.name==="globe",j=!$,U=a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,j),Z=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),X=L*a.bD(1,this.center.lat),Y=this._camera.position[2]/a.bD(1,this.center.lat),J=[L*Z.x,L*Z.y,Y*(j?1:X)],ae=$||_,ce=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),oe=this.isLODDisabled(!0)?l:0;let fe;if(this._elevation&&n.isTerrainDEM)fe=1e4*this._elevation.exaggeration();else if(this._elevation){const je=this._elevation.getMinMaxForVisibleTiles();fe=je?je.max:this._centerAltitude}else fe=this._centerAltitude;const de=n.isTerrainDEM?-fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,ye=this.projection.isReprojectedInTileSpace?a.bO(this):1,ge=je=>{const rt=new a.a5(je.x+25e-6,je.y,je.z),vt=new a.a5(je.x,je.y+25e-6,je.z),xt=je.toLngLat(),lt=rt.toLngLat(),pt=vt.toLngLat(),Kt=this.locationCoordinate(xt),Ot=this.locationCoordinate(lt),Ft=this.locationCoordinate(pt),sr=Math.hypot(Ot.x-Kt.x,Ot.y-Kt.y),Ht=Math.hypot(Ft.x-Kt.x,Ft.y-Kt.y);return Math.sqrt(sr*Ht)*ye/25e-6},ve=je=>{const nt=fe,rt=de;return{aabb:a.bR(this,L,0,0,0,je,rt,nt,this.projection),zoom:0,x:0,y:0,minZ:rt,maxZ:nt,wrap:je,fullyVisible:!1}},Ce=[];let Oe=[];const Te=l,$e=n.reparseOverscaled?f:l,Je=(Y-this._centerAltitude)*X,ct=je=>{if(!this._elevation||!je.tileID||!x)return;const nt=this._elevation.getMinMaxForTile(je.tileID),rt=je.aabb;nt?(rt.min[2]=nt.min,rt.max[2]=nt.max,rt.center[2]=(rt.min[2]+rt.max[2])/2):(je.shouldSplit=_t(je),je.shouldSplit||(rt.min[2]=rt.max[2]=rt.center[2]=this._centerAltitude))},Ke=(je,nt)=>{if(.707*nt<je)return 1;const rt=nt/je;return rt/(1.4144271570014144+(Math.pow(1.1,rt-1.4144271570014144+1)-1)/(1.1-1)-1)},_t=je=>{if(je.zoom<oe)return!0;if(je.zoom===Te)return!1;if(je.shouldSplit!=null)return je.shouldSplit;const nt=je.aabb.distanceX(J),rt=je.aabb.distanceY(J);let vt=Je,xt=1;if($){vt=je.aabb.distanceZ(J);const Ht=Math.pow(2,je.zoom),tr=a.aM((je.y+1)/Ht),Ir=a.aM(je.y/Ht),Pr=Math.min(Math.max(D,tr),Ir),fi=a.c5(Pr)/a.c5(D);if(xt=Pr===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,fi/this._mercatorScaleRatio),this.zoom<=a.c2&&je.zoom===Te-1&&fi>=.9)return!0}else if(v&&(vt=je.aabb.distanceZ(J)*X),this.projection.isReprojectedInTileSpace&&f<=5){const Ht=Math.pow(2,je.zoom),tr=ge(new a.a5((je.x+.5)/Ht,(je.y+.5)/Ht));xt=tr>.85?1:tr}if(!x){const Ht=Math.sqrt(nt*nt+rt*rt+vt*vt);let tr=(1<<Te-je.zoom)*ce*xt;return tr*=Ke(Math.max(vt,Je),Ht),Ht<tr}let lt=Number.MAX_VALUE,pt=0;const Kt=je.aabb.getCorners(),Ot=[];for(const Ht of Kt){a.a6.vec3.sub(Ot,Ht,J),$||(v?Ot[2]*=X:Ot[2]=Je);const tr=a.a6.vec3.dot(Ot,this._camera.forward());tr<lt&&(lt=tr,pt=Math.abs(Ot[2]))}let Ft=(1<<Te-je.zoom)*ce*xt;if(Ft*=Ke(Math.max(pt,Je),lt),lt<Ft)return!0;const sr=je.aabb.closestPoint(B);return sr[0]===B[0]&&sr[1]===B[1]};if(this.renderWorldCopies)for(let je=1;je<=3;je++)Ce.push(ve(-je)),Ce.push(ve(je));for(Ce.push(ve(0));Ce.length>0;){const je=Ce.pop(),nt=je.x,rt=je.y;let vt=je.fullyVisible;const xt=()=>this.projection.name==="globe"&&(je.y===0||je.y===(1<<je.zoom)-1);if(!vt){let lt=ae?je.aabb.intersects(U):je.aabb.intersectsFlat(U);if(lt===0&&xt()){const pt=new a.bP(je.zoom,nt,rt);lt=a.bQ(this,L,pt,!0).intersects(U)}if(lt===0)continue;vt=lt===2}if(je.zoom!==Te&&_t(je))for(let lt=0;lt<4;lt++){const pt=(nt<<1)+lt%2,Kt=(rt<<1)+(lt>>1),Ot={aabb:x?je.aabb.quadrant(lt):a.bR(this,L,je.zoom+1,pt,Kt,je.wrap,je.minZ,je.maxZ,this.projection),zoom:je.zoom+1,x:pt,y:Kt,wrap:je.wrap,fullyVisible:vt,tileID:void 0,shouldSplit:void 0,minZ:je.minZ,maxZ:je.maxZ};v&&!$&&(Ot.tileID=new a.aA(je.zoom+1===Te?$e:je.zoom+1,je.wrap,je.zoom+1,pt,Kt),ct(Ot)),Ce.push(Ot)}else{const lt=je.zoom===Te?$e:je.zoom;if(n.minzoom&&n.minzoom>lt)continue;let pt=0;if(!vt){let sr=ae?je.aabb.intersectsPrecise(U):je.aabb.intersectsPreciseFlat(U);if(sr===0&&xt()){const Ht=new a.bP(je.zoom,nt,rt);sr=a.bQ(this,L,Ht,!0).intersectsPrecise(U)}if(sr===0)continue;if(n.calculateQuadrantVisibility)if(U.containsPoint(je.aabb.center))pt=15;else for(let Ht=0;Ht<4;Ht++)je.aabb.quadrant(Ht).intersects(U)!==0&&(pt|=1<<Ht)}const Kt=B[0]-(.5+nt+(je.wrap<<je.zoom))*(1<<l-je.zoom),Ot=B[1]-.5-rt,Ft=je.tileID?je.tileID:new a.aA(lt,je.wrap,je.zoom,nt,rt);n.calculateQuadrantVisibility&&(Ft.visibleQuadrants=pt),Oe.push({tileID:Ft,distanceSq:Kt*Kt+Ot*Ot})}}if(this.fogCullDistSq){const je=this.fogCullDistSq,nt=this.horizonLineFromTop();Oe=Oe.filter(rt=>{const vt=[0,0,0,1],xt=[a.ab,a.ab,0,1],lt=this.calculateFogTileMatrix(rt.tileID.toUnwrapped());a.a6.vec4.transformMat4(vt,vt,lt),a.a6.vec4.transformMat4(xt,xt,lt);const pt=a.a6.vec4.min([],vt,xt),Kt=a.a6.vec4.max([],vt,xt),Ot=a.bS(pt,Kt);if(Ot===0)return!0;let Ft=!1;const sr=this._elevation;if(sr&&Ot>je&&nt!==0){const Ht=this.calculateProjMatrix(rt.tileID.toUnwrapped());let tr;n.isTerrainDEM||(tr=sr.getMinMaxForTile(rt.tileID)),tr||(tr={min:de,max:fe});const Ir=a.c3(this.rotation),Pr=[Ir[0]*a.ab,Ir[1]*a.ab,tr.max];a.a6.vec3.transformMat4(Pr,Pr,Ht),Ft=(1-Pr[1])*this.height*.5<nt}return Ot<je||Ft})}return Oe.sort((je,nt)=>je.distanceSq-nt.distanceSq).map(je=>je.tileID)}resize(n,l){this.width=n,this.height=l,this.pixelsToGLUnits=[2/n,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const l=a.ap(n.lat,-a.bT,a.bT),f=this.projection.project(n.lng,l);return new a.P(f.x*this.worldSize,f.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,l){let f,_;const v=this.centerPoint;if(this.projection.name==="globe"){const C=this.worldSize;f=(l.x-v.x)/C,_=(l.y-v.y)/C}else{const C=this.pointCoordinate(l),D=this.pointCoordinate(v);f=C.x-D.x,_=C.y-D.y}const x=this.locationCoordinate(n);this.setLocation(new a.a5(x.x-f,x.y-_))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,l){const f=l?a.bD(l,n.lat):void 0,_=this.projection.project(n.lng,n.lat);return new a.a5(_.x,_.y,f)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,l){const f=l!=null?l:this._centerAltitude,_=[n.x,n.y,0,1],v=[n.x,n.y,1,1];a.a6.vec4.transformMat4(_,_,this.pixelMatrixInverse),a.a6.vec4.transformMat4(v,v,this.pixelMatrixInverse);const x=v[3];a.a6.vec4.scale(_,_,1/_[3]),a.a6.vec4.scale(v,v,1/x);const C=_[2],D=v[2];return{p0:_,p1:v,t:C===D?0:(f-C)/(D-C)}}screenPointToMercatorRay(n){const l=[n.x,n.y,0,1],f=[n.x,n.y,1,1];return a.a6.vec4.transformMat4(l,l,this.pixelMatrixInverse),a.a6.vec4.transformMat4(f,f,this.pixelMatrixInverse),a.a6.vec4.scale(l,l,1/l[3]),a.a6.vec4.scale(f,f,1/f[3]),l[2]=a.bD(l[2],this._center.lat)*this.worldSize,f[2]=a.bD(f[2],this._center.lat)*this.worldSize,a.a6.vec4.scale(l,l,1/this.worldSize),a.a6.vec4.scale(f,f,1/this.worldSize),new a.aj([l[0],l[1],l[2]],a.a6.vec3.normalize([],a.a6.vec3.sub([],f,l)))}rayIntersectionCoordinate(n){const{p0:l,p1:f,t:_}=n,v=a.bD(l[2],this._center.lat),x=a.bD(f[2],this._center.lat);return new a.a5(a.aa(l[0],f[0],_)/this.worldSize,a.aa(l[1],f[1],_)/this.worldSize,a.aa(v,x,_))}pointCoordinate(n,l=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,l)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let l=this.projection.pointCoordinate3D(this,n.x,n.y);if(l)return new a.a5(l[0],l[1],l[2]);let f=0,_=this.horizonLineFromTop();if(n.y>_)return this.pointCoordinate(n);const v=.02*_,x=n.clone();for(let C=0;C<10&&_-f>v;C++){x.y=a.aa(f,_,.66);const D=this.projection.pointCoordinate3D(this,x.x,x.y);D?(_=x.y,l=D):f=x.y}return l?new a.a5(l[0],l[1],l[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=a.bU)return!this.isPointAboveHorizon(n);const l=this.pointCoordinate(n);return l.y>=0&&l.y<=1}_coordinatePoint(n,l){const f=l&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,_=[n.x*this.worldSize,n.y*this.worldSize,f+n.toAltitude(),1];return a.a6.vec4.transformMat4(_,_,this.pixelMatrix),_[3]>0?new a.P(_[0]/_[3],_[1]/_[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:l}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,v=this.pointLocation3D(new a.P(l,n)),x=this.pointLocation3D(new a.P(_,n)),C=this.pointLocation3D(new a.P(_,f)),D=this.pointLocation3D(new a.P(l,f));let L=Math.min(v.lng,x.lng,C.lng,D.lng),B=Math.max(v.lng,x.lng,C.lng,D.lng),$=Math.min(v.lat,x.lat,C.lat,D.lat),j=Math.max(v.lat,x.lat,C.lat,D.lat);const U=Math.pow(2,-this.zoom)/16*270,Z=this.projection.name==="globe"?1:4,X=(Y,J,ae,ce,oe)=>{const fe=(Y+ae)/2,de=(J+ce)/2,ye=new a.P(fe,de),{lng:ge,lat:ve}=this.pointLocation3D(ye),Ce=Math.max(0,L-ge,$-ve,ge-B,ve-j);L=Math.min(L,ge),B=Math.max(B,ge),$=Math.min($,ve),j=Math.max(j,ve),(oe<Z||Ce>U)&&(X(Y,J,fe,de,oe+1),X(fe,de,ae,ce,oe+1))};if(X(l,n,_,n,1),X(_,n,_,f,1),X(_,f,l,f,1),X(l,f,l,n,1),this.projection.name==="globe"){const[Y,J]=a.bV(this);Y?(j=90,B=180,L=-180):J&&($=-90,B=180,L=-180)}return new a.as(new a.bK(L,$),new a.bK(B,j))}_getBoundsRectangular(n,l){const{top:f,left:_}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,C=new a.P(_,f),D=new a.P(x,f),L=new a.P(x,v),B=new a.P(_,v);let $=this.pointCoordinate(C,n),j=this.pointCoordinate(D,n);const U=this.pointCoordinate(L,l),Z=this.pointCoordinate(B,l),X=(Y,J)=>(J.y-Y.y)/(J.x-Y.x);return $.y>1&&j.y>=0?$=new a.a5((1-Z.y)/X(Z,$)+Z.x,1):$.y<0&&j.y<=1&&($=new a.a5(-Z.y/X(Z,$)+Z.x,0)),j.y>1&&$.y>=0?j=new a.a5((1-U.y)/X(U,j)+U.x,1):j.y<0&&$.y<=1&&(j=new a.a5(-U.y/X(U,j)+U.x,0)),new a.as().extend(this.coordinateLocation($)).extend(this.coordinateLocation(j)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(U))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=n.visibleDemTiles.reduce((f,_)=>{if(_.dem){const v=_.dem.tree;f.min=Math.min(f.min,v.minimums[0]),f.max=Math.max(f.max,v.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*n.exaggeration(),l.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,f=this.height/2-l*(1-this._horizonShift);return n?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-a.bT,this.maxLat=a.bT,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.am(this.minLng)*this.tileSize,this.worldMaxX=a.am(this.maxLng)*this.tileSize,this.worldMinY=a.at(this.maxLat)*this.tileSize,this.worldMaxY=a.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,l){return this.projection.createTileMatrix(this,l,n)}calculateDistanceTileData(n){const l=n.key,f=this._distanceTileDataCache;if(f[l])return f[l];const _=n.canonical,v=1/this.height,x=this.cameraWorldSize,C=x/this.zoomScale(_.z),D=(_.x+Math.pow(2,_.z)*n.wrap)*C,L=_.y*C,B=this.point;B.x*=x/this.worldSize,B.y*=x/this.worldSize;const $=this.angle,j=Math.sin(-$),U=-Math.cos(-$);return f[l]={bearing:[j,U],center:[(B.x-D)*v,(B.y-L)*v],scale:C/a.ab*v},f[l]}calculateFogTileMatrix(n){const l=n.key,f=this._fogTileMatrixCache;if(f[l])return f[l];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return a.a6.mat4.multiply(_,this.worldToFogMatrix,_),f[l]=new Float32Array(_),f[l]}calculateProjMatrix(n,l=!1,f=!1){const _=n.key;let v;if(v=f?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,v[_])return v[_];const x=this.calculatePosMatrix(n,this.worldSize);let C;return C=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,a.a6.mat4.multiply(x,C,x),v[_]=new Float32Array(x),v[_]}calculatePixelsToTileUnitsMatrix(n){const l=n.tileID.key,f=this._pixelsToTileUnitsCache;if(f[l])return f[l];const _=a.bW(n,this);return f[l]=_,f[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,l=a.a6.mat4.fromScaling([],[n,n,n]);return a.a6.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const l=a.bD(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(l),_=this._camera.forward(),v=a.bD(1,this._center.lat);f[2]/=v,_[2]/=v,a.a6.vec3.normalize(_,_);const x=n.raycast(f,_,n.exaggeration());if(x){const C=a.a6.vec3.scaleAndAdd([],f,_,x),D=new a.a5(C[0],C[1],a.bD(C[2],a.aM(C[1]))),L=(D.z+a.a6.vec3.length([D.x-f[0],D.y-f[1],D.z-f[2]*v]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(L),this._centerAltitude=D.toAltitude(),this._center=this.coordinateLocation(D),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const l=this._elevation,f=a.bD(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(f),v=l.getAtPointOrZero(new a.a5(..._)),x=this.pixelsPerMeter/this.worldSize*v,C=this._minimumHeightOverTerrain(),D=_[2]-x;if(D<=C)if(D<0||n){const L=this.locationCoordinate(this._center,this._centerAltitude),B=[_[0],_[1],L.z-_[2]],$=a.a6.vec3.length(B);B[2]-=(C-D)/this._pixelsPerMercatorPixel;const j=a.a6.vec3.length(B);if(j===0)return;a.a6.vec3.scale(B,B,$/j*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],L.z*this._pixelsPerMercatorPixel-B[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const j=this.center;return j.lat=a.ap(j.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(j.lng=a.ap(j.lng,this.minLng,this.maxLng)),this.center=j,void(this._constraining=!1)}const l=this._unmodified,{x:f,y:_}=this.point;let v=0,x=f,C=_;const D=this.width/2,L=this.height/2,B=this.worldMinY*this.scale,$=this.worldMaxY*this.scale;if(_-L<B&&(C=B+L),_+L>$&&(C=$-L),$-B<this.height&&(v=Math.max(v,this.height/($-B)),C=($+B)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const j=this.worldMinX*this.scale,U=this.worldMaxX*this.scale,Z=this.worldSize/2-(j+U)/2;x=(f+Z+this.worldSize)%this.worldSize-Z,x-D<j&&(x=j+D),x+D>U&&(x=U-D),U-j<this.width&&(v=Math.max(v,this.width/(U-j)),x=(U+j)/2)}x===f&&C===_||(this.center=this.unproject(new a.P(x,C))),v&&(this.zoom+=this.scaleZoom(v)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,l=this.projection.name==="globe",f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.bD(1,this.center.lat)/a.bD(1,a.c4));const _=a.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this.projection.zAxisUnit==="meters"?f:1,x=this._camera.getWorldToCamera(this.worldSize,v);let C;const D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(D[8]=2*-n.x/this.width,D[9]=2*n.y/this.height,this.isOrthographic){let ve=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ce=ve*this.aspect,Oe=-Ce,Te=-ve;Ce-=n.x,Oe-=n.x,ve+=n.y,Te+=n.y,C=this._camera.getCameraToClipOrthographic(Oe,Ce,Te,ve,this._nearZ,this._farZ),(($e,Je,ct,Ke)=>{for(let _t=0;_t<16;_t++)$e[_t]=tu(Je[_t],ct[_t],Ke)})(C,C,D,ru(this.pitch>=15?1:this.pitch/15))}else C=D;const L=a.a6.mat4.mul([],D,x);let B=a.a6.mat4.mul([],C,x);if(this.projection.isReprojectedInTileSpace){const ve=this.locationCoordinate(this.center),Ce=a.a6.mat4.identity([]);a.a6.mat4.translate(Ce,Ce,[ve.x*this.worldSize,ve.y*this.worldSize,0]),a.a6.mat4.multiply(Ce,Ce,a.bY(this)),a.a6.mat4.translate(Ce,Ce,[-ve.x*this.worldSize,-ve.y*this.worldSize,0]),a.a6.mat4.multiply(B,B,Ce),a.a6.mat4.multiply(L,L,Ce),this.inverseAdjustmentMatrix=a.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.a6.mat4.scale([],B,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=B,this.invProjMatrix=a.a6.mat4.invert(new Float64Array(16),this.projMatrix),l){const ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);ve[8]=2*-n.x/this.width,ve[9]=2*n.y/this.height,this.expandedFarZProjMatrix=a.a6.mat4.mul([],ve,x)}else this.expandedFarZProjMatrix=this.projMatrix;const $=a.a6.mat4.invert([],C);this.frustumCorners=a.b_.fromInvProjectionMatrix($,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const j=new Float32Array(16);a.a6.mat4.identity(j),a.a6.mat4.scale(j,j,[1,-1,1]),a.a6.mat4.rotateX(j,j,this._pitch),a.a6.mat4.rotateZ(j,j,this.angle);const U=a.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.a6.mat4.clone(U);const Z=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;U[8]=2*-n.x/this.width,U[9]=2*(n.y+Z)/this.height,this.skyboxMatrix=a.a6.mat4.multiply(j,U,j);const X=this.point,Y=X.x,J=X.y,ae=this.width%2/2,ce=this.height%2/2,oe=Math.cos(this.angle),fe=Math.sin(this.angle),de=Y-Math.round(Y)+oe*ae+fe*ce,ye=J-Math.round(J)+oe*ce+fe*ae,ge=new Float64Array(B);if(a.a6.mat4.translate(ge,ge,[de>.5?de-1:de,ye>.5?ye-1:ye,0]),this.alignedProjMatrix=ge,B=a.a6.mat4.create(),a.a6.mat4.scale(B,B,[this.width/2,-this.height/2,1]),a.a6.mat4.translate(B,B,[1,-1,0]),this.labelPlaneMatrix=B,B=a.a6.mat4.create(),a.a6.mat4.scale(B,B,[1,-1,1]),a.a6.mat4.translate(B,B,[-1,-1,0]),a.a6.mat4.scale(B,B,[2/this.width,2/this.height,1]),this.glCoordMatrix=B,this.pixelMatrix=a.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,L),this._calcFogMatrices(),this._distanceTileDataCache={},B=a.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!B)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=B,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.b$(this);const ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.a6.vec3.transformMat4(ve,ve,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=B;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,f=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,v=[n,n,l];a.a6.vec3.scale(v,v,_),a.a6.vec3.scale(f,f,-1),a.a6.vec3.multiply(f,f,v);const x=a.a6.mat4.create();a.a6.mat4.translate(x,x,f),a.a6.mat4.scale(x,x,v),this.mercatorFogMatrix=x,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,l,_)}_computeCameraPosition(n){const l=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),_=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-n/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-f[0]*v,_.y/this.worldSize-f[1]*v,n/this.worldSize*this._centerAltitude-f[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],_=n[2];let v=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(v=Math.min((l-f)/_,1)),this._camera.position=a.a6.vec3.scaleAndAdd([],this._camera.position,n,v),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,l=this._camera.forward(),{pitch:f,bearing:_}=this._camera.getPitchBearing(),v=a.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,x=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.bB(this._maxPitch)),C=Math.max((n[2]-v)/Math.cos(f),x),D=this._zoomFromMercatorZ(C);a.a6.vec3.scaleAndAdd(n,n,l,C),this._pitch=a.ap(f,a.bB(this.minPitch),a.bB(this.maxPitch)),this.angle=a.bA(_,-Math.PI,Math.PI),this._setZoom(a.ap(D,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.a5(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}zoomFromMercatorZAdjusted(n){let l=0,f=a.bU,_=0,v=1/0;for(;f-l>1e-6&&f>l;){const x=l+.5*(f-l),C=this.tileSize*Math.pow(2,x),D=this.getCameraToCenterDistance(this.projection,x,C),L=this.scaleZoom(D/(n*this.tileSize)),B=Math.abs(x-L);B<v&&(v=B,_=x),x<L?l=x:f=x}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,l){const f=Math.min(n.x,l.x),_=Math.max(n.x,l.x),v=Math.min(n.y,l.y),x=Math.max(n.y,l.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const C=[new a.P(f,v),new a.P(_,x),new a.P(f,x),new a.P(_,v)],D=this.renderWorldCopies?-3:0,L=this.renderWorldCopies?4:1;for(const B of C){const $=this.pointRayIntersection(B);if($.t<0)return!0;const j=this.rayIntersectionCoordinate($);if(j.x<D||j.y<0||j.x>L||j.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(n,l){const f=a.a6.vec3.length(a.a6.vec3.sub([],this._camera.position,n)),_=this._zoomFromMercatorZ(f)+l;return f-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([l,f,_],v){const x=[l,f,_,1];a.a6.vec4.transformMat4(x,x,v);const C=x[3]=Math.max(x[3],1e-6);return x[0]/=C,x[1]/=C,x[2]/=C,x}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,n))}}getCameraToCenterDistance(n,l=this.zoom,f=this.worldSize){const _=a.bX(n,l,this.width,this.height,1024),v=n.pixelSpaceConversion(this.center.lat,f,_);let x=.5/Math.tan(.5*this._fov)*this.height*v;return this.isOrthographic&&(x=tu(1,x,ru(this.pitch>=15?1:this.pitch/15))),x}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.a6.mat4.multiply(n,n,this.globeMatrix),n}getFrustum(n){return a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const Na=(d,n)=>{if(n>0&&d.terrain&&a.w("Cutoff is currently disabled on terrain"),n<=0||d.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=d.transform,f=Math.max(Math.abs(l._zoom-(d.minCutoffZoom-1)),1),_=l.isLODDisabled(!1)?a.a7(60,45,l.pitch):a.a7(30,15,l.pitch),v=l._farZ-l._nearZ,x=n*l.height,C=((1-(D=_))*l.cameraToCenterDistance+D*(l._farZ+x))*f;var D;return{shouldRenderCutoff:_<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(C-l._nearZ)/v,(C-x-l._nearZ)/v]}}},Ji={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Em{constructor(n,l){this.aabb=n,this.lastCascade=l}}class It{add(n,l){const f=this.receivers[n.key];f!==void 0?(f.aabb.min[0]=Math.min(f.aabb.min[0],l.min[0]),f.aabb.min[1]=Math.min(f.aabb.min[1],l.min[1]),f.aabb.min[2]=Math.min(f.aabb.min[2],l.min[2]),f.aabb.max[0]=Math.max(f.aabb.max[0],l.max[0]),f.aabb.max[1]=Math.max(f.aabb.max[1],l.max[1]),f.aabb.max[2]=Math.max(f.aabb.max[2],l.max[2])):this.receivers[n.key]=new Em(l,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,l,f){const _=a.c9.fromPoints(n.points);let v=0;for(const x in this.receivers){const C=this.receivers[x];if(!C||!_.intersectsAabb(C.aabb))continue;C.aabb.min=_.closestPoint(C.aabb.min),C.aabb.max=_.closestPoint(C.aabb.max);const D=C.aabb.getCorners();for(let L=0;L<f.length;L++){let B=!0;for(const $ of D){const j=[$[0]*l,$[1]*l,$[2]];if(a.a6.vec3.transformMat4(j,j,f[L].matrix),j[0]<-1||j[0]>1||j[1]<-1||j[1]>1){B=!1;break}}if(C.lastCascade=L,v=Math.max(v,L),B)break}}return v+1}}class Uy{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new It,this._depthMode=new Qt(n.context.gl.LEQUAL,Qt.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),n.tp.registerParameter(Ji,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(Ji,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(Ji,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,l){const f=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const _=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||_<=0||(this._shadowLayerCount=f.style.order.reduce((Z,X)=>{const Y=f.style._mergedLayers[X];return Z+(Y.hasShadowPass()&&!Y.isHidden(n.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const v=f.context,x=Ji.shadowMapResolution,C=Ji.shadowMapResolution;if(this._cascades.length===0||Ji.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let Z=0;Z<Ji.cascadeCount;++Z){const X=f._shadowMapDebug,Y=v.gl,J=v.createFramebuffer(x,C,X,"texture"),ae=new a.T(v,{width:x,height:C,data:null},Y.DEPTH_COMPONENT16);if(J.depthAttachment.set(ae.texture),X){const ce=new a.T(v,{width:x,height:C,data:null},Y.RGBA8);J.colorAttachment.set(ce.texture)}this._cascades.push({framebuffer:J,texture:ae,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.bN,scale:0})}}this.shadowDirection=df(l);let D=0;if(n.elevation){const Z=n.elevation,X=[1e4,-1e4];Z.visibleDemTiles.filter(Y=>Y.dem).forEach(Y=>{const J=Y.dem.tree;X[0]=Math.min(X[0],J.minimums[0]),X[1]=Math.max(X[1],J.maximums[0])}),X[0]!==1e4&&(D=(X[1]-X[0])*Z.exaggeration())}const L=1.5*n.cameraToCenterDistance,B=3*L,$=new Float64Array(16);for(let Z=0;Z<this._cascades.length;++Z){const X=this._cascades[Z];let Y=n.height/50,J=1;Ji.cascadeCount===1?J=B:Z===0?J=L:(Y=L,J=B);const[ae,ce]=pf(n,this.shadowDirection,Y,J,Ji.shadowMapResolution,D);X.scale=n.scale,X.matrix=ae,X.boundingSphereRadius=ce,a.a6.mat4.invert($,X.matrix),X.frustum=a.bN.fromInvProjectionMatrix($,1,0,!0),X.far=J}const j=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[j].far,this._cascades[j].far],this._uniformValues.u_shadow_intensity=_,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ji.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ji.shadowMapResolution,this._uniformValues.u_shadowmap_0=ro.ShadowMap0,this._uniformValues.u_shadowmap_1=ro.ShadowMap0+1,this._groundShadowTiles=f.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const U=f.transform.elevation;for(const Z of this._groundShadowTiles){let X={min:0,max:0};if(U){const Y=U.getMinMaxForTile(Z);Y&&(X=Y)}this.addShadowReceiver(Z.toUnwrapped(),X.min,X.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,l){if(!this.enabled)return;const f=this.painter,_=f.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(f.transform.getFrustum(0),f.transform.worldSize,this._cascades),_.viewport.set([0,0,Ji.shadowMapResolution,Ji.shadowMapResolution]);for(let v=0;v<this._numCascadesToRender;++v){f.currentShadowCascade=v,_.bindFramebuffer.set(this._cascades[v].framebuffer.framebuffer),_.clear({color:a.bz.white,depth:1});for(const x of n.order){const C=n._mergedLayers[x];if(!C.hasShadowPass()||C.isHidden(f.transform.zoom))continue;const D=n.getLayerSourceCache(C),L=D?l[D.id]:void 0;(C.type==="model"||L&&L.length)&&f.renderLayer(f,D,C,L)}}f.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,l=n.style,f=n.context,_=l.directionalLight,v=l.ambientLight;if(!_||!v)return;const x=[],C=Na(n,n.longestCutoffRange);C.shouldRenderCutoff&&x.push("RENDER_CUTOFF");const D=ff(l,_,v),L=new Qt(f.gl.LEQUAL,Qt.ReadOnly,n.depthRangeFor3D);for(const B of this._groundShadowTiles){const $=B.toUnwrapped(),j=n.isTileAffectedByFog(B),U=n.getOrCreateProgram("groundShadow",{defines:x,overrideFog:j});this.setupShadows($,U),n.uploadCommonUniforms(f,U,$,null,C);const Z={u_matrix:n.transform.calculateProjMatrix($),u_ground_shadow_factor:D};U.draw(n,f.gl.TRIANGLES,L,yr.disabled,kr.multiply,lr.disabled,Z,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,{},n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?kr.unblended:kr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const l=this.painter.transform,f=l.calculatePosMatrix(n,l.worldSize);return a.a6.mat4.multiply(f,this._cascades[this.painter.currentShadowCascade].matrix,f),Float32Array.from(f)}calculateShadowPassMatrixFromMatrix(n){return a.a6.mat4.multiply(n,this._cascades[this.painter.currentShadowCascade].matrix,n),Float32Array.from(n)}setupShadows(n,l,f,_=0){if(!this.enabled)return;const v=this.painter.transform,x=this.painter.context,C=x.gl,D=this._uniformValues,L=new Float64Array(16),B=v.calculatePosMatrix(n,v.worldSize);for(let $=0;$<this._cascades.length;$++)a.a6.mat4.multiply(L,this._cascades[$].matrix,B),D[$===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),x.activeTexture.set(C.TEXTURE0+ro.ShadowMap0+$),this._cascades[$].texture.bind(C.NEAREST,C.CLAMP_TO_EDGE);if(this.useNormalOffset=!!f,this.useNormalOffset){const $=a.c8(n.canonical),j=2/v.tileSize*a.ab/Ji.shadowMapResolution,U=j*this._cascades[0].boundingSphereRadius,Z=j*this._cascades[this._cascades.length-1].boundingSphereRadius,X=(f==="vector-tile"?1:3)/Math.pow(2,_-n.canonical.z-(1-v.zoom+Math.floor(v.zoom)));D.u_shadow_normal_offset=[$,U*X,Z*X],D.u_shadow_bias=[6e-5,.0012,.012]}else D.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(x,D)}setupShadowsFromMatrix(n,l,f=!1){if(!this.enabled)return;const _=this.painter.context,v=_.gl,x=this._uniformValues,C=new Float64Array(16);for(let D=0;D<Ji.cascadeCount;D++)a.a6.mat4.multiply(C,this._cascades[D].matrix,n),x[D===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(C),_.activeTexture.set(v.TEXTURE0+ro.ShadowMap0+D),this._cascades[D].texture.bind(v.NEAREST,v.CLAMP_TO_EDGE);if(this.useNormalOffset=f,f){const D=Ji.normalOffset;x.u_shadow_normal_offset=[1,D,D],x.u_shadow_bias=[6e-5,.0012,.012]}else x.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(_,x)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,l,f,_){if(_[2]>=0)return{};const v=function(D,L,B){const $=B/(1<<D.canonical.z);return new a.c9([D.canonical.x*$+D.wrap*B,D.canonical.y*$+D.wrap*B,0],[(D.canonical.x+1)*$+D.wrap*B,(D.canonical.y+1)*$+D.wrap*B,L])}(n,l,f).getCorners(),x=l/-_[2];_[0]<0?(a.a6.vec3.add(v[0],v[0],[_[0]*x,0,0]),a.a6.vec3.add(v[3],v[3],[_[0]*x,0,0])):_[0]>0&&(a.a6.vec3.add(v[1],v[1],[_[0]*x,0,0]),a.a6.vec3.add(v[2],v[2],[_[0]*x,0,0])),_[1]<0?(a.a6.vec3.add(v[0],v[0],[0,_[1]*x,0]),a.a6.vec3.add(v[1],v[1],[0,_[1]*x,0])):_[1]>0&&(a.a6.vec3.add(v[2],v[2],[0,_[1]*x,0]),a.a6.vec3.add(v[3],v[3],[0,_[1]*x,0]));const C={};return C.vertices=v,C.planes=[iu(v[1],v[0],v[4]),iu(v[2],v[1],v[5]),iu(v[3],v[2],v[6]),iu(v[0],v[3],v[7])],C}addShadowReceiver(n,l,f){this._receivers.add(n,a.c9.fromTileIdAndHeight(n,l,f))}getMaxCascadeForTile(n){const l=this._receivers.get(n);return l&&l.lastCascade?l.lastCascade:0}}function iu(d,n,l){const f=a.a6.vec3.sub([],l,n),_=a.a6.vec3.sub([],d,n),v=a.a6.vec3.cross([],f,_),x=a.a6.vec3.length(v);return x===0?[0,0,1,0]:(a.a6.vec3.scale(v,v,1/x),[v[0],v[1],v[2],-a.a6.vec3.dot(v,n)])}function df(d){const n=d.properties.get("direction"),l=a.c7(n.x,n.y,n.z);l[2]=a.ap(l[2],0,75);const f=a.ca([l[0],l[1],l[2]]);return a.a6.vec3.fromValues(f.x,f.y,f.z)}function ff(d,n,l){const f=n.properties.get("color"),_=n.properties.get("intensity"),v=n.properties.get("direction"),x=[v.x,v.y,v.z],C=l.properties.get("color"),D=l.properties.get("intensity"),L=Math.max(a.a6.vec3.dot([0,0,1],x),0),B=[0,0,0];a.a6.vec3.scale(B,C.toRenderColor(d.getLut(n.scope)).toArray01Linear().slice(0,3),D);const $=[0,0,0];return a.a6.vec3.scale($,f.toRenderColor(d.getLut(l.scope)).toArray01Linear().slice(0,3),L*_),a.cb([B[0]>0?B[0]/(B[0]+$[0]):0,B[1]>0?B[1]/(B[1]+$[1]):0,B[2]>0?B[2]/(B[2]+$[2]):0])}function pf(d,n,l,f,_,v){const x=d.zoom,C=d.scale,D=d.worldSize,L=1/D,B=d.aspect,$=Math.sqrt(1+B*B)*Math.tan(.5*d.fovX),j=$*$,U=f-l,Z=f+l;let X,Y;j>U/Z?(X=f,Y=f*$):(X=.5*Z*(1+j),Y=.5*Math.sqrt(U*U+2*(f*f+l*l)*j+Z*Z*j*j));const J=d.projection.pixelsPerMeter(d.center.lat,D),ae=d._camera.getCameraToWorldMercator(),ce=[0,0,-X*L];a.a6.vec3.transformMat4(ce,ce,ae);let oe=Y*L;const fe=d._edgeInsets;if(!(fe.left===0&&fe.top===0&&fe.right===0&&fe.bottom===0||fe.left===fe.right&&fe.top===fe.bottom)){const vt=d._camera.getWorldToCamera(d.worldSize,d.projection.zAxisUnit==="meters"?J:1),xt=d._camera.getCameraToClipPerspective(d._fov,d.width/d.height,l,f);xt[8]=2*-d.centerOffset.x/d.width,xt[9]=2*d.centerOffset.y/d.height;const lt=new Float64Array(16);a.a6.mat4.mul(lt,xt,vt);const pt=new Float64Array(16);a.a6.mat4.invert(pt,lt);const Kt=a.bN.fromInvProjectionMatrix(pt,D,x,!0);for(const Ot of Kt.points){const Ft=((de=Ot)[0]/=C,de[1]/=C,de[2]=a.bD(de[2],d._center.lat),de);oe=Math.max(oe,a.a6.vec3.len(a.a6.vec3.subtract([],ce,Ft)))}}var de;oe*=_/(_-1);const ye=Math.acos(n[2]),ge=Math.atan2(-n[0],-n[1]),ve=new rc;ve.position=ce,ve.setPitchBearing(ye,ge);const Ce=ve.getWorldToCamera(D,J),Oe=oe*D,Te=Math.min(d._mercatorZfromZoom(17)*D*-2,-2*Oe),$e=ve.getCameraToClipOrthographic(-Oe,Oe,-Oe,Oe,Te,(Oe+v*J)/n[2]),Je=new Float64Array(16);a.a6.mat4.multiply(Je,$e,Ce);const ct=a.a6.vec3.fromValues(Math.floor(1e6*ce[0])/1e6*D,Math.floor(1e6*ce[1])/1e6*D,0),Ke=.5*_,_t=[0,0,0];a.a6.vec3.transformMat4(_t,ct,Je),a.a6.vec3.scale(_t,_t,Ke);const je=[Math.floor(_t[0]),Math.floor(_t[1]),Math.floor(_t[2])],nt=[0,0,0];a.a6.vec3.sub(nt,_t,je),a.a6.vec3.scale(nt,nt,-1/Ke);const rt=new Float64Array(16);return a.a6.mat4.identity(rt),a.a6.mat4.translate(rt,rt,nt),a.a6.mat4.multiply(Je,rt,Je),[Je,Oe]}class $a extends a.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.numModelsLoading={}}loadModel(n,l){return a.aG(this.requestManager.transformRequest(l,a.R.Model).url).then(f=>{if(!f)return;const _=a.aH(f),v=new a.aI(n,void 0,void 0,_);return v.computeBoundsAndApplyParent(),v}).catch(f=>{if(f&&f.status===404)return null;this.fire(new a.t(new Error(`Could not load model ${n} from ${l}: ${f.message}`)))})}load(n,l){this.models[l]||(this.models[l]={});const f=Object.keys(n);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+f.length;const _=[];for(const v of f)_.push(this.loadModel(v,n[v]));Promise.allSettled(_).then(v=>{for(let x=0;x<v.length;x++){const{status:C,value:D}=v[x];C==="fulfilled"&&D&&(this.models[l][f[x]]={model:D,numReferences:1})}this.numModelsLoading[l]-=f.length,this.fire(new a.x("data",{dataType:"style"}))}).catch(v=>{this.fire(new a.t(new Error(`Could not load models: ${v.message}`)))})}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,l){return!!this.getModel(n,l)}getModel(n,l){return this.models[l]||(this.models[l]={}),this.models[l][n]?this.models[l][n].model:void 0}addModel(n,l,f){this.models[f]||(this.models[f]={}),this.hasModel(n,f)&&this.models[f][n].numReferences++,this.load({[n]:this.requestManager.normalizeModelURL(l)},f)}addModels(n,l){this.models[l]||(this.models[l]={});const f={};for(const _ in n)this.models[l][_]={},f[_]=this.requestManager.normalizeModelURL(n[_]);this.load(f,l)}addModelsFromBucket(n,l){this.models[l]||(this.models[l]={});const f={};for(const _ of n)this.hasModel(_,l)?this.models[l][_].numReferences++:f[_]=this.requestManager.normalizeModelURL(_);this.load(f,l)}removeModel(n,l){if(this.models[l]&&this.models[l][n]&&(this.models[l][n].numReferences--,this.models[l][n].numReferences===0)){const f=this.models[l][n].model;delete this.models[l][n],f.destroy()}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,l){this.models[l]||(this.models[l]={});for(const f in this.models[l])this.models[l][f].model&&this.models[l][f].model.upload(n.context)}}const Sm=new a.a0({data:new a.a1(a._.colorTheme.data)}),Ko=(d,n)=>ke(d,n&&n.filter(l=>l.identifier!=="source.canvas")),mf=a.ar(Qr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),nu=a.ar(Qr,["setCenter","setZoom","setBearing","setPitch"]),Gy={version:8,layers:[],sources:{}},Hy={duration:300,delay:0};class Yo extends a.E{constructor(n,l={}){super(),this.map=n,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=a.l({},Hy),this._buildingIndex=new gm(this),this.crossTileSymbolIndex=new lf,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new Qe,this.dispatcher=l.dispatcher?l.dispatcher:new a.cd(a.ce(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Bt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new a.cf(n._requestManager,l.localFontFamily?a.cg.all:l.localIdeographFontFamily?a.cg.ideographs:a.cg.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new $a(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",a.ch());const f=this;this._rtlTextPluginCallback=Yo.registerForPluginStateChange(_=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(v,x)=>{if(a.ci(v),x&&x.every(C=>C))for(const C in f._sourceCaches){const D=f._sourceCaches[C],L=D.getSource().type;L!=="vector"&&L!=="geojson"||D.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const v=this.getOwnSource(_.sourceId);if(v&&v.vectorLayerIds)for(const x in this._layers){const C=this._layers[x];C.source===v.id&&this._validateLayer(C)}})}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(a.f(n))return n;const l=a.cj(n);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${a.ck(JSON.stringify(n))}`}_diffStyle(n,l,f){this.globalId=this._getGlobalId(n);const _=(v,x)=>{try{x(null,this.setState(v,f))}catch(C){x(C,!1)}};if(typeof n=="string"){const v=this.map._requestManager.normalizeStyleURL(n),x=this.map._requestManager.transformRequest(v,a.R.Style);a.n(x,(C,D)=>{C?this.fire(new a.t(C)):D&&_(D,l)})}else typeof n=="object"&&_(n,l)}loadURL(n,l={}){this.fire(new a.x("dataloading",{dataType:"style"}));const f=typeof l.validate=="boolean"?l.validate:!a.f(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,l.accessToken),this.resolvedImports.add(n);const _=this.importsCache.get(n);if(_)return this._load(_,f);const v=this.map._requestManager.transformRequest(n,a.R.Style);this._request=a.n(v,(x,C)=>{if(this._request=null,x)this.fire(new a.t(x));else if(C)return this.importsCache.set(n,C),this._load(C,f)})}loadJSON(n,l={}){this.fire(new a.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=a.q.frame(()=>{this._request=null,this._load(n,l.validate!==!1)})}loadEmpty(){this.fire(new a.x("dataloading",{dataType:"style"})),this._load(Gy,!1)}_loadImports(n,l,f){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const _=[];for(const v of n){const x=this._createFragmentStyle(v),C=new Promise(B=>{x.once("style.import.load",B),x.once("error",B)}).then(()=>this.mergeAll());if(_.push(C),this.resolvedImports.has(v.url)){x.loadEmpty();continue}const D=v.data||this.importsCache.get(v.url);D?(x.loadJSON(D,{validate:l}),this._isInternalStyle(D)&&(x.globalId=null)):v.url?x.loadURL(v.url,{validate:l}):x.loadEmpty();const L={style:x,id:v.id,config:v.config};if(f){const B=this.fragments.findIndex(({id:$})=>$===f);this.fragments=this.fragments.slice(0,B).concat(L).concat(this.fragments.slice(B))}else this.fragments.push(L)}return Promise.allSettled(_)}getImportGlobalIds(n=this,l=new Set){for(const f of n.fragments)f.style.globalId&&l.add(f.style.globalId),this.getImportGlobalIds(f.style,l);return[...l.values()]}_createFragmentStyle(n){const l=this.scope?a.av(n.id,this.scope):n.id;let f;const _=this._initialConfig&&this._initialConfig[l];(n.config||_)&&(f=a.l({},n.config,_));const v=new Yo(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:f,configOptions:this.options,configDependentLayers:this._configDependentLayers});return v.setEventedParent(this.map,{style:v}),v}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,l){const f=n.schema;if(this._isInternalStyle(n)){const x=a.l({},Gy,{imports:[{id:"basemap",data:n,url:""}]});return void this._load(x,l)}if(this.updateConfig(this._config,f),l&&Ko(this,Wo(n)))return;this._loaded=!0,this.stylesheet=a.cl(n);const _=()=>{for(const L in n.sources)this.addSource(L,n.sources[L],{validate:!1,isInitialLoad:!0});n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(n.glyphs,this.scope);const x=_m(this.stylesheet.layers);if(this._order=x.map(L=>L.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const L=this.stylesheet.lights[0];this.light=new Ve(L.properties,L.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ve(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const L of x){const B=a.cq(L,this.scope,this._styleColorTheme.lut,this.options);B.configDependencies.size!==0&&this._configDependentLayers.add(B.fqid),B.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=B,this._serializedLayers[B.id]=B.serialize();const $=this.getOwnLayerSourceCache(B),j=!!this.directionalLight&&this.directionalLight.shadowsEnabled();$&&B.canCastShadows()&&j&&($.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const C=this.stylesheet.terrain;C&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(C,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.x("data",{dataType:"style"}));const D=this.isRootStyle();n.imports?this._loadImports(n.imports,l).then(()=>{this._reloadImports(),this.fire(new a.x(D?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.x(D?"style.load":"style.import.load")))},v=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=v,v){const x=this._evaluateColorThemeData(v);this._loadColorTheme(x).then(()=>{_()}).catch(C=>{a.w(`Couldn't load color theme from the stylesheet: ${C}`),_()})}else this._styleColorTheme.lut=null,_()}isRootStyle(){return this.importDepth===0}mergeAll(){let n,l,f,_,v,x,C,D;const L={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(B=>{if(B.stylesheet){if(B.light!=null&&(n=B.light),B.stylesheet.lights)for(const $ of B.stylesheet.lights)$.type==="ambient"&&B.ambientLight!=null&&(l=B.ambientLight),$.type==="directional"&&B.directionalLight!=null&&(f=B.directionalLight);_=this._prioritizeTerrain(_,B.terrain,B.stylesheet.terrain),B.stylesheet.fog&&B.fog!=null&&(v=B.fog),B.stylesheet.camera!=null&&(D=B.stylesheet.camera),B.stylesheet.projection!=null&&(x=B.stylesheet.projection),B.stylesheet.transition!=null&&(C=B.stylesheet.transition),L[B.scope]=B._styleColorTheme}}),this.light=n,this.ambientLight=l,this.directionalLight=f,this.fog=v,this._styleColorThemeForScope=L,_===null?delete this.terrain:this.terrain=_,this.camera=D||{"camera-projection":"perspective"},this.projection=x||{name:"mercator"},this.transition=a.l({},Hy,C),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(n){const l=f=>{for(const _ of f.fragments)l(_.style);n(f)};l(this)}_prioritizeTerrain(n,l,f){const _=n&&n.drapeRenderMode===0;return f===null?l&&l.drapeRenderMode===0?l:_?n:null:l!=null&&(!n||_||l&&l.drapeRenderMode===1)?l:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{n=this._prioritizeTerrain(n,l.terrain,l.stylesheet.terrain)}),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(n=l.stylesheet.projection)}),this.projection=n||{name:"mercator"}}mergeSources(){const n={},l={},f={};this.forEachFragmentStyle(_=>{for(const v in _._sourceCaches){const x=a.av(v,_.scope);n[x]=_._sourceCaches[v]}for(const v in _._otherSourceCaches){const x=a.av(v,_.scope);l[x]=_._otherSourceCaches[v]}for(const v in _._symbolSourceCaches){const x=a.av(v,_.scope);f[x]=_._symbolSourceCaches[v]}}),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=f}mergeLayers(){const n={},l=[],f={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(v=>{for(const x of v._order){const C=v._layers[x];if(C.type==="slot"){const D=a.cm(x);if(n[D])continue;n[D]=[]}C.slot&&n[C.slot]?n[C.slot].push(C):l.push(C)}}),this._mergedOrder=[];const _=(v=[])=>{for(const x of v)if(x.type==="slot"){const C=a.cm(x.id);n[C]&&_(n[C]),this._mergedSlots.push(C)}else{const C=a.av(x.id,x.scope);this._mergedOrder.push(C),f[C]=x,x.is3D()&&(this._has3DLayers=!0),x.type==="circle"&&(this._hasCircleLayers=!0),x.type==="symbol"&&(this._hasSymbolLayers=!0),x.type==="clip"&&(this._clipLayerPresent=!0)}};_(l),this._mergedOrder.sort((v,x)=>{const C=f[v],D=f[x];return C.hasInitialOcclusionOpacityProperties?D.is3D()?1:0:C.is3D()&&D.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=f,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=a.l({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?function(l,f,_){const v=a.l({},f);for(const C of Object.keys(a._.colorTheme))v[C]===void 0&&(v[C]=a._.colorTheme[C].default);const x=new a.$(Sm,l,new Map(_));return x.setTransitionOrValue(v,_),x.untransitioned().possiblyEvaluate(new a.a3(0))}(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((f,_)=>{const v="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void f();let x=n;x.startsWith(v)||(x=v+x);const C="mapbox-reserved-lut",D=new Image;D.src=x,D.onerror=()=>{this._styleColorTheme.lutLoading=!1,_(new Error("Failed to load image data"))},D.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void f();this._styleColorTheme.lutLoading=!1;const{width:L,height:B,data:$}=a.q.getImageData(D);if(B>32)return void _(new Error("The height of the image must be less than or equal to 32 pixels."));if(L!==B*B)return void _(new Error("The width of the image must be equal to the height squared."));this.getImage(C)&&this.removeImage(C),this.addImage(C,{data:new a.r({width:L,height:B},$),pixelRatio:1,sdf:!1,version:0});const j=this.imageManager.getImage(C,this.scope);j?(this._styleColorTheme.lut={image:j.data,data:n},f()):_(new Error("Missing LUT image."))}})}getLut(n){const l=this._styleColorThemeForScope[n];return l?l.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=function(l,f,_){let v,x,C;const D=a.q.devicePixelRatio>1?"@2x":"";let L=a.n(f.transformRequest(f.normalizeSpriteURL(l,D,".json"),a.R.SpriteJSON),(j,U)=>{L=null,C||(C=j,v=U,$())}),B=a.o(f.transformRequest(f.normalizeSpriteURL(l,D,".png"),a.R.SpriteImage),(j,U)=>{B=null,C||(C=j,x=U,$())});function $(){if(C)_(C);else if(v&&x){const j=a.q.getImageData(x),U={};for(const Z in v){const{width:X,height:Y,x:J,y:ae,sdf:ce,pixelRatio:oe,stretchX:fe,stretchY:de,content:ye}=v[Z],ge=new a.r({width:X,height:Y});a.r.copy(j,ge,{x:J,y:ae},{x:0,y:0},{width:X,height:Y},null),U[Z]={data:ge,pixelRatio:oe,sdf:ce,stretchX:fe,stretchY:de,content:ye}}_(null,U)}}return{cancel(){L&&(L.cancel(),L=null),B&&(B.cancel(),B=null)}}}(n,this.map._requestManager,(l,f)=>{if(this._spriteRequest=null,l)this.fire(new a.t(l));else if(f)for(const _ in f)this.imageManager.addImage(_,this.scope,f[_]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.x("data",{dataType:"style"}))})}_validateLayer(n){const l=this.getOwnSource(n.source);if(!l)return;const f=n.sourceLayer;f&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(f)===-1)&&this.fire(new a.t(new Error(`Source layer "${f}" does not exist on source "${l.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((n,l)=>{const f=this.fragments[l];return f&&f.style&&(n.data=f.style.serialize()),n})}_serializeSources(){const n={};for(const l in this._sourceCaches){const f=this._sourceCaches[l].getSource();n[f.id]||(n[f.id]=f.serialize())}return n}_serializeLayers(n){const l=[];for(const f of n){const _=this._layers[f];_&&_.type!=="custom"&&l.push(_.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const l=this.getOwnLayer(n);if(l)return l;this.fire(new a.t(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const l=this.getOwnSource(n);if(l)return l;this.fire(new a.t(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,l){const f=this.map.painter;if(f)for(let _=n.minzoom||0;_<(n.maxzoom||25.5);_++){const v=n.getProgramIds();if(v)for(const x of v){const C=n.getDefaultProgramParams(x,l.zoom,this._styleColorTheme.lut);C&&(f.style=this,this.fog&&(f._fogVisible=!0,C.overrideFog=!0,f.getOrCreateProgram(x,C)),f._fogVisible=!1,C.overrideFog=!1,f.getOrCreateProgram(x,C),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(C.overrideRtt=!0,f.getOrCreateProgram(x,C)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const l=this.calculateLightsBrightness();n.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const f=this._changes.isDirty();let _=!1;if(this._changes.isDirty()){const x=this._changes.getLayerUpdatesByScope();for(const C in x){const{updatedIds:D,removedIds:L}=x[C];(D||L)&&(this._updateWorkerLayers(C,D,L),_=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._changes.reset()}const v={};for(const x in this._mergedSourceCaches){const C=this._mergedSourceCaches[x];v[x]=C.used,C.used=!1,C.tileCoverLift=0}for(const x of this._mergedOrder){const C=this._mergedLayers[x];if(C.recalculate(n,this._availableImages),!C.isHidden(n.zoom)){const D=this.getLayerSourceCache(C);D&&(D.used=!0,D.tileCoverLift=Math.max(D.tileCoverLift,C.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(C,n)}):this.precompilePrograms(C,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&_&&this.mergeLayers();for(const x in v){const C=this._mergedSourceCaches[x];v[x]!==C.used&&C.getSource().fire(new a.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new a.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=this._changes.getUpdatedImages();if(n.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n);this._changes.resetUpdatedImages()}}_updateWorkerLayers(n,l,f){const _=this.getFragmentStyle(n);_&&this.dispatcher.broadcast("updateLayers",{layers:l?_._serializeLayers(l):[],scope:n,removedIds:f||[],options:_.options})}setState(n,l){if(this._checkLoaded(),Ko(this,Wo(n)))return!1;(n=a.cl(n)).layers=_m(n.layers);const f=function(x,C){if(!x)return[{command:Qr.setStyle,args:[C]}];let D=[];try{if(!a.bh(x.version,C.version))return[{command:Qr.setStyle,args:[C]}];if(a.bh(x.center,C.center)||D.push({command:Qr.setCenter,args:[C.center]}),a.bh(x.zoom,C.zoom)||D.push({command:Qr.setZoom,args:[C.zoom]}),a.bh(x.bearing,C.bearing)||D.push({command:Qr.setBearing,args:[C.bearing]}),a.bh(x.pitch,C.pitch)||D.push({command:Qr.setPitch,args:[C.pitch]}),a.bh(x.sprite,C.sprite)||D.push({command:Qr.setSprite,args:[C.sprite]}),a.bh(x.glyphs,C.glyphs)||D.push({command:Qr.setGlyphs,args:[C.glyphs]}),a.bh(x.imports,C.imports)||function(U=[],Z=[],X){Z=Z||[];const Y=(U=U||[]).map(Jl),J=Z.map(Jl),ae=U.reduce(qc,{}),ce=Z.reduce(qc,{}),oe=Y.slice();let fe,de,ye,ge;for(fe=0,de=0;fe<Y.length;fe++)ye=Y[fe],ce.hasOwnProperty(ye)?de++:(X.push({command:Qr.removeImport,args:[ye]}),oe.splice(oe.indexOf(ye,de),1));for(fe=0,de=0;fe<J.length;fe++)ye=J[J.length-1-fe],oe[oe.length-1-fe]!==ye&&(ae.hasOwnProperty(ye)?(X.push({command:Qr.removeImport,args:[ye]}),oe.splice(oe.lastIndexOf(ye,oe.length-de),1)):de++,ge=oe[oe.length-fe],X.push({command:Qr.addImport,args:[ce[ye],ge]}),oe.splice(oe.length-fe,0,ye));for(const ve of Z){const Ce=ae[ve.id];Ce&&!a.bh(Ce,ve)&&X.push({command:Qr.updateImport,args:[ve.id,ve]})}}(x.imports,C.imports,D),a.bh(x.transition,C.transition)||D.push({command:Qr.setTransition,args:[C.transition]}),a.bh(x.light,C.light)||D.push({command:Qr.setLight,args:[C.light]}),a.bh(x.fog,C.fog)||D.push({command:Qr.setFog,args:[C.fog]}),a.bh(x.projection,C.projection)||D.push({command:Qr.setProjection,args:[C.projection]}),a.bh(x.lights,C.lights)||D.push({command:Qr.setLights,args:[C.lights]}),a.bh(x.camera,C.camera)||D.push({command:Qr.setCamera,args:[C.camera]}),!a.bh(x["color-theme"],C["color-theme"]))return[{command:Qr.setStyle,args:[C]}];const L={},B=[];(function(U,Z,X,Y){let J;for(J in Z=Z||{},U=U||{})U.hasOwnProperty(J)&&(Z.hasOwnProperty(J)||li(J,X,Y));for(J in Z){if(!Z.hasOwnProperty(J))continue;const ae=Z[J];U.hasOwnProperty(J)?a.bh(U[J],ae)||(U[J].type==="geojson"&&ae.type==="geojson"&&nr(U,Z,J)?X.push({command:Qr.setGeoJSONSourceData,args:[J,ae.data]}):N1(J,Z,X,Y)):ym(J,Z,X)}})(x.sources,C.sources,B,L);const $=[];x.layers&&x.layers.forEach(U=>{U.source&&L[U.source]?D.push({command:Qr.removeLayer,args:[U.id]}):$.push(U)});let j=x.terrain;j&&L[j.source]&&(D.push({command:Qr.setTerrain,args:[void 0]}),j=void 0),D=D.concat(B),a.bh(j,C.terrain)||D.push({command:Qr.setTerrain,args:[C.terrain]}),function(U,Z,X){Z=Z||[];const Y=(U=U||[]).map(Jl),J=Z.map(Jl),ae=U.reduce(qc,{}),ce=Z.reduce(qc,{}),oe=Y.slice(),fe=Object.create(null);let de,ye,ge,ve,Ce,Oe,Te;for(de=0,ye=0;de<Y.length;de++)ge=Y[de],ce.hasOwnProperty(ge)?ye++:(X.push({command:Qr.removeLayer,args:[ge]}),oe.splice(oe.indexOf(ge,ye),1));for(de=0,ye=0;de<J.length;de++)ge=J[J.length-1-de],oe[oe.length-1-de]!==ge&&(ae.hasOwnProperty(ge)?(X.push({command:Qr.removeLayer,args:[ge]}),oe.splice(oe.lastIndexOf(ge,oe.length-ye),1)):ye++,Oe=oe[oe.length-de],X.push({command:Qr.addLayer,args:[ce[ge],Oe]}),oe.splice(oe.length-de,0,ge),fe[ge]=!0);for(de=0;de<J.length;de++)if(ge=J[de],ve=ae[ge],Ce=ce[ge],!fe[ge]&&!a.bh(ve,Ce))if(a.bh(ve.source,Ce.source)&&a.bh(ve["source-layer"],Ce["source-layer"])&&a.bh(ve.type,Ce.type)){for(Te in xh(ve.layout,Ce.layout,X,ge,null,Qr.setLayoutProperty),xh(ve.paint,Ce.paint,X,ge,null,Qr.setPaintProperty),a.bh(ve.slot,Ce.slot)||X.push({command:Qr.setSlot,args:[ge,Ce.slot]}),a.bh(ve.filter,Ce.filter)||X.push({command:Qr.setFilter,args:[ge,Ce.filter]}),a.bh(ve.minzoom,Ce.minzoom)&&a.bh(ve.maxzoom,Ce.maxzoom)||X.push({command:Qr.setLayerZoomRange,args:[ge,Ce.minzoom,Ce.maxzoom]}),ve)ve.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&Te!=="slot"&&(Te.indexOf("paint.")===0?xh(ve[Te],Ce[Te],X,ge,Te.slice(6),Qr.setPaintProperty):a.bh(ve[Te],Ce[Te])||X.push({command:Qr.setLayerProperty,args:[ge,Te,Ce[Te]]}));for(Te in Ce)Ce.hasOwnProperty(Te)&&!ve.hasOwnProperty(Te)&&Te!=="layout"&&Te!=="paint"&&Te!=="filter"&&Te!=="metadata"&&Te!=="minzoom"&&Te!=="maxzoom"&&Te!=="slot"&&(Te.indexOf("paint.")===0?xh(ve[Te],Ce[Te],X,ge,Te.slice(6),Qr.setPaintProperty):a.bh(ve[Te],Ce[Te])||X.push({command:Qr.setLayerProperty,args:[ge,Te,Ce[Te]]}))}else X.push({command:Qr.removeLayer,args:[ge]}),Oe=oe[oe.lastIndexOf(ge)+1],X.push({command:Qr.addLayer,args:[Ce,Oe]})}($,C.layers,D)}catch(L){console.warn("Unable to compute style diff:",L),D=[{command:Qr.setStyle,args:[C]}]}return D}(this.serialize(),n).filter(x=>!(x.command in nu));if(f.length===0)return!1;const _=f.filter(x=>!(x.command in mf));if(_.length>0)throw new Error(`Unimplemented: ${_.map(x=>x.command).join(", ")}.`);const v=[];return f.forEach(x=>{v.push(this[x.command].apply(this,x.args))}),l&&Promise.all(v).then(l),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(n,l){return this.getImage(n)?this.fire(new a.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,this.scope,l),this._afterImageUpdated(n),this)}updateImage(n,l){this.imageManager.updateImage(n,this.scope,l)}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._afterImageUpdated(n),this):this.fire(new a.t(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(n),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(n,l,f={}){return this._checkLoaded(),this._validate(Se,`models.${n}`,l,null,f)||(this.modelManager.addModel(n,l,this.scope),this._changes.setDirty()),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope),this):this.fire(new a.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,l,f={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Kl,`sources.${n}`,l,null,f))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const _=Vc(n,l,this.dispatcher,this);_.scope=this.scope,_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(_.id),source:_.serialize(),sourceId:_.id}));const v=x=>{const C=(x?"symbol:":"other:")+_.id,D=a.av(C,this.scope),L=this._sourceCaches[C]=new Bo(D,_,x);(x?this._symbolSourceCaches:this._otherSourceCaches)[_.id]=L,L.onAdd(this.map)};v(!1),l.type!=="vector"&&l.type!=="geojson"||v(!0),_.onAdd&&_.onAdd(this.map),f.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const l=this.getOwnSource(n);if(!l)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===n)return this.fire(new a.t(new Error(`Source "${n}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new a.t(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const f=this.getOwnSourceCaches(n);for(const _ of f){const v=a.cm(_.id);delete this._sourceCaches[v],this._changes.discardSourceCacheUpdate(_.id),_.fire(new a.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,l){this._checkLoaded(),this.getOwnSource(n).setData(l),this._changes.setDirty()}getOwnSource(n){const l=this.getOwnSourceCache(n);return l&&l.getSource()}getOwnSources(){const n=[];for(const l in this._otherSourceCaches){const f=this.getOwnSourceCache(l);f&&n.push(f.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const l in n){const f=n[l]._tiles;for(const _ in f){const v=f[_];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const _ of n){if(this._validate($c,"lights",_))return;switch(_.type){case"ambient":if(this.ambientLight){const v=this.ambientLight;v.set(_),v.updateTransitions(l)}else this.ambientLight=new pi(_,Or||(Or=new a.a0({color:new a.a1(a._.properties_light_ambient.color),intensity:new a.a1(a._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const v=this.directionalLight;v.set(_),v.updateTransitions(l)}else this.directionalLight=new pi(_,di||(di=new a.a0({direction:new a.ad(a._.properties_light_directional.direction),color:new a.a1(a._.properties_light_directional.color),intensity:new a.a1(a._.properties_light_directional.intensity),"cast-shadows":new a.a1(a._.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.a1(a._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const f=new a.a3(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(f),this.directionalLight&&this.directionalLight.recalculate(f),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,l=this.ambientLight;if(!n||!l)return;const f=$=>.2126*($[0]<=.03928?$[0]/12.92:Math.pow(($[0]+.055)/1.055,2.4))+.7152*($[1]<=.03928?$[1]/12.92:Math.pow(($[1]+.055)/1.055,2.4))+.0722*($[2]<=.03928?$[2]/12.92:Math.pow(($[2]+.055)/1.055,2.4)),_=n.properties.get("color").toRenderColor(null).toArray01(),v=n.properties.get("intensity"),x=n.properties.get("direction"),C=1-a.c7(x.x,x.y,x.z)[2]/90,D=f(_)*v*C,L=l.properties.get("color").toRenderColor(null).toArray01(),B=l.properties.get("intensity");return(D+f(L)*B)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(!n)return this;if(a.cn(n)){const l=a.co(n),f=this.fragments.find(({id:v})=>v===l);if(!f)throw new Error(`Style import not found: ${n}`);const _=a.cm(n);return f.style.getFragmentStyle(_)}{const l=this.fragments.find(({id:f})=>f===n);if(!l)throw new Error(`Style import not found: ${n}`);return l.style}}getConfigProperty(n,l){const f=this.getFragmentStyle(n);if(!f)return null;const _=a.av(l,f.scope),v=f.options.get(_),x=v?v.value||v.default:null;return x?x.serialize():null}setConfigProperty(n,l,f){const _=this.getFragmentStyle(n);if(!_)return;const v=_.stylesheet.schema;if(!v||!v[l])return;const x=a.M(f);if(x.result!=="success")return void Ko(this,x.value);const C=x.value.expression,D=a.av(l,_.scope),L=_.options.get(D);if(!L)return;let B;const{minValue:$,maxValue:j,stepValue:U,type:Z,values:X}=v[l],Y=a.M(v[l].default);Y.result==="success"&&(B=Y.value.expression),B?(this.options.set(D,{...L,value:C,default:B,minValue:$,maxValue:j,stepValue:U,type:Z,values:X}),this.updateConfigDependencies(l)):this.fire(new a.t(new Error(`No schema defined for the config option "${l}" in the "${n}" fragment.`)))}getConfig(n){const l=this.getFragmentStyle(n);if(!l)return null;const f=l.stylesheet.schema;if(!f)return null;const _={};for(const v in f){const x=a.av(v,l.scope),C=l.options.get(x),D=C?C.value||C.default:null;_[v]=D?D.serialize():null}return _}setConfig(n,l){const f=this.getFragmentStyle(n);f&&(f.updateConfig(l,f.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const l=this.getFragmentStyle(n);return l?l.stylesheet.schema:null}setSchema(n,l){const f=this.getFragmentStyle(n);f&&(f.stylesheet.schema=l,f.updateConfig(f._config,l),this.updateConfigDependencies())}updateConfig(n,l){if(this._config=n,n||l)if(l)for(const f in l){let _,v;const x=a.M(l[f].default);if(x.result==="success"&&(_=x.value.expression),n&&n[f]!==void 0){const j=a.M(n[f]);j.result==="success"&&(v=j.value.expression)}const{minValue:C,maxValue:D,stepValue:L,type:B,values:$}=l[f];if(_){const j=a.av(f,this.scope);this.options.set(j,{default:_,value:v,minValue:C,maxValue:D,stepValue:L,type:B,values:$})}else this.fire(new a.t(new Error(`No schema defined for config option "${f}".`)))}else this.fire(new a.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(n){for(const l of this._configDependentLayers){const f=this.getLayer(l);if(f){if(n&&!f.configDependencies.has(n))continue;f.possiblyEvaluateVisibility(),this._updateLayer(f)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(l=>{if(l._styleColorTheme.colorTheme){const f=l._evaluateColorThemeData(l._styleColorTheme.colorTheme);(!l._styleColorTheme.lut&&f!==""||l._styleColorTheme.lut&&f!==l._styleColorTheme.lut.data)&&l.setColorTheme(l._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(n,l,f={}){this._checkLoaded();const _=n.id;if(this._layers[_])return void this.fire(new a.t(new Error(`Layer with id "${_}" already exists on this map`)));let v;if(n.type==="custom"){if(Ko(this,a.cp(n)))return;v=a.cq(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(_,n.source),n=a.cl(n),n=a.l(n,{source:_})),this._validate(qe,`layers.${_}`,n,{arrayIndex:-1},f))return;v=a.cq(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(v),v.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[v.id]=v.serialize()}v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid);let x=this._order.length;if(l){const B=this._order.indexOf(l);if(B===-1)return void this.fire(new a.t(new Error(`Layer with id "${l}" does not exist on this map.`)));v.slot===this._layers[l].slot?x=B:a.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(x,0,_),this._layerOrderChanged=!0,this._layers[_]=v;const C=this.getOwnLayerSourceCache(v),D=!!this.directionalLight&&this.directionalLight.shadowsEnabled();C&&v.canCastShadows()&&D&&(C.castsShadows=!0);const L=this._changes.getRemovedLayer(v);if(L&&v.source&&C&&v.type!=="custom"){this._changes.discardLayerRemoval(v);const B=a.av(v.source,v.scope);L.type!==v.type?this._changes.updateSourceCache(B,"clear"):(this._changes.updateSourceCache(B,"reload"),C.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),v.scope=this.scope,this.mergeLayers()}moveLayer(n,l){this._checkLoaded();const f=this._checkLayer(n);if(!f||n===l)return;const _=this._order.indexOf(n);this._order.splice(_,1);let v=this._order.length;if(l){const x=this._order.indexOf(l);if(x===-1)return void this.fire(new a.t(new Error(`Layer with id "${l}" does not exist on this map.`)));f.slot===this._layers[l].slot?v=x:a.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(v,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const l=this._checkLayer(n);if(!l)return;l.setEventedParent(null);const f=this._order.indexOf(n);this._order.splice(f,1),delete this._layers[n],delete this._serializedLayers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const _=this.getOwnLayerSourceCache(l);if(_&&_.castsShadows){let v=!1;for(const x in this._layers)if(this._layers[x].source===l.source&&this._layers[x].canCastShadows()){v=!0;break}_.castsShadows=v}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const l in this._layers)if(this._layers[l].type===n)return!0;return!1}setLayerZoomRange(n,l,f){this._checkLoaded();const _=this._checkLayer(n);_&&(_.minzoom===l&&_.maxzoom===f||(l!=null&&(_.minzoom=l),f!=null&&(_.maxzoom=f),this._updateLayer(_)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,l){this._checkLoaded();const f=this._checkLayer(n);f&&f.slot!==l&&(f.slot=l,this._updateLayer(f))}setFilter(n,l,f={}){this._checkLoaded();const _=this._checkLayer(n);if(_&&!a.bh(_.filter,l))return l==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(Q,`layers.${_.id}.filter`,l,{layerType:_.type},f)||(_.filter=a.cl(l),this._updateLayer(_)))}getFilter(n){const l=this._checkLayer(n);if(l)return a.cl(l.filter)}setLayoutProperty(n,l,f,_={}){this._checkLoaded();const v=this._checkLayer(n);if(v&&!a.bh(v.getLayoutProperty(l),f)){if(f!=null&&(!_||_.validate!==!1)&&Ko(v,pe.call(Wo,{key:`layers.${n}.layout.${l}`,layerType:v.type,objectKey:l,value:f,styleSpec:a._,style:{glyphs:!0,sprite:!0}})))return;v.setLayoutProperty(l,f),v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),this._updateLayer(v)}}getLayoutProperty(n,l){const f=this._checkLayer(n);if(f)return f.getLayoutProperty(l)}setPaintProperty(n,l,f,_={}){this._checkLoaded();const v=this._checkLayer(n);if(!v||a.bh(v.getPaintProperty(l),f)||f!=null&&(!_||_.validate!==!1)&&Ko(v,re.call(Wo,{key:`layers.${n}.paint.${l}`,layerType:v.type,objectKey:l,value:f,styleSpec:a._})))return;const x=v.setPaintProperty(l,f);v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),x&&this._updateLayer(v),this._changes.updatePaintProperties(v)}getPaintProperty(n,l){const f=this._checkLayer(n);if(f)return f.getPaintProperty(l)}setFeatureState(n,l){this._checkLoaded();const f=n.source,_=n.sourceLayer,v=this._checkSource(f);if(!v)return;const x=v.type;if(x==="geojson"&&_)return void this.fire(new a.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(x==="vector"&&!_)return void this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new a.t(new Error("The feature id parameter must be provided.")));const C=this.getOwnSourceCaches(f);for(const D of C)D.setFeatureState(_,n.id,l)}removeFeatureState(n,l){this._checkLoaded();const f=n.source,_=this._checkSource(f);if(!_)return;const v=_.type,x=v==="vector"?n.sourceLayer:void 0;if(v==="vector"&&!x)return void this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new a.t(new Error("A feature id is required to remove its specific state property.")));const C=this.getOwnSourceCaches(f);for(const D of C)D.removeFeatureState(x,n.id,l)}getFeatureState(n){this._checkLoaded();const l=n.source,f=n.sourceLayer,_=this._checkSource(l);if(_){if(_.type!=="vector"||f)return n.id===void 0&&this.fire(new a.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(f,n.id);this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=a.l({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return a.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),l=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return a.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(n){this._changes.updateLayer(n);const l=this.getLayerSourceCache(n),f=a.av(n.source,n.scope),_=this._changes.getUpdatedSourceCaches();n.source&&!_[f]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(f,"reload"),l.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const l=C=>this._mergedLayers[C].is3D(),f=this.order,_={},v=[];for(let C=f.length-1;C>=0;C--){const D=f[C];if(l(D)){_[D]=C;for(const L of n){const B=L[D];if(B)for(const $ of B)v.push($)}}}v.sort((C,D)=>D.intersectionZ-C.intersectionZ);const x=[];for(let C=f.length-1;C>=0;C--){const D=f[C];if(l(D))for(let L=v.length-1;L>=0;L--){const B=v[L].feature;if(B.layer&&_[B.layer.id]<C)break;x.push(B),v.pop()}else for(const L of n){const B=L[D];if(B)for(const $ of B)x.push($.feature)}}return x}queryRenderedFeatures(n,l,f){l&&l.filter&&this._validate(Q,"queryRenderedFeatures.filter",l.filter,null,l),l.scope=this.scope,l.availableImages=this._availableImages,l.serializedLayers=this._serializedLayers;const _={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new a.t(new Error("parameters.layers must be an Array."))),[];for(const L of l.layers){const B=this._mergedLayers[L];if(!B)return this.fire(new a.t(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];_[B.source]=!0}}const v=[],x=l.serializedLayers||{},C=l&&l.layers?l.layers.some(L=>{const B=this.getLayer(L);return B&&B.is3D()}):this.has3DLayers(),D=Wi.createFromScreenPoints(n,f);for(const L in this._mergedSourceCaches){const B=this._mergedSourceCaches[L].getSource();if(!B||B.scope!==l.scope)continue;const $=this._mergedSourceCaches[L].getSource().id;l.layers&&!_[$]||v.push(fm(this._mergedSourceCaches[L],this._mergedLayers,x,D,l,f,C,!!this.map._showQueryGeometry))}return this.placement&&v.push(function(L,B,$,j,U,Z,X){const Y={},J=Z.queryRenderedSymbols(j),ae=[];for(const ce of Object.keys(J).map(Number))ae.push(X[ce]);ae.sort(Uc);for(const ce of ae){const oe=ce.featureIndex.lookupSymbolFeatures(J[ce.bucketInstanceId],B,ce.bucketIndex,ce.sourceLayerIndex,U.filter,U.layers,U.availableImages,L);for(const fe in oe){const de=Y[fe]=Y[fe]||[],ye=oe[fe];ye.sort((ge,ve)=>{const Ce=ce.featureSortOrder;if(Ce){const Oe=Ce.indexOf(ge.featureIndex);return Ce.indexOf(ve.featureIndex)-Oe}return ve.featureIndex-ge.featureIndex});for(const ge of ye)de.push(ge)}}for(const ce in Y)Y[ce].forEach(oe=>{const fe=oe.feature,de=$(L[ce]);if(!de)return;const ye=de.getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=ye});return Y}(this._mergedLayers,x,this.getLayerSourceCache.bind(this),D.screenGeometry,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(n,l){l&&l.filter&&this._validate(Q,"querySourceFeatures.filter",l.filter,null,l);const f=this.getOwnSourceCaches(n);let _=[];for(const v of f)_=_.concat(yh(v,l));return _}addSourceType(n,l,f){return Yo.getSourceType(n)?f(new Error(`A source type called "${n}" already exists.`)):(Yo.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},f):f(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,l,f={}){this._checkLoaded();const _=this.light.getLight();let v=!1;for(const C in n)if(!a.bh(n[C],_[C])){v=!0;break}if(!v)return;const x=this._getTransitionParameters();this.light.setLight(n,l,f),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,l=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let f=n;const _=n.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof f.source=="object"){const C="terrain-dem-src";this.addSource(C,f.source),f=a.cl(f),f=a.l(f,{source:C})}const v=a.l({},f),x={};if(this.terrain&&_){v.source=this.terrain.get().source;const C=this.terrain?this.getFragmentStyle(this.terrain.scope):null;C&&(x.style=C.serialize())}if(this._validate(gh,"terrain",v,x))return}if(!this.terrain||this.terrain.scope!==this.scope&&!_||this.terrain&&l!==this.terrain.drapeRenderMode){if(!f)return;this._createTerrain(f,l),this.fire(new a.x("data",{dataType:"style"}))}else{const v=this.terrain,x=v.get();for(const C of Object.keys(a._.terrain))!f.hasOwnProperty(C)&&a._.terrain[C].default&&(f[C]=a._.terrain[C].default);for(const C in n)if(!a.bh(n[C],x[C])){v.set(n,this.options),this.stylesheet.terrain=n;const D=this._getTransitionParameters({duration:0});v.updateTransitions(D),this.fire(new a.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const l=this.fog=new ai(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!a.bh(l.get(),n)){l.set(n,this.options),this.stylesheet.fog=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}}else this._createFog(n);this._markersNeedUpdate=!0}setColorTheme(n){this._checkLoaded();const l=()=>{for(const _ in this._layers)this._layers[_].lut=this._styleColorTheme.lut;for(const _ in this._sourceCaches)this._sourceCaches[_].clearTiles()};if(this._styleColorTheme.colorTheme=n,!n)return this._styleColorTheme.lut=null,void l();const f=this._evaluateColorThemeData(n);this._loadColorTheme(f).then(()=>{this.fire(new a.x("colorthemeset")),l()}).catch(_=>{a.w(`Couldn't set color theme: ${_}`)})}_getTransitionParameters(n){return{now:a.q.now(),transition:a.l(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],l=[];for(const f of this._mergedOrder)this.isLayerDraped(this._mergedLayers[f])?n.push(f):l.push(f);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...l)}_createTerrain(n,l){const f=this.terrain=new it(n,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const _=this._getTransitionParameters({duration:0});f.updateTransitions(_)}_force3DLayerUpdate(){for(const n in this._layers){const l=this._layers[n];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const l=this._layers[n];l.type==="symbol"&&this._updateLayer(l)}}_validate(n,l,f,_,v={}){if(v&&v.validate===!1)return!1;const x=a.l({},this.serialize());return Ko(this,n.call(Wo,a.l({key:l,style:x,value:f,styleSpec:a._},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(n){const l=this.getSourceCaches(n);for(const f of l)f.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}reloadSource(n){const l=this.getSourceCaches(n);for(const f of l)f.resume(),f.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}updateSources(n){let l;this.directionalLight&&(l=df(this.directionalLight));for(const f in this._mergedSourceCaches)this._mergedSourceCaches[f].update(n,void 0,void 0,l)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const l=this._sourceCaches[n];l.resume(),l.reload()}}_updatePlacement(n,l,f,_,v,x,C=!1){let D=!1,L=!1;const B={},$={};for(const j of this._mergedOrder){const U=this._mergedLayers[j];if(U.type!=="symbol")continue;const Z=a.av(U.source,U.scope);let X=B[Z];if(!X){const J=this.getLayerSourceCache(U);if(!J)continue;const ae=J.getRenderableIds(!0).map(ce=>J.getTileByID(ce));$[Z]=ae.slice(),X=B[Z]=ae.sort((ce,oe)=>oe.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(oe.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(U,X,l.center.lng,l.projection);D=D||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),C=C||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new a.x("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.q.now(),l.zoom))&&(this.pauseablePlacement=new wh(l,this._mergedOrder,C,f,_,v,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,B,$),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.q.now()),L=!0),D&&this.pauseablePlacement.placement.setStale()),L||D){this._buildingIndex.onNewFrame(l.zoom);for(let j=0;j<this._mergedOrder.length;j++){const U=this._mergedLayers[this._mergedOrder[j]];if(U.type!=="symbol")continue;const Z=this.isLayerClipped(U);this.placement.updateLayerOpacities(U,B[a.av(U.source,U.scope)],j,Z?x:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.q.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,l){this._checkLoaded();const f=this.stylesheet.imports=this.stylesheet.imports||[];if(f.findIndex(({id:v})=>v===n.id)!==-1)return void this.fire(new a.t(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!l)return f.push(n),this._loadImports([n],!0);const _=f.findIndex(({id:v})=>v===l);return _===-1&&this.fire(new a.t(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=f.slice(0,_).concat(n).concat(f.slice(_)),this._loadImports([n],!0,l)}updateImport(n,l){this._checkLoaded();const f=this.stylesheet.imports||[],_=this.getImportIndex(n);return _===-1?this:typeof l=="string"?(this.setImportUrl(n,l),this):(l.url&&l.url!==f[_].url&&this.setImportUrl(n,l.url),a.bh(l.config,f[_].config)||this.setImportConfig(n,l.config),a.bh(l.data,f[_].data)||this.setImportData(n,l.data),this)}moveImport(n,l){this._checkLoaded();let f=this.stylesheet.imports||[];const _=this.getImportIndex(n);if(_===-1)return this;const v=this.getImportIndex(l);if(v===-1)return this;const x=f[_],C=this.fragments[_];return f=f.filter(({id:D})=>D!==n),this.fragments=this.fragments.filter(({id:D})=>D!==n),this.stylesheet.imports=f.slice(0,v).concat(x).concat(f.slice(v)),this.fragments=this.fragments.slice(0,v).concat(C).concat(this.fragments.slice(v)),this.mergeLayers(),this}setImportUrl(n,l){this._checkLoaded();const f=this.stylesheet.imports||[],_=this.getImportIndex(n);if(_===-1)return this;f[_].url=l;const v=this.fragments[_];return v.style=this._createFragmentStyle(f[_]),v.style.on("style.import.load",()=>this.mergeAll()),v.style.loadURL(l),this}setImportData(n,l){this._checkLoaded();const f=this.getImportIndex(n),_=this.stylesheet.imports||[];return f===-1?this:l?(this.fragments[f].style.setState(l),this._reloadImports(),this):(delete _[f].data,this.setImportUrl(n,_[f].url))}setImportConfig(n,l){this._checkLoaded();const f=this.getImportIndex(n),_=this.stylesheet.imports||[];if(f===-1)return this;l?_[f].config=l:delete _[f].config;const v=this.fragments[f],x=v.style.stylesheet&&v.style.stylesheet.schema;return v.config=l,v.style.updateConfig(l,x),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const l=this.stylesheet.imports||[],f=this.getImportIndex(n);f!==-1&&(l.splice(f,1),this.fragments[f].style._remove(),this.fragments.splice(f,1),this._reloadImports())}getImportIndex(n){const l=(this.stylesheet.imports||[]).findIndex(f=>f.id===n);return l===-1&&this.fire(new a.t(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),l}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const l in this._mergedOtherSourceCaches){const f=this._mergedOtherSourceCaches[l];f&&n.push(f.getSource())}return n}getSource(n,l){const f=this.getSourceCache(n,l);return f&&f.getSource()}getLayerSource(n){const l=this.getLayerSourceCache(n);return l&&l.getSource()}getSourceCache(n,l){const f=a.av(n,l);return this._mergedOtherSourceCaches[f]}getLayerSourceCache(n){const l=a.av(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[n]&&l.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&l.push(this._mergedSymbolSourceCaches[n]),l}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const l in n){const f=n[l];f==="reload"?this.reloadSource(l):f==="clear"&&this.clearSource(l)}}updateLayers(n){const l=this._changes.getUpdatedPaintProperties();for(const f of l){const _=this.getLayer(f);_&&_.updateTransitions(n)}}getImages(n,l,f){this.imageManager.getImages(l.icons,l.scope,f),this._updateTilesForChangedImages();const _=v=>{v&&v.setDependencies(l.tileID.key,l.type,l.icons)};_(this._otherSourceCaches[l.source]),_(this._symbolSourceCaches[l.source])}getGlyphs(n,l,f){this.glyphManager.getGlyphs(l.stacks,l.scope,f)}getResource(n,l,f){return a.ct(l,f)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const l=[];return this._otherSourceCaches[n]&&l.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&l.push(this._symbolSourceCaches[n]),l}_isSourceCacheLoaded(n){const l=this.getOwnSourceCaches(n);return l.length===0?(this.fire(new a.t(new Error(`There is no source with ID '${n}'`))),!1):l.every(f=>f.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,l){if(!this._clipLayerPresent&&n.type!=="fill-extrusion")return!1;const f=n.type==="fill-extrusion"&&n.sourceLayer==="building";if(n.is3D()){if(f||l&&l.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(n=>{n.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Yo.getSourceType=function(d){return ef[d]},Yo.setSourceType=function(d,n){ef[d]=n},Yo.registerForPluginStateChange=a.cc;var qy=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Om=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Pm=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,gf="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Wy=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Zy=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Xy=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Ky=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Am=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Yy=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Eh=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const _f=[];_l(qy,_f),_l(Pm,_f),_l(Om,_f);const Sh={"_prelude_fog.vertex.glsl":Zy,"_prelude_terrain.vertex.glsl":Wy,"_prelude_shadow.vertex.glsl":Yy,"_prelude_fog.fragment.glsl":Xy,"_prelude_shadow.fragment.glsl":Eh,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Ky,"_prelude_raster_particle.glsl":Am},ou={};Zr("",Wy),Zr(Xy,Zy),Zr(Eh,Yy),Zr(Ky,""),Zr(Am,"");const Oh=Zr(Om,Pm),yf=qy;var gl={background:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Zr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Zr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Zr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Zr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Zr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Zr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Zr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Zr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Zr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Zr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Zr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Zr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Zr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Zr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Zr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Zr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,gf),skyboxGradient:Zr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,gf),skyboxCapture:Zr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Zr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Zr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Zr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Zr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Zr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function _l(d,n){const l=d.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let f of l)if(f=f.trim(),f[0]==="#"&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=f.split(" ");for(const v of _)n.includes(v)||n.push(v)}}function Zr(d,n){const l=/#include\s+"([^"]+)"/g,f=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let _=n.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);_&&(_=_.map(L=>{const B=L.split(" ");return B[B.length-1]}),_=[...new Set(_)]);const v={},x=[],C=[];if(d=d.replace(l,(L,B)=>(C.push(B),"")),(n=n.replace(l,(L,B)=>(x.push(B),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let D=[..._f];_l(d,D),_l(n,D);for(const L of[...x,...C])Sh[L]||console.error(`Undefined include: ${L}`),ou[L]||(ou[L]=[],_l(Sh[L],ou[L])),D=[...D,...ou[L]];return{fragmentSource:d=d.replace(f,(L,B,$,j,U)=>(v[U]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${$} ${j} ${U};
#else
uniform ${$} ${j} u_${U};
#endif
`:B==="initialize"?`
#ifdef HAS_UNIFORM_u_${U}
    ${$} ${j} ${U} = u_${U};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    in ${$} ${j} ${U};
#endif
`:B==="initialize-attribute"?"":void 0)),vertexSource:n=n.replace(f,(L,B,$,j,U)=>{const Z=j==="float"?"vec2":j,X=U.match(/color/)?"color":Z;return B==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${U}
in ${$} ${j} a_${U};
#endif
`:v[U]?B==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${$} ${Z} a_${U};
out ${$} ${j} ${U};
#else
uniform ${$} ${j} u_${U};
#endif
`:B==="initialize"?X==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${$} ${j} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${X}(a_${U}, u_${U}_t);
#else
    ${$} ${j} ${U} = u_${U};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    in ${$} ${j} a_${U};
    out ${$} ${j} ${U};
#endif
`:B==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    ${U} = a_${U};
#endif
`:void 0:B==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${$} ${Z} a_${U};
#else
uniform ${$} ${j} u_${U};
#endif
`:B==="define-instanced"?X==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${U}0;
in vec4 a_${U}1;
in vec4 a_${U}2;
in vec4 a_${U}3;
#else
uniform ${$} ${j} u_${U};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${$} ${Z} a_${U};
#else
uniform ${$} ${j} u_${U};
#endif
`:B==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    ${$} ${j} ${U} = a_${U};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${$} ${j} ${U} = a_${U};
#else
    ${$} ${j} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${$} ${j} ${U} = unpack_mix_${X}(a_${U}, u_${U}_t);
#else
    ${$} ${j} ${U} = u_${U};
#endif
`}),staticAttributes:_,usedDefines:D,vertexIncludes:x,fragmentIncludes:C}}class su{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,l,f,_,v,x,C,D){this.context=n;let L=this.boundPaintVertexBuffers.length!==_.length;for(let $=0;!L&&$<_.length;$++)this.boundPaintVertexBuffers[$]!==_[$]&&(L=!0);let B=this.boundDynamicVertexBuffers.length!==C.length;for(let $=0;!B&&$<C.length;$++)this.boundDynamicVertexBuffers[$]!==C[$]&&(B=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==f||L||B||this.boundIndexBuffer!==v||this.boundVertexOffset!==x)this.freshBind(l,f,_,v,x,C,D);else{n.bindVertexArrayOES.set(this.vao);for(const $ of C)$&&($.bind(),D&&$.instanceCount&&$.setVertexAttribDivisor(n.gl,l,D));v&&v.dynamicDraw&&v.bind()}}freshBind(n,l,f,_,v,x,C){const D=n.numAttributes,L=this.context,B=L.gl;this.vao&&this.destroy(),this.vao=L.gl.createVertexArray(),L.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=v,this.boundDynamicVertexBuffers=x,l.enableAttributes(B,n),l.bind(),l.setVertexAttribPointers(B,n,v);for(const $ of f)$.enableAttributes(B,n),$.bind(),$.setVertexAttribPointers(B,n,v);for(const $ of x)$&&($.enableAttributes(B,n),$.bind(),$.setVertexAttribPointers(B,n,v),C&&$.instanceCount&&$.setVertexAttribDivisor(B,n,C));_&&_.bind(),L.currentNumAttributes=D}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Ph(d,n){const l=Math.pow(2,n.canonical.z),f=n.canonical.y;return[new a.a5(0,f/l).toLngLat().lat,new a.a5(0,(f+1)/l).toLngLat().lat]}function vf(d,n,l,f,_,v,x){const C=d.context,D=C.gl,L=l.hillshadeFBO;if(!L)return;d.prepareDrawTile();const B=d.isTileAffectedByFog(n),$=d.getOrCreateProgram("hillshade",{overrideFog:B});C.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,L.colorAttachment.get());const j=((Y,J,ae,ce)=>{const oe=ae.paint.get("hillshade-shadow-color"),fe=ae.paint.get("hillshade-highlight-color"),de=ae.paint.get("hillshade-accent-color"),ye=ae.paint.get("hillshade-emissive-strength");let ge=a.bB(ae.paint.get("hillshade-illumination-direction"));if(ae.paint.get("hillshade-illumination-anchor")==="viewport")ge-=Y.transform.angle;else if(Y.style&&Y.style.enable3dLights()&&Y.style.directionalLight){const Ce=Y.style.directionalLight.properties.get("direction"),Oe=a.c7(Ce.x,Ce.y,Ce.z);ge=a.bB(Oe[1])}const ve=!Y.options.moving;return{u_matrix:ce||Y.transform.calculateProjMatrix(J.tileID.toUnwrapped(),ve),u_image:0,u_latrange:Ph(0,J.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),ge],u_shadow:oe.toRenderColor(ae.lut),u_highlight:fe.toRenderColor(ae.lut),u_emissive_strength:ye,u_accent:de.toRenderColor(ae.lut)}})(d,l,f,d.terrain?n.projMatrix:null);d.uploadCommonUniforms(C,$,n.toUnwrapped());const{tileBoundsBuffer:U,tileBoundsIndexBuffer:Z,tileBoundsSegments:X}=d.getTileBoundsBuffers(l);$.draw(d,D.TRIANGLES,_,v,x,lr.disabled,j,f.id,U,Z,X)}function bf(d,n,l){if(!n.needsDEMTextureUpload)return;const f=d.context,_=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||d.getTileTexture(l.stride);const v=l.getPixels();n.demTexture?n.demTexture.update(v,{premultiply:!1}):n.demTexture=new a.T(f,v,_.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Ah(d,n,l){const f=d.context,_=f.gl;if(!n.dem)return;const v=n.dem;if(f.activeTexture.set(_.TEXTURE1),bf(d,n,v),!n.demTexture)return;n.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE);const x=v.dim;f.activeTexture.set(_.TEXTURE0);let C=n.hillshadeFBO;if(!C){const j=new a.T(f,{width:x,height:x,data:null},_.RGBA8);j.bind(_.LINEAR,_.CLAMP_TO_EDGE),C=n.hillshadeFBO=f.createFramebuffer(x,x,!0,"renderbuffer"),C.colorAttachment.set(j.texture)}f.bindFramebuffer.set(C.framebuffer),f.viewport.set([0,0,x,x]);const{tileBoundsBuffer:D,tileBoundsIndexBuffer:L,tileBoundsSegments:B}=d.getMercatorTileBoundsBuffers(),$=[];d.linearFloatFilteringSupported()&&$.push("TERRAIN_DEM_FLOAT_FORMAT"),d.getOrCreateProgram("hillshadePrepare",{defines:$}).draw(d,_.TRIANGLES,Qt.disabled,yr.disabled,kr.unblended,lr.disabled,((j,U)=>{const Z=U.stride,X=a.a6.mat4.create();return a.a6.mat4.ortho(X,0,a.ab,-a.ab,0,0,1),a.a6.mat4.translate(X,X,[0,-a.ab,0]),{u_matrix:X,u_image:1,u_dimension:[Z,Z],u_zoom:j.overscaledZ}})(n.tileID,v),l.id,D,L,B),n.needsHillshadePrepare=!1}class xi{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cm extends xi{getDefault(){return a.bz.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Jy extends xi{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Mm extends xi{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class xf extends xi{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ch extends xi{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Qy extends xi{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class ev extends xi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class tv extends xi{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class au extends xi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class rv extends xi{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class G1 extends xi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class H1 extends xi{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class q1 extends xi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class Im extends xi{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Dm extends xi{getDefault(){return a.bz.transparent}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Rm extends xi{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class Lm extends xi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class iv extends xi{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class nv extends xi{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let W1=class extends xi{getDefault(){return null}set(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)}};class Mh extends xi{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Ih extends xi{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ov extends xi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Jo extends xi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Bm extends xi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class wf extends xi{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Tf extends xi{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class km extends xi{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class zm extends xi{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Ef extends xi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Fm extends xi{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Dh extends xi{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class Sf extends Dh{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Nm extends Dh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class sv extends Dh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class lu extends Nm{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Z1=(d,n,l)=>({u_matrix:d,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:l}),av=(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:l,u_zoom_transition:_,u_merc_center:v,u_image0:0,u_frustum_tl:x,u_frustum_tr:C,u_frustum_br:D,u_frustum_bl:L,u_globe_pos:B,u_globe_radius:$,u_viewport:j,u_grid_matrix:X?Float32Array.from(X):new Float32Array(9),u_skirt_height:U,u_far_z_cutoff:Z});function lv(d,n){return d!=null&&n!=null&&!(!d.hasData()||!n.hasData())&&d.demTexture!=null&&n.demTexture!=null&&d.tileID.key!==n.tileID.key}const cu=new class{constructor(){this.operations={}}newMorphing(d,n,l,f,_){if(d in this.operations){const v=this.operations[d];v.to.tileID.key!==l.tileID.key&&(v.queued=l)}else this.operations[d]={startTime:f,phase:0,duration:_,from:n,to:l,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const n=this.operations[d];return{from:n.from,to:n.to,phase:n.phase}}update(d){for(const n in this.operations){const l=this.operations[n];for(l.phase=(d-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,d)){delete this.operations[n];break}}}_nextOp(d,n){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=n,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},cv={0:null,1:"TERRAIN_VERTEX_MORPHING"};function uv(d,n,l){if(n===0)return 0;const f=n<1&&l===514?.25/n:1;return 6*Math.pow(1.5,22-d)*Math.max(n,1)*f}function $m(d,n){const l=1<<d.z;return!n&&(d.x===0||d.x===l-1)||d.y===0||d.y===l-1}const Rh=d=>({u_matrix:d});function Of(d,n,l,f,_){if(_>0){const v=a.q.now(),x=(v-d.timeAdded)/_,C=n?(v-n.timeAdded)/_:-1,D=l.getSource(),L=f.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),B=!n||Math.abs(n.tileID.overscaledZ-L)>Math.abs(d.tileID.overscaledZ-L),$=B&&d.refreshedUponExpiration?1:a.ap(B?x:1-C,0,1);return d.refreshedUponExpiration&&x>=1&&(d.refreshedUponExpiration=!1),n?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}class uu extends Bo{constructor(n){const l={type:"raster-dem",maxzoom:n.transform.maxZoom},f=new a.cd(a.ce(),null),_=Vc("mock-dem",l,f,n.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,l){n.state="loaded",l(null)}}class hv extends Bo{constructor(n){const l=Vc("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new a.cd(a.ce(),null),n.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,l,f){if(n.freezeTileCoverage)return;this.transform=n;const _=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,x)=>{if(v[x.key]="",!this._tiles[x.key]){const C=new pa(x,this._source.tileSize*x.overscaleFactor(),n.tileZoom);C.state="loaded",this._tiles[x.key]=C}return v},{});for(const v in this._tiles)v in _||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(n){const l=this.proxyCachedFBO[n];if(l!==void 0){const f=Object.values(l);this.renderCachePool.push(...f),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class jm extends a.aA{constructor(n,l,f){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=l,this.projMatrix=f}}class Vm extends a.cE{constructor(n,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,_,v]=function(D){const L=new a.a_,B=new a.aO,$=131;L.reserve(17161),B.reserve(33800);const j=a.ab/128,U=a.ab+j/2,Z=U+j;for(let Y=-j;Y<Z;Y+=j)for(let J=-j;J<Z;J+=j){const ae=J<0||J>U||Y<0||Y>U?24575:0,ce=a.ap(Math.round(J),0,a.ab),oe=a.ap(Math.round(Y),0,a.ab);L.emplaceBack(ce+ae,oe)}const X=(Y,J)=>{const ae=J*$+Y;B.emplaceBack(ae+1,ae,ae+$),B.emplaceBack(ae+$,ae+$+1,ae+1)};for(let Y=1;Y<129;Y++)for(let J=1;J<129;J++)X(J,Y);return[0,129].forEach(Y=>{for(let J=0;J<130;J++)X(J,Y),X(Y,J)}),[L,B,32768]}(),x=n.context;this.gridBuffer=x.createVertexBuffer(f,a.b0.members),this.gridIndexBuffer=x.createIndexBuffer(_),this.gridSegments=a.b1.simpleSegment(0,0,f.length,_.length),this.gridNoSkirtSegments=a.b1.simpleSegment(0,0,f.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hv(l.map),this.orthoMatrix=a.a6.mat4.create(),a.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.ab,0,a.ab,0,1);const C=x.gl;this._overlapStencilMode=new yr({func:C.GEQUAL,mask:255},0,255,C.KEEP,C.KEEP,C.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new uu(l.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,l,f){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const _=n.terrain.properties,v=n.terrain.drapeRenderMode===0,x=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.q.now();const C=n.terrain&&n.terrain.scope,D=_.get("source"),L=v?this._mockSourceCache:n.getSourceCache(D,C);if(!L)return void a.w(`Couldn't find terrain source "${D}".`);if(this.sourceCache=L,this._exaggeration=x?this.calculateExaggeration(l):_.get("exaggeration"),!l.projection.requiresDraping&&x&&this._exaggeration===0)return void this._disable();this.enabled=!0;const B=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const $=this.getScaledDemTileSize();this.sourceCache.update(l,$,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,B(),this._initializing=!0),B(),l.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(n){const l=this._previousCameraAltitude,f=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=f;const _=l!=null?f-l:Number.MAX_VALUE;if(Math.abs(_)<2)return this._exaggeration;const v=n.zoom,x=this._style.terrain;if(!this._previousUpdateTimestamp)return x.getExaggeration(v);let C=v-this._previousZoom;const D=this._previousUpdateTimestamp;let L=v;this._evaluationZoom!=null&&(L=this._evaluationZoom,Math.abs(v-L)>.5&&(C=.5*(v-L+C)),C*_<0&&(L+=C)),this._evaluationZoom=L;const B=x.getExaggeration(L),$=B===x.getExaggeration(Math.max(0,L-.1));if($&&Math.abs(B-this._exaggeration)<.01)return B;let j=Math.min(.1,.00375*(this._updateTimestamp-D));return($||B<.1||Math.abs(C)<1e-4)&&(j=Math.min(.2,4*j)),a.aa(this._exaggeration,B,j)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(a.a5.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=l.getIds().map(D=>{const L=l.getTileByID(D).tileID;return L.projMatrix=f.calculateProjMatrix(L.toUnwrapped()),L});(function(D,L){const B=L.transform.pointCoordinate(L.transform.getCameraPoint()),$=new a.P(B.x,B.y);D.sort((j,U)=>{if(U.overscaledZ-j.overscaledZ)return U.overscaledZ-j.overscaledZ;const Z=new a.P(j.canonical.x+(1<<j.canonical.z)*j.wrap,j.canonical.y),X=new a.P(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),Y=$.mult(1<<j.canonical.z);return Y.x-=.5,Y.y-=.5,Y.distSqr(Z)-Y.distSqr(X)})})(_,this.painter);const v=this.proxyToSource||{};this.proxyToSource={},_.forEach(D=>{this.proxyToSource[D.key]={}}),this.terrainTileForTile={};const x=this._style._mergedSourceCaches;for(const D in x){const L=x[D];if(!L.used||(L!==this.sourceCache&&this.resetTileLookupCache(L.id),this._setupProxiedCoordsForOrtho(L,n[D],v),L.usedForTerrain))continue;const B=n[D];L.getSource().reparseOverscaled&&this._assignTerrainTiles(B)}this.proxiedCoords[l.id]=_.map(D=>new jm(D,D.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1;const C={};this._visibleDemTiles=[];for(const D of this.proxyCoords){const L=this.terrainTileForTile[D.key];if(!L)continue;const B=L.tileID.key;B in C||(this._visibleDemTiles.push(L),C[B]=B)}}_assignTerrainTiles(n){this._initializing||n.forEach(l=>{if(this.terrainTileForTile[l.key])return;const f=this._findTileCoveringTileID(l,this.sourceCache);f&&(this.terrainTileForTile[l.key]=f)})}_prepareDEMTextures(){const n=this.painter.context,l=n.gl;for(const f in this.terrainTileForTile){const _=this.terrainTileForTile[f],v=_.dem;!v||_.demTexture&&!_.needsDEMTextureUpload||(n.activeTexture.set(l.TEXTURE1),bf(this.painter,_,v))}}_prepareDemTileUniforms(n,l,f,_){if(!l||l.demTexture==null)return!1;const v=n.tileID.canonical,x=Math.pow(2,l.tileID.canonical.z-v.z),C=_||"";return f[`u_dem_tl${C}`]=[v.x*x%1,v.y*x%1],f[`u_dem_scale${C}`]=x,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const l=this._visibleDemTiles.reduce((f,_)=>{if(!_.dem)return f;const v=_.dem.tree.minimums[0];return v>0&&n++,f+v},0);return n?l/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,l=n.gl;n.activeTexture.set(l.TEXTURE2);const f=this._getLoadedAreaMinimum(),_=new a.cF({width:1,height:1},new Float32Array([f]));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(_,{premultiply:!1}):v=this._emptyDEMTexture=new a.T(n,_,l.R32F,{premultiply:!1}),v}setupElevationDraw(n,l,f){const _=this.painter.context,v=_.gl,x={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};x.u_exaggeration=this.exaggeration();let C=null,D=null,L=1;if(f&&f.morphing&&this._useVertexMorphing){const U=f.morphing.srcDemTile,Z=f.morphing.dstDemTile;L=f.morphing.phase,U&&Z&&(this._prepareDemTileUniforms(n,U,x,"_prev")&&(D=U),this._prepareDemTileUniforms(n,Z,x)&&(C=Z))}const B=U=>U&&U.demTexture&&this.painter.linearFloatFilteringSupported()?v.LINEAR:v.NEAREST;let $=null;var j;if(this.enabled?D&&C?($=C.demTexture,_.activeTexture.set(v.TEXTURE4),D.demTexture.bind(B(D),v.CLAMP_TO_EDGE),x.u_dem_lerp=L):(C=this.terrainTileForTile[n.tileID.key],$=this._prepareDemTileUniforms(n,C,x)?C.demTexture:this.emptyDEMTexture):$=this.emptyDEMTexture,_.activeTexture.set(v.TEXTURE2),$&&(x.u_dem_size=(j=$).size[0]===1?1:j.size[0]-2,$.bind(B(C),v.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(f&&f.useDepthForOcclusion,l,x),f&&f.useMeterToDem&&C){const U=(1<<C.tileID.canonical.z)*a.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;x.u_meter_to_dem=U}if(f&&f.labelPlaneMatrixInv&&(x.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),l.setTerrainUniformValues(_,x),this.painter.transform.projection.name==="globe"){const U=this.globeUniformValues(this.painter.transform,n.tileID.canonical,f&&f.useDenormalizedUpVectorScale);l.setGlobeUniformValues(_,U)}}globeUniformValues(n,l,f){const _=n.projection;return{u_tile_tl_up:_.upVector(l,0,0),u_tile_tr_up:_.upVector(l,a.ab,0),u_tile_br_up:_.upVector(l,a.ab,a.ab),u_tile_bl_up:_.upVector(l,0,a.ab),u_tile_up_scale:f?a.cG(1):_.upVectorScale(l,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const l=this.painter,f=this.painter.context;n.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,v,x,C,D){if(_.transform.projection.name==="globe")(function(L,B,$,j,U){const Z=L.context,X=Z.gl;let Y,J;const ae=L.transform,ce=a.cx(L,Z,ae),oe=($e,Je)=>{if(J===Je)return;const ct=[cv[Je],"PROJECTION_GLOBE_VIEW"];ce&&ct.push("CUSTOM_ANTIALIASING");const Ke=L.isTileAffectedByFog($e);Y=L.getOrCreateProgram("globeRaster",{defines:ct,overrideFog:Ke}),J=Je},fe=L.colorModeForRenderPass(),de=new Qt(X.LEQUAL,Qt.ReadWrite,L.depthRangeFor3D);cu.update(U);const ye=a.cy(ae),ge=[a.am(ae.center.lng),a.at(ae.center.lat)],ve=L.globeSharedBuffers,Ce=[ae.width*a.q.devicePixelRatio,ae.height*a.q.devicePixelRatio],Oe=Float32Array.from(ae.globeMatrix),Te={useDenormalizedUpVectorScale:!0};{const $e=L.transform,Je=uv($e.zoom,B.exaggeration(),B.sourceCache._source.tileSize);J=-1;const ct=X.TRIANGLES;for(const Ke of j){const _t=$.getTile(Ke),je=yr.disabled,nt=B.prevTerrainTileForTile[Ke.key],rt=B.terrainTileForTile[Ke.key];lv(nt,rt)&&cu.newMorphing(Ke.key,nt,rt,U,250),Z.activeTexture.set(X.TEXTURE0),_t.texture&&_t.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const vt=cu.getMorphValuesForProxy(Ke.key),xt=vt?1:0;vt&&a.C(Te,{morphing:{srcDemTile:vt.from,dstDemTile:vt.to,phase:a.cw(vt.phase)}});const lt=a.cz(Ke.canonical),pt=a.cA(lt.getCenter().lat),Kt=a.cB(Ke.canonical,lt,pt,$e.worldSize/$e._pixelsPerMercatorPixel),Ot=a.b5(a.cC(Ke.canonical)),Ft=av($e.expandedFarZProjMatrix,Oe,ye,Ot,a.a9($e.zoom),ge,$e.frustumCorners.TL,$e.frustumCorners.TR,$e.frustumCorners.BR,$e.frustumCorners.BL,$e.globeCenterInViewSpace,$e.globeRadius,Ce,Je,$e._farZ,Kt);if(oe(Ke,xt),Y&&(B.setupElevationDraw(_t,Y,Te),L.uploadCommonUniforms(Z,Y,Ke.toUnwrapped()),ve)){const[sr,Ht,tr]=ve.getGridBuffers(pt,Je!==0);Y.draw(L,ct,de,je,fe,lr.backCCW,Ft,"globe_raster",sr,Ht,tr)}}}if(ve&&(L.renderDefaultNorthPole||L.renderDefaultSouthPole)){const $e=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ce&&$e.push("CUSTOM_ANTIALIASING"),Y=L.getOrCreateProgram("globeRaster",{defines:$e});for(const Je of j){const{x:ct,y:Ke,z:_t}=Je.canonical,je=Ke===0,nt=Ke===(1<<_t)-1,[rt,vt,xt,lt]=ve.getPoleBuffers(_t,!1);if(lt&&(je||nt)){const pt=$.getTile(Je);Z.activeTexture.set(X.TEXTURE0),pt.texture&&pt.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);let Kt=a.cD(_t,ct,ae);const Ot=a.b5(a.cC(Je.canonical)),Ft=(sr,Ht)=>sr.draw(L,X.TRIANGLES,de,yr.disabled,fe,lr.disabled,av(ae.expandedFarZProjMatrix,Kt,Kt,Ot,0,ge,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,Ce,0,ae._farZ),"globe_pole_raster",Ht,xt,lt);B.setupElevationDraw(pt,Y,Te),L.uploadCommonUniforms(Z,Y,Je.toUnwrapped()),je&&L.renderDefaultNorthPole&&Ft(Y,rt),nt&&L.renderDefaultSouthPole&&(Kt=a.a6.mat4.scale(a.a6.mat4.create(),Kt,[1,-1,1]),Ft(Y,vt))}}}})(_,v,x,C,D);else{const L=_.context,B=L.gl;let $,j;const U=_.shadowRenderer,Z=Na(_,_.longestCutoffRange),X=fe=>{if(j===fe)return;const de=[];de.push(cv[fe]),Z.shouldRenderCutoff&&de.push("RENDER_CUTOFF"),$=_.getOrCreateProgram("terrainRaster",{defines:de}),j=fe},Y=_.colorModeForRenderPass(),J=new Qt(B.LEQUAL,Qt.ReadWrite,_.depthRangeFor3D);cu.update(D);const ae=_.transform,ce=uv(ae.zoom,v.exaggeration(),v.sourceCache._source.tileSize);let oe=[0,0,0];if(U){const fe=_.style.directionalLight,de=_.style.ambientLight;fe&&de&&(oe=ff(_.style,fe,de))}{j=-1;const fe=B.TRIANGLES,[de,ye]=[v.gridIndexBuffer,v.gridSegments];for(const ge of C){const ve=x.getTile(ge),Ce=yr.disabled,Oe=v.prevTerrainTileForTile[ge.key],Te=v.terrainTileForTile[ge.key];lv(Oe,Te)&&cu.newMorphing(ge.key,Oe,Te,D,250),L.activeTexture.set(B.TEXTURE0),ve.texture&&ve.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE);const $e=cu.getMorphValuesForProxy(ge.key),Je=$e?1:0;let ct;$e&&(ct={morphing:{srcDemTile:$e.from,dstDemTile:$e.to,phase:a.cw($e.phase)}});const Ke=Z1(ge.projMatrix,$m(ge.canonical,ae.renderWorldCopies)?ce/10:ce,oe);if(X(Je),!$)continue;v.setupElevationDraw(ve,$,ct);const _t=ge.toUnwrapped();U&&U.setupShadows(_t,$),_.uploadCommonUniforms(L,$,_t,null,Z),$.draw(_,fe,J,Ce,Y,lr.backCCW,Ke,"terrain_raster",v.gridBuffer,de,ye)}}}}(l,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const l=this.painter,f=this.painter.context,_=this.proxySourceCache,v=this.proxiedCoords[_.id],x=this._drapedRenderBatches.shift(),C=l.style.order,D=[];let L=0;for(const B of v){const $=_.getTileByID(B.proxyTileKey),j=_.proxyCachedFBO[B.key]?_.proxyCachedFBO[B.key][n]:void 0,U=j!==void 0?_.renderCache[j]:this.pool[L++],Z=j!==void 0;if($.texture=U.tex,Z&&!U.dirty){D.push($.tileID);continue}let X;f.bindFramebuffer.set(U.fb.framebuffer),this.renderedToTile=!1,U.dirty&&(f.clear({color:a.bz.transparent,stencil:0}),U.dirty=!1);for(let Y=x.start;Y<=x.end;++Y){const J=l.style._mergedLayers[C[Y]];if(J.isHidden(l.transform.zoom))continue;const ae=l.style.getLayerSourceCache(J),ce=ae?this.proxyToSource[B.key][ae.id]:[B];if(!ce)continue;const oe=ce;f.viewport.set([0,0,U.fb.width,U.fb.height]),X!==(ae?ae.id:null)&&(this._setupStencil(U,ce,J,ae),X=ae?ae.id:null),l.renderLayer(l,ae,J,oe)}if(this._drapedRenderBatches.length===0)for(const Y of this._pendingGroundEffectLayers){const J=l.style._mergedLayers[C[Y]];if(J.isHidden(l.transform.zoom))continue;const ae=l.style.getLayerSourceCache(J),ce=ae?this.proxyToSource[B.key][ae.id]:[B];if(!ce)continue;const oe=ce;f.viewport.set([0,0,U.fb.width,U.fb.height]),X!==(ae?ae.id:null)&&(this._setupStencil(U,ce,J,ae),X=ae?ae.id:null),l.renderLayer(l,ae,J,oe)}this.renderedToTile?(U.dirty=!0,D.push($.tileID)):Z||--L,L===5&&(L=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,l.width,l.height]),x.end+1}postRender(){}isLayerOrderingCorrect(n){const l=n.order.length;let f=-1,_=l;for(let v=0;v<l;++v)this._style.isLayerDraped(n._mergedLayers[n.order[v]])?f=Math.max(f,v):_=Math.min(_,v);return _>f}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{n=Math.min(n,l.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,l,f){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const x=v.tileID,C=1<<x.overscaledZ,{x:D,y:L}=x.canonical,B=D/C,$=(D+1)/C,j=L/C,U=(L+1)/C;return{minx:B,miny:j,maxx:$,maxy:U,t:v.dem.tree.raycastRoot(B,j,$,U,n,l,f),tile:v}});_.sort((v,x)=>(v.t!==null?v.t:Number.MAX_VALUE)-(x.t!==null?x.t:Number.MAX_VALUE));for(const v of _){if(v.t==null)return null;const x=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,n,l,f);if(x!=null)return x}return null}_createFBO(){const n=this.painter.context,l=n.gl,f=this.drapeBufferSize;n.activeTexture.set(l.TEXTURE0);const _=new a.T(n,{width:f[0],height:f[1],data:null},l.RGBA8);_.bind(l.LINEAR,l.CLAMP_TO_EDGE);const v=n.createFramebuffer(f[0],f[1],!0,null);return v.colorAttachment.set(_.texture),v.depthAttachment=new lu(n,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:v,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const l=this._style._mergedLayers[n],f=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!f&&l.shouldRedrape():!f&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const f of this._style.getSources())if(f instanceof Qd){n=!0;break}if(!n)return;const l={};for(let f=0;f<this._style.order.length;++f){const _=this._style._mergedLayers[this._style.order[f]],v=this._style.getLayerSourceCache(_);if(v&&!l[v.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof a.a4){l[v.id]=!0;for(const x of this.proxyCoords){const C=this.proxyToSource[x.key][v.id];if(C)for(const D of C)this._clearRenderCacheForTile(v.id,D)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const f in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[f]._source instanceof _h){n=!0;break}if(!n)return;const l={};for(let f=0;f<this._style.order.length;++f){const _=this._style._mergedLayers[this._style.order[f]],v=this._style.getLayerSourceCache(_);if(!v||l[v.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const x=_.paint.get("raster-fade-duration");for(const C of this.proxyCoords){const D=this.proxyToSource[C.key][v.id];if(D)for(const L of D){const B=Of(v.getTile(L),v.findLoadedParent(L,0),v,this.painter.transform,x);(B.opacity!==1||B.mix!==0)&&this._clearRenderCacheForTile(v.id,L)}}}}_setupDrapedRenderBatches(){const n=this._style.order,l=n.length;if(l===0)return;const f=[];this._pendingGroundEffectLayers=[];let _,v=0,x=this._style._mergedLayers[n[v]];for(;!this._style.isLayerDraped(x)&&x.isHidden(this.painter.transform.zoom)&&++v<l;)x=this._style._mergedLayers[n[v]];for(;v<l;++v){const C=this._style._mergedLayers[n[v]];C.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(C)?_===void 0&&(_=v):(C.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(v),_!==void 0&&(f.push({start:_,end:v-1}),_=void 0)))}if(_!==void 0&&f.push({start:_,end:v-1}),f.length!==0){const C=f[f.length-1];this._pendingGroundEffectLayers.every(D=>D>C.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=f}_setupRenderCache(n){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const x=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let C=0;C<x.length;++C){const D=Object.values(x[C]);l.renderCachePool.push(...D)}}return}this._clearRasterLayersFromRenderCache();const f=this.proxyCoords,_=this._tilesDirty;for(let x=f.length-1;x>=0;x--){const C=f[x];if(l.getTileByID(C.key),l.proxyCachedFBO[C.key]!==void 0){const D=n[C.key],L=this.proxyToSource[C.key];let B=0;for(const $ in L){const j=L[$],U=D[$];if(!U||U.length!==j.length||j.some((Z,X)=>Z!==U[X]||_[$]&&_[$].hasOwnProperty(Z.key))){B=-1;break}++B}for(const $ in l.proxyCachedFBO[C.key])l.renderCache[l.proxyCachedFBO[C.key][$]].dirty=B<0||B!==Object.values(D).length}}const v=[...this._drapedRenderBatches];v.sort((x,C)=>C.end-C.start-(x.end-x.start));for(const x of v)for(const C of f){if(l.proxyCachedFBO[C.key])continue;let D=l.renderCachePool.pop();D===void 0&&l.renderCache.length<50&&(D=l.renderCache.length,l.renderCache.push(this._createFBO())),D!==void 0&&(l.proxyCachedFBO[C.key]={},l.proxyCachedFBO[C.key][x.start]=D,l.renderCache[D].dirty=!0)}this._tilesDirty={}}_setupStencil(n,l,f,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,x=v.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let C;if(f.isTileClipped())C=l.length,this._overlapStencilMode.test={func:x.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);C=1,this._overlapStencilMode.test={func:x.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+C>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=C,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):yr.disabled}_renderTileClippingMasks(n,l){const f=this.painter,_=this.painter.context,v=_.gl;f._tileClippingMaskIDs={},_.setColorMode(kr.disabled),_.setDepthMode(Qt.disabled);const x=f.getOrCreateProgram("clippingMask");for(const C of n){const D=f._tileClippingMaskIDs[C.key]=--l;x.draw(f,v.TRIANGLES,Qt.disabled,new yr({func:v.ALWAYS,mask:0},D,255,v.KEEP,v.KEEP,v.REPLACE),kr.disabled,lr.disabled,Rh(C.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(n){const l=this.painter.transform;if(n.x<0||n.x>l.width||n.y<0||n.y>l.height)return null;const f=[n.x,n.y,1,1];a.a6.vec4.transformMat4(f,f,l.pixelMatrixInverse),a.a6.vec4.scale(f,f,1/f[3]),f[0]/=l.worldSize,f[1]/=l.worldSize;const _=l._camera.position,v=a.bD(1,l.center.lat),x=[_[0],_[1],_[2]/v,0],C=a.a6.vec3.subtract([],f.slice(0,3),x);a.a6.vec3.normalize(C,C);const D=this.raycast(x,C,this._exaggeration);return D!==null&&D?(a.a6.vec3.scaleAndAdd(x,x,C,D),x[3]=x[2],x[2]*=v,x):null}_setupProxiedCoordsForOrtho(n,l,f){if(n.getSource()instanceof a.aD)return this._setupProxiedCoordsForImageSource(n,l,f);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const _=this.proxiedCoords[n.id]=[],v=this.proxyCoords;for(let D=0;D<v.length;D++){const L=v[D],B=this._findTileCoveringTileID(L,n);if(B){const $=this._createProxiedId(L,B,f[L.key]&&f[L.key][n.id]);_.push($),this.proxyToSource[L.key][n.id]=[$]}}let x=!1;const C=new Set;for(let D=0;D<l.length;D++){const L=n.getTile(l[D]);if(!L||!L.hasData())continue;const B=this._findTileCoveringTileID(L.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==L.tileID.canonical.z){const $=this.proxyToSource[B.tileID.key][n.id],j=this._createProxiedId(B.tileID,L,f[B.tileID.key]&&f[B.tileID.key][n.id]);$?$.splice($.length-1,0,j):this.proxyToSource[B.tileID.key][n.id]=[j];const U=this.proxyToSource[B.tileID.key][n.id];C.has(U)||C.add(U),_.push(j),x=!0}}if(this._sourceTilesOverlap[n.id]=x,x&&this._debugParams.sortTilesHiZFirst)for(const D of C)D.sort((L,B)=>B.overscaledZ-L.overscaledZ)}_setupProxiedCoordsForImageSource(n,l,f){if(!n.getSource().loaded())return;const _=this.proxiedCoords[n.id]=[],v=this.proxyCoords,x=n.getSource(),C=x.tileID;if(!C)return;const D=new a.P(C.x,C.y)._div(1<<C.z),L=x.coordinates.map(a.a5.fromLngLat).reduce(($,j)=>($.min.x=Math.min($.min.x,j.x-D.x),$.min.y=Math.min($.min.y,j.y-D.y),$.max.x=Math.max($.max.x,j.x-D.x),$.max.y=Math.max($.max.y,j.y-D.y),$),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=($,j)=>{const U=$.wrap+$.canonical.x/(1<<$.canonical.z),Z=$.canonical.y/(1<<$.canonical.z),X=a.ab/(1<<$.canonical.z),Y=j.wrap+j.canonical.x/(1<<j.canonical.z),J=j.canonical.y/(1<<j.canonical.z);return U+X<Y+L.min.x||U>Y+L.max.x||Z+X<J+L.min.y||Z>J+L.max.y};for(let $=0;$<v.length;$++){const j=v[$];for(let U=0;U<l.length;U++){const Z=n.getTile(l[U]);if(!Z||!Z.hasData()||B(j,Z.tileID))continue;const X=this._createProxiedId(j,Z,f[j.key]&&f[j.key][n.id]),Y=this.proxyToSource[j.key][n.id];Y?Y.push(X):this.proxyToSource[j.key][n.id]=[X],_.push(X)}}}_createProxiedId(n,l,f){let _=this.orthoMatrix;if(f){const v=f.find(x=>x.key===l.tileID.key);if(v)return v}if(l.tileID.key!==n.key){const v=n.canonical.z-l.tileID.canonical.z;let x,C,D;_=a.a6.mat4.create();const L=l.tileID.wrap-n.wrap<<n.overscaledZ;v>0?(x=a.ab>>v,C=x*((l.tileID.canonical.x<<v)-n.canonical.x+L),D=x*((l.tileID.canonical.y<<v)-n.canonical.y)):(x=a.ab<<-v,C=a.ab*(l.tileID.canonical.x-(n.canonical.x+L<<-v)),D=a.ab*(l.tileID.canonical.y-(n.canonical.y<<-v))),a.a6.mat4.ortho(_,0,x,0,x,0,1),a.a6.mat4.translate(_,_,[C,D,0])}return new jm(l.tileID,n.key,_)}_findTileCoveringTileID(n,l){let f=l.getTile(n);if(f&&f.hasData())return f;const _=this._findCoveringTileCache[l.id],v=_[n.key];if(f=v?l.getTileByID(v):null,f&&f.hasData()||v===null)return f;let x=f?f.tileID:n,C=x.overscaledZ;const D=l.getSource().minzoom,L=[];if(!v){const $=l.getSource().maxzoom;if(n.canonical.z>=$){const j=n.canonical.z-$;l.getSource().reparseOverscaled?(C=Math.max(n.canonical.z+2,l.transform.tileZoom),x=new a.aA(C,n.wrap,$,n.canonical.x>>j,n.canonical.y>>j)):j!==0&&(C=$,x=new a.aA(C,n.wrap,$,n.canonical.x>>j,n.canonical.y>>j))}x.key!==n.key&&(L.push(x.key),f=l.getTile(x))}const B=$=>{L.forEach(j=>{_[j]=$}),L.length=0};for(C-=1;C>=D&&(!f||!f.hasData());C--){f&&B(f.tileID.key);const $=x.calculateScaledKey(C);if(f=l.getTileByID($),f&&f.hasData())break;const j=_[$];if(j===null)break;j===void 0?L.push($):f=l.getTileByID(j)}return B(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,l){let f=this._tilesDirty[n];f||(f=this._tilesDirty[n]={}),f[l.key]=!0}}function Um(d,n,l){const f=function(C,D,L){const B=a.a6.vec3.dot(D,C),$=a.a6.vec3.dot(L,[.2126,.7152,.0722]),j=(Z,X,Y)=>(1-Y)*Z+Y*X,U=j(1-.3*Math.min($,1),1,Math.min(B+1,1));return j(.92,1,Math.asin(a.ap(D[2],-1,1))/Math.PI+.5)*U}(d,[0,0,1],n),_=[0,0,0];a.a6.vec3.scale(_,l.slice(0,3),f);const v=[0,0,0];a.a6.vec3.scale(v,n.slice(0,3),d[2]);const x=[0,0,0];return a.a6.vec3.add(x,_,v),a.cb(x)}const ic=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],dv=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class yl{static cacheKey(n,l,f,_){let v=`${l}${_?_.cacheKey:""}`;for(const x of f)n.usedDefines.includes(x)&&(v+=`/${x}`);return v}constructor(n,l,f,_,v,x){const C=n.gl;this.program=C.createProgram(),this.configuration=_,this.name=l,this.fixedDefines=[...x];const D=_?_.getBinderAttributes():[],L=(f.staticAttributes||[]).concat(D);let B=_?_.defines():[];B=B.concat(x.map(Y=>`#define ${Y}`));const $=`#version 300 es
`;let j=$+B.concat("precision mediump float;",yf,Oh.fragmentSource).join(`
`);for(const Y of f.fragmentIncludes)j+=`
${Sh[Y]}`;j+=`
${f.fragmentSource}`;let U=$+B.concat("precision highp float;",yf,Oh.vertexSource).join(`
`);for(const Y of f.vertexIncludes)U+=`
${Sh[Y]}`;U+=`
${f.vertexSource}`;const Z=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(Z,j),C.compileShader(Z),C.attachShader(this.program,Z);const X=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(X,U),C.compileShader(X),C.attachShader(this.program,X),this.attributes={},this.numAttributes=L.length;for(let Y=0;Y<this.numAttributes;Y++)if(L[Y]){const J=L[Y].startsWith("a_")?L[Y]:`a_${L[Y]}`;C.bindAttribLocation(this.program,Y,J),this.attributes[J]=Y}C.linkProgram(this.program),C.deleteShader(X),C.deleteShader(Z),this.fixedUniforms=v(n),this.binderUniforms=_?_.getUniforms(n):[],(x.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(Y=>({u_dem:new a.bJ(Y),u_dem_prev:new a.bJ(Y),u_dem_tl:new a.bG(Y),u_dem_scale:new a.bI(Y),u_dem_tl_prev:new a.bG(Y),u_dem_scale_prev:new a.bI(Y),u_dem_size:new a.bI(Y),u_dem_lerp:new a.bI(Y),u_exaggeration:new a.bI(Y),u_depth:new a.bJ(Y),u_depth_size_inv:new a.bG(Y),u_depth_range_unpack:new a.bG(Y),u_occluder_half_size:new a.bI(Y),u_occlusion_depth_offset:new a.bI(Y),u_meter_to_dem:new a.bI(Y),u_label_plane_matrix_inv:new a.bF(Y)}))(n)),x.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new a.bH(Y),u_tile_tr_up:new a.bH(Y),u_tile_br_up:new a.bH(Y),u_tile_bl_up:new a.bH(Y),u_tile_up_scale:new a.bI(Y)}))(n)),x.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new a.bF(Y),u_fog_range:new a.bG(Y),u_fog_color:new a.c6(Y),u_fog_horizon_blend:new a.bI(Y),u_fog_vertical_limit:new a.bG(Y),u_fog_temporal_offset:new a.bI(Y),u_frustum_tl:new a.bH(Y),u_frustum_tr:new a.bH(Y),u_frustum_br:new a.bH(Y),u_frustum_bl:new a.bH(Y),u_globe_pos:new a.bH(Y),u_globe_radius:new a.bI(Y),u_globe_transition:new a.bI(Y),u_is_globe:new a.bJ(Y),u_viewport:new a.bG(Y)}))(n)),x.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Y=>({u_cutoff_params:new a.c6(Y)}))(n)),x.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Y=>({u_lighting_ambient_color:new a.bH(Y),u_lighting_directional_dir:new a.bH(Y),u_lighting_directional_color:new a.bH(Y),u_ground_radiance:new a.bH(Y)}))(n)),x.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Y=>({u_light_matrix_0:new a.bF(Y),u_light_matrix_1:new a.bF(Y),u_fade_range:new a.bG(Y),u_shadow_normal_offset:new a.bH(Y),u_shadow_intensity:new a.bI(Y),u_shadow_texel_size:new a.bI(Y),u_shadow_map_resolution:new a.bI(Y),u_shadow_direction:new a.bH(Y),u_shadow_bias:new a.bH(Y),u_shadowmap_0:new a.bJ(Y),u_shadowmap_1:new a.bJ(Y)}))(n))}}setTerrainUniformValues(n,l){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in l)f[_]&&f[_].set(this.program,_,l[_])}}setGlobeUniformValues(n,l){if(!this.globeUniforms)return;const f=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in l)f[_]&&f[_].set(this.program,_,l[_])}}setFogUniformValues(n,l){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in l)f[_].set(this.program,_,l[_])}}setCutoffUniformValues(n,l){if(!this.cutoffUniforms)return;const f=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in l)f[_].set(this.program,_,l[_])}}setLightsUniformValues(n,l){if(!this.lightsUniforms)return;const f=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in l)f[_].set(this.program,_,l[_])}}setShadowUniformValues(n,l){if(this.failedToCreate||!this.shadowUniforms)return;const f=this.shadowUniforms;n.program.set(this.program);for(const _ in l)f[_].set(this.program,_,l[_])}_drawDebugWireframe(n,l,f,_,v,x,C,D,L,B){const $=n.options.wireframe;if($.terrain===!1&&$.layers2D===!1&&$.layers3D===!1)return;const j=n.context;if(!(()=>!(!$.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!$.layers2D||n._terrain&&n._terrain.renderingToTexture||!ic.includes(this.name))||!(!$.layers3D||!dv.includes(this.name)))())return;const U=j.gl,Z=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,v,j);if(!Z)return;const X=[...this.fixedDefines];X.push("DEBUG_WIREFRAME");const Y=n.getOrCreateProgram(this.name,{config:this.configuration,defines:X});j.program.set(Y.program);const J=(oe,fe,de)=>{if(fe[oe]&&de[oe])for(const ye in fe[oe])de[oe][ye]&&de[oe][ye].set(de.program,ye,fe[oe][ye].current)};L&&L.setUniforms(Y.program,j,Y.binderUniforms,C,{zoom:D}),J("fixedUniforms",this,Y),J("terrainUniforms",this,Y),J("globeUniforms",this,Y),J("fogUniforms",this,Y),J("lightsUniforms",this,Y),J("shadowUniforms",this,Y),Z.bind(),j.setColorMode(new kr([U.ONE,U.ONE_MINUS_SRC_ALPHA,U.ZERO,U.ONE],a.bz.transparent,[!0,!0,!0,!1])),j.setDepthMode(new Qt(l.func===U.LESS?U.LEQUAL:l.func,Qt.ReadOnly,l.range)),j.setStencilMode(yr.disabled);const ae=3*x.primitiveLength*2,ce=3*x.primitiveOffset*2*2;B&&B>1?U.drawElementsInstanced(U.LINES,ae,U.UNSIGNED_SHORT,ce,B):U.drawElements(U.LINES,ae,U.UNSIGNED_SHORT,ce),v.bind(),j.program.set(this.program),j.setDepthMode(l),j.setStencilMode(f),j.setColorMode(_)}draw(n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y){const J=n.context,ae=J.gl;if(this.failedToCreate)return;J.program.set(this.program),J.setDepthMode(f),J.setStencilMode(_),J.setColorMode(v),J.setCullFace(x);for(const fe of Object.keys(this.fixedUniforms))this.fixedUniforms[fe].set(this.program,fe,C[fe]);Z&&Z.setUniforms(this.program,J,this.binderUniforms,j,{zoom:U});const ce={[ae.POINTS]:1,[ae.LINES]:2,[ae.TRIANGLES]:3,[ae.LINE_STRIP]:1}[l],oe=Y&&Y>0?1:void 0;for(const fe of $.get()){const de=fe.vaos||(fe.vaos={});(de[D]||(de[D]=new su)).bind(J,this,L,Z?Z.getPaintVertexBuffers():[],B,fe.vertexOffset,X||[],oe),Y&&Y>1?ae.drawElementsInstanced(l,fe.primitiveLength*ce,ae.UNSIGNED_SHORT,fe.primitiveOffset*ce*2,Y):B?ae.drawElements(l,fe.primitiveLength*ce,ae.UNSIGNED_SHORT,fe.primitiveOffset*ce*2):ae.drawArrays(l,fe.vertexOffset,fe.vertexLength),l===ae.TRIANGLES&&B&&this._drawDebugWireframe(n,f,_,v,B,fe,j,U,Z,Y)}}}function Gm(d,n){const l=Math.pow(2,n.tileID.overscaledZ),f=n.tileSize*Math.pow(2,d.transform.tileZoom)/l,_=f*(n.tileID.canonical.x+n.tileID.wrap*l),v=f*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.ak(n,1,d.transform.tileZoom),u_pixel_coord_upper:[_>>16,v>>16],u_pixel_coord_lower:[65535&_,65535&v]}}const Pf=a.a6.mat4.create(),Hm=(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X)=>{const Y=n.style.light,J=Y.properties.get("position"),ae=[J.x,J.y,J.z],ce=a.a6.mat3.create();Y.properties.get("anchor")==="viewport"&&(a.a6.mat3.fromRotation(ce,-n.transform.angle),a.a6.vec3.transformMat3(ae,ae,ce));const oe=Y.properties.get("color"),fe=n.transform,de={u_matrix:d,u_lightpos:ae,u_lightintensity:Y.properties.get("intensity"),u_lightcolor:[oe.r,oe.g,oe.b],u_vertical_gradient:+l,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Pf,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:v,u_width_scale:x,u_flood_light_color:j,u_vertical_scale:U,u_flood_light_intensity:Z,u_ground_shadow_factor:X};return fe.projection.name==="globe"&&(de.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],de.u_zoom_transition=L,de.u_inv_rot_matrix=$,de.u_merc_center=B,de.u_up_dir=fe.projection.upVector(new a.bP(0,0,0),B[0]*a.ab,B[1]*a.ab),de.u_height_lift=D),de},fv=(d,n,l,f)=>({u_matrix:d,u_edge_radius:n,u_width_scale:l,u_vertical_scale:f}),qm=(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z)=>{const X=Hm(d,n,l,f,_,v,x,C,L,B,$,j,U,Z,1,[0,0,0]),Y={u_height_factor:-Math.pow(2,C.overscaledZ)/D.tileSize/8};return a.l(X,Gm(n,D),Y)},Af=(d,n)=>({u_matrix:d,u_emissive_strength:n}),pv=(d,n,l,f)=>a.l(Af(d,n),Gm(l,f)),mv=(d,n,l)=>({u_matrix:d,u_world:l,u_emissive_strength:n}),Lh=(d,n,l,f,_)=>a.l(pv(d,n,l,f),{u_world:_}),X1=(d,n,l,f)=>{const _=a.ab/l.tileSize;return{u_matrix:d,u_camera_to_center_distance:n.getCameraToCenterDistance(f),u_extrude_scale:[n.pixelsToGLUnits[0]/_,n.pixelsToGLUnits[1]/_]}},gv=(d,n,l=1)=>({u_matrix:d,u_color:n.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),_v=a.a6.mat4.create(),K1=(d,n,l,f,_,v,x)=>{const C=d.transform,D=C.projection.name==="globe",L=D?a.cI(C.zoom,n.canonical)*C._pixelsPerMercatorPixel:a.ak(l,1,v),B={u_matrix:n.projMatrix,u_extrude_scale:L,u_intensity:x,u_inv_rot_matrix:_v,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){B.u_inv_rot_matrix=f,B.u_merc_center=_,B.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],B.u_zoom_transition=a.a9(C.zoom);const $=_[0]*a.ab,j=_[1]*a.ab;B.u_up_dir=C.projection.upVector(new a.bP(0,0,0),$,j)}return B};function Cf(d,[n,l,f,_],[v,x]){if(v===x)return[0,0,0,0];const C=255*(d-1)/(d*(x-v));return[n*C,l*C,f*C,_*C]}function Mf(d,n,[l,f]){return l===f?0:.5/d+(n-l)*(d-1)/(d*(f-l))}const Bh=(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y,J,ae,ce,oe)=>({u_matrix:d,u_normalize_matrix:n,u_globe_matrix:l,u_merc_matrix:f,u_grid_matrix:_,u_tl_parent:v,u_scale_parent:L,u_fade_t:B.mix,u_opacity:B.opacity*$.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:$.paint.get("raster-brightness-min"),u_brightness_high:$.paint.get("raster-brightness-max"),u_saturation_factor:a.cJ($.paint.get("raster-saturation")),u_contrast_factor:a.cK($.paint.get("raster-contrast")),u_spin_weights:Wm($.paint.get("raster-hue-rotate")),u_perspective_transform:j,u_raster_elevation:U,u_zoom_transition:x,u_merc_center:C,u_cutoff_params:D,u_colorization_mix:Cf(a.cL,X,J),u_colorization_offset:Mf(a.cL,Y,J),u_color_ramp:Z,u_texture_offset:[ce/(ae+2*ce),ae/(ae+2*ce)],u_texture_res:[ae+2*ce,ae+2*ce],u_emissive_strength:oe});function Wm(d){d*=Math.PI/180;const n=Math.sin(d),l=Math.cos(d);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const _a=.05,yv=(d,n,l,f,_,v,x,C,D,L,B,$)=>({u_matrix:d,u_normalize_matrix:n,u_globe_matrix:l,u_merc_matrix:f,u_grid_matrix:_,u_tl_parent:v,u_scale_parent:L,u_fade_t:B.mix,u_opacity:B.opacity,u_image0:0,u_image1:1,u_raster_elevation:$,u_zoom_transition:x,u_merc_center:C,u_cutoff_params:D}),If=(d,n,l,f,_,v,x,C,D,L)=>({u_particle_texture:d,u_particle_texture_side_len:n,u_tile_offset:l,u_velocity:f,u_color_ramp:v,u_velocity_res:_,u_max_speed:x,u_uv_offset:C,u_data_scale:[255*D[0],255*D[1]],u_data_offset:L,u_particle_pos_scale:1.1,u_particle_pos_offset:[_a,_a]}),Df=(d,n,l,f,_,v,x,C,D,L)=>({u_particle_texture:d,u_particle_texture_side_len:n,u_velocity:l,u_velocity_res:f,u_max_speed:_,u_speed_factor:v,u_reset_rate:x,u_rand_seed:Math.random(),u_uv_offset:C,u_data_scale:[255*D[0],255*D[1]],u_data_offset:L,u_particle_pos_scale:1.1,u_particle_pos_offset:[_a,_a]}),Rf=a.a6.mat4.create(),Zm=(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y,J,ae,ce,oe)=>{const fe=_.transform,de={u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:fe.getCameraToCenterDistance(ae),u_rotate_symbol:+l,u_aspect_ratio:fe.width/fe.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:x,u_coord_matrix:C,u_is_text:+L,u_elevation_from_sea:D?1:0,u_pitch_with_map:+f,u_texsize:B,u_texsize_icon:$,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Rf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Rf,u_up_vector:[0,-1,0],u_color_adj_mat:ce,u_icon_transition:oe||0,u_gamma_scale:f?_.transform.getCameraToCenterDistance(ae)*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:a.q.devicePixelRatio,u_is_halo:+j};return ae.name==="globe"&&(de.u_tile_id=[U.canonical.x,U.canonical.y,1<<U.canonical.z],de.u_zoom_transition=Z,de.u_inv_rot_matrix=Y,de.u_merc_center=X,de.u_camera_forward=fe._camera.forward(),de.u_ecef_origin=a.cM(fe.globeMatrix,U.toUnwrapped()),de.u_tile_matrix=Float32Array.from(fe.globeMatrix),de.u_up_vector=J),de},vv=(d,n,l,f)=>({u_matrix:d,u_emissive_strength:n,u_opacity:l,u_color:f}),nc=(d,n,l,f,_,v,x,C,D)=>a.l(function(L,B,$,j,U,Z){const{width:X,height:Y}=j.imageManager.getPixelSize(B),J=Math.pow(2,Z.tileID.overscaledZ),ae=Z.tileSize*Math.pow(2,j.transform.tileZoom)/J,ce=ae*(Z.tileID.canonical.x+Z.tileID.wrap*J),oe=ae*Z.tileID.canonical.y;return{u_image:0,u_pattern_tl:$.tl,u_pattern_br:$.br,u_texsize:[X,Y],u_pattern_size:$.displaySize,u_pattern_units_to_pixels:U?[j.transform.width,-1*j.transform.height]:[1/a.ak(Z,1,j.transform.tileZoom),1/a.ak(Z,1,j.transform.tileZoom)],u_pixel_coord_upper:[ce>>16,oe>>16],u_pixel_coord_lower:[65535&ce,65535&oe]}}(0,v,x,f,C,D),{u_matrix:d,u_emissive_strength:n,u_opacity:l}),hu=new Float32Array(a.a6.mat4.identity([])),jt=(d,n,l,f,_,v,x,C,D,L,B,$,j,U=[0,0,0],Z)=>{const X=_.style.light,Y=X.properties.get("position"),J=[-Y.x,-Y.y,Y.z],ae=a.a6.mat3.create();X.properties.get("anchor")==="viewport"&&(a.a6.mat3.fromRotation(ae,-_.transform.angle),a.a6.vec3.transformMat3(J,J,ae));const ce=B.alphaMode==="MASK",oe=X.properties.get("color").toRenderColor(null),fe=j.paint.get("model-ambient-occlusion-intensity"),de=j.paint.get("model-color").constantOr(a.bz.white).toRenderColor(null),ye=j.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:d,u_lighting_matrix:n,u_normal_matrix:l,u_node_matrix:f||hu,u_lightpos:J,u_lightintensity:X.properties.get("intensity"),u_lightcolor:[oe.r,oe.g,oe.b],u_camera_pos:U,u_opacity:v,u_baseTextureIsAlpha:0,u_alphaMask:+ce,u_alphaCutoff:B.alphaCutoff,u_baseColorFactor:[x.r,x.g,x.b,x.a],u_emissiveFactor:[C[0],C[1],C[2],1],u_metallicFactor:D,u_roughnessFactor:L,u_baseColorTexture:ro.BaseColor,u_metallicRoughnessTexture:ro.MetallicRoughness,u_normalTexture:ro.Normal,u_occlusionTexture:ro.Occlusion,u_emissionTexture:ro.Emission,u_lutTexture:ro.LUT,u_color_mix:[de.r,de.g,de.b,ye],u_aoIntensity:fe,u_emissive_strength:$,u_occlusionTextureTransform:Z||[0,0,0,0]}},Xm=(d,n=hu,l=hu)=>({u_matrix:d,u_instance:n,u_node_matrix:l}),bv={fillExtrusion:d=>({u_matrix:new a.bF(d),u_lightpos:new a.bH(d),u_lightintensity:new a.bI(d),u_lightcolor:new a.bH(d),u_vertical_gradient:new a.bI(d),u_opacity:new a.bI(d),u_edge_radius:new a.bI(d),u_width_scale:new a.bI(d),u_ao:new a.bG(d),u_tile_id:new a.bH(d),u_zoom_transition:new a.bI(d),u_inv_rot_matrix:new a.bF(d),u_merc_center:new a.bG(d),u_up_dir:new a.bH(d),u_height_lift:new a.bI(d),u_flood_light_color:new a.bH(d),u_vertical_scale:new a.bI(d),u_flood_light_intensity:new a.bI(d),u_ground_shadow_factor:new a.bH(d)}),fillExtrusionDepth:d=>({u_matrix:new a.bF(d),u_edge_radius:new a.bI(d),u_width_scale:new a.bI(d),u_vertical_scale:new a.bI(d)}),fillExtrusionPattern:d=>({u_matrix:new a.bF(d),u_lightpos:new a.bH(d),u_lightintensity:new a.bI(d),u_lightcolor:new a.bH(d),u_vertical_gradient:new a.bI(d),u_height_factor:new a.bI(d),u_edge_radius:new a.bI(d),u_width_scale:new a.bI(d),u_ao:new a.bG(d),u_tile_id:new a.bH(d),u_zoom_transition:new a.bI(d),u_inv_rot_matrix:new a.bF(d),u_merc_center:new a.bG(d),u_up_dir:new a.bH(d),u_height_lift:new a.bI(d),u_image:new a.bJ(d),u_texsize:new a.bG(d),u_pixel_coord_upper:new a.bG(d),u_pixel_coord_lower:new a.bG(d),u_tile_units_to_pixels:new a.bI(d),u_opacity:new a.bI(d)}),fillExtrusionGroundEffect:d=>({u_matrix:new a.bF(d),u_opacity:new a.bI(d),u_ao_pass:new a.bI(d),u_meter_to_tile:new a.bI(d),u_ao:new a.bG(d),u_flood_light_intensity:new a.bI(d),u_flood_light_color:new a.bH(d),u_attenuation:new a.bI(d),u_edge_radius:new a.bI(d),u_fb:new a.bJ(d),u_fb_size:new a.bI(d),u_dynamic_offset:new a.bI(d)}),fill:d=>({u_matrix:new a.bF(d),u_emissive_strength:new a.bI(d)}),fillPattern:d=>({u_matrix:new a.bF(d),u_emissive_strength:new a.bI(d),u_image:new a.bJ(d),u_texsize:new a.bG(d),u_pixel_coord_upper:new a.bG(d),u_pixel_coord_lower:new a.bG(d),u_tile_units_to_pixels:new a.bI(d)}),fillOutline:d=>({u_matrix:new a.bF(d),u_emissive_strength:new a.bI(d),u_world:new a.bG(d)}),fillOutlinePattern:d=>({u_matrix:new a.bF(d),u_emissive_strength:new a.bI(d),u_world:new a.bG(d),u_image:new a.bJ(d),u_texsize:new a.bG(d),u_pixel_coord_upper:new a.bG(d),u_pixel_coord_lower:new a.bG(d),u_tile_units_to_pixels:new a.bI(d)}),circle:a.cN,collisionBox:d=>({u_matrix:new a.bF(d),u_camera_to_center_distance:new a.bI(d),u_extrude_scale:new a.bG(d)}),collisionCircle:d=>({u_matrix:new a.bF(d),u_inv_matrix:new a.bF(d),u_camera_to_center_distance:new a.bI(d),u_viewport_size:new a.bG(d)}),debug:d=>({u_color:new a.cu(d),u_matrix:new a.bF(d),u_overlay:new a.bJ(d),u_overlay_scale:new a.bI(d)}),clippingMask:d=>({u_matrix:new a.bF(d)}),heatmap:d=>({u_extrude_scale:new a.bI(d),u_intensity:new a.bI(d),u_matrix:new a.bF(d),u_inv_rot_matrix:new a.bF(d),u_merc_center:new a.bG(d),u_tile_id:new a.bH(d),u_zoom_transition:new a.bI(d),u_up_dir:new a.bH(d)}),heatmapTexture:d=>({u_image:new a.bJ(d),u_color_ramp:new a.bJ(d),u_opacity:new a.bI(d)}),hillshade:d=>({u_matrix:new a.bF(d),u_image:new a.bJ(d),u_latrange:new a.bG(d),u_light:new a.bG(d),u_shadow:new a.cu(d),u_highlight:new a.cu(d),u_emissive_strength:new a.bI(d),u_accent:new a.cu(d)}),hillshadePrepare:d=>({u_matrix:new a.bF(d),u_image:new a.bJ(d),u_dimension:new a.bG(d),u_zoom:new a.bI(d)}),line:a.cO,linePattern:a.cP,raster:d=>({u_matrix:new a.bF(d),u_normalize_matrix:new a.bF(d),u_globe_matrix:new a.bF(d),u_merc_matrix:new a.bF(d),u_grid_matrix:new a.cv(d),u_tl_parent:new a.bG(d),u_scale_parent:new a.bI(d),u_fade_t:new a.bI(d),u_opacity:new a.bI(d),u_image0:new a.bJ(d),u_image1:new a.bJ(d),u_brightness_low:new a.bI(d),u_brightness_high:new a.bI(d),u_saturation_factor:new a.bI(d),u_contrast_factor:new a.bI(d),u_spin_weights:new a.bH(d),u_perspective_transform:new a.bG(d),u_raster_elevation:new a.bI(d),u_zoom_transition:new a.bI(d),u_merc_center:new a.bG(d),u_cutoff_params:new a.c6(d),u_colorization_mix:new a.c6(d),u_colorization_offset:new a.bI(d),u_color_ramp:new a.bJ(d),u_texture_offset:new a.bG(d),u_texture_res:new a.bG(d),u_emissive_strength:new a.bI(d)}),rasterParticle:d=>({u_matrix:new a.bF(d),u_normalize_matrix:new a.bF(d),u_globe_matrix:new a.bF(d),u_merc_matrix:new a.bF(d),u_grid_matrix:new a.cv(d),u_tl_parent:new a.bG(d),u_scale_parent:new a.bI(d),u_fade_t:new a.bI(d),u_opacity:new a.bI(d),u_image0:new a.bJ(d),u_image1:new a.bJ(d),u_raster_elevation:new a.bI(d),u_zoom_transition:new a.bI(d),u_merc_center:new a.bG(d),u_cutoff_params:new a.c6(d)}),rasterParticleTexture:d=>({u_texture:new a.bJ(d),u_opacity:new a.bI(d)}),rasterParticleDraw:d=>({u_particle_texture:new a.bJ(d),u_particle_texture_side_len:new a.bI(d),u_tile_offset:new a.bG(d),u_velocity:new a.bJ(d),u_color_ramp:new a.bJ(d),u_velocity_res:new a.bG(d),u_max_speed:new a.bI(d),u_uv_offset:new a.bG(d),u_data_scale:new a.bG(d),u_data_offset:new a.bI(d),u_particle_pos_scale:new a.bI(d),u_particle_pos_offset:new a.bG(d)}),rasterParticleUpdate:d=>({u_particle_texture:new a.bJ(d),u_particle_texture_side_len:new a.bI(d),u_velocity:new a.bJ(d),u_velocity_res:new a.bG(d),u_max_speed:new a.bI(d),u_speed_factor:new a.bI(d),u_reset_rate:new a.bI(d),u_rand_seed:new a.bI(d),u_uv_offset:new a.bG(d),u_data_scale:new a.bG(d),u_data_offset:new a.bI(d),u_particle_pos_scale:new a.bI(d),u_particle_pos_offset:new a.bG(d)}),symbol:d=>({u_is_size_zoom_constant:new a.bJ(d),u_is_size_feature_constant:new a.bJ(d),u_size_t:new a.bI(d),u_size:new a.bI(d),u_camera_to_center_distance:new a.bI(d),u_rotate_symbol:new a.bJ(d),u_aspect_ratio:new a.bI(d),u_fade_change:new a.bI(d),u_matrix:new a.bF(d),u_label_plane_matrix:new a.bF(d),u_coord_matrix:new a.bF(d),u_is_text:new a.bJ(d),u_elevation_from_sea:new a.bJ(d),u_pitch_with_map:new a.bJ(d),u_texsize:new a.bG(d),u_texsize_icon:new a.bG(d),u_texture:new a.bJ(d),u_texture_icon:new a.bJ(d),u_gamma_scale:new a.bI(d),u_device_pixel_ratio:new a.bI(d),u_tile_id:new a.bH(d),u_zoom_transition:new a.bI(d),u_inv_rot_matrix:new a.bF(d),u_merc_center:new a.bG(d),u_camera_forward:new a.bH(d),u_tile_matrix:new a.bF(d),u_up_vector:new a.bH(d),u_ecef_origin:new a.bH(d),u_is_halo:new a.bJ(d),u_icon_transition:new a.bI(d),u_color_adj_mat:new a.bF(d)}),background:d=>({u_matrix:new a.bF(d),u_emissive_strength:new a.bI(d),u_opacity:new a.bI(d),u_color:new a.cu(d)}),backgroundPattern:d=>({u_matrix:new a.bF(d),u_emissive_strength:new a.bI(d),u_opacity:new a.bI(d),u_image:new a.bJ(d),u_pattern_tl:new a.bG(d),u_pattern_br:new a.bG(d),u_texsize:new a.bG(d),u_pattern_size:new a.bG(d),u_pixel_coord_upper:new a.bG(d),u_pixel_coord_lower:new a.bG(d),u_pattern_units_to_pixels:new a.bG(d)}),terrainRaster:d=>({u_matrix:new a.bF(d),u_image0:new a.bJ(d),u_skirt_height:new a.bI(d),u_ground_shadow_factor:new a.bH(d)}),skybox:d=>({u_matrix:new a.bF(d),u_sun_direction:new a.bH(d),u_cubemap:new a.bJ(d),u_opacity:new a.bI(d),u_temporal_offset:new a.bI(d)}),skyboxGradient:d=>({u_matrix:new a.bF(d),u_color_ramp:new a.bJ(d),u_center_direction:new a.bH(d),u_radius:new a.bI(d),u_opacity:new a.bI(d),u_temporal_offset:new a.bI(d)}),skyboxCapture:d=>({u_matrix_3f:new a.cv(d),u_sun_direction:new a.bH(d),u_sun_intensity:new a.bI(d),u_color_tint_r:new a.c6(d),u_color_tint_m:new a.c6(d),u_luminance:new a.bI(d)}),globeRaster:d=>({u_proj_matrix:new a.bF(d),u_globe_matrix:new a.bF(d),u_normalize_matrix:new a.bF(d),u_merc_matrix:new a.bF(d),u_zoom_transition:new a.bI(d),u_merc_center:new a.bG(d),u_image0:new a.bJ(d),u_grid_matrix:new a.cv(d),u_skirt_height:new a.bI(d),u_far_z_cutoff:new a.bI(d),u_frustum_tl:new a.bH(d),u_frustum_tr:new a.bH(d),u_frustum_br:new a.bH(d),u_frustum_bl:new a.bH(d),u_globe_pos:new a.bH(d),u_globe_radius:new a.bI(d),u_viewport:new a.bG(d)}),globeAtmosphere:d=>({u_frustum_tl:new a.bH(d),u_frustum_tr:new a.bH(d),u_frustum_br:new a.bH(d),u_frustum_bl:new a.bH(d),u_horizon:new a.bI(d),u_transition:new a.bI(d),u_fadeout_range:new a.bI(d),u_color:new a.c6(d),u_high_color:new a.c6(d),u_space_color:new a.c6(d),u_temporal_offset:new a.bI(d),u_horizon_angle:new a.bI(d)}),model:d=>({u_matrix:new a.bF(d),u_lighting_matrix:new a.bF(d),u_normal_matrix:new a.bF(d),u_node_matrix:new a.bF(d),u_lightpos:new a.bH(d),u_lightintensity:new a.bI(d),u_lightcolor:new a.bH(d),u_camera_pos:new a.bH(d),u_opacity:new a.bI(d),u_baseColorFactor:new a.c6(d),u_emissiveFactor:new a.c6(d),u_metallicFactor:new a.bI(d),u_roughnessFactor:new a.bI(d),u_baseTextureIsAlpha:new a.bJ(d),u_alphaMask:new a.bJ(d),u_alphaCutoff:new a.bI(d),u_baseColorTexture:new a.bJ(d),u_metallicRoughnessTexture:new a.bJ(d),u_normalTexture:new a.bJ(d),u_occlusionTexture:new a.bJ(d),u_emissionTexture:new a.bJ(d),u_lutTexture:new a.bJ(d),u_color_mix:new a.c6(d),u_aoIntensity:new a.bI(d),u_emissive_strength:new a.bI(d),u_occlusionTextureTransform:new a.c6(d)}),modelDepth:d=>({u_matrix:new a.bF(d),u_instance:new a.bF(d),u_node_matrix:new a.bF(d)}),groundShadow:d=>({u_matrix:new a.bF(d),u_ground_shadow_factor:new a.bH(d)}),stars:d=>({u_matrix:new a.bF(d),u_up:new a.bH(d),u_right:new a.bH(d),u_intensity_multiplier:new a.bI(d)}),occlusion:d=>({u_matrix:new a.bF(d),u_anchorPos:new a.bH(d),u_screenSizePx:new a.bG(d),u_occluderSizePx:new a.bG(d),u_color:new a.c6(d)})};class Fo{constructor(n,l,f,_){this.id=Fo.uniqueIdxCounter,Fo.uniqueIdxCounter++,this.context=n;const v=n.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(f),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||_||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=Fo.uniqueIdxCounter,Fo.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Fo.uniqueIdxCounter=0;const oc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wt{constructor(n,l,f,_,v,x){this.length=l.length,this.attributes=f,this.itemSize=l.bytesPerElement,this.dynamicDraw=_,this.instanceCount=x,this.context=n;const C=n.gl;this.buffer=C.createBuffer(),n.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||v||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let f=0;f<this.attributes.length;f++){const _=l.attributes[this.attributes[f].name];_!==void 0&&n.enableVertexAttribArray(_)}}setVertexAttribPointers(n,l,f){for(let _=0;_<this.attributes.length;_++){const v=this.attributes[_],x=l.attributes[v.name];x!==void 0&&n.vertexAttribPointer(x,v.components,n[oc[v.type]],!1,this.itemSize,v.offset+this.itemSize*(f||0))}}setVertexAttribDivisor(n,l,f){for(let _=0;_<this.attributes.length;_++){const v=l.attributes[this.attributes[_].name];v!==void 0&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(v,f)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Lf{constructor(n,l,f,_,v){this.context=n,this.width=l,this.height=f;const x=this.framebuffer=n.gl.createFramebuffer();_&&(this.colorAttachment=new Sf(n,x)),v&&(this.depthAttachmentType=v,this.depthAttachment=v==="renderbuffer"?new Nm(n,x):new sv(n,x))}destroy(){const n=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&n.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&n.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&n.deleteTexture(l)}n.deleteFramebuffer(this.framebuffer)}}class Y1{constructor(n,l){this.gl=n,this.clearColor=new Cm(this),this.clearDepth=new Jy(this),this.clearStencil=new Mm(this),this.colorMask=new xf(this),this.depthMask=new Ch(this),this.stencilMask=new Qy(this),this.stencilFunc=new ev(this),this.stencilOp=new tv(this),this.stencilTest=new au(this),this.depthRange=new rv(this),this.depthTest=new G1(this),this.depthFunc=new H1(this),this.blend=new q1(this),this.blendFunc=new Im(this),this.blendColor=new Dm(this),this.blendEquation=new Rm(this),this.cullFace=new Lm(this),this.cullFaceSide=new iv(this),this.frontFace=new nv(this),this.program=new W1(this),this.activeTexture=new Mh(this),this.viewport=new Ih(this),this.bindFramebuffer=new ov(this),this.bindRenderbuffer=new Jo(this),this.bindTexture=new Bm(this),this.bindVertexBuffer=new wf(this),this.bindElementBuffer=new Tf(this),this.bindVertexArrayOES=new km(this),this.pixelStoreUnpack=new zm(this),this.pixelStoreUnpackPremultiplyAlpha=new Ef(this),this.pixelStoreUnpackFlipY=new Fm(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l,f){return new Fo(this,n,l,f)}createVertexBuffer(n,l,f,_,v){return new Wt(this,n,l,f,_,v)}createRenderbuffer(n,l,f){const _=this.gl,v=_.createRenderbuffer();return this.bindRenderbuffer.set(v),_.renderbufferStorage(_.RENDERBUFFER,n,l,f),this.bindRenderbuffer.set(null),v}createFramebuffer(n,l,f,_){return new Lf(this,n,l,f,_)}clear({color:n,depth:l,stencil:f,colorMask:_}){const v=this.gl;let x=0;n&&(x|=v.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set(_||[!0,!0,!0,!0])),l!==void 0&&(x|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),f!==void 0&&(x|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),v.clear(x)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){a.bh(n.blendFunction,kr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Bf;function kf(d,n,l,f,_,v,x){const C=d.context,D=C.gl,L=d.transform,B=d.getOrCreateProgram("collisionBox"),$=[];let j=0,U=0;for(let oe=0;oe<f.length;oe++){const fe=f[oe],de=n.getTile(fe),ye=de.getBucket(l);if(!ye)continue;const ge=Ny(fe,ye,L);let ve=ge;_[0]===0&&_[1]===0||(ve=d.translatePosMatrix(ge,de,_,v));const Ce=x?ye.textCollisionBox:ye.iconCollisionBox,Oe=ye.collisionCircleArray;if(Oe.length>0){const Te=a.a6.mat4.create(),$e=ve;a.a6.mat4.mul(Te,ye.placementInvProjMatrix,L.glCoordMatrix),a.a6.mat4.mul(Te,Te,ye.placementViewportMatrix),$.push({circleArray:Oe,circleOffset:U,transform:$e,invTransform:Te,projection:ye.getProjection()}),j+=Oe.length/4,U=j}Ce&&(d.terrain&&d.terrain.setupElevationDraw(de,B),B.draw(d,D.LINES,Qt.disabled,yr.disabled,d.colorModeForRenderPass(),lr.disabled,X1(ve,L,de,ye.getProjection()),l.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,null,L.zoom,null,[Ce.collisionVertexBuffer,Ce.collisionVertexBufferExt]))}if(!x||!$.length)return;const Z=d.getOrCreateProgram("collisionCircle"),X=new a.cQ;X.resize(4*j),X._trim();let Y=0;for(const oe of $)for(let fe=0;fe<oe.circleArray.length/4;fe++){const de=4*fe,ye=oe.circleArray[de+0],ge=oe.circleArray[de+1],ve=oe.circleArray[de+2],Ce=oe.circleArray[de+3];X.emplace(Y++,ye,ge,ve,Ce,0),X.emplace(Y++,ye,ge,ve,Ce,1),X.emplace(Y++,ye,ge,ve,Ce,2),X.emplace(Y++,ye,ge,ve,Ce,3)}(!Bf||Bf.length<2*j)&&(Bf=function(oe){const fe=2*oe,de=new a.aO;de.resize(fe),de._trim();for(let ye=0;ye<fe;ye++){const ge=6*ye;de.uint16[ge+0]=4*ye+0,de.uint16[ge+1]=4*ye+1,de.uint16[ge+2]=4*ye+2,de.uint16[ge+3]=4*ye+2,de.uint16[ge+4]=4*ye+3,de.uint16[ge+5]=4*ye+0}return de}(j));const J=C.createIndexBuffer(Bf,!0),ae=C.createVertexBuffer(X,a.cR.members,!0);for(const oe of $){const fe={u_matrix:oe.transform,u_inv_matrix:oe.invTransform,u_camera_to_center_distance:(ce=L).getCameraToCenterDistance(oe.projection),u_viewport_size:[ce.width,ce.height]};Z.draw(d,D.TRIANGLES,Qt.disabled,yr.disabled,d.colorModeForRenderPass(),lr.disabled,fe,l.id,ae,J,a.b1.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,L.zoom)}var ce;ae.destroy(),J.destroy()}const kh=a.a6.mat4.create();function Km(d){const n=d._camera.getWorldToCamera(d.worldSize,1),l=a.a6.mat4.multiply([],n,d.globeMatrix);a.a6.mat4.invert(l,l);const f=[0,0,0],_=[0,1,0,0];return a.a6.vec4.transformMat4(_,_,l),f[0]=_[0],f[1]=_[1],f[2]=_[2],a.a6.vec3.normalize(f,f),f}function J1({width:d,height:n,anchor:l,textOffset:f,textScale:_},v){const{horizontalAlign:x,verticalAlign:C}=a.bx(l),D=-(x-.5)*d,L=-(C-.5)*n,B=a.bw(l,f);return new a.P((D/_+B[0])*v,(L/_+B[1])*v)}function Q1(d,n,l,f,_,v,x,C,D,L,B){const $=d.text.placedSymbolArray,j=d.text.dynamicLayoutVertexArray,U=d.icon.dynamicLayoutVertexArray,Z={},X=d.getProjection(),Y=pl(C,X,v),J=v.elevation,ae=X.upVectorScale(C.canonical,v.center.lat,v.worldSize).metersToTile;j.clear();for(let ce=0;ce<$.length;ce++){const oe=$.get(ce),{tileAnchorX:fe,tileAnchorY:de,numGlyphs:ye}=oe,ge=oe.hidden||!oe.crossTileID||d.allowVerticalPlacement&&!oe.placedOrientation?null:f[oe.crossTileID];if(ge){let ve=0,Ce=0,Oe=0;if(J){const rt=J?J.getAtTileOffset(C,fe,de):0,[vt,xt,lt]=X.upVector(C.canonical,fe,de);ve=rt*vt*ae,Ce=rt*xt*ae,Oe=rt*lt*ae}let[Te,$e,Je,ct]=co(oe.projectedAnchorX+ve,oe.projectedAnchorY+Ce,oe.projectedAnchorZ+Oe,l?Y:x);const Ke=Yr(v.getCameraToCenterDistance(X),ct);let _t=_.evaluateSizeForFeature(d.textSizeData,L,oe)*Ke/a.bq;l&&(_t*=d.tilePixelRatio/D);const je=J1(ge,_t);l?({x:Te,y:$e,z:Je}=X.projectTilePoint(fe+je.x,de+je.y,C.canonical),[Te,$e,Je]=co(Te+ve,$e+Ce,Je+Oe,x)):(n&&je._rotate(-v.angle),Te+=je.x,$e+=je.y,Je=0);const nt=d.allowVerticalPlacement&&oe.placedOrientation===a.bk.vertical?Math.PI/2:0;for(let rt=0;rt<ye;rt++)a.bn(j,Te,$e,Je,nt);B&&oe.associatedIconIndex>=0&&(Z[oe.associatedIconIndex]={x:Te,y:$e,z:Je,angle:nt})}else ga(ye,j)}if(B){U.clear();const ce=d.icon.placedSymbolArray;for(let oe=0;oe<ce.length;oe++){const fe=ce.get(oe),{numGlyphs:de}=fe,ye=Z[oe];if(fe.hidden||!ye)ga(de,U);else{const{x:ge,y:ve,z:Ce,angle:Oe}=ye;for(let Te=0;Te<de;Te++)a.bn(U,ge,ve,Ce,Oe)}}d.icon.dynamicLayoutVertexBuffer.updateData(U)}d.text.dynamicLayoutVertexBuffer.updateData(j)}function zh(d,n,l,f,_,v,x={}){const C=l.paint.get("icon-translate"),D=l.paint.get("text-translate"),L=l.paint.get("icon-translate-anchor"),B=l.paint.get("text-translate-anchor"),$=l.layout.get("icon-rotation-alignment"),j=l.layout.get("text-rotation-alignment"),U=l.layout.get("icon-pitch-alignment"),Z=l.layout.get("text-pitch-alignment"),X=l.layout.get("icon-keep-upright"),Y=l.layout.get("text-keep-upright"),J=l.paint.get("icon-color-saturation"),ae=l.paint.get("icon-color-contrast"),ce=l.paint.get("icon-color-brightness-min"),oe=l.paint.get("icon-color-brightness-max"),fe=l.paint.get("symbol-elevation-reference")==="sea",de=l.paint.get("text-occlusion-opacity").constantOr(0),ye=d.context,ge=ye.gl,ve=d.transform,Ce=$==="map",Oe=j==="map",Te=U==="map",$e=Z==="map",Je=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ct=!1;const Ke=d.depthModeForSublayer(0,Qt.ReadOnly),_t=[a.am(ve.center.lng),a.at(ve.center.lat)],je=l.layout.get("text-variable-anchor"),nt=ve.projection.name==="globe",rt=[],vt=[0,-1,0];for(const xt of f){const lt=n.getTile(xt),pt=lt.getBucket(l);if(!pt||pt.projection.name==="mercator"&&nt||pt.fullyClipped)continue;const Kt=pt.projection.name==="globe",Ot=Kt?a.a9(ve.zoom):0,Ft=pl(xt,pt.getProjection(),ve),sr=ve.calculatePixelsToTileUnitsMatrix(lt),Ht=je&&pt.hasTextData(),tr=pt.hasIconTextFit()&&Ht&&pt.hasIconData(),Ir=pt.getProjection().createInversionMatrix(ve,xt.canonical),Pr=mi=>{ve.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||d.terrain)&&(mi.push("DEPTH_D24"),mi.push("DEPTH_OCCLUSION"))},fi=()=>{const mi=Ce&&l.layout.get("symbol-placement")!=="point",Ar=[];Pr(Ar);const ri=mi||tr,ci=l.paint.get("icon-image-cross-fade").constantOr(0);d.terrainRenderModeElevated()&&Te&&Ar.push("PITCH_WITH_MAP_TERRAIN"),Kt&&(Ar.push("PROJECTION_GLOBE_VIEW"),ri&&Ar.push("PROJECTED_POS_ON_VIEWPORT")),ci>0&&Ar.push("ICON_TRANSITION"),pt.icon.zOffsetVertexBuffer&&Ar.push("Z_OFFSET"),J===0&&ae===0&&ce===0&&oe===1||Ar.push("COLOR_ADJUSTMENT"),pt.sdfIcons&&Ar.push("RENDER_SDF");const sn=pt.icon.programConfigurations.get(l.id),_n=d.getOrCreateProgram("symbol",{config:sn,defines:Ar}),Xr=lt.imageAtlasTexture?lt.imageAtlasTexture.size:[0,0],In=pt.iconSizeData,jn=a.bj(In,ve.zoom),Dn=Te||ve.pitch!==0,Ii=qr(Ft,lt.tileID.canonical,Te,Ce,ve,pt.getProjection(),sr),Oo=ko(Ft,lt.tileID.canonical,Te,Ce,ve,pt.getProjection(),sr),Po=d.translatePosMatrix(Oo,lt,C,L,!0),ms=d.translatePosMatrix(Ft,lt,C,L),es=ri?kh:Ii,$o=Ce&&!Te&&!mi;let gs=vt;!nt&&!ve.mercatorFromTransition||Ce||(gs=Km(ve));const Ha=Kt?gs:vt,Sl=l.getColorAdjustmentMatrix(J,ae,ce,oe),xa=Zm(In.kind,jn,$o,Te,d,ms,es,Po,fe,!1,Xr,[0,0],!0,xt,Ot,_t,Ir,Ha,pt.getProjection(),Sl,ci),wu=lt.imageAtlasTexture?lt.imageAtlasTexture:null,Tu=l.layout.get("icon-size").constantOr(0)!==1||pt.iconsNeedLinear,Qf=pt.sdfIcons||d.options.rotating||d.options.zooming||Tu||Dn?ge.LINEAR:ge.NEAREST,Eu=pt.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,Di=d.terrain&&Te&&mi?a.a6.mat4.invert(a.a6.mat4.create(),Ii):kh;if(mi&&pt.icon){const hc=ve.elevation,pw=hc?hc.getAtTileOffsetFunc(xt,ve.center.lat,ve.worldSize,pt.getProjection()):null,Nv=Wr(Ft,lt.tileID.canonical,Te,Ce,ve,pt.getProjection(),sr);Wc(pt,Ft,d,!1,Nv,Oo,Te,X,pw,xt)}return{program:_n,buffers:pt.icon,uniformValues:xa,atlasTexture:wu,atlasTextureIcon:null,atlasInterpolation:Qf,atlasInterpolationIcon:null,isSDF:pt.sdfIcons,hasHalo:Eu,tile:lt,labelPlaneMatrixInv:Di}},wi=()=>{const mi=Oe&&l.layout.get("symbol-placement")!=="point",Ar=[],ri=mi||je||tr;d.terrainRenderModeElevated()&&$e&&Ar.push("PITCH_WITH_MAP_TERRAIN"),Kt&&(Ar.push("PROJECTION_GLOBE_VIEW"),ri&&Ar.push("PROJECTED_POS_ON_VIEWPORT")),pt.text.zOffsetVertexBuffer&&Ar.push("Z_OFFSET"),pt.iconsInText&&Ar.push("RENDER_TEXT_AND_SYMBOL"),Ar.push("RENDER_SDF"),Pr(Ar);const ci=pt.text.programConfigurations.get(l.id),sn=d.getOrCreateProgram("symbol",{config:ci,defines:Ar});let _n,Xr=[0,0],In=null;const jn=pt.textSizeData;pt.iconsInText&&(Xr=lt.imageAtlasTexture?lt.imageAtlasTexture.size:[0,0],In=lt.imageAtlasTexture?lt.imageAtlasTexture:null,_n=$e||ve.pitch!==0||d.options.rotating||d.options.zooming||jn.kind==="composite"||jn.kind==="camera"?ge.LINEAR:ge.NEAREST);const Dn=lt.glyphAtlasTexture?lt.glyphAtlasTexture.size:[0,0],Ii=a.bj(jn,ve.zoom),Oo=qr(Ft,lt.tileID.canonical,$e,Oe,ve,pt.getProjection(),sr),Po=ko(Ft,lt.tileID.canonical,$e,Oe,ve,pt.getProjection(),sr),ms=d.translatePosMatrix(Po,lt,D,B,!0),es=d.translatePosMatrix(Ft,lt,D,B),$o=ri?kh:Oo,gs=Oe&&!$e&&!mi;let Ha=vt;!nt&&!ve.mercatorFromTransition||Oe||(Ha=Km(ve));const Sl=Zm(jn.kind,Ii,gs,$e,d,es,$o,ms,fe,!0,Dn,Xr,!0,xt,Ot,_t,Ir,Kt?Ha:vt,pt.getProjection(),de),xa=lt.glyphAtlasTexture?lt.glyphAtlasTexture:null,wu=ge.LINEAR,Tu=l.paint.get("text-halo-width").constantOr(1)!==0,Qf=d.terrain&&$e&&mi?a.a6.mat4.invert(a.a6.mat4.create(),Oo):kh;if(mi&&pt.text){const Eu=ve.elevation,Di=Eu?Eu.getAtTileOffsetFunc(xt,ve.center.lat,ve.worldSize,pt.getProjection()):null,hc=Wr(Ft,lt.tileID.canonical,$e,Oe,ve,pt.getProjection(),sr);Wc(pt,Ft,d,!0,hc,Po,$e,Y,Di,xt)}return{program:sn,buffers:pt.text,uniformValues:Sl,atlasTexture:xa,atlasTextureIcon:In,atlasInterpolation:wu,atlasInterpolationIcon:_n,isSDF:!0,hasHalo:Tu,tile:lt,labelPlaneMatrixInv:Qf}},zi=pt.icon.segments.get().length,ps=pt.text.segments.get().length,gn=zi&&!x.onlyText?fi():null,Fr=ps&&!x.onlyIcons?wi():null,vi=l.paint.get("icon-opacity").constantOr(1),Gi=l.paint.get("text-opacity").constantOr(1);if(Je&&pt.canOverlap){ct=!0;const mi=vi&&!x.onlyText?pt.icon.segments.get():[],Ar=Gi&&!x.onlyIcons?pt.text.segments.get():[];for(const ri of mi)rt.push({segments:new a.b1([ri]),sortKey:ri.sortKey,state:gn});for(const ri of Ar)rt.push({segments:new a.b1([ri]),sortKey:ri.sortKey,state:Fr})}else x.onlyText||rt.push({segments:vi?pt.icon.segments:new a.b1([]),sortKey:0,state:gn}),x.onlyIcons||rt.push({segments:Gi?pt.text.segments:new a.b1([]),sortKey:0,state:Fr})}ct&&rt.sort((xt,lt)=>xt.sortKey-lt.sortKey);for(const xt of rt){const lt=xt.state;if(lt)if(d.terrain?d.terrain.setupElevationDraw(lt.tile,lt.program,{useDepthForOcclusion:ve.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:lt.labelPlaneMatrixInv}):d.setupDepthForOcclusion(ve.depthOcclusionForSymbolsAndCircles,lt.program),ye.activeTexture.set(ge.TEXTURE0),lt.atlasTexture&&lt.atlasTexture.bind(lt.atlasInterpolation,ge.CLAMP_TO_EDGE,!0),lt.atlasTextureIcon&&(ye.activeTexture.set(ge.TEXTURE1),lt.atlasTextureIcon&&lt.atlasTextureIcon.bind(lt.atlasInterpolationIcon,ge.CLAMP_TO_EDGE,!0)),d.uploadCommonLightUniforms(d.context,lt.program),lt.hasHalo){const pt=lt.uniformValues;pt.u_is_halo=1,Fh(lt.buffers,xt.segments,l,d,lt.program,Ke,_,v,pt,2),pt.u_is_halo=0}else{if(lt.isSDF){const pt=lt.uniformValues;lt.hasHalo&&(pt.u_is_halo=1,Fh(lt.buffers,xt.segments,l,d,lt.program,Ke,_,v,pt,1)),pt.u_is_halo=0}Fh(lt.buffers,xt.segments,l,d,lt.program,Ke,_,v,lt.uniformValues,1)}}}function Fh(d,n,l,f,_,v,x,C,D,L){const B=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.iconTransitioningVertexBuffer,d.globeExtVertexBuffer,d.zOffsetVertexBuffer];_.draw(f,f.context.gl.TRIANGLES,v,x,C,lr.disabled,D,l.id,d.layoutVertexBuffer,d.indexBuffer,n,l.paint,f.transform.zoom,d.programConfigurations.get(l.id),B,L)}function zf(d,n,l,f,_,v,x){const C=d.context.gl,D=l.paint.get("fill-pattern"),L=l.is3D(),B=L?d.stencilModeFor3D():yr.disabled,$=D&&D.constantOr(1);let j,U,Z,X,Y;x?(U=$&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=C.LINES):(U=$?"fillPattern":"fill",j=C.TRIANGLES);for(const J of f){const ae=n.getTile(J);if($&&!ae.patternsLoaded())continue;const ce=ae.getBucket(l);if(!ce)continue;d.prepareDrawTile();const oe=ce.programConfigurations.get(l.id),fe=d.isTileAffectedByFog(J),de=d.getOrCreateProgram(U,{config:oe,overrideFog:fe});$&&(d.context.activeTexture.set(C.TEXTURE0),ae.imageAtlasTexture&&ae.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),oe.updatePaintBuffers());const ye=D.constantOr(null);if(ye&&ae.imageAtlas){const Ce=ae.imageAtlas.patternPositions[ye.toString()];Ce&&oe.setConstantPatternPositions(Ce)}const ge=d.translatePosMatrix(J.projMatrix,ae,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),ve=l.paint.get("fill-emissive-strength");if(x){X=ce.indexBuffer2,Y=ce.segments2;const Ce=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[C.drawingBufferWidth,C.drawingBufferHeight];Z=U==="fillOutlinePattern"&&$?Lh(ge,ve,d,ae,Ce):mv(ge,ve,Ce)}else X=ce.indexBuffer,Y=ce.segments,Z=$?pv(ge,ve,d,ae):Af(ge,ve);d.uploadCommonUniforms(d.context,de,J.toUnwrapped()),de.draw(d,j,_,L?B:d.stencilModeForClipping(J),v,lr.disabled,Z,l.id,ce.layoutVertexBuffer,X,Y,l.paint,d.transform.zoom,oe,void 0)}}function du(d,n,l,f,_,v,x,C){l.resetLayerRenderingStats(d);const D=d.context,L=D.gl,B=d.transform,$=l.paint.get("fill-extrusion-pattern"),j=$.constantOr(1),U=l.paint.get("fill-extrusion-opacity"),Z=d.style.enable3dLights(),X=l.paint.get(Z&&!j?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Y=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),X],J=l.layout.get("fill-extrusion-edge-radius"),ae=J>0&&!l.paint.get("fill-extrusion-rounded-roof"),ce=ae?0:J,oe=B.projection.name==="globe"?a.c_():0,fe=B.projection.name==="globe",de=fe?a.a9(B.zoom):0,ye=[a.am(B.center.lng),a.at(B.center.lat)],ge=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),ve=l.paint.get("fill-extrusion-flood-light-intensity"),Ce=l.paint.get("fill-extrusion-vertical-scale"),Oe=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Te=Na(d,l.paint.get("fill-extrusion-cutoff-fade-range")),$e=[];let Je;fe&&$e.push("PROJECTION_GLOBE_VIEW"),Y[0]>0&&$e.push("FAUX_AO"),ae&&$e.push("ZERO_ROOF_RADIUS"),C&&$e.push("HAS_CENTROID"),ve>0&&$e.push("FLOOD_LIGHT"),Te.shouldRenderCutoff&&$e.push("RENDER_CUTOFF"),Oe&&$e.push("RENDER_WALL_MODE");const ct=d.renderPass==="shadow",Ke=d.shadowRenderer,_t=ct&&!!Ke;d.shadowRenderer&&(d.shadowRenderer.useNormalOffset=!0);let je=[0,0,0];if(Ke){const vt=d.style.directionalLight,xt=d.style.ambientLight;vt&&xt&&(je=ff(d.style,vt,xt)),Je=$e.concat(["SHADOWS_SINGLE_CASCADE"])}const nt=_t?"fillExtrusionDepth":j?"fillExtrusionPattern":"fillExtrusion",rt=l.getLayerRenderingStats();for(const vt of f){const xt=n.getTile(vt),lt=xt.getBucket(l);if(!lt||lt.projection.name!==B.projection.name)continue;let pt=!1;Ke&&(pt=Ke.getMaxCascadeForTile(vt.toUnwrapped())===0);const Kt=d.isTileAffectedByFog(vt),Ot=lt.programConfigurations.get(l.id),Ft=d.getOrCreateProgram(nt,{config:Ot,defines:pt?Je:$e,overrideFog:Kt});if(d.terrain&&d.terrain.setupElevationDraw(xt,Ft,{useMeterToDem:!0}),!lt.centroidVertexBuffer){const wi=Ft.attributes.a_centroid_pos;wi!==void 0&&L.vertexAttrib2f(wi,0,0)}!ct&&Ke&&Ke.setupShadows(xt.tileID.toUnwrapped(),Ft,"vector-tile",xt.tileID.overscaledZ),j&&(d.context.activeTexture.set(L.TEXTURE0),xt.imageAtlasTexture&&xt.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Ot.updatePaintBuffers());const sr=$.constantOr(null);if(sr&&xt.imageAtlas){const wi=xt.imageAtlas.patternPositions[sr.toString()];wi&&Ot.setConstantPatternPositions(wi)}const Ht=l.paint.get("fill-extrusion-vertical-gradient"),tr=1/lt.tileToMeter;let Ir;if(ct&&Ke){if(Qm(xt.tileID,lt,d))continue;const wi=Ke.calculateShadowPassMatrixFromTile(xt.tileID.toUnwrapped());Ir=fv(wi,ce,tr,Ce)}else{const wi=d.translatePosMatrix(vt.expandedProjMatrix,xt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),zi=B.projection.createInversionMatrix(B,vt.canonical);Ir=j?qm(wi,d,Ht,U,Y,ce,tr,vt,xt,oe,de,ye,zi,ge,Ce):Hm(wi,d,Ht,U,Y,ce,tr,vt,oe,de,ye,zi,ge,Ce,ve,je)}d.uploadCommonUniforms(D,Ft,vt.toUnwrapped(),null,Te);let Pr=lt.segments;if(B.projection.name==="mercator"&&!ct&&(Pr=lt.getVisibleSegments(xt.tileID,d.terrain,d.transform.getFrustum(0)),!Pr.get().length))continue;if(rt)if(ct)for(const wi of Pr.get())rt.numRenderedVerticesInShadowPass+=wi.primitiveLength;else for(const wi of Pr.get())rt.numRenderedVerticesInTransparentPass+=wi.primitiveLength;const fi=[];(d.terrain||C)&&fi.push(lt.centroidVertexBuffer),fe&&fi.push(lt.layoutVertexExtBuffer),Oe&&fi.push(lt.wallVertexBuffer),Ft.draw(d,D.gl.TRIANGLES,_,v,x,lr.backCCW,Ir,l.id,lt.layoutVertexBuffer,lt.indexBuffer,Pr,l.paint,d.transform.zoom,Ot,fi)}d.shadowRenderer&&(d.shadowRenderer.useNormalOffset=!1)}function Vn(d,n,l,f,_,v,x,C,D,L,B,$,j,U,Z,X,Y,J,ae){const ce=d.context,oe=ce.gl,fe=d.transform,de=d.transform.zoom,ye=[],ge=Na(d,l.paint.get("fill-extrusion-cutoff-fade-range"));L==="clear"?(ye.push("CLEAR_SUBPASS"),ae&&(ye.push("CLEAR_FROM_TEXTURE"),ce.activeTexture.set(oe.TEXTURE0),ae.bind(oe.LINEAR,oe.CLAMP_TO_EDGE))):L==="sdf"&&ye.push("SDF_SUBPASS"),Y&&ye.push("HAS_CENTROID"),ge.shouldRenderCutoff&&ye.push("RENDER_CUTOFF");const ve=l.layout.get("fill-extrusion-edge-radius"),Ce=(Oe,Te,$e,Je,ct)=>{const Ke=Te.programConfigurations.get(l.id),_t=d.isTileAffectedByFog(Oe),je=d.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ke,defines:ye,overrideFog:_t}),nt=((vt,xt,lt,pt,Kt,Ot,Ft,sr,Ht,tr,Ir)=>({u_matrix:xt,u_opacity:lt,u_ao_pass:pt?1:0,u_meter_to_tile:Kt,u_ao:Ot,u_flood_light_intensity:Ft,u_flood_light_color:sr,u_attenuation:Ht,u_edge_radius:tr,u_fb:0,u_fb_size:Ir,u_dynamic_offset:1}))(0,Je,B,D,ct,[$,j*ct],U,Z,X,de>=17?0:ve*ct,ae?ae.size[0]:0),rt=[];Y&&rt.push(Te.hiddenByLandmarkVertexBuffer),d.uploadCommonUniforms(ce,je,Oe.toUnwrapped(),null,ge),je.draw(d,ce.gl.TRIANGLES,_,v,x,C,nt,l.id,Te.vertexBuffer,Te.indexBuffer,$e,l.paint,de,Ke,rt)};for(const Oe of f){const Te=n.getTile(Oe),$e=Te.getBucket(l);if(!$e||$e.projection.name!==fe.projection.name||!$e.groundEffect||$e.groundEffect&&!$e.groundEffect.hasData())continue;const Je=$e.groundEffect,ct=1/$e.tileToMeter;{const Ke=d.translatePosMatrix(Oe.projMatrix,Te,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),_t=Je.getDefaultSegment();Ce(Oe,Je,_t,Ke,ct)}if(J)for(let Ke=0;Ke<4;Ke++){const _t=a.c$[Ke](Oe),je=n.getTile(_t);if(!je)continue;const nt=je.getBucket(l);if(!nt||nt.projection.name!==fe.projection.name||!nt.groundEffect||nt.groundEffect&&!nt.groundEffect.hasData())continue;const rt=nt.groundEffect;let vt,xt;Ke===0?(vt=[-a.ab,0,0],xt=1):Ke===1?(vt=[a.ab,0,0],xt=0):Ke===2?(vt=[0,-a.ab,0],xt=3):(vt=[0,a.ab,0],xt=2);const lt=rt.regionSegments[xt];if(!lt)continue;const pt=new Float32Array(16);a.a6.mat4.translate(pt,Oe.projMatrix,vt),Ce(Oe,rt,lt,d.translatePosMatrix(pt,Te,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),ct)}}}function vl(d,n,l,f,_,v,x){f.centroidVertexArray.length===0&&f.createCentroidsBuffer();const C=v?v.findDEMTileFor(l):null;if(!(C&&C.dem||x))return;const D=J=>new a.P(Math.ceil((J+a.d2)*a.d3),0),L=J=>{const ae=n.getSource().minzoom,ce=fe=>{const de=n.getTileByID(fe);if(de&&de.hasData())return de.getBucket(_)},oe=[0,-1,1];for(const fe of oe){if(J.overscaledZ+fe<ae)continue;const de=ce(J.calculateScaledKey(J.overscaledZ+fe));if(de)return de}},B=[0,0,0],$=(J,ae)=>(B[0]=Math.min(J.min.y,ae.min.y),B[1]=Math.max(J.max.y,ae.max.y),B[2]=a.ab-ae.min.x>J.max.x?ae.min.x-a.ab:J.max.x,B),j=(J,ae)=>(B[0]=Math.min(J.min.x,ae.min.x),B[1]=Math.max(J.max.x,ae.max.x),B[2]=a.ab-ae.min.y>J.max.y?ae.min.y-a.ab:J.max.y,B),U=[(J,ae)=>$(J,ae),(J,ae)=>$(ae,J),(J,ae)=>j(J,ae),(J,ae)=>j(ae,J)],Z=(J,ae,ce,oe,fe,de,ye)=>{if(!v)return 0;const ge=[[de?ce:J,de?J:ce,0],[de?ce:ae,de?ae:ce,0]],ve=ye<0?a.ab+ye:ye,Ce=[de?ve:(J+ae)/2,de?(J+ae)/2:ve,0];return ce===0&&ye<0||ce!==0&&ye>0?v.getForTilePoints(fe,[Ce],!0,oe):ge.push(Ce),v.getForTilePoints(l,ge,!0,C),Math.max(ge[0][2],ge[1][2],Ce[2])/v.exaggeration()};for(let J=0;J<4;J++){const ae=f.borderFeatureIndices[J];if(ae.length===0)continue;const ce=a.c$[J](l),oe=L(ce);if(!(oe&&oe instanceof a.d0)||f.borderDoneWithNeighborZ[J]===oe.canonical.z)continue;oe.centroidVertexArray.length===0&&oe.createCentroidsBuffer();const fe=v?v.findDEMTileFor(ce):null;if(!(fe&&fe.dem||x))continue;const de=(J<2?1:5)-J,ye=oe.borderDoneWithNeighborZ[de]!==f.canonical.z,ge=oe.borderFeatureIndices[de];let ve=0;if(f.canonical.z!==oe.canonical.z){for(const Ce of ae)f.showCentroid(f.featuresOnBorder[Ce]);if(ye)for(const Ce of ge)oe.showCentroid(oe.featuresOnBorder[Ce]);f.borderDoneWithNeighborZ[J]=oe.canonical.z,oe.borderDoneWithNeighborZ[de]=f.canonical.z}for(const Ce of ae){const Oe=f.featuresOnBorder[Ce],Te=f.centroidData[Oe.centroidDataIndex],$e=Oe.borders[J];let Je;for(;ve<ge.length;){Je=oe.featuresOnBorder[ge[ve]];const ct=Je.borders[de];if(ct[1]>$e[0]+3||ct[0]>$e[0]-3)break;oe.showCentroid(Je),ve++}if(Je&&ve<ge.length){const ct=ve;let Ke=0;for(;!(Je.borders[de][0]>$e[1]-3)&&(Ke++,++ve!==ge.length);)Je=oe.featuresOnBorder[ge[ve]];Je=oe.featuresOnBorder[ge[ct]];let _t=!1;if(Ke>=1){const rt=Je.borders[de];Math.abs($e[0]-rt[0])<3&&Math.abs($e[1]-rt[1])<3&&(Ke=1,_t=!0,ve=ct+1)}else if(Ke===0){f.showCentroid(Oe);continue}const je=oe.centroidData[Je.centroidDataIndex];x&&_t&&(((X=Te).flags|(Y=je).flags)&a.d1?(X.flags|=a.d1,Y.flags|=a.d1):(X.flags&=~a.d1,Y.flags&=~a.d1));const nt=Oe.intersectsCount()>1||Je.intersectsCount()>1;if(Ke>1)ve=ct,Te.centroidXY=je.centroidXY=new a.P(0,0);else if(fe&&fe.dem&&!nt){const rt=U[J](Te,je),vt=J%2?a.ab-1:0,xt=Z(rt[0],Math.min(a.ab-1,rt[1]),vt,fe,ce,J<2,rt[2]);Te.centroidXY=je.centroidXY=D(xt)}else nt?Te.centroidXY=je.centroidXY=new a.P(0,0):(Te.centroidXY=f.encodeBorderCentroid(Oe),je.centroidXY=oe.encodeBorderCentroid(Je));f.writeCentroidToBuffer(Te),oe.writeCentroidToBuffer(je)}else f.showCentroid(Oe)}f.borderDoneWithNeighborZ[J]=oe.canonical.z,oe.borderDoneWithNeighborZ[de]=f.canonical.z}var X,Y;(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(d)}const xv=[1,0,0],Ym=[0,1,0],Jm=[0,0,1];function Qm(d,n,l){const f=l.transform,_=l.shadowRenderer;if(!_)return!0;const v=d.toUnwrapped(),x=f.tileSize*_._cascades[l.currentShadowCascade].scale;let C=n.maxHeight;if(f.elevation){const X=f.elevation.getMinMaxForTile(d);X&&(C+=X.max)}const D=[..._.shadowDirection];D[2]=-D[2];const L=_.computeSimplifiedTileShadowVolume(v,C,x,D);if(!L)return!1;const B=[xv,Ym,Jm,D,[D[0],0,D[2]],[0,D[1],D[2]]],$=f.projection.name==="globe",j=f.scaleZoom(x),U=a.bN.fromInvProjectionMatrix(f.invProjMatrix,f.worldSize,j,!$),Z=_.getCurrentCascadeFrustum();return U.intersectsPrecise(L.vertices,L.planes,B)===0||Z.intersectsPrecise(L.vertices,L.planes,B)===0}function eg(d){return[d[0]*a.d4,d[1]*a.d4,d[2]*a.d4,0]}function No(d,n,l,f,_,v,x,C,D){const L=f.getSource(),B=l.globeSharedBuffers;if(!B)return;let $,j,U;if(n&&($=f.getTile(n)),L instanceof a.aD?(j=L.texture,U=a.cD(0,0,l.transform)):$&&n&&(j=$.texture,U=a.cD(n.canonical.z,n.canonical.x,l.transform)),!j||!U)return;d||(U=a.a6.mat4.scale(a.a6.mat4.create(),U,[1,-1,1]));const Z=l.context,X=Z.gl,Y=_.paint.get("raster-resampling")==="nearest"?X.NEAREST:X.LINEAR,J=l.colorModeForDrapableLayerRenderPass(v),ae=x.defines;ae.push("GLOBE_POLES");const ce=new Qt(X.LEQUAL,Qt.ReadWrite,l.depthRangeFor3D),oe=Float32Array.from(l.transform.expandedFarZProjMatrix),fe=Float32Array.from(a.b5(a.cC(new a.bP(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),Z.activeTexture.set(X.TEXTURE0),j.bind(Y,X.CLAMP_TO_EDGE),Z.activeTexture.set(X.TEXTURE1),j.bind(Y,X.CLAMP_TO_EDGE),j.useMipmap&&Z.extTextureFilterAnisotropic&&l.transform.pitch>20&&X.texParameterf(X.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const[de,ye,ge,ve]=n?B.getPoleBuffers(n.canonical.z,!1):B.getPoleBuffers(0,!0),Ce=_.paint.get("raster-elevation");let Oe;d?(Oe=de,l.renderDefaultNorthPole=Ce!==0):(Oe=ye,l.renderDefaultSouthPole=Ce!==0);const Te=eg(x.mix),$e=((ct,Ke,_t,je,nt,rt,vt,xt,lt,pt,Kt,Ot,Ft)=>Bh(ct,Ke,_t,new Float32Array(16),new Float32Array(9),[0,0],je,[0,0],[0,0,0,0],1,{opacity:1,mix:0},rt,[0,0],xt,2,pt,Kt,Ot,1,0,Ft))(oe,fe,U,a.a9(l.transform.zoom),0,_,0,Ce,0,Te,x.offset,x.range,v),Je=l.getOrCreateProgram("raster",{defines:ae});l.uploadCommonUniforms(Z,Je,null),Je.draw(l,X.TRIANGLES,ce,D,J,C,$e,_.id,Oe,ge,ve)}function nn(d){const n=d._nearZ,l=d.projection.farthestPixelDistance(d),f=l-n,_=.2*d.height,v=n+_;return[n,l,(v-_-n)/f,(v-n)/f]}function Ff(d,n,l,f){if(d)return n instanceof jc&&d instanceof tf?n.getTextureDescriptor(d,l,!0):{texture:d.texture,mix:eg(f.mix),offset:f.offset,buffer:0,tileSize:1}}var tg=a.d5([{name:"a_index",type:"Int16",components:1}]);class wv{constructor(n,l,f,_){const v={width:f[0],height:f[1],data:null},x=n.gl;this.targetColorTexture=new a.T(n,v,x.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(n,v,x.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(l,_),this.lastInvalidatedAt=0}updateParticleTexture(n,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const f=this.context.gl,_=l.width*l.height;this.particleTexture0=new a.T(this.context,l,f.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,l,f.RGBA8,{premultiply:!1,useMipmap:!1});const v=new a.d6;v.reserve(_);for(let x=0;x<_;x++)v.emplaceBack(x);this.particleIndexBuffer=this.context.createVertexBuffer(v,tg.members,!0),this.particleSegment=a.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=a.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Tv(d,n,l){if(!d)return null;const f=n.getTextureDescriptor(d,l,!0);if(!f)return null;let{texture:_,mix:v,offset:x,tileSize:C,buffer:D,format:L}=f;if(!_||!L)return null;let B=!1;return L==="uint32"&&(B=!0,v[3]=0,v=Cf(a.d7,v,[0,l.paint.get("raster-particle-max-speed")]),x=Mf(a.d7,x,[0,l.paint.get("raster-particle-max-speed")])),{texture:_,textureOffset:[D/(C+2*D),C/(C+2*D)],tileSize:C,scalarData:B,scale:v,offset:x,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[L]]}}function Ev(d){const n=d._nearZ,l=d.projection.farthestPixelDistance(d),f=l-n,_=.2*d.height,v=n+_;return[n,l,(v-_-n)/f,(v-n)/f]}const ew=new a.bz(1,0,0,1),fu=new a.bz(0,1,0,1),pu=new a.bz(0,0,1,1),wt=new a.bz(1,0,1,1),Xt=new a.bz(0,1,1,1);function Gs(d,n,l,f,_,v,x){const C=d.context,D=d.transform,L=C.gl,B=D.projection.name==="globe",$=B?["PROJECTION_GLOBE_VIEW"]:[];let j=a.a6.mat4.clone(l.projMatrix);if(B&&a.a9(D.zoom)>0){const Te=a.b4(l.canonical,D),$e=a.d8(Te);j=a.a6.mat4.multiply(new Float32Array(16),D.globeMatrix,$e),a.a6.mat4.multiply(j,D.projMatrix,j)}const U=a.a6.mat4.create();U[12]+=2*_/(a.q.devicePixelRatio*D.width),U[13]+=2*v/(a.q.devicePixelRatio*D.height),a.a6.mat4.multiply(j,U,j);const Z=d.getOrCreateProgram("debug",{defines:$}),X=n.getTileByID(l.key);d.terrain&&d.terrain.setupElevationDraw(X,Z);const Y=Qt.disabled,J=yr.disabled,ae=d.colorModeForRenderPass(),ce="$debug";C.activeTexture.set(L.TEXTURE0),d.emptyTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),B?X._makeGlobeTileDebugBuffers(d.context,D):X._makeDebugTileBoundsBuffers(d.context,D.projection);const oe=X._tileDebugBuffer||d.debugBuffer,fe=X._tileDebugIndexBuffer||d.debugIndexBuffer,de=X._tileDebugSegments||d.debugSegments;if(Z.draw(d,L.LINE_STRIP,Y,J,ae,lr.disabled,gv(j,f),ce,oe,fe,de,null,null,null,[X._globeTileDebugBorderBuffer]),x){const Te=X.latestRawTileData,$e=Math.floor((Te&&Te.byteLength||0)/1024);let Je=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Je+=` => ${l.overscaledZ}`),Je+=` ${X.state}`,Je+=` ${$e}kb`,function(ct,Ke){ct.initDebugOverlayCanvas();const _t=ct.debugOverlayCanvas,je=ct.context.gl,nt=ct.debugOverlayCanvas.getContext("2d");nt.clearRect(0,0,_t.width,_t.height),nt.shadowColor="white",nt.shadowBlur=2,nt.lineWidth=1.5,nt.strokeStyle="white",nt.textBaseline="top",nt.font="bold 36px Open Sans, sans-serif",nt.fillText(Ke,5,5),nt.strokeText(Ke,5,5),ct.debugOverlayTexture.update(_t),ct.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)}(d,Je)}const ye=n.getTile(l).tileSize,ge=512/Math.min(ye,512)*(l.overscaledZ/D.zoom)*.5,ve=X._tileDebugTextBuffer||d.debugBuffer,Ce=X._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,Oe=X._tileDebugTextSegments||d.debugSegments;Z.draw(d,L.TRIANGLES,Y,J,kr.alphaBlended,lr.disabled,gv(j,a.bz.transparent,ge),ce,ve,Ce,Oe,null,null,null,[X._globeTileDebugTextBuffer])}function Ui(d,n,l,f){Nh(d,0,n+l/2,d.transform.width,l,f)}function Ue(d,n,l,f){Nh(d,n-l/2,0,l,d.transform.height,f)}function Nh(d,n,l,f,_,v){const x=d.context,C=x.gl;C.enable(C.SCISSOR_TEST),C.scissor(n*a.q.devicePixelRatio,l*a.q.devicePixelRatio,f*a.q.devicePixelRatio,_*a.q.devicePixelRatio),x.clear({color:v}),C.disable(C.SCISSOR_TEST)}const Nf=a.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:rg}=Nf;function Hs(d,n,l,f){d.emplaceBack(n,l,f)}class ig{constructor(n){this.vertexArray=new a.d9,this.indices=new a.aO,Hs(this.vertexArray,-1,-1,1),Hs(this.vertexArray,1,-1,1),Hs(this.vertexArray,-1,1,1),Hs(this.vertexArray,1,1,1),Hs(this.vertexArray,-1,-1,-1),Hs(this.vertexArray,1,-1,-1),Hs(this.vertexArray,-1,1,-1),Hs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,rg),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=a.b1.simpleSegment(0,0,36,12)}}function sc(d,n,l,f,_,v){const x=d.context.gl,C=n.paint.get("sky-atmosphere-color"),D=n.paint.get("sky-atmosphere-halo-color"),L=n.paint.get("sky-atmosphere-sun-intensity"),B=(($,j,U,Z,X)=>({u_matrix_3f:$,u_sun_direction:j,u_sun_intensity:U,u_color_tint_r:[Z.r,Z.g,Z.b,Z.a],u_color_tint_m:[X.r,X.g,X.b,X.a],u_luminance:5e-5}))(a.a6.mat3.fromMat4(a.a6.mat3.create(),f),_,L,C,D);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_CUBE_MAP_POSITIVE_X+v,n.skyboxTexture,0),l.draw(d,x.TRIANGLES,Qt.disabled,yr.disabled,kr.unblended,lr.frontCW,B,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const mu=a.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class tw{constructor(n){const l=new a.da;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const f=new a.aO;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(l,mu.members),this.indexBuffer=n.createIndexBuffer(f),this.segments=a.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const rw=a.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Sv{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class $f{constructor(n){this.colorModeAlphaBlendedWriteRGB=new kr([1,Xo,1,Xo],a.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new kr([1,0,1,0],a.bz.transparent,[!1,!1,!1,!0]),this.params=new Sv,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(n){const l=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new tw(l);const f=this.params.sizeRange,_=this.params.intensityRange,v=function(B){const $=a.dd(30),j=[];for(let U=0;U<B;++U){const Z=2*Math.PI*$(),X=Math.acos(1-2*$())-.5*Math.PI;j.push(a.a6.vec3.fromValues(Math.cos(X)*Math.cos(Z),Math.cos(X)*Math.sin(Z),Math.sin(X)))}return j}(this.params.starsCount),x=a.dd(300),C=new a.db,D=new a.aO;let L=0;for(let B=0;B<v.length;++B){const $=a.a6.vec3.scale([],v[B],200),j=Math.max(0,1+.01*f*(1*x()-.5)),U=Math.max(0,1+.01*_*(1*x()-.5));C.emplaceBack($[0],$[1],$[2],-1,-1,j,U),C.emplaceBack($[0],$[1],$[2],1,-1,j,U),C.emplaceBack($[0],$[1],$[2],1,1,j,U),C.emplaceBack($[0],$[1],$[2],-1,1,j,U),D.emplaceBack(L+0,L+1,L+2),D.emplaceBack(L+0,L+2,L+3),L+=4}this.starsVx=l.createVertexBuffer(C,rw.members),this.starsIdx=l.createIndexBuffer(D),this.starsSegments=a.b1.simpleSegment(0,0,C.length,D.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,l){const f=n.context,_=f.gl,v=n.transform,x=new Qt(_.LEQUAL,Qt.ReadOnly,[0,1]),C=a.a9(v.zoom),D=n.style.getLut(l.scope),L=l.properties.get("color").toRenderColor(D).toArray01(),B=l.properties.get("high-color").toRenderColor(D).toArray01(),$=l.properties.get("space-color").toRenderColor(D).toArray01PremultipliedAlpha(),j=5e-4,U=a.dc(l.properties.get("horizon-blend"),0,1,j,.25),Z=a.cx(n,f,v)&&U===j?v.worldSize/(2*Math.PI*1.025)-1:v.globeRadius,X=n.frameCounter/1e3%1,Y=a.a6.vec3.length(v.globeCenterInViewSpace),J=Math.sqrt(Math.pow(Y,2)-Math.pow(Z,2)),ae=Math.acos(J/Y),ce=oe=>{const fe=v.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];oe&&fe.push("ALPHA_PASS");const de=n.getOrCreateProgram("globeAtmosphere",{defines:fe}),ye=((ve,Ce,Oe,Te,$e,Je,ct,Ke,_t,je,nt,rt)=>({u_frustum_tl:ve,u_frustum_tr:Ce,u_frustum_br:Oe,u_frustum_bl:Te,u_horizon:$e,u_transition:Je,u_fadeout_range:ct,u_color:Ke,u_high_color:_t,u_space_color:je,u_temporal_offset:nt,u_horizon_angle:rt}))(v.frustumCorners.TL,v.frustumCorners.TR,v.frustumCorners.BR,v.frustumCorners.BL,v.frustumCorners.horizon,C,U,L,B,$,X,ae);n.uploadCommonUniforms(f,de);const ge=this.atmosphereBuffer;ge&&de.draw(n,_.TRIANGLES,x,yr.disabled,oe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,lr.backCW,ye,oe?"atmosphere_glow_alpha":"atmosphere_glow",ge.vertexBuffer,ge.indexBuffer,ge.segments)};ce(!1),ce(!0)}drawStars(n,l){const f=a.ap(l.properties.get("star-intensity"),0,1);if(f===0)return;const _=n.context,v=_.gl,x=n.transform,C=n.getOrCreateProgram("stars"),D=a.a6.quat.identity([]);a.a6.quat.rotateX(D,D,-x._pitch),a.a6.quat.rotateZ(D,D,-x.angle),a.a6.quat.rotateX(D,D,a.bB(x._center.lat)),a.a6.quat.rotateY(D,D,-a.bB(x._center.lng));const L=a.a6.mat4.fromQuat(new Float32Array(16),D),B=a.a6.mat4.multiply([],x.starsProjMatrix,L),$=a.a6.mat3.fromMat4([],L),j=a.a6.mat3.invert([],$),U=[0,1,0];a.a6.vec3.transformMat3(U,U,j),a.a6.vec3.scale(U,U,this.params.sizeMultiplier);const Z=[1,0,0];a.a6.vec3.transformMat3(Z,Z,j),a.a6.vec3.scale(Z,Z,this.params.sizeMultiplier);const X=(Y=U,J=Z,ae=f,{u_matrix:Float32Array.from(B),u_up:Y,u_right:J,u_intensity_multiplier:ae});var Y,J,ae;n.uploadCommonUniforms(_,C),this.starsVx&&this.starsIdx&&C.draw(n,v.TRIANGLES,Qt.disabled,yr.disabled,this.colorModeAlphaBlendedWriteRGB,lr.disabled,X,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function jf(d,n){const l=[...d],f=n.cameraWorldSizeForFog/n.worldSize,_=a.a6.mat4.identity([]);return a.a6.mat4.scale(_,_,[f,f,1]),a.a6.mat4.multiply(l,_,l),a.a6.mat4.multiply(l,n.worldToFogMatrix,l),l}function Vf(d,n,l,f,_){const v=l.material,x=f.context,{baseColorTexture:C,metallicRoughnessTexture:D}=v.pbrMetallicRoughness,{normalTexture:L,occlusionTexture:B,emissionTexture:$}=v;function j(U,Z,X){if(U&&(d.push(Z),x.activeTexture.set(x.gl.TEXTURE0+X),U.gfxTexture)){const{minFilter:Y,magFilter:J,wrapS:ae,wrapT:ce}=U.sampler;U.gfxTexture.bindExtraParam(Y,J,ae,ce)}}j(C,"HAS_TEXTURE_u_baseColorTexture",ro.BaseColor),j(D,"HAS_TEXTURE_u_metallicRoughnessTexture",ro.MetallicRoughness),j(L,"HAS_TEXTURE_u_normalTexture",ro.Normal),j(B,"HAS_TEXTURE_u_occlusionTexture",ro.Occlusion),j($,"HAS_TEXTURE_u_emissionTexture",ro.Emission),_&&(_.texture||(_.texture=new a.df(f.context,_.image,[_.image.height,_.image.height,_.image.height],x.gl.RGBA8)),x.activeTexture.set(x.gl.TEXTURE0+ro.LUT),_.texture&&_.texture.bind(x.gl.LINEAR,x.gl.CLAMP_TO_EDGE),d.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(d.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(l.texcoordBuffer)),l.colorBuffer&&(d.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(l.colorBuffer)),l.normalBuffer&&(d.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(l.normalBuffer)),l.pbrBuffer&&(d.push("HAS_ATTRIBUTE_a_pbr"),d.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(l.pbrBuffer)),v.alphaMode!=="OPAQUE"&&v.alphaMode!=="MASK"||d.push("UNPREMULT_TEXTURE_IN_SHADER"),v.defined||d.push("DIFFUSE_SHADED"),d.push("USE_STANDARD_DERIVATIVES")}function $h(d,n,l,f,_,v){const x=l.paint.get("model-opacity"),C=n.context,D=new Qt(n.context.gl.LEQUAL,Qt.ReadWrite,n.depthRangeFor3D),L=n.transform,B=d.mesh,$=B.material,j=$.pbrMetallicRoughness,U=n.style.fog;let Z;Z=n.transform.projection.zAxisUnit==="pixels"?[...d.nodeModelMatrix]:a.a6.mat4.multiply([],f.zScaleMatrix,d.nodeModelMatrix),a.a6.mat4.multiply(Z,f.negCameraPosMatrix,Z);const X=a.a6.mat4.invert([],Z);a.a6.mat4.transpose(X,X);const Y=l.paint.get("model-emissive-strength").constantOr(0),J=jt(new Float32Array(d.worldViewProjection),new Float32Array(Z),new Float32Array(X),null,n,x,j.baseColorFactor.toRenderColor(null),$.emissiveFactor,j.metallicFactor,j.roughnessFactor,$,Y,l),ae={defines:[]},ce=[];Vf(ae.defines,ce,B,n,l.lut);const oe=n.shadowRenderer;oe&&(oe.useNormalOffset=!1);let fe=null;if(U){const ge=jf(d.nodeModelMatrix,n.transform);if(fe=new Float32Array(ge),L.projection.name!=="globe"){const ve=B.aabb.min,Ce=B.aabb.max,[Oe,Te]=U.getOpacityForBounds(ge,ve[0],ve[1],Ce[0],Ce[1]);ae.overrideFog=Oe>=kt||Te>=kt}}const de=Na(n,l.paint.get("model-cutoff-fade-range"));de.shouldRenderCutoff&&ae.defines.push("RENDER_CUTOFF");const ye=n.getOrCreateProgram("model",ae);n.uploadCommonUniforms(C,ye,null,fe,de),n.renderPass!=="shadow"&&oe&&oe.setupShadowsFromMatrix(d.nodeModelMatrix,ye),ye.draw(n,C.gl.TRIANGLES,D,_,v,B.material.doubleSided?lr.disabled:lr.backCCW,J,l.id,B.vertexBuffer,B.indexBuffer,B.segments,l.paint,n.transform.zoom,void 0,ce)}function jh(d,n,l,f,_,v,x){let C;C=d.projection.name==="globe"?a.dg(l,d):[...l],a.a6.mat4.multiply(C,C,n.matrix);const D=a.a6.mat4.multiply([],f,C);if(n.meshes)for(const L of n.meshes){if(L.material.alphaMode!=="BLEND"){x.push({mesh:L,depth:0,modelIndex:_,worldViewProjection:D,nodeModelMatrix:C});continue}const B=a.a6.vec3.transformMat4([],L.centroid,D);B[2]>0&&v.push({mesh:L,depth:B[2],modelIndex:_,worldViewProjection:D,nodeModelMatrix:C})}if(n.children)for(const L of n.children)jh(d,L,l,f,_,v,x)}function gu(d,n,l,f){const _=l.shadowRenderer;if(!_)return;const v=_.getShadowPassDepthMode(),x=_.getShadowPassColorMode(),C=_.calculateShadowPassMatrixFromMatrix(n),D=Xm(C);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,v,yr.disabled,x,lr.backCCW,D,f.id,d.vertexBuffer,d.indexBuffer,d.segments,f.paint,l.transform.zoom,void 0,void 0)}function Ov(d,n,l){const f=n.updateZoomBasedPaintProperties(),_=function(v,x,C){let D,L,B,$=v.terrain?v.terrain.exaggeration():0;if(v.terrain&&$>0){const j=v.terrain,U=j.findDEMTileFor(C);U&&U.dem?D=a.di.create(j,C,U):$=0}if($===0&&(x.terrainElevationMin=0,x.terrainElevationMax=0),$===x.validForExaggeration&&($===0||D&&D._demTile&&D._demTile.tileID===x.validForDEMTile.id&&D._dem._timestamp===x.validForDEMTile.timestamp))return!1;for(const j in x.instancesPerModel){const U=x.instancesPerModel[j];for(let Z=0;Z<U.instancedDataArray.length;++Z){const X=(D?$*D.getElevationAt(0|U.instancedDataArray.float32[16*Z],0|U.instancedDataArray.float32[16*Z+1],!0,!0):0)+U.instancesEvaluatedElevation[Z];U.instancedDataArray.float32[16*Z+6]=X,L=L?Math.min(x.terrainElevationMin,X):X,B=B?Math.max(x.terrainElevationMax,X):X}}return x.terrainElevationMin=L||0,x.terrainElevationMax=B||0,x.validForExaggeration=$,x.validForDEMTile=D&&D._demTile?{id:D._demTile.tileID,timestamp:D._dem._timestamp}:{id:void 0,timestamp:0},!0}(d,n,l);(f||_)&&(n.uploaded=!1,n.upload(d.context))}const qs={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.c9([0,0,0],[a.ab,a.ab,0])};function iw(d,n){const l=1<<d.canonical.z,f=n.getFreeCameraOptions().position,_=n.elevation,v=d.canonical.x/l,x=(d.canonical.x+1)/l,C=d.canonical.y/l,D=(d.canonical.y+1)/l;let L=n._centerAltitude;if(_){const U=_.getMinMaxForTile(d);U&&U.max>L&&(L=U.max)}const B=a.ap(f.x,v,x)-f.x,$=a.ap(f.y,C,D)-f.y,j=a.bD(L,n.center.lat)-f.z;return n._zoomFromMercatorZ(Math.sqrt(B*B+$*$+j*j))}function ho(d,n,l,f,_,v,x){const C=d.context,D=d.renderPass==="shadow",L=d.shadowRenderer,B=D&&L?L.getShadowPassDepthMode():new Qt(C.gl.LEQUAL,Qt.ReadWrite,d.depthRangeFor3D),$=d.isTileAffectedByFog(v);if(l.meshes)for(const j of l.meshes){const U=["MODEL_POSITION_ON_GPU"],Z=[];let X,Y,J;f.instancedDataArray.length>20&&U.push("INSTANCED_ARRAYS");const ae=Na(d,n.paint.get("model-cutoff-fade-range"));if(ae.shouldRenderCutoff&&U.push("RENDER_CUTOFF"),D&&L)X=d.getOrCreateProgram("modelDepth",{defines:U}),Y=Xm(x.shadowTileMatrix,x.shadowTileMatrix,Float32Array.from(l.matrix)),J=L.getShadowPassColorMode();else{Vf(U,Z,j,d,n.lut),X=d.getOrCreateProgram("model",{defines:U,overrideFog:$});const oe=j.material,fe=oe.pbrMetallicRoughness,de=n.paint.get("model-opacity"),ye=n.paint.get("model-emissive-strength").constantOr(0);Y=jt(v.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,d,de,fe.baseColorFactor.toRenderColor(null),oe.emissiveFactor,fe.metallicFactor,fe.roughnessFactor,oe,ye,n,_),L&&(x.shadowUniformsInitialized?X.setShadowUniformValues(C,L.getShadowUniformValues()):(L.setupShadows(v.toUnwrapped(),X,"model-tile",v.overscaledZ),x.shadowUniformsInitialized=!0)),J=ae.shouldRenderCutoff||de<1||oe.alphaMode!=="OPAQUE"?kr.alphaBlended:kr.unblended}d.uploadCommonUniforms(C,X,v.toUnwrapped(),null,ae);const ce=j.material.doubleSided?lr.disabled:lr.backCCW;if(f.instancedDataArray.length>20)Z.push(f.instancedDataBuffer),X.draw(d,C.gl.TRIANGLES,B,yr.disabled,J,ce,Y,n.id,j.vertexBuffer,j.indexBuffer,j.segments,n.paint,d.transform.zoom,void 0,Z,f.instancedDataArray.length);else{const oe=D?"u_instance":"u_normal_matrix";for(let fe=0;fe<f.instancedDataArray.length;++fe)Y[oe]=new Float32Array(f.instancedDataArray.arrayBuffer,64*fe,16),X.draw(d,C.gl.TRIANGLES,B,yr.disabled,J,ce,Y,n.id,j.vertexBuffer,j.indexBuffer,j.segments,n.paint,d.transform.zoom,void 0,Z)}}if(l.children)for(const j of l.children)ho(d,n,j,f,_,v,x)}const nw=[1,-1,1];function Vh(d,n,l,f){if(!l.modelManager)return!0;const _=l.modelManager;if(!l.shadowRenderer)return!0;const v=l.shadowRenderer,x=n.aabb;let C=!0,D=d.maxHeight;if(D===0){let B=0;for(const $ in d.instancesPerModel){const j=_.getModel($,f);j?B=Math.max(B,Math.max(Math.max(j.aabb.max[0],j.aabb.max[1]),j.aabb.max[2])):C=!1}D=d.maxScale*B*1.41+d.maxVerticalOffset,C&&(d.maxHeight=D)}x.max[2]=D,x.min[2]+=d.terrainElevationMin,x.max[2]+=d.terrainElevationMax,a.a6.vec3.transformMat4(x.min,x.min,n.tileMatrix),a.a6.vec3.transformMat4(x.max,x.max,n.tileMatrix);const L=x.intersects(v.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(d.isInsideFirstShadowMapFrustum=L===2),L===0}function $i(d,n){const l=d.uniformValues.u_cutoff_params[0],f=d.uniformValues.u_cutoff_params[1],_=d.uniformValues.u_cutoff_params[2],v=d.uniformValues.u_cutoff_params[3];return f===l||v===_?1:a.ap(((n-l)/(f-l)-_)/(v-_),0,1)}function ti(d,n,l,f){if(n.pitch<20)return 1;const _=n.getWorldToCameraMatrix();a.a6.mat4.multiply(_,_,d);const v=a.a6.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let x=a.a6.vec4.transformMat4(a.a6.vec4.create(),v,_),C=x,D=x;v[1]=l.max[1],x=a.a6.vec4.transformMat4(a.a6.vec4.create(),v,_),C=x[1]<C[1]?x:C,D=x[1]>D[1]?x:D,v[0]=l.max[0],x=a.a6.vec4.transformMat4(a.a6.vec4.create(),v,_),C=x[1]<C[1]?x:C,D=x[1]>D[1]?x:D,v[1]=l.min[1],x=a.a6.vec4.transformMat4(a.a6.vec4.create(),v,_),C=x[1]<C[1]?x:C,D=x[1]>D[1]?x:D;const L=a.ap(f[0],0,1),B=100*n.pixelsPerMeter*a.ap(f[1],0,1),$=a.ap(f[2],0,1),j=a.a6.vec4.lerp(a.a6.vec4.create(),C,D,L),U=Math.tan(.5*n.fovX),Z=-j[2]*U;if(B===0)return j[1]<-Math.abs(Z)?$:1;const X=(-Math.abs(Z)-j[1])/B,Y=(ae,ce,oe)=>(1-oe)*ae+oe*ce,J=a.ap(Y(1,$,X),$,1);return Y(1,J,a.ap((n.pitch-20)/20,0,1))}class Pv{}class bl{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,l,f){{const $=this._storage.get(l.id);if($)return $.lastUsedFrameIdx=n,$.buf}const _=f.gl,v=_.getBufferParameter(_.ELEMENT_ARRAY_BUFFER,_.BUFFER_SIZE),x=new ArrayBuffer(v),C=new Int16Array(x);_.getBufferSubData(_.ELEMENT_ARRAY_BUFFER,0,new Int16Array(x));const D=new a.dk;for(let $=0;$<v/2;$+=3){const j=C[$],U=C[$+1],Z=C[$+2];D.emplaceBack(j,U),D.emplaceBack(U,Z),D.emplaceBack(Z,j)}const L=f.bindVertexArrayOES.current,B=new Pv;return B.buf=new Fo(f,D),B.lastUsedFrameIdx=n,this._storage.set(l.id,B),f.bindVertexArrayOES.set(L),B.buf}update(n){for(const[l,f]of this._storage)n-f.lastUsedFrameIdx>30&&(f.buf.destroy(),this._storage.delete(l))}destroy(){for(const[n,l]of this._storage)l.buf.destroy(),this._storage.delete(n)}}class Uf{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const xl={symbol:function(d,n,l,f,_){if(d.renderPass!=="translucent")return;const v=yr.disabled,x=d.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(L,B,$,j,U,Z,X){const Y=B.transform,J=U==="map",ae=Z==="map";for(const ce of L){const oe=j.getTile(ce),fe=oe.getBucket($);if(!fe||!fe.text||!fe.text.segments.get().length)continue;const de=a.bj(fe.textSizeData,Y.zoom),ye=pl(ce,fe.getProjection(),Y),ge=Y.calculatePixelsToTileUnitsMatrix(oe),ve=qr(ye,oe.tileID.canonical,ae,J,Y,fe.getProjection(),ge),Ce=fe.hasIconTextFit()&&fe.hasIconData();if(de){const Oe=Math.pow(2,Y.zoom-oe.tileID.overscaledZ);Q1(fe,J,ae,X,a.cS,Y,ve,ce,Oe,de,Ce)}}}(f,d,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),_);const C=l.paint.get("icon-opacity").constantOr(1)!==0,D=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(C||D)?zh(d,n,l,f,v,x):(C&&zh(d,n,l,f,v,x,{onlyIcons:!0}),D&&zh(d,n,l,f,v,x,{onlyText:!0})),n.map.showCollisionBoxes&&(kf(d,n,l,f,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),kf(d,n,l,f,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(d,n,l,f){if(d.renderPass!=="translucent")return;const _=l.paint.get("circle-opacity"),v=l.paint.get("circle-stroke-width"),x=l.paint.get("circle-stroke-opacity"),C=l.layout.get("circle-sort-key").constantOr(1)!==void 0,D=l.paint.get("circle-emissive-strength");if(_.constantOr(1)===0&&(v.constantOr(1)===0||x.constantOr(1)===0))return;const L=d.context,B=L.gl,$=d.transform,j=d.depthModeForSublayer(0,Qt.ReadOnly),U=yr.disabled,Z=d.colorModeForDrapableLayerRenderPass(D),X=$.projection.name==="globe",Y=[a.am($.center.lng),a.at($.center.lat)],J=[];for(let ce=0;ce<f.length;ce++){const oe=f[ce],fe=n.getTile(oe),de=fe.getBucket(l);if(!de||de.projection.name!==$.projection.name)continue;const ye=de.programConfigurations.get(l.id),ge=a.cT(l),ve=d.isTileAffectedByFog(oe);X&&ge.push("PROJECTION_GLOBE_VIEW"),ge.push("DEPTH_D24"),d.terrain&&$.depthOcclusionForSymbolsAndCircles&&ge.push("DEPTH_OCCLUSION");const Ce=d.getOrCreateProgram("circle",{config:ye,defines:ge,overrideFog:ve}),Oe=de.layoutVertexBuffer,Te=de.globeExtVertexBuffer,$e=de.indexBuffer,Je=$.projection.createInversionMatrix($,oe.canonical),ct={programConfiguration:ye,program:Ce,layoutVertexBuffer:Oe,globeExtVertexBuffer:Te,indexBuffer:$e,uniformValues:a.cU(d,oe,fe,Je,Y,l),tile:fe};if(C){const Ke=de.segments.get();for(const _t of Ke)J.push({segments:new a.b1([_t]),sortKey:_t.sortKey,state:ct})}else J.push({segments:de.segments,sortKey:0,state:ct})}C&&J.sort((ce,oe)=>ce.sortKey-oe.sortKey);const ae={useDepthForOcclusion:$.depthOcclusionForSymbolsAndCircles};for(const ce of J){const{programConfiguration:oe,program:fe,layoutVertexBuffer:de,globeExtVertexBuffer:ye,indexBuffer:ge,uniformValues:ve,tile:Ce}=ce.state,Oe=ce.segments;d.terrain&&d.terrain.setupElevationDraw(Ce,fe,ae),d.uploadCommonUniforms(L,fe,Ce.tileID.toUnwrapped()),fe.draw(d,B.TRIANGLES,j,U,Z,lr.disabled,ve,l.id,de,ge,Oe,l.paint,$.zoom,oe,[ye])}},heatmap:function(d,n,l,f){if(l.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const _=d.context,v=_.gl,x=yr.disabled,C=new kr([v.ONE,v.ONE,v.ONE,v.ONE],a.bz.transparent,[!0,!0,!0,!0]);(function(U,Z,X,Y){const J=U.gl,ae=Z.width*Y,ce=Z.height*Y;U.activeTexture.set(J.TEXTURE1),U.viewport.set([0,0,ae,ce]);let oe=X.heatmapFbo;if(!oe||oe&&(oe.width!==ae||oe.height!==ce)){oe&&oe.destroy();const fe=J.createTexture();J.bindTexture(J.TEXTURE_2D,fe),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),oe=X.heatmapFbo=U.createFramebuffer(ae,ce,!0,null),function(de,ye,ge,ve,Ce,Oe){const Te=de.gl;Te.texImage2D(Te.TEXTURE_2D,0,de.extRenderToTextureHalfFloat?Te.RGBA16F:Te.RGBA,Ce,Oe,0,Te.RGBA,de.extRenderToTextureHalfFloat?Te.HALF_FLOAT:Te.UNSIGNED_BYTE,null),ve.colorAttachment.set(ge)}(U,0,fe,oe,ae,ce)}else J.bindTexture(J.TEXTURE_2D,oe.colorAttachment.get()),U.bindFramebuffer.set(oe.framebuffer)})(_,d,l,d.transform.projection.name==="globe"?.5:.25),_.clear({color:a.bz.transparent});const D=d.transform,L=D.projection.name==="globe",B=L?["PROJECTION_GLOBE_VIEW"]:[],$=L?lr.frontCCW:lr.disabled,j=[a.am(D.center.lng),a.at(D.center.lat)];for(let U=0;U<f.length;U++){const Z=f[U];if(n.hasRenderableParent(Z))continue;const X=n.getTile(Z),Y=X.getBucket(l);if(!Y||Y.projection.name!==D.projection.name)continue;const J=d.isTileAffectedByFog(Z),ae=Y.programConfigurations.get(l.id),ce=d.getOrCreateProgram("heatmap",{config:ae,defines:B,overrideFog:J}),{zoom:oe}=d.transform;d.terrain&&d.terrain.setupElevationDraw(X,ce),d.uploadCommonUniforms(_,ce,Z.toUnwrapped());const fe=D.projection.createInversionMatrix(D,Z.canonical);ce.draw(d,v.TRIANGLES,Qt.disabled,x,C,$,K1(d,Z,X,fe,j,oe,l.paint.get("heatmap-intensity")),l.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,l.paint,d.transform.zoom,ae,L?[Y.globeExtVertexBuffer]:null)}_.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(_,v){const x=_.context,C=x.gl,D=v.heatmapFbo;if(!D)return;x.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,D.colorAttachment.get()),x.activeTexture.set(C.TEXTURE1);let L=v.colorRampTexture;L||(L=v.colorRampTexture=new a.T(x,v.colorRamp,C.RGBA8)),L.bind(C.LINEAR,C.CLAMP_TO_EDGE),_.getOrCreateProgram("heatmapTexture").draw(_,C.TRIANGLES,Qt.disabled,yr.disabled,_.colorModeForRenderPass(),lr.disabled,((B,$,j,U)=>({u_image:0,u_color_ramp:1,u_opacity:$.paint.get("heatmap-opacity")}))(0,v),v.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,v.paint,_.transform.zoom)}(d,l))},line:function(d,n,l,f){if(d.renderPass!=="translucent")return;const _=l.paint.get("line-opacity"),v=l.paint.get("line-width");if(_.constantOr(1)===0||v.constantOr(1)===0)return;const x=l.paint.get("line-emissive-strength"),C=l.paint.get("line-occlusion-opacity"),D=d.context,L=D.gl,B=l.layout.get("line-z-offset"),$=!B.isConstant()||!!B.constantOr(0),j=$?new Qt(d.depthOcclusion?L.GREATER:L.LEQUAL,Qt.ReadOnly,d.depthRangeFor3D):d.depthModeForSublayer(0,Qt.ReadOnly),U=d.colorModeForDrapableLayerRenderPass(x),Z=d.terrain&&d.terrain.renderingToTexture,X=Z?1:a.q.devicePixelRatio,Y=l.paint.get("line-dasharray"),J=Y.constantOr(1),ae=l.layout.get("line-cap"),ce=Y.constantOr(null),oe=ae.constantOr(null),fe=l.paint.get("line-pattern"),de=fe.constantOr(1),ye=fe.constantOr(null),ge=l.paint.get("line-opacity").constantOr(1);let ve=!de&&ge!==1||d.depthOcclusion&&C>0&&C<1;const Ce=l.paint.get("line-gradient"),Oe=de?"linePattern":"line",Te=a.cV(l);let $e;if(Z&&d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(ve=!1),C!==0&&d.depthOcclusion){const ct=l.paint._values["line-opacity"];ct&&ct.value&&ct.value.kind==="constant"?$e=ct.value:a.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if($&&(d.forceTerrainMode=!0),!$&&C!==0&&d.terrain&&!Z)return void a.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const Je=ve&&$?d.stencilModeFor3D():yr.disabled;for(const ct of f){const Ke=n.getTile(ct);if(de&&!Ke.patternsLoaded())continue;const _t=Ke.getBucket(l);if(!_t)continue;d.prepareDrawTile();const je=_t.programConfigurations.get(l.id),nt=d.isTileAffectedByFog(ct),rt=d.getOrCreateProgram(Oe,{config:je,defines:$?[...Te,"ELEVATED"]:Te,overrideFog:nt});if(ye&&Ke.imageAtlas){const Ot=Ke.imageAtlas.patternPositions[ye.toString()];Ot&&je.setConstantPatternPositions(Ot)}if(!de&&ce&&oe&&Ke.lineAtlas){const Ot=Ke.lineAtlas.getDash(ce,oe);Ot&&je.setConstantPatternPositions(Ot)}let[vt,xt]=l.paint.get("line-trim-offset");(oe==="round"||oe==="square")&&vt!==xt&&(vt===0&&(vt-=1),xt===1&&(xt+=1));const lt=Z?ct.projMatrix:null,pt=de?a.cW(d,Ke,l,lt,X,[vt,xt]):a.cX(d,Ke,l,lt,_t.lineClipsArray.length,X,[vt,xt]);if(Ce){const Ot=_t.gradients[l.id];let Ft=Ot.texture;if(l.gradientVersion!==Ot.version){let sr=256;if(l.stepInterpolant){const Ht=n.getSource().maxzoom,tr=ct.canonical.z===Ht?Math.ceil(1<<d.transform.maxZoom-ct.canonical.z):1;sr=a.ap(a.cY(_t.maxLineLength/a.ab*1024*tr),256,D.maxTextureSize)}Ot.gradient=a.cZ({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:sr,image:Ot.gradient||void 0,clips:_t.lineClipsArray}),Ot.texture?Ot.texture.update(Ot.gradient):Ot.texture=new a.T(D,Ot.gradient,L.RGBA8),Ot.version=l.gradientVersion,Ft=Ot.texture}D.activeTexture.set(L.TEXTURE1),Ft.bind(l.stepInterpolant?L.NEAREST:L.LINEAR,L.CLAMP_TO_EDGE)}J&&(D.activeTexture.set(L.TEXTURE0),Ke.lineAtlasTexture&&Ke.lineAtlasTexture.bind(L.LINEAR,L.REPEAT),je.updatePaintBuffers()),de&&(D.activeTexture.set(L.TEXTURE0),Ke.imageAtlasTexture&&Ke.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),je.updatePaintBuffers()),$&&d.terrain.setupElevationDraw(Ke,rt),d.uploadCommonUniforms(D,rt,ct.toUnwrapped());const Kt=Ot=>{$e!=null&&($e.value=ge*C),rt.draw(d,L.TRIANGLES,j,Ot,U,lr.disabled,pt,l.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,l.paint,d.transform.zoom,je,[_t.layoutVertexBuffer2,_t.patternVertexBuffer,_t.zOffsetVertexBuffer]),$e!=null&&($e.value=ge)};if(ve&&!$){const Ot=d.stencilModeForClipping(ct).ref;Ot===0&&Z&&D.clear({stencil:0});const Ft={func:L.EQUAL,mask:255};pt.u_alpha_discard_threshold=.8,Kt(new yr(Ft,Ot,255,L.KEEP,L.KEEP,L.INVERT)),pt.u_alpha_discard_threshold=0,Kt(new yr(Ft,Ot,255,L.KEEP,L.KEEP,L.KEEP))}else ve&&$&&(pt.u_alpha_discard_threshold=.001),Kt($?Je:d.stencilModeForClipping(ct))}ve&&(d.resetStencilClippingMasks(),Z&&D.clear({stencil:0})),C===0||d.depthOcclusion||Z||d.layersWithOcclusionOpacity.push(d.currentLayer),$&&(d.forceTerrainMode=!1)},fill:function(d,n,l,f){const _=l.paint.get("fill-color"),v=l.paint.get("fill-opacity"),x=l.is3D(),C=new Qt(d.context.gl.LEQUAL,Qt.ReadWrite,d.depthRangeFor3D);if(v.constantOr(1)===0)return;const D=l.paint.get("fill-emissive-strength"),L=d.colorModeForDrapableLayerRenderPass(D),B=l.paint.get("fill-pattern"),$=d.opaquePassEnabledForLayer()&&!B.constantOr(1)&&_.constantOr(a.bz.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===$){const j=x?C:d.depthModeForSublayer(1,d.renderPass==="opaque"?Qt.ReadWrite:Qt.ReadOnly);zf(d,n,l,f,j,L,!1)}if(!x&&d.renderPass==="translucent"&&l.paint.get("fill-antialias")){const j=x?C:d.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,Qt.ReadOnly);zf(d,n,l,f,j,L,!0)}},"fill-extrusion":function(d,n,l,f){const _=l.paint.get("fill-extrusion-opacity"),v=d.context,x=v.gl,C=d.terrain,D=C&&C.renderingToTexture;if(_===0)return;const L=d.conflationActive&&d.style.isLayerClipped(l,n.getSource()),B=d.style.order.indexOf(l.fqid);if(L&&function($,j,U,Z,X){for(const Y of Z){const J=j.getTile(Y).getBucket(U);J&&(J.updateReplacement(Y,$.replacementSource,X),J.uploadCentroid($.context))}}(d,n,l,f,B),C||L)for(const $ of f){const j=n.getTile($).getBucket(l);j&&vl(d.context,n,$,j,l,C,L)}if(d.renderPass==="shadow"&&d.shadowRenderer){const $=d.shadowRenderer;if(C&&_<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.a4)return;const j=$.getShadowPassDepthMode(),U=$.getShadowPassColorMode();du(d,n,l,f,j,yr.disabled,U,L)}else if(d.renderPass==="translucent"){const $=!l.paint.get("fill-extrusion-pattern").constantOr(1),j=l.paint.get("fill-extrusion-color").constantOr(a.bz.white);if(!D&&j.a!==0){const U=new Qt(d.context.gl.LEQUAL,Qt.ReadWrite,d.depthRangeFor3D);_===1&&$?du(d,n,l,f,U,yr.disabled,kr.unblended,L):(du(d,n,l,f,U,yr.disabled,kr.disabled,L),du(d,n,l,f,U,d.stencilModeFor3D(),d.colorModeForRenderPass(),L),d.resetStencilClippingMasks())}if(d.style.enable3dLights()&&$&&(!C&&d.transform.projection.name!=="globe"||D)){const U=l.paint.get("fill-extrusion-opacity"),Z=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),X=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Y=l.paint.get("fill-extrusion-flood-light-intensity"),J=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(l.lut).toArray01().slice(0,3),ae=Z>0&&X>0,ce=Y>0,oe=(de,ye,ge)=>(1-ge)*de+ge*ye,fe=de=>{const ye=d.depthModeForSublayer(1,Qt.ReadOnly,x.LEQUAL,!0),ge=l.paint.get(de?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ve=oe(.1,3,ge),Ce=d._showOverdrawInspector;if(!Ce){const Oe=new yr({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),Te=new kr([x.ONE,x.ONE,x.ONE,x.ONE],a.bz.transparent,[!1,!1,!1,!0],x.MIN);Vn(d,n,l,f,ye,Oe,Te,lr.disabled,de,"sdf",U,Z,X,Y,J,ve,L,!1)}{const Oe=Ce?yr.disabled:new yr({func:x.EQUAL,mask:255},255,255,x.KEEP,x.DECR,x.DECR),Te=Ce?d.colorModeForRenderPass():new kr([x.ONE_MINUS_DST_ALPHA,x.DST_ALPHA,x.ONE,x.ONE],a.bz.transparent,[!0,!0,!0,!0]);Vn(d,n,l,f,ye,Oe,Te,lr.disabled,de,"color",U,Z,X,Y,J,ve,L,!1)}};if(D){const de=(ye,ge,ve)=>{const Ce=d.depthModeForSublayer(1,Qt.ReadOnly,x.LEQUAL,!1),Oe=l.paint.get(ye?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Te=oe(.1,3,Oe);{const $e=new kr([x.ONE,x.ONE,x.ONE,x.ONE],a.bz.transparent,[!1,!1,!1,!0]);Vn(d,n,l,f,Ce,yr.disabled,$e,lr.disabled,ye,"clear",U,Z,X,Y,J,Te,L,ge)}{const $e=new yr({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),Je=new kr([x.ONE,x.ONE,x.ONE,x.ONE],a.bz.transparent,[!1,!1,!1,!0],x.MIN);Vn(d,n,l,f,Ce,$e,Je,lr.disabled,ye,"sdf",U,Z,X,Y,J,Te,L,ge)}{const $e=ye?x.ZERO:x.ONE_MINUS_DST_ALPHA,Je=new yr({func:x.EQUAL,mask:255},255,255,x.KEEP,x.DECR,x.DECR),ct=new kr([$e,x.DST_ALPHA,x.ONE_MINUS_DST_ALPHA,x.ZERO],a.bz.transparent,[!0,!0,!0,!0]);Vn(d,n,l,f,Ce,Je,ct,lr.disabled,ye,"color",U,Z,X,Y,J,Te,L,ge)}{const $e=new kr([x.ONE,x.ONE,x.ONE,ye?x.ZERO:x.ONE],a.bz.transparent,[!1,!1,!1,!0],ye?x.FUNC_ADD:x.MAX);Vn(d,n,l,f,Ce,yr.disabled,$e,lr.disabled,ye,"clear",U,Z,X,Y,J,Te,L,ge,ve)}};if(ae||ce){let ye;if(d.prepareDrawTile(),C){const ge=C.drapeBufferSize[0],ve=C.drapeBufferSize[1];ye=C.framebufferCopyTexture,ye&&(!ye||ye.size[0]===ge&&ye.size[1]===ve)||(ye&&ye.destroy(),ye=C.framebufferCopyTexture=new a.T(v,new a.r({width:ge,height:ve}),x.RGBA8)),ye.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.copyTexImage2D(x.TEXTURE_2D,0,x.RGBA,0,0,ge,ve,0)}ae&&de(!0,!1,ye),ce&&de(!1,!0,ye)}}else ae&&fe(!0),ce&&fe(!1),(ae||ce)&&d.resetStencilClippingMasks()}}},hillshade:function(d,n,l,f){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent"||d.style.disableElevatedTerrain)return;const _=d.context,v=d.terrain&&d.terrain.renderingToTexture,[x,C]=d.renderPass!=="translucent"||v?[{},f]:d.stencilConfigForOverlap(f);for(const D of C){const L=n.getTile(D);if(L.needsHillshadePrepare&&d.renderPass==="offscreen")Ah(d,L,l);else if(d.renderPass==="translucent"){const B=d.depthModeForSublayer(0,Qt.ReadOnly),$=l.paint.get("hillshade-emissive-strength"),j=d.colorModeForDrapableLayerRenderPass($),U=v&&d.terrain?d.terrain.stencilModeForRTTOverlap(D):x[D.overscaledZ];vf(d,D,L,l,B,U,j)}}_.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,n,l,f,_,v){if(d.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const x=d.transform.projection.name==="globe",C=l.paint.get("raster-elevation")!==0,D=C&&x;if(d.renderElevatedRasterBackface&&!D)return;const L=d.context,B=L.gl,$=n.getSource(),j=function(de,ye,ge,ve){const Ce=ye.paint.get("raster-color"),Oe=de.type==="raster-array",Te=[],$e=ye.paint.get("raster-resampling"),Je=ye.paint.get("raster-color-mix");let ct=ye.paint.get("raster-color-range");const Ke=[Je[0],Je[1],Je[2],0],_t=Je[3];let je=$e==="nearest"?ve.NEAREST:ve.LINEAR;if(Oe&&(Te.push("RASTER_ARRAY"),Ce||Te.push("RASTER_COLOR"),$e==="linear"&&Te.push("RASTER_ARRAY_LINEAR"),je=ve.NEAREST,!ct&&de.rasterLayers)){const nt=de.rasterLayers.find(({id:rt})=>rt===ye.sourceLayer);nt&&nt.fields&&nt.fields.range&&(ct=nt.fields.range)}if(ct=ct||[0,1],Ce){Te.push("RASTER_COLOR"),ge.activeTexture.set(ve.TEXTURE2),ye.updateColorRamp(ct);let nt=ye.colorRampTexture;nt||(nt=ye.colorRampTexture=new a.T(ge,ye.colorRamp,ve.RGBA8)),nt.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)}return{mix:Ke,range:ct,offset:_t,defines:Te,resampling:je}}($,l,L,B);if($ instanceof a.aD&&!f.length&&!x)return;const U=l.paint.get("raster-emissive-strength"),Z=d.colorModeForDrapableLayerRenderPass(U),X=d.terrain&&d.terrain.renderingToTexture,Y=!d.options.moving,J=l.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;if($ instanceof a.aD&&!f.length&&($.onNorthPole||$.onSouthPole)){const de=C?d.stencilModeFor3D():yr.disabled;return void No(!!$.onNorthPole,null,d,n,l,U,j,lr.disabled,de)}if(!f.length)return;const[ae,ce]=$ instanceof a.aD||X?[{},f]:d.stencilConfigForOverlap(f),oe=ce[ce.length-1].overscaledZ;D&&j.defines.push("PROJECTION_GLOBE_VIEW"),C&&j.defines.push("RENDER_CUTOFF");const fe=(de,ye,ge)=>{for(const ve of de){const Ce=ve.toUnwrapped(),Oe=n.getTile(ve);if(X&&(!Oe||!Oe.hasData()))continue;L.activeTexture.set(B.TEXTURE0);const Te=Ff(Oe,$,l,j);if(!Te||!Te.texture)continue;const{texture:$e,mix:Je,offset:ct,tileSize:Ke,buffer:_t}=Te;let je,nt;X?(je=Qt.disabled,nt=ve.projMatrix):C?(je=new Qt(B.LEQUAL,Qt.ReadWrite,d.depthRangeFor3D),nt=x?Float32Array.from(d.transform.expandedFarZProjMatrix):d.transform.calculateProjMatrix(Ce,Y)):(je=d.depthModeForSublayer(ve.overscaledZ-oe,l.paint.get("raster-opacity")===1?Qt.ReadWrite:Qt.ReadOnly,B.LESS),nt=d.transform.calculateProjMatrix(Ce,Y));const rt=d.terrain&&X?d.terrain.stencilModeForRTTOverlap(ve):ae[ve.overscaledZ],vt=v?0:l.paint.get("raster-fade-duration");Oe.registerFadeDuration(vt);const xt=n.findLoadedParent(ve,0),lt=Of(Oe,xt,n,d.transform,vt);let pt,Kt;d.terrain&&d.terrain.prepareDrawTile(),L.activeTexture.set(B.TEXTURE0),$e.bind(J,B.CLAMP_TO_EDGE),L.activeTexture.set(B.TEXTURE1),xt?(xt.texture&&xt.texture.bind(J,B.CLAMP_TO_EDGE),pt=Math.pow(2,xt.tileID.overscaledZ-Oe.tileID.overscaledZ),Kt=[Oe.tileID.canonical.x*pt%1,Oe.tileID.canonical.y*pt%1]):$e.bind(J,B.CLAMP_TO_EDGE),$e.useMipmap&&L.extTextureFilterAnisotropic&&d.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax);const Ot=d.transform;let Ft;const sr=C?nn(Ot):[0,0,0,0];let Ht,tr,Ir,Pr,fi,wi=0;if(D&&$ instanceof a.aD&&$.coordinates.length>3)Ht=Float32Array.from(a.b5(a.cC(new a.bP(0,0,0)))),tr=Float32Array.from(Ot.globeMatrix),Ir=Float32Array.from(a.cy(Ot)),Pr=[a.am(Ot.center.lng),a.at(Ot.center.lat)],Ft=$.elevatedGlobePerspectiveTransform,fi=$.elevatedGlobeGridMatrix||new Float32Array(9);else if(D){const Fr=a.cz(ve.canonical);wi=a.cA(Fr.getCenter().lat),Ht=Float32Array.from(a.b5(a.cC(ve.canonical))),tr=Float32Array.from(Ot.globeMatrix),Ir=Float32Array.from(a.cy(Ot)),Pr=[a.am(Ot.center.lng),a.at(Ot.center.lat)],Ft=[0,0],fi=Float32Array.from(a.cB(ve.canonical,Fr,wi,Ot.worldSize/Ot._pixelsPerMercatorPixel))}else Ft=$ instanceof a.aD?$.perspectiveTransform:[0,0],Ht=new Float32Array(16),tr=new Float32Array(9),Ir=new Float32Array(16),Pr=[0,0],fi=new Float32Array(9);const zi=Bh(nt,Ht,tr,Ir,fi,Kt||[0,0],a.a9(d.transform.zoom),Pr,sr,pt||1,lt,l,Ft,C?l.paint.get("raster-elevation"):0,2,Je,ct,j.range,Ke,_t,U),ps=d.isTileAffectedByFog(ve),gn=d.getOrCreateProgram("raster",{defines:j.defines,overrideFog:ps});if(d.uploadCommonUniforms(L,gn,Ce),$ instanceof a.aD){const Fr=$.elevatedGlobeVertexBuffer,vi=$.elevatedGlobeIndexBuffer;if(X||!x)$.boundsBuffer&&$.boundsSegments&&gn.draw(d,B.TRIANGLES,je,yr.disabled,Z,lr.disabled,zi,l.id,$.boundsBuffer,d.quadTriangleIndexBuffer,$.boundsSegments);else if(Fr&&vi){const Gi=Ot.zoom<=a.c2?$.elevatedGlobeSegments:$.getSegmentsForLongitude(Ot.center.lng);Gi&&gn.draw(d,B.TRIANGLES,je,yr.disabled,Z,ye,zi,l.id,Fr,vi,Gi)}}else if(D){je=new Qt(B.LEQUAL,Qt.ReadOnly,d.depthRangeFor3D);const Fr=d.globeSharedBuffers;if(Fr){const[vi,Gi,mi]=Fr.getGridBuffers(wi,!1);gn.draw(d,B.TRIANGLES,je,ge||rt,d.colorModeForRenderPass(),ye,zi,l.id,vi,Gi,mi)}}else{const{tileBoundsBuffer:Fr,tileBoundsIndexBuffer:vi,tileBoundsSegments:Gi}=d.getTileBoundsBuffers(Oe);gn.draw(d,B.TRIANGLES,je,rt,Z,lr.disabled,zi,l.id,Fr,vi,Gi)}}if(!($ instanceof a.aD)&&D)for(const ve of de){const Ce=ve.canonical.y===(1<<ve.canonical.z)-1;ve.canonical.y===0&&No(!0,ve,d,n,l,U,j,ye,ge||yr.disabled),Ce&&No(!1,ve,d,n,l,U,j,ye===lr.frontCW?lr.backCW:lr.frontCW,ge||yr.disabled)}};D?fe(ce,d.renderElevatedRasterBackface?lr.backCW:lr.frontCW,d.stencilModeFor3D()):fe(ce,lr.disabled,void 0),d.resetStencilClippingMasks()},"raster-particle":function(d,n,l,f,_,v){d.renderPass==="offscreen"&&function(x,C,D,L){if(!L.length)return;const B=x.context,$=B.gl,j=C.getSource();if(!(j instanceof jc))return;const U=Math.ceil(Math.sqrt(D.paint.get("raster-particle-count")));let Z=D.particlePositionRGBAImage;if(!Z||Z.width!==U){const ce=function(oe){const fe=oe*oe,de=new Uint8Array(4*fe),ye=function(ve){return ve|=0,ve=Math.imul(2747636419^ve,2654435769),ve=Math.imul(ve^ve>>>16,2654435769),((ve=Math.imul(ve^ve>>>16,2654435769))>>>0)/4294967296},ge=1/1.1;for(let ve=0;ve<fe;ve++){const Ce=ge*(ye(2*ve+0)+_a),Oe=ge*(ye(2*ve+1)+_a),Te=255*Ce%1,$e=255*Oe%1,Je=Te,ct=Oe-$e/255,Ke=$e;de[4*ve+0]=255*(Ce-Te/255),de[4*ve+1]=255*Je,de[4*ve+2]=255*ct,de[4*ve+3]=255*Ke}return de}(U);Z=D.particlePositionRGBAImage=new a.r({width:U,height:U},ce)}let X=D.particleFramebuffer;X?X.width!==U&&(X.destroy(),X=D.particleFramebuffer=B.createFramebuffer(U,U,!0,null)):X=D.particleFramebuffer=B.createFramebuffer(U,U,!0,null);const Y=[];for(const ce of L){const oe=C.getTile(ce);if(!(oe instanceof tf))continue;const fe=Tv(oe,j,D);if(!fe)continue;const de=[oe.tileSize,oe.tileSize];let ye=D.tileFramebuffer;ye||(ye=D.tileFramebuffer=B.createFramebuffer(de[0],de[1],!0,null));let ge=oe.rasterParticleState;ge||(ge=oe.rasterParticleState=new wv(B,ce,de,Z));const ve=ge.update(D.lastInvalidatedAt);ge.particleTextureDimension!==U&&ge.updateParticleTexture(ce,Z);const Ce=ge.targetColorTexture;ge.targetColorTexture=ge.backgroundColorTexture,ge.backgroundColorTexture=Ce;const Oe=ge.particleTexture0;ge.particleTexture0=ge.particleTexture1,ge.particleTexture1=Oe,Y.push([ce,fe,ge,ve])}if(Y.length===0)return;const J=a.q.now(),ae=D.previousDrawTimestamp?.001*(J-D.previousDrawTimestamp):.0167;if(D.previousDrawTimestamp=J,D.hasColorMap()){B.activeTexture.set($.TEXTURE0+2);let ce=D.colorRampTexture;ce||(ce=D.colorRampTexture=new a.T(B,D.colorRamp,$.RGBA8)),ce.bind($.LINEAR,$.CLAMP_TO_EDGE)}B.bindFramebuffer.set(D.tileFramebuffer.framebuffer),function(ce,oe,fe){const de=ce.context,ye=de.gl,ge=oe.tileFramebuffer;de.activeTexture.set(ye.TEXTURE0);const ve={u_texture:0,u_opacity:1.05*(Oe=oe.paint.get("raster-particle-fade-opacity-factor"))/(Oe+.05)},Ce=ce.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Oe;for(const Te of fe){const[,,$e,Je]=Te;ge.colorAttachment.set($e.targetColorTexture.texture),de.viewport.set([0,0,ge.width,ge.height]),de.clear({color:a.bz.transparent}),Je&&($e.backgroundColorTexture.bind(ye.NEAREST,ye.CLAMP_TO_EDGE),Ce.draw(ce,ye.TRIANGLES,Qt.disabled,yr.disabled,kr.alphaBlended,lr.disabled,ve,oe.id,ce.viewportBuffer,ce.quadTriangleIndexBuffer,ce.viewportSegments))}}(x,D,Y),function(ce,oe,fe,de){const ye=ce.context,ge=ye.gl,ve=fe.tileFramebuffer,Ce=ce.transform.projection.name==="globe",Oe=fe.paint.get("raster-particle-max-speed");for(const Te of de){const[$e,Je,ct]=Te;ye.activeTexture.set(ge.TEXTURE0+0),Je.texture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),ve.colorAttachment.set(ct.targetColorTexture.texture);const Ke=ce.getOrCreateProgram("rasterParticleDraw",{defines:Je.defines,overrideFog:!1});ye.activeTexture.set(ge.TEXTURE0+1);const _t=Je.scalarData?[]:[0,1,2,3].map(rt=>a.c$[rt]($e));_t.push($e);const je=$e.canonical.x,nt=$e.canonical.y;for(const rt of _t){const vt=oe.getTile(Ce?rt.wrapped():rt);if(!vt)continue;const xt=vt.rasterParticleState;if(!xt)continue;const lt=rt.canonical.x+(1<<rt.canonical.z)*(rt.wrap-$e.wrap),pt=rt.canonical.y;xt.particleTexture0.bind(ge.NEAREST,ge.CLAMP_TO_EDGE);const Kt=If(1,xt.particleTexture0.size[0],[lt-je,pt-nt],0,Je.texture.size,2,Oe,Je.textureOffset,Je.scale,Je.offset);Ke.draw(ce,ge.POINTS,Qt.disabled,yr.disabled,kr.alphaBlended,lr.disabled,Kt,fe.id,xt.particleIndexBuffer,void 0,xt.particleSegment)}}}(x,C,D,Y),B.bindFramebuffer.set(D.particleFramebuffer.framebuffer),function(ce,oe,fe,de){const ye=ce.context,ge=ye.gl,ve=oe.paint.get("raster-particle-max-speed"),Ce=de*oe.paint.get("raster-particle-speed-factor")*.15,Oe=function($e){return Math.pow($e,6)}(.01+1*oe.paint.get("raster-particle-reset-rate-factor")),Te=oe.particleFramebuffer;ye.viewport.set([0,0,Te.width,Te.height]);for(const $e of fe){const[,Je,ct]=$e;ye.activeTexture.set(ge.TEXTURE0+0),Je.texture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),ye.activeTexture.set(ge.TEXTURE0+1);const Ke=ct.particleTexture0;Ke.bind(ge.NEAREST,ge.CLAMP_TO_EDGE);const _t=Df(1,Ke.size[0],0,Je.texture.size,ve,Ce,Oe,Je.textureOffset,Je.scale,Je.offset);Te.colorAttachment.set(ct.particleTexture1.texture),ye.clear({color:a.bz.transparent}),ce.getOrCreateProgram("rasterParticleUpdate",{defines:Je.defines}).draw(ce,ge.TRIANGLES,Qt.disabled,yr.disabled,kr.unblended,lr.disabled,_t,oe.id,ce.viewportBuffer,ce.quadTriangleIndexBuffer,ce.viewportSegments)}}(x,D,Y,ae)}(d,n,l,f),d.renderPass==="translucent"&&(function(x,C,D,L,B){const $=x.context,j=$.gl,U=C.getSource().tileSize,Z=5*(1-a.a7(a.bU,a.bU+1,x.transform.zoom))*U+D.paint.get("raster-particle-elevation"),X=!x.options.moving,Y=x.transform.projection.name==="globe";if(!L.length)return;const[J,ae]=x.stencilConfigForOverlap(L),ce=[];Y&&ce.push("PROJECTION_GLOBE_VIEW");const oe=x.stencilModeFor3D();for(const fe of ae){const de=fe.toUnwrapped(),ye=C.getTile(fe);if(!ye.rasterParticleState)continue;const ge=ye.rasterParticleState,ve=100;ye.registerFadeDuration(ve);const Ce=C.findLoadedParent(fe,0),Oe=Of(ye,Ce,C,x.transform,ve);let Te,$e;x.terrain&&x.terrain.prepareDrawTile(),$.activeTexture.set(j.TEXTURE0),ge.targetColorTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),$.activeTexture.set(j.TEXTURE1),Ce&&Ce.rasterParticleState?(Ce.rasterParticleState.targetColorTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Te=Math.pow(2,Ce.tileID.overscaledZ-ye.tileID.overscaledZ),$e=[ye.tileID.canonical.x*Te%1,ye.tileID.canonical.y*Te%1]):ge.targetColorTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Je=Y?Float32Array.from(x.transform.expandedFarZProjMatrix):x.transform.calculateProjMatrix(de,X),ct=x.transform,Ke=Ev(ct),_t=a.cz(fe.canonical),je=a.cA(_t.getCenter().lat);let nt,rt,vt,xt,lt;Y?(nt=Float32Array.from(a.b5(a.cC(fe.canonical))),rt=Float32Array.from(ct.globeMatrix),vt=Float32Array.from(a.cy(ct)),xt=[a.am(ct.center.lng),a.at(ct.center.lat)],lt=Float32Array.from(a.cB(fe.canonical,_t,je,ct.worldSize/ct._pixelsPerMercatorPixel))):(nt=new Float32Array(16),rt=new Float32Array(9),vt=new Float32Array(16),xt=[0,0],lt=new Float32Array(9));const pt=yv(Je,nt,rt,vt,lt,$e||[0,0],a.a9(x.transform.zoom),xt,Ke,Te||1,Oe,Z),Kt=x.isTileAffectedByFog(fe),Ot=x.getOrCreateProgram("rasterParticle",{defines:ce,overrideFog:Kt});if(x.uploadCommonUniforms($,Ot,de),Y){const Ft=new Qt(j.LEQUAL,Qt.ReadOnly,x.depthRangeFor3D),sr=0,Ht=x.globeSharedBuffers;if(Ht){const[tr,Ir,Pr]=Ht.getGridBuffers(je,sr!==0);Ot.draw(x,j.TRIANGLES,Ft,oe,kr.alphaBlended,x.renderElevatedRasterBackface?lr.frontCCW:lr.backCCW,pt,D.id,tr,Ir,Pr)}}else{const Ft=x.depthModeForSublayer(0,Qt.ReadOnly),sr=J[fe.overscaledZ],{tileBoundsBuffer:Ht,tileBoundsIndexBuffer:tr,tileBoundsSegments:Ir}=x.getTileBoundsBuffers(ye);Ot.draw(x,j.TRIANGLES,Ft,sr,kr.alphaBlended,lr.disabled,pt,D.id,Ht,tr,Ir)}}x.resetStencilClippingMasks()}(d,n,l,f),d.style.map.triggerRepaint())},background:function(d,n,l,f){const _=l.paint.get("background-color"),v=l.paint.get("background-opacity"),x=l.paint.get("background-emissive-strength"),C=l.paint.get("background-pitch-alignment")==="viewport";if(v===0)return;const D=d.context,L=D.gl,B=d.transform,$=B.tileSize,j=l.paint.get("background-pattern");let U;if(j!==void 0&&(j===null||(U=d.imageManager.getPattern(j.toString(),l.scope,d.style.getLut(l.scope)),!U)))return;const Z=!j&&_.a===1&&v===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==Z)return;const X=yr.disabled,Y=d.depthModeForSublayer(0,Z==="opaque"?Qt.ReadWrite:Qt.ReadOnly),J=d.colorModeForDrapableLayerRenderPass(x),ae=j?"backgroundPattern":"background";let ce,oe=f;if(oe||(ce=d.getBackgroundTiles(),oe=Object.values(ce).map(fe=>fe.tileID)),j&&(D.activeTexture.set(L.TEXTURE0),d.imageManager.bind(d.context,l.scope)),C){const fe=d.getOrCreateProgram(ae,{overrideFog:!1,overrideRtt:!0}),de=new Float32Array(a.a6.mat4.identity([])),ye=new a.aA(0,0,0,0,0),ge=j?nc(de,x,v,d,0,l.scope,U,C,{tileID:ye,tileSize:$}):vv(de,x,v,_.toRenderColor(l.lut));fe.draw(d,L.TRIANGLES,Y,X,J,lr.disabled,ge,l.id,d.viewportBuffer,d.quadTriangleIndexBuffer,d.viewportSegments)}else for(const fe of oe){const de=d.isTileAffectedByFog(fe),ye=d.getOrCreateProgram(ae,{overrideFog:de}),ge=fe.toUnwrapped(),ve=f?fe.projMatrix:d.transform.calculateProjMatrix(ge);d.prepareDrawTile();const Ce=n?n.getTile(fe):ce?ce[fe.key]:new pa(fe,$,B.zoom,d),Oe=j?nc(ve,x,v,d,0,l.scope,U,C,{tileID:fe,tileSize:$}):vv(ve,x,v,_.toRenderColor(l.lut));d.uploadCommonUniforms(D,ye,ge);const{tileBoundsBuffer:Te,tileBoundsIndexBuffer:$e,tileBoundsSegments:Je}=d.getTileBoundsBuffers(Ce);ye.draw(d,L.TRIANGLES,Y,X,J,lr.disabled,Oe,l.id,Te,$e,Je)}},sky:function(d,n,l){const f=d._atmosphere?a.a9(d.transform.zoom):1,_=l.paint.get("sky-opacity")*f;if(_===0)return;const v=d.context,x=l.paint.get("sky-type"),C=new Qt(v.gl.LEQUAL,Qt.ReadOnly,[0,1]),D=d.frameCounter/1e3%1;x==="atmosphere"?d.renderPass==="offscreen"?l.needsSkyboxCapture(d)&&(function(L,B,$,j){const U=L.context,Z=U.gl;let X=B.skyboxFbo;if(!X){X=B.skyboxFbo=U.createFramebuffer(32,32,!0,null),B.skyboxGeometry=new ig(U),B.skyboxTexture=U.gl.createTexture(),Z.bindTexture(Z.TEXTURE_CUBE_MAP,B.skyboxTexture),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_CUBE_MAP,Z.TEXTURE_MAG_FILTER,Z.LINEAR);for(let ce=0;ce<6;++ce)Z.texImage2D(Z.TEXTURE_CUBE_MAP_POSITIVE_X+ce,0,Z.RGBA,32,32,0,Z.RGBA,Z.UNSIGNED_BYTE,null)}U.bindFramebuffer.set(X.framebuffer),U.viewport.set([0,0,32,32]);const Y=B.getCenter(L,!0),J=L.getOrCreateProgram("skyboxCapture"),ae=new Float64Array(16);a.a6.mat4.identity(ae),a.a6.mat4.rotateY(ae,ae,.5*-Math.PI),sc(L,B,J,ae,Y,0),a.a6.mat4.identity(ae),a.a6.mat4.rotateY(ae,ae,.5*Math.PI),sc(L,B,J,ae,Y,1),a.a6.mat4.identity(ae),a.a6.mat4.rotateX(ae,ae,.5*-Math.PI),sc(L,B,J,ae,Y,2),a.a6.mat4.identity(ae),a.a6.mat4.rotateX(ae,ae,.5*Math.PI),sc(L,B,J,ae,Y,3),a.a6.mat4.identity(ae),sc(L,B,J,ae,Y,4),a.a6.mat4.identity(ae),a.a6.mat4.rotateY(ae,ae,Math.PI),sc(L,B,J,ae,Y,5),U.viewport.set([0,0,L.width,L.height])}(d,l),l.markSkyboxValid(d)):d.renderPass==="sky"&&function(L,B,$,j,U){const Z=L.context,X=Z.gl,Y=L.transform,J=L.getOrCreateProgram("skybox");Z.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_CUBE_MAP,B.skyboxTexture);const ae=((ce,oe,fe,de,ye)=>({u_matrix:ce,u_sun_direction:oe,u_cubemap:0,u_opacity:de,u_temporal_offset:ye}))(Y.skyboxMatrix,B.getCenter(L,!1),0,j,U);L.uploadCommonUniforms(Z,J),J.draw(L,X.TRIANGLES,$,yr.disabled,L.colorModeForRenderPass(),lr.backCW,ae,"skybox",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(d,l,C,_,D):x==="gradient"&&d.renderPass==="sky"&&function(L,B,$,j,U){const Z=L.context,X=Z.gl,Y=L.transform,J=L.getOrCreateProgram("skyboxGradient");B.skyboxGeometry||(B.skyboxGeometry=new ig(Z)),Z.activeTexture.set(X.TEXTURE0);let ae=B.colorRampTexture;ae||(ae=B.colorRampTexture=new a.T(Z,B.colorRamp,X.RGBA8)),ae.bind(X.LINEAR,X.CLAMP_TO_EDGE);const ce=((oe,fe,de,ye,ge)=>({u_matrix:oe,u_color_ramp:0,u_center_direction:fe,u_radius:a.bB(de),u_opacity:ye,u_temporal_offset:ge}))(Y.skyboxMatrix,B.getCenter(L,!1),B.paint.get("sky-gradient-radius"),j,U);L.uploadCommonUniforms(Z,J),J.draw(L,X.TRIANGLES,$,yr.disabled,L.colorModeForRenderPass(),lr.backCW,ce,"skyboxGradient",B.skyboxGeometry.vertexBuffer,B.skyboxGeometry.indexBuffer,B.skyboxGeometry.segment)}(d,l,C,_,D)},debug:function(d,n,l,f,_,v){for(let x=0;x<l.length;x++)if(_){const L=new a.bz(f.r*.8,f.g*.8,f.b*.8,1);Gs(d,n,l[x],f,-1,-1,v),Gs(d,n,l[x],f,-1,1,v),Gs(d,n,l[x],f,1,1,v),Gs(d,n,l[x],f,1,-1,v),Gs(d,n,l[x],L,0,0,v)}else Gs(d,n,l[x],f,0,0,v)},custom:function(d,n,l,f){const _=d.context,v=l.implementation;if(!d.transform.projection.unsupportedLayers||!d.transform.projection.unsupportedLayers.includes("custom")||d.terrain&&(d.terrain.renderingToTexture||d.renderPass==="offscreen")&&l.isDraped(n)){if(d.renderPass==="offscreen"){const x=v.prerender;if(x){if(d.setCustomLayerDefaults(),_.setColorMode(d.colorModeForRenderPass()),d.transform.projection.name==="globe"){const C=d.transform.pointMerc;x.call(v,_.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),a.a9(d.transform.zoom),[C.x,C.y],d.transform.pixelsPerMeterRatio)}else x.call(v,_.gl,d.transform.customLayerMatrix());_.setDirty(),d.setBaseState()}}else if(d.renderPass==="translucent"){if(d.terrain&&d.terrain.renderingToTexture){const C=v.renderToTile;if(C){const D=f[0].canonical,L=new a.a5(D.x+f[0].wrap*(1<<D.z),D.y,D.z);_.setDepthMode(Qt.disabled),_.setStencilMode(yr.disabled),_.setColorMode(d.colorModeForRenderPass()),d.setCustomLayerDefaults(),C.call(v,_.gl,L),_.setDirty(),d.setBaseState()}return}d.setCustomLayerDefaults(),_.setColorMode(d.colorModeForRenderPass()),_.setStencilMode(yr.disabled);const x=v.renderingMode==="3d"?new Qt(d.context.gl.LEQUAL,Qt.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,Qt.ReadOnly);if(_.setDepthMode(x),d.transform.projection.name==="globe"){const C=d.transform.pointMerc;v.render(_.gl,d.transform.customLayerMatrix(),d.transform.getProjection(),d.transform.globeToMercatorMatrix(),a.a9(d.transform.zoom),[C.x,C.y],d.transform.pixelsPerMeterRatio)}else v.render(_.gl,d.transform.customLayerMatrix());_.setDirty(),d.setBaseState(),_.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(d,n,l,f){if(d.renderPass==="opaque")return;const _=l.paint.get("model-opacity");if(_===0)return;const v=l.paint.get("model-cast-shadows");if(d.renderPass==="shadow"&&(!v||d.terrain&&_<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof a.a4))return;const x=d.shadowRenderer,C=l.paint.get("model-receive-shadows");x&&(x.useNormalOffset=!0,C||(x.enabled=!1));const D=()=>{x&&(x.useNormalOffset=!0,C||(x.enabled=!0))},L=n.getSource();if(d.renderPass==="light-beam"&&L.type!=="batched-model")return;if(L.type==="vector"||L.type==="geojson")return function(J,ae,ce,oe,fe){const de=J.transform;if(de.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${de.projection.name} projection is not yet implemented`);const ye=de.getFreeCameraOptions().position;if(!J.modelManager)return;const ge=J.modelManager;ce.modelManager=ge;const ve=J.shadowRenderer;if(!ce._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ce=ce._unevaluatedLayout._values["model-id"],Oe={...ce.layout.get("model-id").parameters},Te=J.style.order.indexOf(ce.fqid);for(const $e of oe){const Je=ae.getTile($e).getBucket(ce);if(!Je||Je.projection.name!==de.projection.name)continue;const ct=Je.getModelUris();ct&&!Je.modelsRequested&&(ge.addModelsFromBucket(ct,fe),Je.modelsRequested=!0);const Ke=iw($e,de);Oe.zoom=Ke;const _t=Ce.possiblyEvaluate(Oe);if(Ov(J,Je,$e),qs.shadowUniformsInitialized=!1,qs.useSingleShadowCascade=!!ve&&ve.getMaxCascadeForTile($e.toUnwrapped())===0,J.renderPass==="shadow"&&ve){if(J.currentShadowCascade===1&&Je.isInsideFirstShadowMapFrustum)continue;const rt=de.calculatePosMatrix($e.toUnwrapped(),de.worldSize);if(qs.tileMatrix.set(rt),qs.shadowTileMatrix=Float32Array.from(ve.calculateShadowPassMatrixFromMatrix(rt)),qs.aabb.min.fill(0),qs.aabb.max[0]=qs.aabb.max[1]=a.ab,qs.aabb.max[2]=0,Vh(Je,qs,J,ce.scope))continue}const je=1<<$e.canonical.z,nt=[((ye.x-$e.wrap)*je-$e.canonical.x)*a.ab,(ye.y*je-$e.canonical.y)*a.ab,ye.z*je*a.ab];J.conflationActive&&Object.keys(Je.instancesPerModel).length>0&&J.style.isLayerClipped(ce,ae.getSource())&&Je.updateReplacement($e,J.replacementSource,Te,fe)&&(Je.uploaded=!1,Je.upload(J.context));for(let rt in Je.instancesPerModel){const vt=Je.instancesPerModel[rt];vt.features.length>0&&(rt=_t.evaluate(vt.features[0].feature,{}));const xt=ge.getModel(rt,fe);if(xt&&xt.uploaded)for(const lt of xt.nodes)ho(J,ce,lt,vt,nt,$e,qs)}}}(d,n,l,f,L.type==="vector"?l.scope:""),void D();if(!L.loaded())return;if(L.type==="batched-model")return function(J,ae,ce,oe){ce.resetLayerRenderingStats(J);const fe=J.context,de=J.transform,ye=J.style.fog,ge=J.shadowRenderer;if(de.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${de.projection.name} projection is not yet implemented`);const ve=J.transform.getFreeCameraOptions().position,Ce=a.a6.vec3.scale([],[ve.x,ve.y,ve.z],J.transform.worldSize),Oe=a.a6.vec3.negate([],Ce),Te=a.a6.mat4.identity([]),$e=a.de(de.center.lat,de.zoom),Je=a.a6.mat4.fromScaling([],[1,1,1/$e]);a.a6.mat4.translate(Te,Te,Oe);const ct=ce.paint.get("model-opacity"),Ke=new Qt(fe.gl.LEQUAL,Qt.ReadWrite,J.depthRangeFor3D),_t=new Qt(fe.gl.LEQUAL,Qt.ReadOnly,J.depthRangeFor3D),je=new a.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),nt=J.renderPass==="shadow",rt=nt&&ge?ge.getCurrentCascadeFrustum():de.getFrustum(de.scaleZoom(de.worldSize)),vt=ce.paint.get("model-front-cutoff"),xt=vt[2]<1,lt=Na(J,ce.paint.get("model-cutoff-fade-range")),pt=ce.getLayerRenderingStats();(function(Kt,Ot,Ft,sr){const Ht=Kt.terrain?Kt.terrain.exaggeration():0,tr=Kt.transform.zoom;for(const Ir of sr){const Pr=Ot.getTile(Ir).getBucket(Ft);Pr&&(Kt.conflationActive&&Pr.updateReplacement(Ir,Kt.replacementSource),Pr.evaluateScale(Kt,Ft),Kt.terrain&&Ht>0&&Pr.elevationUpdate(Kt.terrain,Ht,Ir,Ft.source),Pr.needsReEvaluation(Kt,tr,Ft)&&Pr.evaluate(Ft))}})(J,ae,ce,oe),function(){let Kt,Ot,Ft;xt?(Kt=oe.length-1,Ot=-1,Ft=-1):(Kt=0,Ot=oe.length,Ft=1);const sr=new Float64Array(16),Ht=a.a6.vec3.create(),tr=new a.P(0,0);for(let Ir=Kt;Ir!==Ot;Ir+=Ft){const Pr=oe[Ir],fi=ae.getTile(Pr).getBucket(ce);if(!fi||!fi.uploaded)continue;let wi=!1;ge&&(wi=ge.getMaxCascadeForTile(Pr.toUnwrapped())===0);const zi=de.calculatePosMatrix(Pr.toUnwrapped(),de.worldSize),ps=fi.modelTraits;!nt&&xt&&(a.a6.mat4.invert(sr,zi),a.a6.vec3.transformMat4(Ht,Ce,sr),tr.x=Ht[0],tr.y=Ht[1]);const gn=[];for(const Fr of fi.getNodesInfo()){if(Fr.hiddenByReplacement||!Fr.node.meshes)continue;const vi=Fr.node;let Gi=0;J.terrain&&vi.elevation&&(Gi=vi.elevation*J.terrain.exaggeration());const mi=(()=>{const Ii=Fr.aabb;return je.min=[...Ii.min],je.max=[...Ii.max],je.min[2]+=Gi,je.max[2]+=Gi,a.a6.vec3.transformMat4(je.min,je.min,zi),a.a6.vec3.transformMat4(je.max,je.max,zi),je})(),Ar=Fr.evaluatedScale;if(Ar[0]<=1&&Ar[1]<=1&&Ar[2]<=1&&mi.intersects(rt)===0)continue;if(!nt&&xt){const Ii=.16666666666666666;Fr.cameraCollisionOpacity=Ce[0]>mi.min[0]&&Ce[0]<mi.max[0]&&Ce[1]>mi.min[1]&&Ce[1]<mi.max[1]&&Ce[2]*$e<mi.max[2]&&vi.footprint&&a.bu(tr,vi.footprint)?Math.max(Fr.cameraCollisionOpacity-Ii,0):Math.min(1,Fr.cameraCollisionOpacity+Ii)}const ri=[...zi],ci=vi.anchor?vi.anchor[0]:0,sn=vi.anchor?vi.anchor[1]:0;a.a6.mat4.translate(ri,ri,[ci*(Ar[0]-1),sn*(Ar[1]-1),Gi]),a.a6.vec3.exactEquals(Ar,a.dh)||a.a6.mat4.scale(ri,ri,Ar);const _n=a.a6.mat4.multiply([],ri,vi.matrix),Xr=a.a6.mat4.multiply([],de.expandedFarZProjMatrix,_n),In=a.a6.mat4.multiply([],de.expandedFarZProjMatrix,ri),jn=a.a6.vec4.transformMat4([],[ci,sn,Gi,1],Xr)[2];vi.hidden=!1;let Dn=ct;nt||(xt&&(Dn*=Fr.cameraCollisionOpacity,Dn*=ti(ri,de,Fr.aabb,vt)),Dn*=$i(lt,jn)),Dn!==0?gn.push({nodeInfo:Fr,depth:jn,opacity:Dn,wvpForNode:Xr,wvpForTile:In,nodeModelMatrix:_n,tileModelMatrix:ri}):vi.hidden=!0}nt||gn.sort((Fr,vi)=>!xt||Fr.opacity===1&&vi.opacity===1?Fr.depth<vi.depth?-1:1:Fr.opacity===1?-1:vi.opacity===1?1:Fr.depth>vi.depth?-1:1);for(const Fr of gn){const vi=Fr.nodeInfo,Gi=vi.node;let mi=a.a6.mat4.multiply([],Je,Fr.tileModelMatrix);a.a6.mat4.multiply(mi,Te,mi);const Ar=a.a6.mat4.invert([],mi);a.a6.mat4.transpose(Ar,Ar),a.a6.mat4.scale(Ar,Ar,nw),mi=a.a6.mat4.multiply(mi,mi,Gi.matrix);const ri=J.renderPass==="light-beam",ci=ps&a.dj.HasMapboxMeshFeatures,sn=ci?0:vi.evaluatedRMEA[0][2];for(let _n=0;_n<Gi.meshes.length;++_n){const Xr=Gi.meshes[_n],In=_n===Gi.lightMeshIndex;let jn=Fr.wvpForNode;if(In){if(!ri&&!J.terrain&&J.shadowRenderer){J.currentLayer<J.firstLightBeamLayer&&(J.firstLightBeamLayer=J.currentLayer);continue}jn=Fr.wvpForTile}else if(ri)continue;const Dn={defines:[]},Ii=[];if(Vf(Dn.defines,Ii,Xr,J,ce.lut),ci||Dn.defines.push("DIFFUSE_SHADED"),wi&&Dn.defines.push("SHADOWS_SINGLE_CASCADE"),pt&&(nt?pt.numRenderedVerticesInShadowPass+=Xr.vertexArray.length:pt.numRenderedVerticesInTransparentPass+=Xr.vertexArray.length),nt){gu(Xr,Fr.nodeModelMatrix,J,ce);continue}let Oo=null;if(ye){const Ha=jf(Fr.nodeModelMatrix,J.transform);if(Oo=new Float32Array(Ha),de.projection.name!=="globe"){const Sl=Xr.aabb.min,xa=Xr.aabb.max,[wu,Tu]=ye.getOpacityForBounds(Ha,Sl[0],Sl[1],xa[0],xa[1]);Dn.overrideFog=wu>=kt||Tu>=kt}}const Po=Xr.material;let ms;Po.occlusionTexture&&Po.occlusionTexture.offsetScale&&(ms=Po.occlusionTexture.offsetScale,Dn.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!nt&&ge&&(ge.useNormalOffset=!!Xr.normalBuffer);const es=J.getOrCreateProgram("model",Dn);!nt&&ge&&ge.setupShadowsFromMatrix(Fr.tileModelMatrix,es,ge.useNormalOffset),J.uploadCommonUniforms(fe,es,null,Oo);const $o=Po.pbrMetallicRoughness;$o.metallicFactor=.9,$o.roughnessFactor=.5;const gs=jt(new Float32Array(jn),new Float32Array(mi),new Float32Array(Ar),new Float32Array(Gi.matrix),J,Fr.opacity,$o.baseColorFactor.toRenderColor(null),Po.emissiveFactor,$o.metallicFactor,$o.roughnessFactor,Po,sn,ce,[0,0,0],ms);!In&&(vi.hasTranslucentParts||Fr.opacity<1)&&es.draw(J,fe.gl.TRIANGLES,Ke,yr.disabled,kr.disabled,lr.backCCW,gs,ce.id,Xr.vertexBuffer,Xr.indexBuffer,Xr.segments,ce.paint,J.transform.zoom,void 0,Ii),es.draw(J,fe.gl.TRIANGLES,In?_t:Ke,yr.disabled,In||Fr.opacity<1||vi.hasTranslucentParts?kr.alphaBlended:kr.unblended,lr.backCCW,gs,ce.id,Xr.vertexBuffer,Xr.indexBuffer,Xr.segments,ce.paint,J.transform.zoom,void 0,Ii)}}}}()}(d,n,l,f),void D();if(L.type!=="model")return;const B=L.getModels(),$=[],j=d.transform.getFreeCameraOptions().position,U=a.a6.vec3.scale([],[j.x,j.y,j.z],d.transform.worldSize);a.a6.vec3.negate(U,U);const Z=[],X=[];let Y=0;for(const J of B){const ae=l.paint.get("model-rotation").constantOr(null),ce=l.paint.get("model-scale").constantOr(null),oe=l.paint.get("model-translation").constantOr(null);J.computeModelMatrix(d,ae,ce,oe,!0,!0,!1);const fe=a.a6.mat4.identity([]),de=a.de(J.position.lat,d.transform.zoom),ye=a.a6.mat4.fromScaling([],[1,1,1/de]);a.a6.mat4.translate(fe,fe,U),$.push({zScaleMatrix:ye,negCameraPosMatrix:fe});for(const ge of J.nodes)jh(d.transform,ge,J.matrix,d.transform.expandedFarZProjMatrix,Y,Z,X);Y++}if(Z.sort((J,ae)=>ae.depth-J.depth),d.renderPass!=="shadow"){if(_===1)for(const J of X)$h(J,d,l,$[J.modelIndex],yr.disabled,d.colorModeForRenderPass());else{for(const J of X)$h(J,d,l,$[J.modelIndex],yr.disabled,kr.disabled);for(const J of X)$h(J,d,l,$[J.modelIndex],d.stencilModeFor3D(),d.colorModeForRenderPass());d.resetStencilClippingMasks()}for(const J of Z)$h(J,d,l,$[J.modelIndex],yr.disabled,d.colorModeForRenderPass());D()}else{for(const J of X)gu(J.mesh,J.nodeModelMatrix,d,l);for(const J of Z)gu(J.mesh,J.nodeModelMatrix,d,l);D()}}},Gf={model:function(d,n,l){const f=n.getSource();if(!f.loaded())return;if(f.type==="vector"||f.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,f.type==="vector"?d.scope:""));if(f.type==="batched-model"||f.type!=="model")return;const _=f.getModels();for(const v of _)v.upload(l.context)},raster:function(d,n,l){const f=n.getSource();if(!(f instanceof jc&&f.loaded()))return;const _=d.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!_)return;const v=d.paint.get("raster-array-band")||f.getInitialBand(_);if(v==null)return;const x=n.getIds().map(C=>n.getTileByID(C));for(const C of x)C.updateNeeded(_,v)&&f.prepareTile(C,_,v)},"raster-particle":function(d,n,l){const f=n.getSource();if(!(f instanceof jc&&f.loaded()))return;const _=d.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!_)return;const v=d.paint.get("raster-particle-array-band")||f.getInitialBand(_);if(v==null)return;const x=n.getIds().map(C=>n.getTileByID(C));for(const C of x)C.updateNeeded(_,v)&&f.prepareTile(C,_,v)}};class ng{constructor(n,l,f,_){this.context=new Y1(n,l),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=_,this._timeStamp=a.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const v=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const C of v)this._debugParams.enabledLayers[C]=!0;_.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),_.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),_.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),_.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),_.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const C of v)_.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],C);this.occlusionParams=new Uf(_),this.setup(),this.numSublayers=Bo.maxUnderzooming+Bo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Uy(this),this._wireframeDebugCache=new bl,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const x=new a.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,x,n.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(n,l){const f=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Vm(this,n));const _=this._terrain;this.transform.elevation=f?_:null,_.update(n,this.transform,l),this.transform.elevation&&!_.enabled&&(this.transform.elevation=null)}_updateFog(n){const l=n.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,_]=l.getFovAdjustedRange(this.transform._fov);if(f>_)return void(this.transform.fogCullDistSq=null);const v=f+.78*(_-f);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new Vm(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,l){if(this.width=n*a.q.devicePixelRatio,this.height=l*a.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._mergedLayers[f].resize()}setup(){const n=this.context,l=new a.a_;l.emplaceBack(0,0),l.emplaceBack(a.ab,0),l.emplaceBack(0,a.ab),l.emplaceBack(a.ab,a.ab),this.tileExtentBuffer=n.createVertexBuffer(l,a.b0.members),this.tileExtentSegments=a.b1.simpleSegment(0,0,4,2);const f=new a.a_;f.emplaceBack(0,0),f.emplaceBack(a.ab,0),f.emplaceBack(0,a.ab),f.emplaceBack(a.ab,a.ab),this.debugBuffer=n.createVertexBuffer(f,a.b0.members),this.debugSegments=a.b1.simpleSegment(0,0,4,5);const _=new a.a_;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,a.b0.members),this.viewportSegments=a.b1.simpleSegment(0,0,4,2);const v=new a.aN;v.emplaceBack(0,0,0,0),v.emplaceBack(a.ab,0,a.ab,0),v.emplaceBack(0,a.ab,0,a.ab),v.emplaceBack(a.ab,a.ab,a.ab,a.ab),this.mercatorBoundsBuffer=n.createVertexBuffer(v,a.b3.members),this.mercatorBoundsSegments=a.b1.simpleSegment(0,0,4,2);const x=new a.aO;x.emplaceBack(0,1,2),x.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(x);const C=new a.a$;for(const L of[0,1,3,2,0])C.emplaceBack(L);this.debugIndexBuffer=n.createIndexBuffer(C),this.emptyTexture=new a.T(n,new a.r({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=a.a6.mat4.create();const D=this.context.gl;this.stencilClearMode=new yr({func:D.ALWAYS,mask:0},0,255,D.ZERO,D.ZERO,D.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,Qt.disabled,this.stencilClearMode,kr.disabled,lr.disabled,Rh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,l,f){if(!l||this.currentStencilSource===l.id||!n.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let C=!1;for(const D of f)if(this._tileClippingMaskIDs[D.key]===void 0){C=!0;break}if(!C)return}this.currentStencilSource=l.id;const _=this.context,v=_.gl;this.nextStencilID+f.length>256&&this.clearStencil(),_.setColorMode(kr.disabled),_.setDepthMode(Qt.disabled);const x=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const C of f){const D=l.getTile(C),L=this._tileClippingMaskIDs[C.key]=this.nextStencilID++,{tileBoundsBuffer:B,tileBoundsIndexBuffer:$,tileBoundsSegments:j}=this.getTileBoundsBuffers(D);x.draw(this,v.TRIANGLES,Qt.disabled,new yr({func:v.ALWAYS,mask:0},L,255,v.KEEP,v.KEEP,v.REPLACE),kr.disabled,lr.disabled,Rh(C.projMatrix),"$clipping",B,$,j)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new yr({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const l=this.context.gl;return new yr({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(n){const l=this.context.gl,f=n.sort((x,C)=>C.overscaledZ-x.overscaledZ),_=f[f.length-1].overscaledZ,v=f[0].overscaledZ-_+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const x={};for(let C=0;C<v;C++)x[C+_]=new yr({func:l.GEQUAL,mask:255},C+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=v,[x,f]}return[{[_]:yr.disabled},f]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new kr([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new a.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?kr.unblended:kr.alphaBlended}colorModeForDrapableLayerRenderPass(n){const l=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new kr([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new a.bz(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,l,f,_=!1){if(this.depthOcclusion)return new Qt(this.context.gl.GREATER,Qt.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!_)return Qt.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Qt(f||this.context.gl.LEQUAL,l,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,l=Math.ceil(this.width),f=Math.ceil(this.height),_=this.context.bindFramebuffer.get(),v=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===f||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&f!==0&&(this.depthFBO=new Lf(this.context,l,f,!1,"texture"),this.depthTexture=new a.T(this.context,{width:l,height:f,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(_),n.bindTexture(n.TEXTURE_2D,v),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,l,f,0,0,l,f,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((n,l)=>n+l/this._fpsHistory.length,0))}render(n,l){const f=a.q.now();this._dt=f-this._timeStamp,this._timeStamp=f,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=l;const _=this.style._mergedLayers,v=this.style.order.filter(Oe=>{const Te=_[Oe];return!(Te.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Te.type]});let x=!1,C=!1;for(const Oe of v){const Te=_[Oe];Te.type==="circle"&&(x=!0),Te.type==="symbol"&&(Te.hasInitialOcclusionOpacityProperties?C=!0:x=!0)}const D=v.map(Oe=>_[Oe]),L=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.q.now()),this.imageManager.beginFrame();let B=0,$=!1;for(const Oe in L){const Te=L[Oe];Te.used&&(Te.prepare(this.context),Te.getSource().usedInConflation&&++B)}let j=!1;for(const Oe of D)Oe.isHidden(this.transform.zoom)||(Oe.type==="clip"&&(j=!0),this.prepareLayer(Oe));const U={},Z={},X={},Y={},J={};for(const Oe in L){const Te=L[Oe];U[Oe]=Te.getVisibleCoordinates(),Z[Oe]=U[Oe].slice().reverse(),X[Oe]=Te.getVisibleCoordinates(!0).reverse(),Y[Oe]=Te.getShadowCasterCoordinates(),J[Oe]=Te.sortCoordinatesByDistance(U[Oe])}const ae=Oe=>{const Te=this.style.getLayerSourceCache(Oe);return Te&&Te.used?Te.getSource():null};if(B||j||this._clippingActiveLastFrame){const Oe=[],Te=[];let $e=0;for(const Je of D)this.isSourceForClippingOrConflation(Je,ae(Je))&&(Oe.push(Je),Te.push($e)),$e++;if(Oe&&(j||Oe.length>1)||this._clippingActiveLastFrame){j=!1;const Je=[];for(let ct=0;ct<Oe.length;ct++){const Ke=Oe[ct],_t=Te[ct],je=this.style.getLayerSourceCache(Ke);if(!je||!je.used||!je.getSource().usedInConflation&&Ke.type!=="clip")continue;let nt=a.dn,rt=a.bs.None;const vt=[];let xt=!0;if(Ke.type==="clip"){nt=_t;for(const lt of Ke.layout.get("clip-layer-types"))rt|=lt==="model"?a.bs.Model:lt==="symbol"?a.bs.Symbol:a.bs.FillExtrusion;for(const lt of Ke.layout.get("clip-layer-scope"))vt.push(lt);Ke.isHidden(this.transform.zoom)?xt=!1:j=!0}xt&&Je.push({layer:Ke.fqid,cache:je,order:nt,clipMask:rt,clipScope:vt})}this.replacementSource.setSources(Je),$=!0}}this._clippingActiveLastFrame=j,$||this.replacementSource.clear(),this.conflationActive=$,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Oe=0;Oe<D.length;Oe++){const Te=D[Oe],$e=Te.cutoffRange();if(this.longestCutoffRange=Math.max($e,this.longestCutoffRange),$e>0){const Je=ae(Te);Je&&(this.minCutoffZoom=Math.max(Je.minzoom,this.minCutoffZoom)),Te.minzoom&&(this.minCutoffZoom=Math.max(Te.minzoom,this.minCutoffZoom))}Te.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Oe),this._lastOcclusionLayer=Oe)}const ce=this.style&&this.style.fog;ce?(this._fogVisible=ce.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=ce.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(X),this.opaquePassCutoff=0);const oe=this._shadowRenderer;if(oe){oe.updateShadowParameters(this.transform,this.style.directionalLight);for(const Oe in L)for(const Te of U[Oe]){let $e={min:0,max:0};this.terrain&&($e=this.terrain.getMinMaxForTile(Te)||$e),oe.addShadowReceiver(Te.toUnwrapped(),$e.min,$e.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new $f(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Kn.has(this.context.gl))return;this.renderPass="offscreen";for(const Oe of D){const Te=n.getLayerSourceCache(Oe);if(!Oe.hasOffscreenPass()||Oe.isHidden(this.transform.zoom))continue;const $e=Te?Z[Te.id]:void 0;(Oe.type==="custom"||Oe.type==="raster"||Oe.type==="raster-particle"||Oe.isSky()||$e&&$e.length)&&this.renderLayer(this,Te,Oe,$e)}this.depthRangeFor3D=[0,1-(D.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Y)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const fe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),de=(()=>{if(l.showOverdrawInspector)return a.bz.black;const Oe=this.style.fog;if(Oe&&this.transform.projection.supportsFog){const Te=this.style.getLut(Oe.scope);if(!fe){const $e=Oe.properties.get("color").toRenderColor(Te).toArray01();return new a.bz(...$e)}if(fe){const $e=Oe.properties.get("space-color").toRenderColor(Te).toArray01();return new a.bz(...$e)}}return a.bz.transparent})();if(this.context.clear({color:de,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&fe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const Oe=D[this.currentLayer],Te=n.getLayerSourceCache(Oe);if(Oe.isSky())continue;const $e=Te?(Oe.is3D()?J:Z)[Te.id]:void 0;this._renderTileClippingMasks(Oe,Te,$e),this.renderLayer(this,Te,Oe,$e)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&fe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const Oe=D[this.currentLayer],Te=n.getLayerSourceCache(Oe);Oe.isSky()&&this.renderLayer(this,Te,Oe,Te?Z[Te.id]:void 0)}function ye(Oe,Te){let $e;return Te&&($e=(Oe.type==="symbol"?X:Oe.is3D()?J:Z)[Te.id]),$e}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<v.length;){const Oe=D[this.currentLayer];if(Oe.type==="raster"||Oe.type==="raster-particle"){const Te=n.getLayerSourceCache(Oe);this.renderLayer(this,Te,Oe,ye(Oe,Te))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ge=0;oe&&(ge=oe.getShadowCastingLayerCount());let ve=!1,Ce=-1;for(let Oe=0;Oe<v.length;++Oe){const Te=D[Oe];Te.isHidden(this.transform.zoom)||Te.is3D()&&(Ce=Oe)}for(C&&Ce===-1&&(x=!0);this.currentLayer<v.length;){const Oe=D[this.currentLayer],Te=n.getLayerSourceCache(Oe);if(Oe.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Oe)){if(Oe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(x&&!ve&&this.terrain&&!this.transform.isOrthographic&&(ve=!0,this.blitDepth()),C&&Ce!==-1&&this.currentLayer===Ce+1&&!this.transform.isOrthographic&&this.blitDepth(),Oe.is3D()||this.terrain||this._renderTileClippingMasks(Oe,Te,Te?U[Te.id]:void 0),this.renderLayer(this,Te,Oe,ye(Oe,Te)),!this.terrain&&oe&&ge>0&&Oe.hasShadowPass()&&--ge==0&&(oe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const $e=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=$e;this.currentLayer++){const Je=D[this.currentLayer];if(!Je.hasLightBeamPass())continue;const ct=n.getLayerSourceCache(Je);this.renderLayer(this,ct,Je,ct?Z[ct.id]:void 0)}this.currentLayer=$e,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const $e=this.currentLayer;this.depthOcclusion=!0;for(const Je of this.layersWithOcclusionOpacity){this.currentLayer=Je;const ct=D[this.currentLayer],Ke=n.getLayerSourceCache(ct),_t=Ke?Z[Ke.id]:void 0;ct.is3D()||this.terrain||this._renderTileClippingMasks(ct,Ke,Ke?U[Ke.id]:void 0),this.renderLayer(this,Ke,ct,_t)}this.depthOcclusion=!1,this.currentLayer=$e,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Oe=null;D.forEach(Te=>{const $e=n.getLayerSourceCache(Te);$e&&!Te.isHidden(this.transform.zoom)&&$e.getVisibleCoordinates().length&&(!Oe||Oe.getSource().maxzoom<$e.getSource().maxzoom)&&(Oe=$e)}),Oe&&this.options.showTileBoundaries&&xl.debug(this,Oe,Oe.getVisibleCoordinates(),a.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&xl.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Oe){const Te=Oe.transform.padding;Ui(Oe,Oe.transform.height-(Te.top||0),3,ew),Ui(Oe,Te.bottom||0,3,fu),Ue(Oe,Te.left||0,3,pu),Ue(Oe,Oe.transform.width-(Te.right||0),3,wt);const $e=Oe.transform.centerPoint;(function(Je,ct,Ke,_t){Nh(Je,ct-1,Ke-10,2,20,_t),Nh(Je,ct-10,Ke-1,20,2,_t)})(Oe,$e.x,Oe.transform.height-$e.y,Xt)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),$||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:l}=this.transform.projection,f=!l||!l.includes(n.type);if(Gf[n.type]&&(f||this.terrain&&n.type==="custom")){const _=this.style.getLayerSourceCache(n);Gf[n.type](n,_,this)}this.gpuTimingEnd()}renderLayer(n,l,f,_){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||f.type==="model"||f.type==="raster"||f.type==="raster-particle"||_&&_.length)&&(this.id=f.id,this.gpuTimingStart(f),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(f.type)&&(!n.terrain||f.type!=="custom")||f.type==="clip"||xl[f.type](n,l,f,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,f=this.context.gl;let _=this.gpuTimers[n.id];_||(_=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:f.createQuery()}),_.calls++,f.beginQuery(l.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,l=this.context.gl,f=l.createQuery();this.deferredRenderGpuTimeQueries.push(f),l.beginQuery(n.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const l={};for(const f in n){const _=n[f],v=this.context.extTimerQuery,x=v.getQueryParameter(_.query,this.context.gl.QUERY_RESULT)/1e6;v.deleteQueryEXT(_.query),l[f]=x}return l}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.extTimerQuery,f=this.context.gl;let _=0;for(const v of n)_+=l.getQueryParameter(v,f.QUERY_RESULT)/1e6,l.deleteQueryEXT(v);return _}translatePosMatrix(n,l,f,_,v){if(!f[0]&&!f[1])return n;const x=v?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(x){const L=Math.sin(x),B=Math.cos(x);f=[f[0]*B-f[1]*L,f[0]*L+f[1]*B]}const C=[v?f[0]:a.ak(l,f[0],this.transform.zoom),v?f[1]:a.ak(l,f[1],this.transform.zoom),0],D=new Float32Array(16);return a.a6.mat4.translate(D,n,C),D}saveTileTexture(n){const l=n.size[0],f=this._tileTextures[l];f?f.push(n):this._tileTextures[l]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,l,f){const _=f===void 0?this.terrain&&this.terrain.renderingToTexture:f,v=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(v.push("LIGHTING_3D_MODE"),v.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):_||v.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||v.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?v.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):v.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(v.push("TERRAIN"),this.linearFloatFilteringSupported()&&v.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&v.push("GLOBE"),!this._fogVisible||_||l!==void 0&&!l||v.push("FOG","FOG_DITHERING"),_&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}getOrCreateProgram(n,l){this.cache=this.cache||{};const f=l&&l.defines||[],_=l&&l.config,v=this.currentGlobalDefines(n,l&&l.overrideFog,l&&l.overrideRtt).concat(f),x=yl.cacheKey(gl[n],n,v,_);return this.cache[x]||(this.cache[x]=new yl(this.context,n,gl[n],_,bv[n],v)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,l){if(this.style.enable3dLights()){const f=this.style.directionalLight,_=this.style.ambientLight;if(f&&_){const v=((x,C,D)=>{const L=x.properties.get("direction"),B=x.properties.get("color").toRenderColor(D.getLut(x.scope)).toArray01(),$=x.properties.get("intensity"),j=C.properties.get("color").toRenderColor(D.getLut(C.scope)).toArray01(),U=C.properties.get("intensity"),Z=[L.x,L.y,L.z],X=a.cH(j,U),Y=a.cH(B,$);return{u_lighting_ambient_color:X,u_lighting_directional_dir:Z,u_lighting_directional_color:Y,u_ground_radiance:Um(Z,Y,X)}})(f,_,this.style);l.setLightsUniformValues(n,v)}}}uploadCommonUniforms(n,l,f,_,v){if(this.uploadCommonLightUniforms(n,l),this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const C=x.getOpacity(this.transform.pitch),D=((L,B,$,j,U,Z,X,Y,J,ae,ce,oe)=>{const fe=L.transform,de=B.properties.get("color").toRenderColor(L.style.getLut(B.scope)).toArray01();de[3]=j;const ye=L.frameCounter/1e3%1,[ge,ve]=B.properties.get("vertical-range");return{u_fog_matrix:$?fe.calculateFogTileMatrix($):oe||L.identityMat,u_fog_range:B.getFovAdjustedRange(fe._fov),u_fog_color:de,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ge,ve),ve],u_fog_temporal_offset:ye,u_frustum_tl:U,u_frustum_tr:Z,u_frustum_br:X,u_frustum_bl:Y,u_globe_pos:J,u_globe_radius:ae,u_viewport:ce,u_globe_transition:a.a9(fe.zoom),u_is_globe:+(fe.projection.name==="globe")}})(this,x,f,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.q.devicePixelRatio,this.transform.height*a.q.devicePixelRatio],_);l.setFogUniformValues(n,D)}v&&l.setCutoffUniformValues(n,v.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,l=n.createTexture();return n.bindTexture(n.TEXTURE_2D,l),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,l=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const _ of f)l[_.key]=n[_.key]||new pa(_,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,l){return!(!n.is3D()||n.type!=="clip"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[n.key];return l||(this._cachedTileFogOpacities[n.key]=l=this.style.fog.getOpacityForTile(n)),l[0]>=kt||l[1]>=kt}setupDepthForOcclusion(n,l,f){const _=this.context,v=_.gl,x=!!f;var C;f||(f={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),_.activeTexture.set(v.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),f.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],f.u_depth_range_unpack=[2/((C=this.depthRangeFor3D)[1]-C[0]),-1-2*C[0]/(C[1]-C[0])],f.u_occluder_half_size=.5*this.occlusionParams.occluderSize,f.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),_.activeTexture.set(v.TEXTURE0),x||l.setTerrainUniformValues(_,f)}}function ja(d,n){let l=!1,f=null;const _=()=>{f=null,l&&(d(),f=setTimeout(_,n),l=!1)};return()=>(l=!0,f||_(),f)}class wl{constructor(n){this._hashName=n&&encodeURIComponent(n),a.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ja(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const l=Va(n);if(this._hashName){const f=this._hashName;let _=!1;const v=location.hash.slice(1).split("&").map(x=>{const C=x.split("=")[0];return C===f?(_=!0,`${C}=${l}`):x}).filter(x=>x);return _||v.push(`${f}=${l}`),`#${v.join("&")}`}return`#${l}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let l;return n.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(l=f)}),(l&&l[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(f=>isNaN(f))){const f=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(l[3]||0):n.getBearing();return n.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:f,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Va(d,n){const l=d.getCenter(),f=Math.round(100*d.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,_),x=Math.round(l.lng*v)/v,C=Math.round(l.lat*v)/v,D=d.getBearing(),L=d.getPitch();let B=n?`/${x}/${C}/${f}`:`${f}/${C}/${x}`;return(D||L)&&(B+="/"+Math.round(10*D)/10),L&&(B+=`/${Math.round(L)}`),B}const ac={linearity:.3,easing:a.dp(0,0,.3,1)},Hf=a.l({deceleration:2500,maxSpeed:1400},ac),og=a.l({deceleration:20,maxSpeed:1400},ac),sg=a.l({deceleration:1e3,maxSpeed:360},ac),ag=a.l({deceleration:1e3,maxSpeed:90},ac);class Tl{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.q.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=a.q.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)l.zoom+=v.zoomDelta||0,l.bearing+=v.bearingDelta||0,l.pitch+=v.pitchDelta||0,v.panDelta&&l.pan._add(v.panDelta),v.around&&(l.around=v.around),v.pinchAround&&(l.pinchAround=v.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(l.pan.mag()){const v=lc(l.pan.mag(),f,a.l({},Hf,n||{}));_.offset=l.pan.mult(v.amount/l.pan.mag()),_.center=this._map.transform.center,_u(_,v)}if(l.zoom){const v=lc(l.zoom,f,og);_.zoom=this._map.transform.zoom+v.amount,_u(_,v)}if(l.bearing){const v=lc(l.bearing,f,sg);_.bearing=this._map.transform.bearing+a.ap(v.amount,-179,179),_u(_,v)}if(l.pitch){const v=lc(l.pitch,f,ag);_.pitch=this._map.transform.pitch+v.amount,_u(_,v)}if(_.zoom||_.bearing){const v=l.pinchAround===void 0?l.around:l.pinchAround;_.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function _u(d,n){(!d.duration||d.duration<n.duration)&&(d.duration=n.duration,d.easing=n.easing)}function lc(d,n,l){const{maxSpeed:f,linearity:_,deceleration:v}=l,x=a.ap(d*_/(n/1e3),-f,f),C=Math.abs(x)/(v*_);return{easing:l.easing,duration:1e3*C,amount:x*(C/2)}}class So extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,f,_={}){const v=gt(l.getCanvasContainer(),f),x=l.unproject(v);super(n,a.l({point:v,lngLat:x,originalEvent:f},_)),this._defaultPrevented=!1,this.target=l}}class yu extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,f){const _=n==="touchend"?f.changedTouches:f.touches,v=Tt(l.getCanvasContainer(),_),x=v.map(D=>l.unproject(D)),C=v.reduce((D,L,B,$)=>D.add(L.div($.length)),new a.P(0,0));super(n,{points:v,point:C,lngLats:x,lngLat:l.unproject(C),originalEvent:f}),this._defaultPrevented=!1}}class Jn extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class lg{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new Jn(this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new So(n.type,this._map,n))}mouseup(n){this._map.fire(new So(n.type,this._map,n))}preclick(n){const l=a.l({},n);l.type="preclick",this._map.fire(new So(l.type,this._map,l))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(n),this._map.fire(new So(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new So(n.type,this._map,n))}mouseover(n){this._map.fire(new So(n.type,this._map,n))}mouseout(n){this._map.fire(new So(n.type,this._map,n))}touchstart(n){return this._firePreventable(new yu(n.type,this._map,n))}touchmove(n){this._map.fire(new yu(n.type,this._map,n))}touchend(n){this._map.fire(new yu(n.type,this._map,n))}touchcancel(n){this._map.fire(new yu(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cg{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new So(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new So("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new So(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vu{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(He(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const f=l,_=this._startPos,v=this._lastPos;if(!_||!v||v.equals(f)||!this._box&&f.dist(_)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=Ie("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const x=Math.min(_.x,f.x),C=Math.max(_.x,f.x),D=Math.min(_.y,f.y),L=Math.max(_.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${x}px,${D}px)`,this._box.style.width=C-x+"px",this._box.style.height=L-D+"px")})}mouseupWindow(n,l){if(!this._active)return;const f=this._startPos,_=l;if(f&&n.button===0){if(this.reset(),st(),f.x!==_.x||f.y!==_.y)return this._map.fire(new a.x("boxzoomend",{originalEvent:n})),{cameraAnimation:v=>v.fitScreenCoordinates(f,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ht(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new a.x(n,{originalEvent:l}))}}function Ua(d,n){const l={};for(let f=0;f<d.length;f++)l[d[f].identifier]=n[f];return l}class ug{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,l,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const v=new a.P(0,0);for(const x of _)v._add(x);return v.div(_.length)}(l),this.touches=Ua(f,l)))}touchmove(n,l,f){if(this.aborted||!this.centroid)return;const _=Ua(f,l);for(const v in this.touches){const x=_[v];(!x||x.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(n,l,f){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Uh{constructor(n){this.singleTap=new ug(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,l,f){this.singleTap.touchstart(n,l,f)}touchmove(n,l,f){this.singleTap.touchmove(n,l,f)}touchend(n,l,f){const _=this.singleTap.touchend(n,l,f);if(_){const v=n.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(_)<30;if(v&&x||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class hg{constructor(){this._zoomIn=new Uh({numTouches:1,numTaps:2}),this._zoomOut=new Uh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,f){this._zoomIn.touchstart(n,l,f),this._zoomOut.touchstart(n,l,f)}touchmove(n,l,f){this._zoomIn.touchmove(n,l,f),this._zoomOut.touchmove(n,l,f)}touchend(n,l,f){const _=this._zoomIn.touchend(n,l,f),v=this._zoomOut.touchend(n,l,f);return _?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(_)},{originalEvent:n})}):v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(v)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Gh={0:1,2:2};class Hh{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,l){return!1}_move(n,l){return{}}mousedown(n,l){if(this._lastPoint)return;const f=at(n);this._correctButton(n,f)&&(this._lastPoint=l,this._eventButton=f)}mousemoveWindow(n,l){const f=this._lastPoint;if(f){if(n.preventDefault(),this._eventButton!=null&&function(_,v){const x=Gh[v];return _.buttons===void 0||(_.buttons&x)!==x}(n,this._eventButton))this.reset();else if(this._moved||!(l.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(f,l)}}mouseupWindow(n){this._lastPoint&&at(n)===this._eventButton&&(this._moved&&st(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qf extends Hh{mousedown(n,l){super.mousedown(n,l),this._lastPoint&&(this._active=!0)}_correctButton(n,l){return l===0&&!n.ctrlKey}_move(n,l){return{around:l,panDelta:l.sub(n)}}}class Wf extends Hh{_correctButton(n,l){return l===0&&n.ctrlKey||l===2}_move(n,l){const f=.8*(l.x-n.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(n){n.preventDefault()}}class Zf extends Hh{_correctButton(n,l){return l===0&&n.ctrlKey||l===2}_move(n,l){const f=-.5*(l.y-n.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(n){n.preventDefault()}}class Av{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),a.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(n,l,f){return this._calculateTransform(n,l,f)}touchmove(n,l,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1&&!a.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,l,f)}}touchend(n,l,f){this._calculateTransform(n,l,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,f){f.length>0&&(this._active=!0);const _=Ua(f,l),v=new a.P(0,0),x=new a.P(0,0);let C=0;for(const L in _){const B=_[L],$=this._touches[L];$&&(v._add(B),x._add(B.sub($)),C++,_[L]=B)}if(this._touches=_,C<this._minTouches||!x.mag())return;const D=x.div(C);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(C),panDelta:D}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ie("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Xf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,l,f){return{}}touchstart(n,l,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,f){const _=this._firstTwoTouches;if(!_)return;n.preventDefault();const[v,x]=_,C=qh(f,l,v),D=qh(f,l,x);if(!C||!D)return;const L=this._aroundCenter?null:C.add(D).div(2);return this._move([C,D],L,n)}touchend(n,l,f){if(!this._firstTwoTouches)return;const[_,v]=this._firstTwoTouches,x=qh(f,l,_),C=qh(f,l,v);x&&C||(this._active&&st(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function qh(d,n,l){for(let f=0;f<d.length;f++)if(d[f].identifier===l)return n[f]}function dg(d,n){return Math.log(d/n)/Math.LN2}class Cv extends Xf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const f=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(dg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:dg(this._distance,f),pinchAround:l}}}function fg(d,n){return 180*d.angleWith(n)/Math.PI}class Mv extends Xf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l){const f=this._vector;if(this._vector=n[0].sub(n[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:fg(this._vector,f),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;const _=fg(n,f);return Math.abs(_)<l}}function Kf(d){return Math.abs(d.y)>Math.abs(d.x)}class Iv extends Xf{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Kf(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,f){const _=this._lastPoints;if(!_)return;const v=n[0].sub(_[0]),x=n[1].sub(_[1]);return this._map._cooperativeGestures&&!a.dq()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(v,x,f.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(v.y+x.y)/2*-.5})}gestureBeginsVertically(n,l,f){if(this._valid!==void 0)return this._valid;const _=n.mag()>=2,v=l.mag()>=2;if(!_&&!v)return;if(!_||!v)return this._firstMove==null&&(this._firstMove=f),f-this._firstMove<100&&void 0;const x=n.y>0==l.y>0;return Kf(n)&&Kf(l)&&x}}const Dv={panStep:100,bearingStep:15,pitchStep:10};class Rv{constructor(){const n=Dv;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,f=0,_=0,v=0,x=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?f=-1:(n.preventDefault(),v=-1);break;case 39:n.shiftKey?f=1:(n.preventDefault(),v=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),x=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:C=>{const D=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:Lv,zoom:l?Math.round(D)+l*(n.shiftKey?2:1):D,bearing:C.getBearing()+f*this._bearingStep,pitch:C.getPitch()+_*this._pitchStep,offset:[-v*this._panStep,-x*this._panStep],center:C.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Lv(d){return d*(2-d)}const pg=4.000244140625,ow=1/450;class sw{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ow,a.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||a.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const f=a.q.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,l!==0&&l%pg==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(_*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=gt(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>pg?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&B!==0&&(B=1/B);const $=l(),j=Math.pow(2,$),U=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):j;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(U*B))),this._type==="wheel"&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:l(),_=this._startZoom,v=this._easing;let x,C=!1;if(this._type==="wheel"&&_&&v){const L=Math.min((a.q.now()-this._lastWheelEventTime)/200,1),B=v(L);x=a.aa(_,f,B),L<1?this._frameId||(this._frameId=!0):C=!0}else x=f,C=!0;this._active=!0,C&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let D=x-l();return D*this._lastDelta<0&&(D=0),{noInertia:!0,needsRenderFrame:!C,zoomDelta:D,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=a.dr;if(this._prevEase){const f=this._prevEase,_=(a.q.now()-f.start)/f.duration,v=f.easing(_+.01)-f.easing(_),x=.27/Math.sqrt(v*v+1e-4)*.01,C=Math.sqrt(.0729-x*x);l=a.dp(x,C,.25,1)}return this._prevEase={start:a.q.now(),duration:n,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ie("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class on{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bv{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,l){return n.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(n.shiftKey?-1:1),around:f.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class aw{constructor(){this._tap=new Uh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,l,f){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=l[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(n,l,f))}touchmove(n,l,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=l[0],v=_.y-this._swipePoint.y;return this._swipePoint=_,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,l,f)}touchend(n,l,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(n,l,f)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lw{constructor(n,l,f){this._el=n,this._mousePan=l,this._touchPan=f}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Wh{constructor(n,l,f){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=l,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class kv{constructor(n,l,f,_){this._el=n,this._touchZoom=l,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const bu=d=>d.zoom||d.drag||d.pitch||d.rotate;class Yf extends a.x{}class Ga{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,l){const f=a.a6.vec3.sub([],l,n);this.radius=a.a6.vec3.length(f[2]<0?a.a6.vec3.div([],f,this.constants):[f[0],f[1],0])}projectRay(n){a.a6.vec3.div(n,n,this.constants),a.a6.vec3.normalize(n,n),a.a6.vec3.mul(n,n,this.constants);const l=a.a6.vec3.scale([],n,this.radius);if(l[2]>0){const f=a.a6.vec3.scale([],[0,0,1],a.a6.vec3.dot(l,[0,0,1])),_=a.a6.vec3.scale([],a.a6.vec3.normalize([],[l[0],l[1],0]),this.radius),v=a.a6.vec3.add([],l,a.a6.vec3.scale([],a.a6.vec3.sub([],a.a6.vec3.add([],_,f),l),2));l[0]=v[0],l[1]=v[1]}return l}}function cc(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class fo{constructor(n,l){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tl(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ga,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),a.aJ(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,v,x]of this._listeners){const C=_===document?this.handleWindowEvent:this.handleEvent;_.addEventListener(v,C,x)}}destroy(){for(const[n,l,f]of this._listeners){const _=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(l,_,f)}}_addDefaultHandlers(n){const l=this._map,f=l.getCanvasContainer();this._add("mapEvent",new lg(l,n));const _=l.boxZoom=new vu(l,n);this._add("boxZoom",_);const v=new hg,x=new Bv;l.doubleClickZoom=new on(x,v),this._add("tapZoom",v),this._add("clickZoom",x);const C=new aw;this._add("tapDragZoom",C);const D=l.touchPitch=new Iv(l);this._add("touchPitch",D);const L=new Wf(n),B=new Zf(n);l.dragRotate=new Wh(n,L,B),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const $=new qf(n),j=new Av(l,n);l.dragPan=new lw(f,$,j),this._add("mousePan",$),this._add("touchPan",j,["touchZoom","touchRotate"]);const U=new Mv,Z=new Cv;l.touchZoomRotate=new kv(f,Z,U,C),this._add("touchRotate",U,["touchPan","touchZoom"]),this._add("touchZoom",Z,["touchPan","touchRotate"]),this._add("blockableMapEvent",new cg(l));const X=l.scrollZoom=new sw(l,this);this._add("scrollZoom",X,["mousePan"]);const Y=l.keyboard=new Rv;this._add("keyboard",Y);for(const J of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[J]&&l[J].enable(n[J])}_add(n,l,f){this._handlers.push({handlerName:n,handler:l,allowed:f}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!bu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,l,f){for(const _ in n)if(_!==f&&(!l||l.indexOf(_)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const l=[];for(const f of n)this._el.contains(f.target)&&l.push(f);return l}handleEvent(n,l){this._updatingCamera=!0;const f=n.type==="renderFrame",_=f?void 0:n,v={needsRenderFrame:!1},x={},C={},D=n.touches?this._getMapTouches(n.touches):void 0,L=D?Tt(this._el,D):f?void 0:gt(this._el,n);for(const{handlerName:j,handler:U,allowed:Z}of this._handlers){if(!U.isEnabled())continue;let X;this._blockedByActive(C,Z,j)?U.reset():U[l||n.type]&&(X=U[l||n.type](n,L,D),this.mergeHandlerResult(v,x,X,j,_),X&&X.needsRenderFrame&&this._triggerRenderFrame()),(X||U.isActive())&&(C[j]=U)}const B={};for(const j in this._previousActiveHandlers)C[j]||(B[j]=_);this._previousActiveHandlers=C,(Object.keys(B).length||cc(v))&&(this._changes.push([v,x,B]),this._triggerRenderFrame()),(Object.keys(C).length||cc(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=v;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))}mergeHandlerResult(n,l,f,_,v){if(!f)return;a.l(n,f);const x={handlerName:_,originalEvent:f.originalEvent||v};f.zoomDelta!==void 0&&(l.zoom=x),f.panDelta!==void 0&&(l.drag=x),f.pitchDelta!==void 0&&(l.pitch=x),f.bearingDelta!==void 0&&(l.rotate=x)}_applyChanges(){const n={},l={},f={};for(const[_,v,x]of this._changes)_.panDelta&&(n.panDelta=(n.panDelta||new a.P(0,0))._add(_.panDelta)),_.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(n.around=_.around),_.aroundCoord!==void 0&&(n.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(n.pinchAround=_.pinchAround),_.noInertia&&(n.noInertia=_.noInertia),a.l(l,v),a.l(f,x);this._updateMapTransform(n,l,f),this._changes=[]}_updateMapTransform(n,l,f){const _=this._map,v=_.transform,x=ae=>[ae.x,ae.y,ae.z];if((ae=>{const ce=this._eventsInProgress.drag;return ce&&!this._handlersById[ce.handlerName].isActive()})()&&!cc(n)){const ae=v.zoom;v.cameraElevationReference="sea",this._originalZoom!=null&&v._orthographicProjectionAtLowPitch&&v.projection.name!=="globe"&&v.pitch===0?(v.cameraElevationReference="ground",v.zoom=this._originalZoom):(v.recenterOnTerrain(),v.cameraElevationReference="ground"),ae!==v.zoom&&this._map._update(!0)}if(v._isCameraConstrained&&_._stop(!0),!cc(n))return void this._fireEvents(l,f,!0);let{panDelta:C,zoomDelta:D,bearingDelta:L,pitchDelta:B,around:$,aroundCoord:j,pinchAround:U}=n;v._isCameraConstrained&&(D>0&&(D=0),v._isCameraConstrained=!1),U!==void 0&&($=U),(D||(ae=>l[ae]&&!this._eventsInProgress[ae])("drag"))&&$&&(this._dragOrigin=x(v.pointCoordinate3D($)),this._originalZoom=v.zoom,this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",_._stop(!0),$=$||_.transform.centerPoint,L&&(v.bearing+=L),B&&(v.pitch+=B),v._updateCameraState();const Z=[0,0,0];if(C)if(v.projection.name==="mercator"){const ae=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay($).dir),ce=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay($.sub(C)).dir);Z[0]=ce[0]-ae[0],Z[1]=ce[1]-ae[1]}else{const ae=v.pointCoordinate($);if(v.projection.name==="globe"){C=C.rotate(-v.angle);const ce=v._pixelsPerMercatorPixel/v.worldSize;Z[0]=-C.x*a.ds(a.aM(ae.y))*ce,Z[1]=-C.y*a.ds(v.center.lat)*ce}else{const ce=v.pointCoordinate($.sub(C));ae&&ce&&(Z[0]=ce.x-ae.x,Z[1]=ce.y-ae.y)}}const X=v.zoom,Y=[0,0,0];if(D){const ae=x(j||v.pointCoordinate3D($)),ce={dir:a.a6.vec3.normalize([],a.a6.vec3.sub([],ae,v._camera.position))};if(ce.dir[2]<0){const oe=v.zoomDeltaToMovement(ae,D);a.a6.vec3.scale(Y,ce.dir,oe)}}const J=a.a6.vec3.add(Z,Z,Y);v._translateCameraConstrained(J),D&&Math.abs(v.zoom-X)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,f,!0)}_fireEvents(n,l,f){const _=bu(this._eventsInProgress),v=bu(n),x={};for(const B in n){const{originalEvent:$}=n[B];this._eventsInProgress[B]||(x[`${B}start`]=$),this._eventsInProgress[B]=n[B]}!_&&v&&this._fireEvent("movestart",v.originalEvent);for(const B in x)this._fireEvent(B,x[B]);v&&this._fireEvent("move",v.originalEvent);for(const B in n){const{originalEvent:$}=n[B];this._fireEvent(B,$)}const C={};let D;for(const B in this._eventsInProgress){const{handlerName:$,originalEvent:j}=this._eventsInProgress[B];this._handlersById[$].isActive()||(delete this._eventsInProgress[B],D=l[$]||j,C[`${B}end`]=D)}for(const B in C)this._fireEvent(B,C[B]);const L=bu(this._eventsInProgress);if(f&&(_||v)&&!L){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;B?($(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:D})):(this._map.fire(new a.x("moveend",{originalEvent:D})),$(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new a.x(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Yf("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ya="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class mg extends a.E{constructor(n,l){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,a.aJ(["_renderFrameCallback"],this)}getCenter(){return new a.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}panBy(n,l,f){return n=a.P.convert(n).mult(-1),this.panTo(this.transform.center,a.l({offset:n},l),f)}panTo(n,l,f){return this.easeTo(a.l({center:n},l),f)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,f){return this.easeTo(a.l({zoom:n},l),f)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,f){return this.easeTo(a.l({bearing:n},l),f)}resetNorth(n,l){return this.rotateTo(0,a.l({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(a.l({bearing:0,pitch:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}cameraForBounds(n,l){n=a.as.convert(n);const f=l&&l.bearing||0,_=l&&l.pitch||0,v=n.getNorthWest(),x=n.getSouthEast();return this._cameraForBounds(this.transform,v,x,f,_,l)}_extendPadding(n){const l={top:0,right:0,bottom:0,left:0};return n==null?a.l({},l,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:a.l({},l,n)}_extendCameraOptions(n){return(n=a.l({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,l){const f=l.max[0]-l.min[0],_=l.max[1]-l.min[1];return f/_>n.aspect?f/(2*Math.tan(.5*n.fovX)*n.aspect):_/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,l,f,_,v,x){const C=n.clone(),D=this._extendCameraOptions(x);C.bearing=_,C.pitch=v;const L=a.bK.convert(l),B=a.bK.convert(f),$=.5*(L.lat+B.lat),j=.5*(L.lng+B.lng),U=a.dt($,j),Z=a.a6.vec3.normalize([],U),X=a.a6.vec3.normalize([],a.a6.vec3.cross([],Z,[0,1,0])),Y=a.a6.vec3.cross([],X,Z),J=[X[0],X[1],X[2],0,Y[0],Y[1],Y[2],0,Z[0],Z[1],Z[2],0,0,0,0,1],ae=[U,a.dt(L.lat,L.lng),a.dt(B.lat,L.lng),a.dt(B.lat,B.lng),a.dt(L.lat,B.lng),a.dt($,L.lng),a.dt($,B.lng),a.dt(L.lat,j),a.dt(B.lat,j)];let ce=a.c9.fromPoints(ae.map(rt=>[a.a6.vec3.dot(X,rt),a.a6.vec3.dot(Y,rt),a.a6.vec3.dot(Z,rt)]));const oe=a.a6.vec3.transformMat4([],ce.center,J);a.a6.vec3.squaredLength(oe)===0&&a.a6.vec3.set(oe,0,0,1),a.a6.vec3.normalize(oe,oe),a.a6.vec3.scale(oe,oe,a.aq),C.center=a.du(oe);const fe=C.getWorldToCameraMatrix(),de=a.a6.mat4.invert(new Float64Array(16),fe);ce=a.c9.applyTransform(ce,a.a6.mat4.multiply([],fe,J));const ye=this._extendAABB(ce,C,D,_);if(!ye)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ce=ye,a.a6.vec3.transformMat4(oe,oe,fe);const ge=.5*(ce.max[2]-ce.min[2]),ve=this._minimumAABBFrustumDistance(C,ce),Ce=a.a6.vec3.scale([],[0,0,1],ge),Oe=a.a6.vec3.add(Ce,oe,Ce),Te=ve+(C.pitch===0?0:a.a6.vec3.distance(oe,Oe)),$e=C.globeCenterInViewSpace,Je=a.a6.vec3.sub([],oe,[$e[0],$e[1],$e[2]]);a.a6.vec3.normalize(Je,Je),a.a6.vec3.scale(Je,Je,Te);const ct=a.a6.vec3.add([],oe,Je);a.a6.vec3.transformMat4(ct,ct,de);const Ke=a.dw/a.aq,_t=a.a6.vec3.length(ct),je=a.bD(Math.max(_t*Ke-a.dw,Number.EPSILON),0),nt=Math.min(C.zoomFromMercatorZAdjusted(je),D.maxZoom);return nt>.5*(a.c2+a.bU)?(C.setProjection({name:"mercator"}),C.zoom=nt,this._cameraForBounds(C,l,f,_,v,x)):{center:C.center,zoom:nt,bearing:_,pitch:v}}_extendAABB(n,l,f,_){const v=.5*((f.padding.left||0)+(f.padding.right||0)),x=.5*((f.padding.top||0)+(f.padding.bottom||0)),C=x,D=v,L=v,B=x,$=l.width-(D+L),j=l.height-(C+B),U=a.a6.vec3.sub([],n.max,n.min),Z=Math.min($/U[0],j/U[1]),X=Math.min(l.scaleZoom(l.scale*Z),f.maxZoom);if(isNaN(X))return null;const Y=l.scale/l.zoomScale(X),J=new a.c9([n.min[0]-D*Y,n.min[1]-B*Y,n.min[2]],[n.max[0]+L*Y,n.max[1]+C*Y,n.max[2]]),ae=(typeof f.offset.x=="number"&&typeof f.offset.y=="number"?new a.P(f.offset.x,f.offset.y):a.P.convert(f.offset)).rotate(-a.bB(_));return J.center[0]-=ae.x*Y,J.center[1]+=ae.y*Y,J}queryTerrainElevation(n,l){const f=this.transform.elevation;return f?(l=a.l({},{exaggerated:!0},l),f.getAtPoint(a.a5.fromLngLat(n),null,l.exaggerated)):null}_cameraForBounds(n,l,f,_,v,x){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,l,f,_,v,x);const C=n.clone(),D=this._extendCameraOptions(x);C.bearing=_,C.pitch=v;const L=a.bK.convert(l),B=a.bK.convert(f),$=new a.bK(L.lng,B.lat),j=new a.bK(B.lng,L.lat),U=C.project(L),Z=C.project(B),X=this.queryTerrainElevation(L),Y=this.queryTerrainElevation(B),J=this.queryTerrainElevation($),ae=this.queryTerrainElevation(j),ce=[[U.x,U.y,Math.min(X||0,Y||0,J||0,ae||0)],[Z.x,Z.y,Math.max(X||0,Y||0,J||0,ae||0)]];let oe=a.c9.fromPoints(ce);const fe=C.getWorldToCameraMatrix(),de=a.a6.mat4.invert(new Float64Array(16),fe);oe=a.c9.applyTransform(oe,fe);const ye=this._extendAABB(oe,C,D,_);if(!ye)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");oe=ye;const ge=.5*a.a6.vec3.sub([],oe.max,oe.min)[2],ve=this._minimumAABBFrustumDistance(C,oe),Ce=[0,0,1,0];a.a6.vec4.transformMat4(Ce,Ce,fe),a.a6.vec4.normalize(Ce,Ce);const Oe=a.a6.vec3.scale([],Ce,ve+ge),Te=a.a6.vec3.add([],oe.center,Oe);a.a6.vec3.transformMat4(oe.center,oe.center,de),a.a6.vec3.transformMat4(Te,Te,de);const $e=C.unproject(new a.P(oe.center[0],oe.center[1])),Je=a.dv(C.projection,$e),ct=Math.pow(2,Je),Ke=Math.min(C._zoomFromMercatorZ(Te[2]*C.pixelsPerMeter*ct/C.worldSize),D.maxZoom);return C.mercatorFromTransition&&Ke<.5*(a.c2+a.bU)?(C.setProjection({name:"globe"}),C.zoom=Ke,this._cameraForBounds(C,l,f,_,v,x)):{center:$e,zoom:Ke,bearing:_,pitch:v}}fitBounds(n,l,f){const _=this.cameraForBounds(n,l);return this._fitInternal(_,l,f)}fitScreenCoordinates(n,l,f,_,v){const x=a.P.convert(n),C=a.P.convert(l),D=new a.P(Math.min(x.x,C.x),Math.min(x.y,C.y)),L=new a.P(Math.max(x.x,C.x),Math.max(x.y,C.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(x,C))return this;const B=this.transform.pointLocation3D(D),$=this.transform.pointLocation3D(L),j=this.transform.pointLocation3D(new a.P(D.x,L.y)),U=this.transform.pointLocation3D(new a.P(L.x,D.y)),Z=[Math.min(B.lng,$.lng,j.lng,U.lng),Math.min(B.lat,$.lat,j.lat,U.lat)],X=[Math.max(B.lng,$.lng,j.lng,U.lng),Math.max(B.lat,$.lat,j.lat,U.lat)],Y=_&&_.pitch?_.pitch:this.getPitch(),J=this._cameraForBounds(this.transform,Z,X,f,Y,_);return this._fitInternal(J,_,v)}_fitInternal(n,l,f){return n?(l=a.l(n,l)).linear?this.easeTo(l,f):this.flyTo(l,f):this}jumpTo(n,l){this.stop();const f=n.preloadOnly?this.transform.clone():this.transform;let _=!1,v=!1,x=!1;"zoom"in n&&f.zoom!==+n.zoom&&(_=!0,f.zoom=+n.zoom),n.center!==void 0&&(f.center=a.bK.convert(n.center)),"bearing"in n&&f.bearing!==+n.bearing&&(v=!0,f.bearing=+n.bearing),"pitch"in n&&f.pitch!==+n.pitch&&(x=!0,f.pitch=+n.pitch);const C=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!f.isPaddingEqual(C))if(n.retainPadding===!1){const D=f.clone();D.padding=C,f.setLocationAtPoint(f.center,D.centerPoint)}else f.padding=C;return n.preloadOnly?(this._preloadTiles(f),this):(this.fire(new a.x("movestart",l)).fire(new a.x("move",l)),_&&this.fire(new a.x("zoomstart",l)).fire(new a.x("zoom",l)).fire(new a.x("zoomend",l)),v&&this.fire(new a.x("rotatestart",l)).fire(new a.x("rotate",l)).fire(new a.x("rotateend",l)),x&&this.fire(new a.x("pitchstart",l)).fire(new a.x("pitch",l)).fire(new a.x("pitchend",l)),this.fire(new a.x("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(ya),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,l){const f=this.transform;if(!f.projection.supportsFreeCamera)return a.w(ya),this;this.stop();const _=f.zoom,v=f.pitch,x=f.bearing;f.setFreeCameraOptions(n);const C=_!==f.zoom,D=v!==f.pitch,L=x!==f.bearing;return this.fire(new a.x("movestart",l)).fire(new a.x("move",l)),C&&this.fire(new a.x("zoomstart",l)).fire(new a.x("zoom",l)).fire(new a.x("zoomend",l)),L&&this.fire(new a.x("rotatestart",l)).fire(new a.x("rotate",l)).fire(new a.x("rotateend",l)),D&&this.fire(new a.x("pitchstart",l)).fire(new a.x("pitch",l)).fire(new a.x("pitchend",l)),this.fire(new a.x("moveend",l)),this}easeTo(n,l){this._stop(!1,n.easeId),((n=a.l({offset:[0,0],duration:500,easing:a.dr},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const f=this.transform,_=this.getZoom(),v=this.getBearing(),x=this.getPitch(),C=this.getPadding(),D="zoom"in n?+n.zoom:_,L="bearing"in n?this._normalizeBearing(n.bearing,v):v,B="pitch"in n?+n.pitch:x,$=this._extendPadding(n.padding),j=a.P.convert(n.offset);let U,Z,X;if(f.projection.name==="globe"){const Ce=a.a5.fromLngLat(f.center),Oe=j.rotate(-f.angle);Ce.x+=Oe.x/f.worldSize,Ce.y+=Oe.y/f.worldSize;const Te=Ce.toLngLat(),$e=a.bK.convert(n.center||Te);this._normalizeCenter($e),U=f.centerPoint.add(Oe),Z=new a.P(Ce.x,Ce.y).mult(f.worldSize),X=new a.P(a.am($e.lng),a.at($e.lat)).mult(f.worldSize).sub(Z)}else{U=f.centerPoint.add(j);const Ce=f.pointLocation(U),Oe=a.bK.convert(n.center||Ce);this._normalizeCenter(Oe),Z=f.project(Ce),X=f.project(Oe).sub(Z)}const Y=f.zoomScale(D-_);let J,ae;n.around&&(J=a.bK.convert(n.around),ae=f.locationPoint(J));const ce=this._zooming||D!==_,oe=this._rotating||v!==L,fe=this._pitching||B!==x,de=!f.isPaddingEqual($),ye=n.retainPadding===!1?f.clone():f,ge=Ce=>Oe=>{if(ce&&(Ce.zoom=a.aa(_,D,Oe)),oe&&(Ce.bearing=a.aa(v,L,Oe)),fe&&(Ce.pitch=a.aa(x,B,Oe)),de&&(ye.interpolatePadding(C,$,Oe),U=ye.centerPoint.add(j)),J)Ce.setLocationAtPoint(J,ae);else{const Te=Ce.zoomScale(Ce.zoom-_),$e=D>_?Math.min(2,Y):Math.max(.5,Y),Je=Math.pow($e,1-Oe),ct=Ce.unproject(Z.add(X.mult(Oe*Je)).mult(Te));Ce.setLocationAtPoint(Ce.renderWorldCopies?ct.wrap():ct,U)}return n.preloadOnly||this._fireMoveEvents(l),Ce};if(n.preloadOnly){const Ce=this._emulate(ge,n.duration,f);return this._preloadTiles(Ce),this}const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ce,this._rotating=oe,this._pitching=fe,this._padding=de,this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,ve),this._ease(ge(f),Ce=>{f.cameraElevationReference==="sea"&&f.recenterOnTerrain(),this._afterEase(l,Ce)},n),this}_prepareEase(n,l,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||f.moving||this.fire(new a.x("movestart",n)),this._zooming&&!f.zooming&&this.fire(new a.x("zoomstart",n)),this._rotating&&!f.rotating&&this.fire(new a.x("rotatestart",n)),this._pitching&&!f.pitching&&this.fire(new a.x("pitchstart",n))}_fireMoveEvents(n){this.fire(new a.x("move",n)),this._zooming&&this.fire(new a.x("zoom",n)),this._rotating&&this.fire(new a.x("rotate",n)),this._pitching&&this.fire(new a.x("pitch",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const f=this._zooming,_=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new a.x("zoomend",n)),_&&this.fire(new a.x("rotateend",n)),v&&this.fire(new a.x("pitchend",n)),this.fire(new a.x("moveend",n))}flyTo(n,l){if(this._prefersReducedMotion(n)){const rt=a.ar(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(rt,l)}this.stop(),n=a.l({offset:[0,0],speed:1.2,curve:1.42,easing:a.dr},n);const f=this.transform,_=this.getZoom(),v=this.getBearing(),x=this.getPitch(),C=this.getPadding(),D="zoom"in n?a.ap(+n.zoom,f.minZoom,f.maxZoom):_,L="bearing"in n?this._normalizeBearing(n.bearing,v):v,B="pitch"in n?+n.pitch:x,$=this._extendPadding(n.padding),j=f.zoomScale(D-_),U=a.P.convert(n.offset);let Z=f.centerPoint.add(U);const X=f.pointLocation(Z),Y=a.bK.convert(n.center||X);this._normalizeCenter(Y);const J=f.project(X),ae=f.project(Y).sub(J);let ce=n.curve;const oe=Math.max(f.width,f.height),fe=oe/j,de=ae.mag();if("minZoom"in n){const rt=a.ap(Math.min(n.minZoom,_,D),f.minZoom,f.maxZoom),vt=oe/f.zoomScale(rt-_);ce=Math.sqrt(vt/de*2)}const ye=ce*ce;function ge(rt){const vt=(fe*fe-oe*oe+(rt?-1:1)*ye*ye*de*de)/(2*(rt?fe:oe)*ye*de);return Math.log(Math.sqrt(vt*vt+1)-vt)}function ve(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function Ce(rt){return(Math.exp(rt)+Math.exp(-rt))/2}const Oe=ge(0);let Te=function(rt){return Ce(Oe)/Ce(Oe+ce*rt)},$e=function(rt){return oe*((Ce(Oe)*(ve(vt=Oe+ce*rt)/Ce(vt))-ve(Oe))/ye)/de;var vt},Je=(ge(1)-Oe)/ce;if(Math.abs(de)<1e-6||!isFinite(Je)){if(Math.abs(oe-fe)<1e-6)return this.easeTo(n,l);const rt=fe<oe?-1:1;Je=Math.abs(Math.log(fe/oe))/ce,$e=function(){return 0},Te=function(vt){return Math.exp(rt*ce*vt)}}n.duration="duration"in n?+n.duration:1e3*Je/("screenSpeed"in n?+n.screenSpeed/ce:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const ct=v!==L,Ke=B!==x,_t=!f.isPaddingEqual($),je=n.retainPadding===!1?f.clone():f,nt=rt=>vt=>{const xt=vt*Je,lt=1/Te(xt);rt.zoom=vt===1?D:_+rt.scaleZoom(lt),ct&&(rt.bearing=a.aa(v,L,vt)),Ke&&(rt.pitch=a.aa(x,B,vt)),_t&&(je.interpolatePadding(C,$,vt),Z=je.centerPoint.add(U));const pt=vt===1?Y:rt.unproject(J.add(ae.mult($e(xt))).mult(lt));return rt.setLocationAtPoint(rt.renderWorldCopies?pt.wrap():pt,Z),rt._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(l),rt};if(n.preloadOnly){const rt=this._emulate(nt,n.duration,f);return this._preloadTiles(rt),this}return this._zooming=!0,this._rotating=ct,this._pitching=Ke,this._padding=_t,this._prepareEase(l,!1),this._ease(nt(f),()=>this._afterEase(l),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,l)}if(!n){const f=this.handlers;f&&f.stop(!1)}return this}_ease(n,l,f){f.animate===!1||f.duration===0?(n(1),l()):(this._easeStart=a.q.now(),this._easeOptions=f,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((a.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,l){n=a.bA(n,-180,180);const f=Math.abs(n-l);return Math.abs(n-360-l)<f&&(n-=360),Math.abs(n+360-l)<f&&(n+=360),n}_normalizeCenter(n){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const f=n.lng-l.center.lng;n.lng+=f>180?-360:f<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&a.q.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,l,f){const _=Math.ceil(15*l/1e3),v=[],x=n(f.clone());for(let C=0;C<=_;C++){const D=x(C/_);v.push(D.clone())}return v}_preloadTiles(n,l){}}class Jf{constructor(n={}){this.options=n,a.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const l=this.options&&this.options.compact,f=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ie("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",f);const _=Ie("span","mapboxgl-ctrl-icon",this._compactButton);return _.setAttribute("aria-hidden","true"),_.setAttribute("title",f),this._innerContainer=Ie("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(n){const f=l.reduce((_,v,x)=>(v.value&&(_+=`${v.key}=${v.value}${x<l.length-1?"&":""}`),_),"?");n.href=`${a.e.FEEDBACK_URL}/${f}#${Va(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const l=this._map.style._mergedSourceCaches;for(const _ in l){const v=l[_];if(v.used){const x=v.getSource();x.attribution&&n.indexOf(x.attribution)<0&&n.push(x.attribution)}}n.sort((_,v)=>_.length-v.length),n=n.filter((_,v)=>{for(let x=v+1;x<n.length;x++)if(n[x].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const f=n.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,n.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class gg{constructor(){a.aJ(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=Ie("div","mapboxgl-ctrl");const l=Ie("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const l in n){const f=n[l].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const l=n[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class zv{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,f=l?this._queue.concat(l):this._queue;for(const _ of f)if(_.id===n)return void(_.cancelled=!0)}run(n=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const f of l)if(!f.cancelled&&(f.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Zh{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const l=a.cw((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,l,f){this._start=this.getValue(l),this._end=n,this._startTime=l,this._endTime=l+f}}const cw={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class uw{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class _g{constructor(n){this.map=n,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(n,l){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const{type:f,filter:_}=l;if(_){const x=a.M(_,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(x.result==="error")throw new Error(x.value.map(C=>`${C.key}: ${C.message}`).join(", "));this.filters.set(n,x.value)}const v=this.interactionsByType.get(f)||new Map;v.size===0&&(this.map.on(f,this.handleType),this.interactionsByType.set(f,v)),v.set(n,l),this.typeById.set(n,f)}remove(n){const l=this.typeById.get(n);if(!l)return;this.typeById.delete(n),this.filters.delete(n);const f=this.interactionsByType.get(l);f&&(f.delete(n),f.size===0&&this.map.off(l,this.handleType))}handleType(n){const l=n.features||this.map.queryRenderedFeatures(n.point);if(!l)return;const f=this.interactionsByType.get(n.type),_={zoom:0};for(const[v,x]of f){const C=this.filters.get(v),{handler:D,layers:L}=x;for(const B of l)if((!L||L.includes(B.layer.id))&&(!C||C.evaluate(_,B))&&D({id:v,feature:B,interaction:x})!==!1)break}}}const yg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Xh={showCompass:!0,showZoom:!0,visualizePitch:!1};class xu{constructor(n,l,f=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new Wf({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,f&&(this.mousePitch=new Zf({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(n,l){this.mouseRotate.mousedown(n,l),this.mousePitch&&this.mousePitch.mousedown(n,l),He()}move(n,l){const f=this.map,_=this.mouseRotate.mousemoveWindow(n,l),v=_&&_.bearingDelta;if(v&&f.setBearing(f.getBearing()+v),this.mousePitch){const x=this.mousePitch.mousemoveWindow(n,l),C=x&&x.pitchDelta;C&&f.setPitch(f.getPitch()+C)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ht(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(a.l({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),gt(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,gt(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Tt(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=Tt(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function va(d,n,l){if(d=new a.bK(d.lng,d.lat),n){const f=new a.bK(d.lng-360,d.lat),_=new a.bK(d.lng+360,d.lat),v=360*Math.ceil(Math.abs(d.lng-l.center.lng)/360),x=l.locationPoint(d).distSqr(n),C=n.x<0||n.y<0||n.x>l.width||n.y>l.height;l.locationPoint(f).distSqr(n)<x&&(C||Math.abs(f.lng-l.center.lng)<v)?d=f:l.locationPoint(_).distSqr(n)<x&&(C||Math.abs(_.lng-l.center.lng)<v)&&(d=_)}for(;Math.abs(d.lng-l.center.lng)>180;){const f=l.locationPoint(d);if(f.x>=0&&f.y>=0&&f.x<=l.width&&f.y<=l.height)break;d.lng>l.center.lng?d.lng-=360:d.lng+=360}return d}const Qo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ba extends a.E{constructor(n,l){if(super(),(n instanceof HTMLElement||l)&&(n=a.l({element:n},l)),a.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=n&&n.occludedOpacity||.2,n&&n.element)this._element=n.element,this._offset=a.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ie("div");const v=41,x=27,C=dt("svg",{display:"block",height:v*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${v}`},this._element),D=dt("radialGradient",{id:"shadowGradient"},dt("defs",{},C));dt("stop",{offset:"10%","stop-opacity":.4},D),dt("stop",{offset:"100%","stop-opacity":.05},D),dt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},C),dt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},C),dt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},C),dt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},C),this._offset=a.P.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const f=this._element.classList;for(const v in Qo)f.remove(`mapboxgl-marker-anchor-${v}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`);const _=n&&n.className?n.className.trim().split(/\s+/):[];f.add(..._),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.bK.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const l=n.code,f=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(n){const l=n.originalEvent.target,f=this._element;this._popup&&(l===f||f.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,l=this._pos;if(!n||!l)return!1;const f=n.unproject(l),_=n.getFreeCameraOptions();if(!_.position)return!1;const v=_.position.toLngLat();return v.distanceTo(f)<.9*v.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const l=this._pos;if(!l||l.x<0||l.x>n.transform.width||l.y<0||l.y>n.transform.height)return void this._clearFadeTimer();const f=n.unproject(l);let _;n._showingGlobe()&&a.dz(n.transform,this._lngLat)?_=0:(_=1-n._queryFogOpacity(f),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${Qo[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const n=this._pos,l=this._map,f=this.getPitchAlignment();if(!l||!n||f!=="map")return"";if(!l._showingGlobe()){const D=l.getPitch();return D?`rotateX(${D}deg)`:""}const _=a.c0(a.dA(l.transform,this._lngLat)),v=n.sub(a.dB(l.transform)),x=Math.abs(v.x)+Math.abs(v.y);if(x===0)return"";const C=_/x;return`rotateX(${-v.y*C}deg) rotateY(${v.x*C}deg)`}_calculateZTransform(){const n=this._pos,l=this._map;if(!l||!n)return"";let f=0;const _=this.getRotationAlignment();if(_==="map")if(l._showingGlobe()){const v=l.project(new a.bK(this._lngLat.lng,this._lngLat.lat+.001)),x=l.project(new a.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(v);f=a.c0(Math.atan2(x.y,x.x))-90}else f=-l.getBearing();else if(_==="horizon"){const v=a.a7(4,6,l.getZoom()),x=a.dB(l.transform);x.y+=v*l.transform.height;const C=n.sub(x),D=a.c0(Math.atan2(C.y,C.x));f=(D>90?D-270:D+90)*(1-v)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=va(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),n===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=a.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const l=this._map;if(!l)return;const f=this._pointerdownPos,_=this._positionDelta;if(f&&_){if(!this._isDragging){const v=this._clickTolerance||l._clickTolerance;if(n.point.dist(f)<v)return;this._isDragging=!0}this._pos=n.point.sub(_),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.x("dragstart"))),this.fire(new a.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.x("dragend")),this._state="inactive"}_addDragHandler(n){const l=this._map,f=this._pos;l&&f&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(f),this._pointerdownPos=n.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const l=this._map;return l&&(n?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const uc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},El={maxWidth:100,unit:"metric"},hw={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},dw={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},fw=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Fv(d=new a.P(0,0),n="bottom"){if(typeof d=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(n){case"top":return new a.P(0,d);case"top-left":return new a.P(l,l);case"top-right":return new a.P(-l,l);case"bottom":return new a.P(0,-d);case"bottom-left":return new a.P(l,-l);case"bottom-right":return new a.P(-l,-l);case"left":return new a.P(d,0);case"right":return new a.P(-d,0)}return new a.P(0,0)}return d instanceof a.P||Array.isArray(d)?a.P.convert(d):a.P.convert(d[n]||[0,0])}return{version:N,supported:xe.supported,setRTLTextPlugin:a.dC,getRTLTextPluginStatus:a.dD,Map:class extends mg{constructor(d){K.mark(H.create);const n=d;if((d=a.l({},yg,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&a.dx(window)&&(d.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new hf(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._repaint=!!d.repaint,this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._collectResourceTiming=d.collectResourceTiming,this._language=this._parseLanguage(d.language),this._worldview=d.worldview,this._renderTaskQueue=new zv,this._domRenderTaskQueue=new zv,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.aP(),this._locale=a.l({},cw,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._performanceMetricsCollection=d.performanceMetricsCollection,this._tessellationStep=d.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=d.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Zh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new Jt(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,this._contextCreateOptions=d.contextCreateOptions?{...d.contextCreateOptions}:{},typeof d.container=="string"){const l=document.getElementById(d.container);if(!l)throw new Error(`Container '${d.container.toString()}' not found.`);this._container=l}else{if(!(d.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),a.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new uw),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new fo(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,(d.style||!d.testMode)&&this.setStyle(d.style||a.e.DEFAULT_STYLE,{config:d.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),d.hash&&(this._hash=new wl(typeof d.hash=="string"&&d.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch});const l=d.bounds;l&&(this.resize(),this.fitBounds(l,a.l({},d.fitBoundsOptions,{duration:0})))}this.resize(),d.attributionControl&&this.addControl(new Jf({customAttribution:d.customAttribution})),this._logoControl=new gg,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new a.x(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new a.x(`${l.dataType}dataloading`,l))}),this._interactions=new _g(this)}_getMapId(){return this._mapId}addControl(d,n){if(n===void 0&&(n=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=d.onAdd(this);this._controls.push(d);const f=this._controlPositions[n];return n.indexOf("bottom")!==-1?f.insertBefore(l,f.firstChild):f.appendChild(l),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(d);return n>-1&&this._controls.splice(n,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new a.x("movestart",d)).fire(new a.x("move",d)),this.fire(new a.x("resize",d)),n&&this.fire(new a.x("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(a.as.convert(d)),this._update()}setMinZoom(d){if((d=d!=null?d:-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new a.x("zoomstart")).fire(new a.x("zoom")).fire(new a.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d!=null?d:22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new a.x("zoomstart")).fire(new a.x("zoom")).fire(new a.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d!=null?d:0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new a.x("pitchstart")).fire(new a.x("pitch")).fire(new a.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d!=null?d:85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new a.x("pitchstart")).fire(new a.x("pitch")).fire(new a.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(d){return d==="auto"?navigator.language:Array.isArray(d)?d.length===0?void 0:d.map(n=>n==="auto"?navigator.language:n):d}setLanguage(d){const n=this._parseLanguage(d);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){return this.style&&d!==this._worldview?(this._worldview=d,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(d){return this._lazyInitEmptyStyle(),d?typeof d=="string"&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const d=this.transform,n=d.projection.name;let l;n==="globe"&&d.zoom>=a.bU?(d.setMercatorFromTransition(),l=!0):n==="mercator"&&d.zoom<a.bU&&(d.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,n){return this._updateProjection(d||n||{name:"mercator"})}_updateProjection(d){let n;return n=d.name==="globe"&&this.transform.zoom>=a.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(d){return this.transform.locationPoint3D(a.bK.convert(d))}unproject(d){return this.transform.pointLocation3D(a.P.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(d,n,l){if(d==="mouseenter"||d==="mouseover"){let f=!1;const _=x=>{const C=n.filter(L=>this.getLayer(L)),D=C.length?this.queryRenderedFeatures(x.point,{layers:C}):[];D.length?f||(f=!0,l.call(this,new So(d,this,x.originalEvent,{features:D}))):f=!1},v=()=>{f=!1};return{layers:new Set(n),listener:l,delegates:{mousemove:_,mouseout:v}}}if(d==="mouseleave"||d==="mouseout"){let f=!1;const _=x=>{const C=n.filter(D=>this.getLayer(D));(C.length?this.queryRenderedFeatures(x.point,{layers:C}):[]).length?f=!0:f&&(f=!1,l.call(this,new So(d,this,x.originalEvent)))},v=x=>{f&&(f=!1,l.call(this,new So(d,this,x.originalEvent)))};return{layers:new Set(n),listener:l,delegates:{mousemove:_,mouseout:v}}}{const f=_=>{const v=n.filter(C=>this.getLayer(C)),x=v.length?this.queryRenderedFeatures(_.point,{layers:v}):[];x.length&&(_.features=x,l.call(this,_),delete _.features)};return{layers:new Set(n),listener:l,delegates:{[d]:f}}}}on(d,n,l){if(typeof n=="function"||l===void 0)return super.on(d,n);if(Array.isArray(n)||(n=[n]),n){for(const _ of n)if(!this._isValidId(_))return this}const f=this._createDelegatedListener(d,n,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return this}once(d,n,l){if(typeof n=="function"||l===void 0)return super.once(d,n);if(Array.isArray(n)||(n=[n]),n){for(const _ of n)if(!this._isValidId(_))return this}const f=this._createDelegatedListener(d,n,l);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(d,n,l){if(typeof n=="function"||l===void 0)return super.off(d,n);const f=new Set(Array.isArray(n)?n:[n]);for(const x of f)if(!this._isValidId(x))return this;const _=(x,C)=>{if(x.size!==C.size)return!1;for(const D of x)if(!C.has(D))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[d]:void 0;return v&&(x=>{for(let C=0;C<x.length;C++){const D=x[C];if(D.listener===l&&_(D.layers,f)){for(const L in D.delegates)this.off(L,D.delegates[L]);return x.splice(C,1),this}}})(v),this}queryRenderedFeatures(d,n){if(!this.style)return[];if(n!==void 0||d===void 0||d instanceof a.P||Array.isArray(d)||(n=d,d=void 0),d=d||[[0,0],[this.transform.width,this.transform.height]],(n=n||{}).layers&&Array.isArray(n.layers)){for(const l of n.layers)if(!this._isValidId(l))return[]}return this.style.queryRenderedFeatures(d,n,this.transform)}querySourceFeatures(d,n){return this._isValidId(d)?this.style.querySourceFeatures(d,n):[]}isPointOnSurface(d){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&a.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(d))}addInteraction(d,n){return this._interactions.add(d,n),this}removeInteraction(d){return this._interactions.remove(d),this}setStyle(d,n){return n=a.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&d&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(d,(l,f)=>{l?(a.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(d,n)):f&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(d,n))}_getUIString(d){const n=this._locale[d];if(n==null)throw new Error(`Missing UI string '${d}'`);return n}_updateStyle(d,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d){const l=a.l({},n);n&&n.config&&(l.initialConfig=n.config,delete l.config),this.style=new Yo(this,l).load(d),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(d){return d==null?(this.fire(new a.t(new Error("IDs can't be empty."))),!1):!a.cn(d)||(this.fire(new a.t(new Error(`IDs can't contain special symbols: "${d}".`))),!1)}addSource(d,n){return this._isValidId(d)?(this._lazyInitEmptyStyle(),this.style.addSource(d,n),this._update(!0)):this}isSourceLoaded(d){return!!this._isValidId(d)&&!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(d,n,l){this._lazyInitEmptyStyle(),this.style.addSourceType(d,n,l)}removeSource(d){return this._isValidId(d)?(this.style.removeSource(d),this._updateTerrain(),this._update(!0)):this}getSource(d){return this._isValidId(d)?this.style.getOwnSource(d):null}addImage(d,n,{pixelRatio:l=1,sdf:f=!1,stretchX:_,stretchY:v,content:x}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:C,height:D,data:L}=a.q.getImageData(n);this.style.addImage(d,{data:new a.r({width:C,height:D},L),pixelRatio:l,stretchX:_,stretchY:v,content:x,sdf:f,version:0})}else if(n.width===void 0||n.height===void 0)this.fire(new a.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:C,height:D}=n,L=n;this.style.addImage(d,{data:new a.r({width:C,height:D},new Uint8Array(L.data)),pixelRatio:l,stretchX:_,stretchY:v,content:x,sdf:f,version:0,userImage:L}),L.onAdd&&L.onAdd(this,d)}}updateImage(d,n){this._lazyInitEmptyStyle();const l=this.style.getImage(d);if(!l)return void this.fire(new a.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?a.q.getImageData(n):n,{width:_,height:v,data:x}=f;if(_===void 0||v===void 0)return void this.fire(new a.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==l.data.width||v!==l.data.height)return void this.fire(new a.t(new Error(`The width and height of the updated image (${_}, ${v})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const C=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);l.data.replace(x,C),this.style.updateImage(d,l)}hasImage(d){return d?!!this.style&&!!this.style.getImage(d):(this.fire(new a.t(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,n){a.o(this._requestManager.transformRequest(d,a.R.Image),(l,f)=>{n(l,f instanceof HTMLImageElement?a.q.getImageData(f):f)})}listImages(){return this.style.listImages()}addModel(d,n){this._lazyInitEmptyStyle(),this.style.addModel(d,n)}hasModel(d){return d?this.style.hasModel(d):(this.fire(new a.t(new Error("Missing required model id"))),!1)}removeModel(d){this.style.removeModel(d)}listModels(){return this.style.listModels()}addLayer(d,n){return this._isValidId(d.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(d,n),this._update(!0)):this}getSlot(d){const n=this.getLayer(d);return n&&n.slot||null}setSlot(d,n){return this.style.setSlot(d,n),this.style.mergeLayers(),this._update(!0)}addImport(d,n){return this.style.addImport(d,n),this}updateImport(d,n){return typeof n!="string"&&n.id!==d?(this.removeImport(d),this.addImport(n)):(this.style.updateImport(d,n),this._update(!0))}removeImport(d){return this.style.removeImport(d),this}moveImport(d,n){return this.style.moveImport(d,n),this._update(!0)}moveLayer(d,n){return this._isValidId(d)?(this.style.moveLayer(d,n),this._update(!0)):this}removeLayer(d){return this._isValidId(d)?(this.style.removeLayer(d),this._update(!0)):this}getLayer(d){if(!this._isValidId(d))return null;const n=this.style.getOwnLayer(d);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(d,n,l){return this._isValidId(d)?(this.style.setLayerZoomRange(d,n,l),this._update(!0)):this}setFilter(d,n,l={}){return this._isValidId(d)?(this.style.setFilter(d,n,l),this._update(!0)):this}getFilter(d){return this._isValidId(d)?this.style.getFilter(d):null}setPaintProperty(d,n,l,f={}){return this._isValidId(d)?(this.style.setPaintProperty(d,n,l,f),this._update(!0)):this}getPaintProperty(d,n){return this._isValidId(d)?this.style.getPaintProperty(d,n):null}setLayoutProperty(d,n,l,f={}){return this._isValidId(d)?(this.style.setLayoutProperty(d,n,l,f),this._update(!0)):this}getLayoutProperty(d,n){return this._isValidId(d)?this.style.getLayoutProperty(d,n):null}getSchema(d){return this.style.getSchema(d)}setSchema(d,n){return this.style.setSchema(d,n),this._update(!0)}getConfig(d){return this.style.getConfig(d)}setConfig(d,n){return this.style.setConfig(d,n),this._update(!0)}getConfigProperty(d,n){return this.style.getConfigProperty(d,n)}setConfigProperty(d,n,l){return this.style.setConfigProperty(d,n,l),this._update(!0)}setLights(d){if(this._lazyInitEmptyStyle(),d&&d.length===1&&d[0].type==="flat"){const n=d[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(d),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const d=this.style.getLights()||[];return d.length===0&&d.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),d}setLight(d,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:d}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(d){return this._lazyInitEmptyStyle(),this.style.setColorTheme(d),this._update(!0)}setCamera(d){return this.style.setCamera(d),this._triggerCameraUpdate(d)}_triggerCameraUpdate(d){return this._update(this.transform.setOrthographicProjectionAtLowPitch(d["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.bK.convert(d),this.transform):0}setFeatureState(d,n){return this._isValidId(d.source)?(this.style.setFeatureState(d,n),this._update()):this}removeFeatureState(d,n){return this._isValidId(d.source)?(this.style.removeFeatureState(d,n),this._update()):this}getFeatureState(d){return this._isValidId(d.source)?this.style.getFeatureState(d):null}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let l,f,_,v=this._container;for(;v&&(!f||!_);){const x=window.getComputedStyle(v).transform;x&&x!=="none"&&(l=x.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(f=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(_=l[3])),v=v.parentElement}this._containerWidth=f?Math.abs(d/f):d,this._containerHeight=_?Math.abs(n/_):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ie("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=Ie("div","mapboxgl-canvas-container",d);this._canvas=Ie("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=Ie("div","mapboxgl-control-container",d),f=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(_=>{f[_]=Ie("div",`mapboxgl-ctrl-${_}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,n){const l=a.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(d),this._canvas.height=l*Math.ceil(n),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${n}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const n=this._markers.indexOf(d);n!==-1&&this._markers.splice(n,1)}_addPopup(d){this._popups.push(d)}_removePopup(d){const n=this._popups.indexOf(d);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const d=a.l({},xe.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",d);n?(Ne(n,!0),this.painter=new ng(n,this._contextCreateOptions,this.transform,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.m.testSupport(n)):this.fire(new a.t(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.x("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.x("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let n;this.fire(new a.x("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,f=a.q.now(),_=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=_.createQuery(),_.beginQuery(l.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,B=this.transform.pitch,$=a.q.now(),j=new a.a3(L,{now:$,fadeDuration:v,pitch:B,transition:this.style.transition});this.style.update(j)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let x=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),x=this._updateAverageElevation(f),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):x=this._updateAverageElevation(f);const C=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,this.painter.replacementSource);if(C&&(this._placementDirty=C.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,K.mark(H.load),this.fire(new a.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const L=a.q.now()-f;_.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const B=_.getQueryParameter(n,_.QUERY_RESULT)/1e6;_.deleteQuery(n),this.fire(new a.x("gpu-timing-frame",{cpuTime:L,gpuTime:B}))},50)}if(this.listens("gpu-timing-layer")){const L=this.painter.collectGpuTimers();setTimeout(()=>{const B=this.painter.queryGpuTimers(L);this.fire(new a.x("gpu-timing-layer",{layerTimes:B}))},50)}if(this.listens("gpu-timing-deferred-render")){const L=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const B=this.painter.queryGpuTimeDeferredRender(L);this.fire(new a.x("gpu-timing-deferred-render",{gpuTime:B}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(D||this._repaint)this.triggerRepaint();else{const L=this.idle();if(L&&(x=this._updateAverageElevation(f,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),L&&(this.fire(new a.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new a.x("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,K.mark(H.fullLoad),this._performanceMetricsCollection&&hs(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(d){for(const n of this._markers)d&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!d||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(d,n=!1){const l=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const f=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(f||(n||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const _=this.transform.averageElevation;let v=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=d;const x=Math.abs(_-v);if(x>1){if(this._isInitialLoad||f)return this._averageElevation.jumpTo(v),l(v);this._averageElevation.easeTo(v,d,300)}else if(x>1e-4)return this._averageElevation.jumpTo(v),l(v)}return!!this._averageElevation.isEasing(d)&&l(this._averageElevation.getValue(d))}_authenticate(){we(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===xr||d.status===401)){const n=this.painter.context.gl;Ne(n,!1),this._logoControl instanceof gg&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),us(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&yi(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const d=this._isDragging();this.painter.updateTerrain(this.style,d)}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const l=this.painter.context.gl,f=l.createFramebuffer();function _(v){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,v,0);const x=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,x),x}return l.bindFramebuffer(l.FRAMEBUFFER,f),this._canvasPixelComparison(_(d),n.canvasCopies.map(_),n.timeStamps)}_canvasPixelComparison(d,n,l){let f=l[1]-l[0];const _=d.length/4;for(let v=0;v<n.length;v++){const x=n[v];let C=0;for(let D=0;D<x.length;D+=4)x[D]===d[D]&&x[D+1]===d[D+1]&&x[D+2]===d[D+2]&&x[D+3]===d[D+3]&&(C+=1);f+=(l[v+2]-l[v+1])*(1-C/_)}return f}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Kn.delete(this.painter.context.gl),qi.remove(),ir.remove(),this._removed=!0,this.fire(new a.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=a.q.frame(n=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(n)}))}_preloadTiles(d){const n=this.style?this.style.getSourceCaches():[];return a.bf(n,(l,f)=>l._preloadTiles(d,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(d){this._showParseStatus!==d&&(this._showParseStatus=d,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(d){this._showLayers2DWireframe!==d&&(this._showLayers2DWireframe=d,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(d){this._showLayers3DWireframe!==d&&(this._showLayers3DWireframe=d,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,this._tp.refreshUI(),d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(d){this._showTileAABBs!==d&&(this._showTileAABBs=d,this._tp.refreshUI(),d&&this._update())}_setCacheLimits(d,n){a.dy(d,n)}get version(){return N}},NavigationControl:class{constructor(d={}){this.options=a.l({},Xh,d),this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(a.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),Ie("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),Ie("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:n}):l.resetNorth({},{originalEvent:n}))}),this._compassIcon=Ie("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const n=d.getZoom(),l=n===d.getMaxZoom(),f=n===d.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xu(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,n){const l=Ie("button",d,this._container);return l.type="button",l.addEventListener("click",n),l}_setButtonTitle(d,n){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${n}`);d.setAttribute("aria-label",l),d.firstElementChild&&d.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends a.E{constructor(d={}){super();const n=navigator.geolocation;this.options=a.l({geolocation:n},uc,d),a.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ja(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){const n=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,d(l)};this._supportsGeolocation!==void 0?d(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>n(l.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(d){const n=this._map.getMaxBounds(),l=d.coords;return!!n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.x("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.x("geolocate",d)),this._finish()}}_updateCamera(d){const n=new a.bK(d.coords.longitude,d.coords.latitude),l=d.coords.accuracy,f=this._map.getBearing(),_=a.l({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(l),_,{geolocateSource:!0})}_updateMarker(d){if(d){const n=new a.bK(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,n=a.bD(1,d._center.lat)*d.worldSize,l=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.x("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=Ie("button","mapboxgl-ctrl-geolocate",this._container),Ie("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ie("div","mapboxgl-user-location"),this._dotElement.appendChild(Ie("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ie("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ba({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ie("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ba({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.x("trackuserlocationend")))})}}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Jf,ScaleControl:class{constructor(d={}){this.options=a.l({},El,d),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,n=this._map,l=n._containerHeight/2,f=n._containerWidth/2-d/2,_=n.unproject([f,l]),v=n.unproject([f+d,l]),x=_.distanceTo(v);if(this.options.unit==="imperial"){const C=3.2808*x;C>5280?this._setScale(d,C/5280,"mile"):this._setScale(d,C,"foot")}else this.options.unit==="nautical"?this._setScale(d,x/1852,"nautical-mile"):x>=1e3?this._setScale(d,x/1e3,"kilometer"):this._setScale(d,x,"meter")}_setScale(d,n,l){this._map._requestDomTask(()=>{const f=function(v){const x=Math.pow(10,`${Math.floor(v)}`.length-1);let C=v/x;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(D){const L=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*L)/L}(C),x*C}(n),_=f/n;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(f):`${f}&nbsp;${hw[l]}`,this._container.style.width=d*_+"px"})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d={}){this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:a.w("Full screen control 'container' must be a DOM element.")),a.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=Ie("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ie("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(d){super(),this.options=a.l(Object.create(dw),d),a.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),d._addPopup(this),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new a.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),d._canvasContainer&&d._canvasContainer.classList.remove("mapboxgl-track-pointer"),d._removePopup(this),this._map=void 0),this.fire(new a.x("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=a.bK.convert(d),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const n=document.createDocumentFragment(),l=document.createElement("body");let f;for(l.innerHTML=d;f=l.firstChild,f;)n.appendChild(f);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=Ie("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(d),this.options.closeButton){const l=this._closeButton=Ie("button","mapboxgl-popup-close-button",n);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let n;return this._classList.delete(d)?n=!1:(this._classList.add(d),n=!0),this._updateClassList(),n}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const n=this._map,l=this._container,f=this._pos;if(!n||!l||!f)return"bottom";const _=l.offsetWidth,v=l.offsetHeight,x=f.x<_/2,C=f.x>n.transform.width-_/2;if(f.y+d<v)return x?"top-left":C?"top-right":"top";if(f.y>n.transform.height-v){if(x)return"bottom-left";if(C)return"bottom-right"}return x?"left":C?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),d.className=n.join(" ")}_update(d){const n=this._map,l=this._content;if(!n||!this._lngLat&&!this._trackPointer||!l)return;let f=this._container;if(f||(f=this._container=Ie("div","mapboxgl-popup",n.getContainer()),this._tip=Ie("div","mapboxgl-popup-tip",f),f.appendChild(l)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=va(this._lngLat,this._pos,n.transform)),!this._trackPointer||d){const _=this._pos=this._trackPointer&&d instanceof a.P?d:n.project(this._lngLat),v=Fv(this.options.offset),x=this._anchor=this._getAnchor(v.y),C=Fv(this.options.offset,x),D=_.add(C).round();n._requestDomTask(()=>{this._container&&x&&(this._container.style.transform=`${Qo[x]} translate(${D.x}px,${D.y}px)`)})}if(!this._marker&&n._showingGlobe()){const _=a.dz(n.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(fw);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:ba,Style:Yo,LngLat:a.bK,LngLatBounds:a.as,Point:a.P,MercatorCoordinate:a.a5,FreeCameraOptions:ml,Evented:a.E,config:a.e,prewarm:a.dE,clearPrewarmedResources:a.dF,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(d){a.e.ACCESS_TOKEN=d},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(d){a.e.API_URL=d},get workerCount(){return a.dG.workerCount},set workerCount(d){a.dG.workerCount=d},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.e.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){a.dH(d)},get workerUrl(){return a.dI.workerUrl},set workerUrl(d){a.dI.workerUrl=d},get workerClass(){return a.dI.workerClass},set workerClass(d){a.dI.workerClass=d},get workerParams(){return a.dI.workerParams},set workerParams(d){a.dI.workerParams=d},get dracoUrl(){return a.dJ()},set dracoUrl(d){a.dK(d)},get meshoptUrl(){return a.dL()},set meshoptUrl(d){a.dM(d)},setNow:a.q.setNow,restoreNow:a.q.restoreNow}});var I=g;return I})})(K$);const n0=uoe(K$.exports),hoe="pk.eyJ1Ijoiam9obnkxOTkzIiwiYSI6ImNtMjRkdjgwejBmaTkya3F1NjNuMTZscjAifQ.ookk0XVYH0pmSIyajHmJ2w",doe="f7450cc8cbmsh7e7667b28d88e36p131fe8jsnbd882a9da5ae";function foe(t){const e=Xu(null),r=Xu(null),s=Xu(null);return lm(()=>{n0.accessToken=hoe,r.value=new n0.Map({container:e.value,style:"mapbox://styles/mapbox/streets-v11"}),r.value.on("load",()=>{r.value.addSource("polygon",{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:t.features[0].geometry.coordinates}}}),r.value.addLayer({id:"polygon-layer",type:"fill",source:"polygon",layout:{},paint:{"fill-color":"#888888","fill-opacity":.5}});const T=t.features[0].geometry.coordinates[0].reduce((I,a)=>I.extend(a),new n0.LngLatBounds);r.value.fitBounds(T,{padding:20,maxZoom:20}),r.value.on("mouseenter","polygon-layer",I=>{const a=t.features[0].properties.city,N=t.features[0].properties.state;s.value=new n0.Popup().setLngLat(I.lngLat).setHTML(`<h3>${a}, ${N}</h3>`).addTo(r.value),r.value.getCanvas().style.cursor="pointer"}),r.value.on("mouseleave","polygon-layer",()=>{s.value&&(s.value.remove(),s.value=null),r.value.getCanvas().style.cursor=""})})}),{mapContainer:e}}const poe={name:"MapComponent",props:{items:{type:Object,required:!0}},setup(t){const{mapContainer:e}=foe(t.items);return{mapContainer:e}}},moe={class:"map-container",ref:"mapContainer"};function goe(t,e,r,s,g,T){return ih(),$x("div",moe,null,512)}const _oe=VP(poe,[["render",goe],["__scopeId","data-v-981b8023"]]),uk={40202:{type:"FeatureCollection",features:[{type:"Feature",properties:{zipCode:"40202",country:"US",city:"Louisville",county:"Jefferson",state:"KY"},geometry:{type:"Polygon",coordinates:[[[-85.771761,38.263385],[-85.764223,38.269678],[-85.7611400240452,38.2726423364171],[-85.761062,38.27257],[-85.7514808802086,38.268111459107],[-85.750962,38.26787],[-85.744862,38.26717],[-85.7447955625997,38.2671938548939],[-85.741456,38.26079],[-85.741154,38.260395],[-85.739382,38.260037],[-85.736594,38.26066],[-85.738017,38.258813],[-85.737242,38.257697],[-85.738281,38.251799],[-85.73931,38.245839],[-85.737375,38.245135],[-85.739403,38.245302],[-85.739637,38.243938],[-85.741537,38.244831],[-85.74968,38.24544],[-85.752463,38.244923],[-85.752731,38.243006],[-85.755491,38.243309],[-85.755269,38.244562],[-85.758701,38.244241],[-85.75838,38.246079],[-85.760046,38.246201],[-85.760371,38.244389],[-85.763582,38.244709],[-85.763373,38.246452],[-85.766509,38.246867],[-85.766213,38.248535],[-85.763073,38.24819],[-85.76284,38.249493],[-85.761187,38.24931],[-85.760801,38.251497],[-85.762455,38.25168],[-85.762121,38.253604],[-85.763832,38.253435],[-85.763629,38.254564],[-85.766941,38.254927],[-85.768474,38.255796],[-85.767879,38.259213],[-85.769532,38.259393],[-85.769292,38.260814],[-85.772257,38.26285],[-85.771761,38.263385]]]}}]},937081:{type:"FeatureCollection",features:[{type:"Feature",properties:{zipCode:"00937",country:"US",city:"San juan",county:"San juan",state:"PR"},geometry:{type:"Polygon",coordinates:[[[-66.10607808178374,18.468336893066585],[-66.10613103631808,18.46833342489273],[-66.10614684179639,18.46829118105951],[-66.10611143290951,18.468257380064152],[-66.1060643535852,18.46832458248939],[-66.10607808178374,18.468336893066585]]]}}]},93708:{type:"FeatureCollection",features:[{type:"Feature",properties:{zipCode:"93708",country:"US",city:"Fresno",county:"Fresno",state:"CA"},geometry:{type:"Polygon",coordinates:[[[-119.77162,36.747541],[-119.77163,36.747531],[-119.77165,36.747509],[-119.77164,36.747475],[-119.77154,36.747497],[-119.77162,36.747541]]]}}]}},yoe="https://vanitysoft-boundaries-io-v1.p.rapidapi.com/reaperfire/rest/v1/public/boundary";function voe(t){const e=new URL(window.location.href);e.searchParams.set("zipcode",t),window.history.replaceState({},"",e.toString())}function boe(t){return/^\d{5}(-\d{4})?$/.test(t)}const xoe={async getByZipCode(t){var s;if(!boe(t))throw new Error("Please enter a valid ZIP code.");const e=new URL(yoe),r=new URLSearchParams;r.append("zipcode",t),e.search=r.toString();try{const g=await fetch(e.toString(),{method:"GET",headers:{"x-rapidapi-host":"vanitysoft-boundaries-io-v1.p.rapidapi.com","x-rapidapi-key":doe}});if(!g.ok){const I=await g.text();throw new Error(I||"Error fetching boundary data")}if(voe(t),uk[t])return Promise.resolve(uk[t]);const T=await g.json();if(!((s=T.features)!=null&&s[0]))throw new Error(`${t} is not a valid zipcode`);return T}catch(g){throw console.error("Error:",g),g}}};const woe={components:{ZipCodeForm:loe,MapComponent:_oe},mounted(){const e=new URLSearchParams(window.location.search).get("zipcode");e&&this.onSubmit(e)},data(){return{loading:!1,errorMessage:!1,items:null}},methods:{async onSubmit(t){this.loading=!0,this.items=null;try{const e=await xoe.getByZipCode(t);this.items=e}catch(e){this.errorMessage=e,this.$bvModal.show("error-modal")}finally{this.loading=!1}}}},Toe={class:"container"};function Eoe(t,e,r,s,g,T){const I=wd("ZipCodeForm"),a=wd("MapComponent"),N=wd("b-overlay"),H=wd("b-modal");return ih(),$x(_o,null,[iy("div",Toe,[Bi(N,{show:g.loading,rounded:"sm"},{default:Gp(()=>[Bi(I,{onOnSubmit:T.onSubmit},null,8,["onOnSubmit"]),g.items?(ih(),jx(a,{key:0,items:g.items},null,8,["items"])):IO("",!0)]),_:1},8,["show"])]),Bi(H,{id:"error-modal",title:"Error"},{default:Gp(()=>[iy("p",null,nO(g.errorMessage),1)]),_:1})],64)}const Soe=VP(woe,[["render",Eoe],["__scopeId","data-v-acc1106b"]]);An.use(soe);const Ooe=Wx(Soe);Ooe.mount("#app");
